[
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "I am Zhixuan!\nNavigate to the various tabs to view my learning journey!\nThis website is made with the guidance from Prof Kam\nI have taken this module in AY23 Nov Term. Below are the reference to the various hands-on and in class exercise:\n\nIn-class Exercise 1, 2, 4, 5\nHands on Exercise 1, 2 , 3, 4 and In-class Exercise 3\n\nAlso, Prof Kam shared on the useful tips for this module located here"
  },
  {
    "objectID": "Hands-On_Exercise1.html",
    "href": "Hands-On_Exercise1.html",
    "title": "Hands-on Exercise 1",
    "section": "",
    "text": "Overview\nThis is a overview paragraph.\n\n\nGetting Started\nThis is a getting started paragraph"
  },
  {
    "objectID": "hands_on_ex1/hands_on_ex1.1.html",
    "href": "hands_on_ex1/hands_on_ex1.1.html",
    "title": "Hands-on Exercise 1.1: Geospatial Data Wrangling with R",
    "section": "",
    "text": "In this hands-on exercise, I learn how to import and wrangling geospatial data in using appropriate R packages."
  },
  {
    "objectID": "hands_on_ex1/hands_on_ex1.1.html#overview",
    "href": "hands_on_ex1/hands_on_ex1.1.html#overview",
    "title": "Hands-on Exercise 1.1: Geospatial Data Wrangling with R",
    "section": "",
    "text": "In this hands-on exercise, I learn how to import and wrangling geospatial data in using appropriate R packages."
  },
  {
    "objectID": "hands_on_ex1/hands_on_ex1.1.html#getting-started",
    "href": "hands_on_ex1/hands_on_ex1.1.html#getting-started",
    "title": "Hands-on Exercise 1.1: Geospatial Data Wrangling with R",
    "section": "Getting Started",
    "text": "Getting Started\nThe code chunk below install and load sf and tidyverse packages into R environment.\n\npacman::p_load(sf, tidyverse)"
  },
  {
    "objectID": "hands_on_ex1/hands_on_ex1.1.html#importing-geospatial-data",
    "href": "hands_on_ex1/hands_on_ex1.1.html#importing-geospatial-data",
    "title": "Hands-on Exercise 1.1: Geospatial Data Wrangling with R",
    "section": "Importing Geospatial Data",
    "text": "Importing Geospatial Data\n\nImporting polygon feature data\nDataset used:\n\nMaster Plan 2014 Subzone Boundary (Web) from data.gov.sg\nPre-Schools Location from data.gov.sg\nCycling Path from LTADataMall\nLatest version of Singapore Airbnb listing data from Inside Airbnb\n\nClick here to know more about st_read()\n\nMP14_SUBZONE_WEB_PL, a polygon feature layer in ESRI shapefile format\n\n\nmpsz = st_read(dsn = \"data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex1\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\n\nCyclingPath, a line feature layer in ESRI shapefile format\n\n\ncyclingpath = st_read(dsn = \"data/geospatial\",                           layer = \"CyclingPathGazette\")\n\nReading layer `CyclingPathGazette' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex1\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 2558 features and 2 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11854.32 ymin: 28347.98 xmax: 42626.09 ymax: 48948.15\nProjected CRS: SVY21\n\n\n\nPreSchool, a point feature layer in kml file format\n\n\npreschool = st_read(\"data/geospatial/PreSchoolsLocation.kml\")\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex1\\data\\geospatial\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\n\n\nChecking content of a simple dataframe\n\nWorking with st_geometry()\n\n\nst_geometry(mpsz)\n\nGeometry set for 323 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 5 geometries:\n\n\nMULTIPOLYGON (((31495.56 30140.01, 31980.96 296...\n\n\nMULTIPOLYGON (((29092.28 30021.89, 29119.64 300...\n\n\nMULTIPOLYGON (((29932.33 29879.12, 29947.32 298...\n\n\nMULTIPOLYGON (((27131.28 30059.73, 27088.33 297...\n\n\nMULTIPOLYGON (((26451.03 30396.46, 26440.47 303...\n\n\n\nWorking with glimpse()\n\n\nglimpse(mpsz)\n\nRows: 323\nColumns: 16\n$ OBJECTID   &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, …\n$ SUBZONE_NO &lt;int&gt; 1, 1, 3, 8, 3, 7, 9, 2, 13, 7, 12, 6, 1, 5, 1, 1, 3, 2, 2, …\n$ SUBZONE_N  &lt;chr&gt; \"MARINA SOUTH\", \"PEARL'S HILL\", \"BOAT QUAY\", \"HENDERSON HIL…\n$ SUBZONE_C  &lt;chr&gt; \"MSSZ01\", \"OTSZ01\", \"SRSZ03\", \"BMSZ08\", \"BMSZ03\", \"BMSZ07\",…\n$ CA_IND     &lt;chr&gt; \"Y\", \"Y\", \"Y\", \"N\", \"N\", \"N\", \"N\", \"Y\", \"N\", \"N\", \"N\", \"N\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA SOUTH\", \"OUTRAM\", \"SINGAPORE RIVER\", \"BUKIT MERAH\",…\n$ PLN_AREA_C &lt;chr&gt; \"MS\", \"OT\", \"SR\", \"BM\", \"BM\", \"BM\", \"BM\", \"SR\", \"QT\", \"QT\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENT…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\", \"CR\",…\n$ INC_CRC    &lt;chr&gt; \"5ED7EB253F99252E\", \"8C7149B9EB32EEFC\", \"C35FEFF02B13E0E5\",…\n$ FMEL_UPD_D &lt;date&gt; 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05, 2014-12-05…\n$ X_ADDR     &lt;dbl&gt; 31595.84, 28679.06, 29654.96, 26782.83, 26201.96, 25358.82,…\n$ Y_ADDR     &lt;dbl&gt; 29220.19, 29782.05, 29974.66, 29933.77, 30005.70, 29991.38,…\n$ SHAPE_Leng &lt;dbl&gt; 5267.381, 3506.107, 1740.926, 3313.625, 2825.594, 4428.913,…\n$ SHAPE_Area &lt;dbl&gt; 1630379.27, 559816.25, 160807.50, 595428.89, 387429.44, 103…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((31495.56 30..., MULTIPOLYGON (…\n\n\n\nWorking with head()\n\n\nhead(mpsz, n=5) \n\nSimple feature collection with 5 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 25867.68 ymin: 28369.47 xmax: 32362.39 ymax: 30435.54\nProjected CRS: SVY21\n  OBJECTID SUBZONE_NO      SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\n1        1          1   MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\n2        2          1   PEARL'S HILL    OTSZ01      Y          OUTRAM\n3        3          3      BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\n4        4          8 HENDERSON HILL    BMSZ08      N     BUKIT MERAH\n5        5          3        REDHILL    BMSZ03      N     BUKIT MERAH\n  PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1         MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84\n2         OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06\n3         SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96\n4         BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05 26782.83\n5         BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05 26201.96\n    Y_ADDR SHAPE_Leng SHAPE_Area                       geometry\n1 29220.19   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2 29782.05   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3 29974.66   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n4 29933.77   3313.625   595428.9 MULTIPOLYGON (((27131.28 30...\n5 30005.70   2825.594   387429.4 MULTIPOLYGON (((26451.03 30...\n\n\n\n\nPlotting Geospatial Data\n\nUsing plot - Default plot of an object is a multi-plot of all attributes, up to a reasonable maximum as shown below\n\n\nplot(mpsz)\n\nWarning: plotting the first 9 out of 15 attributes; use max.plot = 15 to plot\nall\n\n\n\n\n\n\nChoose only the geometry\n\n\nplot(st_geometry(mpsz))\n\n\n\n\n\nPlot sf using special attributes\n\n\nplot(mpsz[\"PLN_AREA_N\"])\n\n\n\n\n\n\nAssigning EPSG code to a simple feature data frame\nThis is an example the coordinate system of mpsz simple feature data frame by using st_crs() of sf package as shown in the code chunk below.\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: SVY21 \n  wkt:\nPROJCRS[\"SVY21\",\n    BASEGEOGCRS[\"SVY21[WGS84]\",\n        DATUM[\"World Geodetic System 1984\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]],\n            ID[\"EPSG\",6326]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"Degree\",0.0174532925199433]]],\n    CONVERSION[\"unnamed\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"Degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"(E)\",east,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]],\n        AXIS[\"(N)\",north,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1,\n                ID[\"EPSG\",9001]]]]\n\n\nWrong EPSG code because the correct EPSG code for svy21 should be 3414\n\nmpsz3414 &lt;- st_set_crs(mpsz, 3414)\n\nWarning: st_crs&lt;- : replacing crs does not reproject data; use st_transform for\nthat\n\n\nCheck the CSR again\n\nst_crs(mpsz3414)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\n\nTransforming the projection of preschool from wgs84 to svy21\nLet us perform the projection transformation by using the code chunk below.\n\nPrint head of preschool\n\n\nhead(preschool, n=5)\n\nSimple feature collection with 5 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.8048 ymin: 1.299333 xmax: 103.8409 ymax: 1.435024\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n   Name\n1 kml_1\n2 kml_2\n3 kml_3\n4 kml_4\n5 kml_5\n                                                                                                                                                                                                                                                                                                                                                                                                Description\n1           &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDREN'S COVE PRESCHOOL PTE.LTD.&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT9390&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;498CC9FE48CC94D4&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n2                    &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDREN'S COVE PTE. LTD.&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT8675&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;22877550804213FD&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n3       &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDREN'S VINEYARD PRESCHOOL PTE. LTD&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT9308&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;B2FE90E44AD494E3&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n4 &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDTIME CARE & DEVELOPMENT CENTRE PTE.LTD.&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT9122&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;1384CDC0D14B76A1&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n5                               &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILTERN HOUSE&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT2070&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;FB24EAA6E73B2723&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n                       geometry\n1 POINT Z (103.8072 1.299333 0)\n2  POINT Z (103.826 1.312839 0)\n3 POINT Z (103.8409 1.348843 0)\n4 POINT Z (103.8048 1.435024 0)\n5   POINT Z (103.839 1.33315 0)\n\n\n\nTransform the data\n\n\npreschool3414 &lt;- st_transform(preschool,                                crs = 3414)\n\n\nDisplay data\n\n\nhead(preschool3414, n=5)\n\nSimple feature collection with 5 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 24821.92 ymin: 31299.16 xmax: 28844.56 ymax: 46303.16\nz_range:       zmin: 0 zmax: 0\nProjected CRS: SVY21 / Singapore TM\n   Name\n1 kml_1\n2 kml_2\n3 kml_3\n4 kml_4\n5 kml_5\n                                                                                                                                                                                                                                                                                                                                                                                                Description\n1           &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDREN'S COVE PRESCHOOL PTE.LTD.&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT9390&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;498CC9FE48CC94D4&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n2                    &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDREN'S COVE PTE. LTD.&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT8675&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;22877550804213FD&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n3       &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDREN'S VINEYARD PRESCHOOL PTE. LTD&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT9308&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;B2FE90E44AD494E3&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n4 &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILDTIME CARE & DEVELOPMENT CENTRE PTE.LTD.&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT9122&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;1384CDC0D14B76A1&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n5                               &lt;center&gt;&lt;table&gt;&lt;tr&gt;&lt;th colspan='2' align='center'&gt;&lt;em&gt;Attributes&lt;/em&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;CENTRE_NAME&lt;/th&gt; &lt;td&gt;CHILTERN HOUSE&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;CENTRE_CODE&lt;/th&gt; &lt;td&gt;PT2070&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"#E3E3F3\"&gt; &lt;th&gt;INC_CRC&lt;/th&gt; &lt;td&gt;FB24EAA6E73B2723&lt;/td&gt; &lt;/tr&gt;&lt;tr bgcolor=\"\"&gt; &lt;th&gt;FMEL_UPD_D&lt;/th&gt; &lt;td&gt;20211201093631&lt;/td&gt; &lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n                       geometry\n1 POINT Z (25089.46 31299.16 0)\n2 POINT Z (27189.07 32792.54 0)\n3 POINT Z (28844.56 36773.76 0)\n4 POINT Z (24821.92 46303.16 0)\n5 POINT Z (28637.82 35038.49 0)"
  },
  {
    "objectID": "hands_on_ex1/hands_on_ex1.1.html#importing-the-aspatial-data",
    "href": "hands_on_ex1/hands_on_ex1.1.html#importing-the-aspatial-data",
    "title": "Hands-on Exercise 1.1: Geospatial Data Wrangling with R",
    "section": "Importing the aspatial data",
    "text": "Importing the aspatial data\n\nImport listing data\n\nlistings &lt;- read_csv(\"data/aspatial/listings.csv\")\n\nRows: 3483 Columns: 18\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr   (6): name, host_name, neighbourhood_group, neighbourhood, room_type, l...\ndbl  (11): id, host_id, latitude, longitude, price, minimum_nights, number_o...\ndate  (1): last_review\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nExamine the dataset after importing to see if it is imported correctly\n\n\n\nCreating a simple feature data frame from an aspatial data frame\nThe code chunk below converts listing data frame into a simple feature data frame by using st_as_sf() of sf packages\n\nlistings_sf &lt;- st_as_sf(listings, \n                       coords = c(\"longitude\", \"latitude\"),\n                       crs=4326) %&gt;%\n  st_transform(crs = 3414)\n\nExamine the dataset below\n\nglimpse(listings_sf)\n\nRows: 3,483\nColumns: 17\n$ id                             &lt;dbl&gt; 71609, 71896, 71903, 275343, 275344, 28…\n$ name                           &lt;chr&gt; \"Villa in Singapore · ★4.44 · 2 bedroom…\n$ host_id                        &lt;dbl&gt; 367042, 367042, 367042, 1439258, 143925…\n$ host_name                      &lt;chr&gt; \"Belinda\", \"Belinda\", \"Belinda\", \"Kay\",…\n$ neighbourhood_group            &lt;chr&gt; \"East Region\", \"East Region\", \"East Reg…\n$ neighbourhood                  &lt;chr&gt; \"Tampines\", \"Tampines\", \"Tampines\", \"Bu…\n$ room_type                      &lt;chr&gt; \"Private room\", \"Private room\", \"Privat…\n$ price                          &lt;dbl&gt; 150, 80, 80, 55, 69, 220, 85, 75, 45, 7…\n$ minimum_nights                 &lt;dbl&gt; 92, 92, 92, 60, 60, 92, 92, 60, 60, 92,…\n$ number_of_reviews              &lt;dbl&gt; 20, 24, 47, 22, 17, 12, 133, 18, 6, 81,…\n$ last_review                    &lt;date&gt; 2020-01-17, 2019-10-13, 2020-01-09, 20…\n$ reviews_per_month              &lt;dbl&gt; 0.14, 0.16, 0.31, 0.17, 0.12, 0.09, 0.9…\n$ calculated_host_listings_count &lt;dbl&gt; 5, 5, 5, 52, 52, 5, 7, 52, 52, 7, 7, 1,…\n$ availability_365               &lt;dbl&gt; 89, 89, 89, 275, 274, 89, 365, 365, 365…\n$ number_of_reviews_ltm          &lt;dbl&gt; 0, 0, 0, 0, 3, 0, 0, 1, 3, 0, 0, 0, 0, …\n$ license                        &lt;chr&gt; NA, NA, NA, \"S0399\", \"S0399\", NA, NA, \"…\n$ geometry                       &lt;POINT [m]&gt; POINT (41972.5 36390.05), POINT (…"
  },
  {
    "objectID": "hands_on_ex1/hands_on_ex1.1.html#geoprocessing-with-sf-package",
    "href": "hands_on_ex1/hands_on_ex1.1.html#geoprocessing-with-sf-package",
    "title": "Hands-on Exercise 1.1: Geospatial Data Wrangling with R",
    "section": "Geoprocessing with sf package",
    "text": "Geoprocessing with sf package\nsf package also offers a wide range of geoprocessing (also known as GIS analysis) functions.\nIn this section below, I will demonstrate how to perform two commonly used geoprocessing functions, namely buffering and point in polygon count.\n\nBuffering\nScenario: The authority is planning to upgrade the exiting cycling path. To do so, they need to acquire 5 metres of reserved land on the both sides of the current cycling path. I am tasked to determine the extend of the land need to be acquired and their total area.\nSolution:\n\nFirstly, st_buffer() of sf package is used to compute the 5-meter buffers around cycling paths\n\n\nbuffer_cycling &lt;- st_buffer(cyclingpath,dist=5, nQuadSegs = 30)\n\n\nThis is followed by calculating the area of the buffers as shown in the code chunk below.\n\n\nbuffer_cycling$AREA &lt;- st_area(buffer_cycling)\n\n\nLastly, sum() of Base R will be used to derive the total land involved\n\n\nsum(buffer_cycling$AREA)\n\n1774367 [m^2]\n\n\n\n\nPoint-in-polygon count\nScenario: A pre-school service group want to find out the numbers of pre-schools in each Planning Subzone.\nSolution:\n\nThe code chunk below performs two operations at one go. Firstly, identify pre-schools located inside each Planning Subzone by using st_intersects(). Next, length() of Base R is used to calculate numbers of pre-schools that fall inside each planning subzone.\n\n\nmpsz3414$`PreSch Count`&lt;- lengths(st_intersects(mpsz3414, preschool3414))\n\n\nCheck the summary statistics of the newly derived PreSch Count field by using summary() as shown in the code chunk below.\n\n\nsummary(mpsz3414$`PreSch Count`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    0.00    4.00    7.09   10.00   72.00 \n\n\n\nTo list the planning subzone with the most number of pre-school, the top_n() of dplyr package is used as shown in the code chunk below.\n\n\ntop_n(mpsz3414, 1, `PreSch Count`)\n\nSimple feature collection with 1 feature and 16 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 39655.33 ymin: 35966 xmax: 42940.57 ymax: 38622.37\nProjected CRS: SVY21 / Singapore TM\n  OBJECTID SUBZONE_NO     SUBZONE_N SUBZONE_C CA_IND PLN_AREA_N PLN_AREA_C\n1      189          2 TAMPINES EAST    TMSZ02      N   TAMPINES         TM\n     REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR   Y_ADDR SHAPE_Leng\n1 EAST REGION       ER 21658EAAF84F4D8D 2014-12-05 41122.55 37392.39   10180.62\n  SHAPE_Area                       geometry PreSch Count\n1    4339824 MULTIPOLYGON (((42196.76 38...           72\n\n\n**DIY: Calculate the density of pre-school by planning subzone.\n\nFirstly, the code chunk below uses st_area() of sf package to derive the area of each planning subzone.\n\n\nmpsz3414$Area &lt;- mpsz3414 %&gt;%   st_area()\n\n\nNext, mutate() of dplyr package is used to compute the density by using the code chunk below.\n\n\nmpsz3414 &lt;- mpsz3414 %&gt;%   mutate(`PreSch Density` = `PreSch Count`/Area * 1000000)"
  },
  {
    "objectID": "hands_on_ex1/hands_on_ex1.1.html#explorotary-data-analysis-eda",
    "href": "hands_on_ex1/hands_on_ex1.1.html#explorotary-data-analysis-eda",
    "title": "Hands-on Exercise 1.1: Geospatial Data Wrangling with R",
    "section": "Explorotary Data Analysis (EDA)",
    "text": "Explorotary Data Analysis (EDA)\nFirstly, we will plot a histogram to reveal the distribution of PreSch Density. Conventionally, hist() of R Graphics will be used as shown in the code chunk below.\n\nhist(mpsz3414$`PreSch Density`)\n\n\n\n\nIn the code chunk below, appropriate ggplot2 functions will be used.\n\nggplot(data=mpsz3414, \n       aes(x= as.numeric(`PreSch Density`)))+\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  labs(title = \"Are pre-school even distributed in Singapore?\",\n       subtitle= \"There are many planning sub-zones with a single pre-school, on the other hand, \\nthere are two planning sub-zones with at least 20 pre-schools\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Frequency\")\n\n\n\n\n** Using ggplot2 method, plot a scatterplot showing the relationship between Pre-school Density and Pre-school Count.\n\nggplot(data=mpsz3414, \n       aes(y = `PreSch Count`, \n           x= as.numeric(`PreSch Density`)))+\n  geom_point(color=\"black\", \n             fill=\"light blue\") +\n  xlim(0, 40) +\n  ylim(0, 40) +\n  labs(title = \"\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Pre-school count\")\n\nWarning: Removed 2 rows containing missing values (`geom_point()`)."
  },
  {
    "objectID": "hands_on_ex1/hands_on_ex1.2.html",
    "href": "hands_on_ex1/hands_on_ex1.2.html",
    "title": "Hands-on Exercise 1.2: Choropleth Mapping with R",
    "section": "",
    "text": "In this hands-on exercise, I learn how to plot functional and truthful choropleth maps by using an R package called tmap package.\n\n\nThe code chunk below will be used to install and load these packages in RStudio.\n\npacman::p_load(sf, tmap, tidyverse)\n\n\n\n\nThe code chunk below uses the st_read() function of sf package to import MP14_SUBZONE_WEB_PL shapefile into R as a simple feature data frame called mpsz.\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\",layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex1\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\nExamine data\n\nmpsz\n\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 10 features:\n   OBJECTID SUBZONE_NO       SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\n1         1          1    MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\n2         2          1    PEARL'S HILL    OTSZ01      Y          OUTRAM\n3         3          3       BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\n4         4          8  HENDERSON HILL    BMSZ08      N     BUKIT MERAH\n5         5          3         REDHILL    BMSZ03      N     BUKIT MERAH\n6         6          7  ALEXANDRA HILL    BMSZ07      N     BUKIT MERAH\n7         7          9   BUKIT HO SWEE    BMSZ09      N     BUKIT MERAH\n8         8          2     CLARKE QUAY    SRSZ02      Y SINGAPORE RIVER\n9         9         13 PASIR PANJANG 1    QTSZ13      N      QUEENSTOWN\n10       10          7       QUEENSWAY    QTSZ07      N      QUEENSTOWN\n   PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1          MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84\n2          OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06\n3          SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96\n4          BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05 26782.83\n5          BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05 26201.96\n6          BM CENTRAL REGION       CR 9D286521EF5E3B59 2014-12-05 25358.82\n7          BM CENTRAL REGION       CR 7839A8577144EFE2 2014-12-05 27680.06\n8          SR CENTRAL REGION       CR 48661DC0FBA09F7A 2014-12-05 29253.21\n9          QT CENTRAL REGION       CR 1F721290C421BFAB 2014-12-05 22077.34\n10         QT CENTRAL REGION       CR 3580D2AFFBEE914C 2014-12-05 24168.31\n     Y_ADDR SHAPE_Leng SHAPE_Area                       geometry\n1  29220.19   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2  29782.05   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3  29974.66   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n4  29933.77   3313.625   595428.9 MULTIPOLYGON (((27131.28 30...\n5  30005.70   2825.594   387429.4 MULTIPOLYGON (((26451.03 30...\n6  29991.38   4428.913  1030378.8 MULTIPOLYGON (((25899.7 297...\n7  30230.86   3275.312   551732.0 MULTIPOLYGON (((27746.95 30...\n8  30222.86   2208.619   290184.7 MULTIPOLYGON (((29351.26 29...\n9  29893.78   6571.323  1084792.3 MULTIPOLYGON (((20996.49 30...\n10 30104.18   3454.239   631644.3 MULTIPOLYGON (((24472.11 29...\n\n\n\n\nimport respopagsex2000to2018.csv file into RStudio and save the file into an R dataframe called popagsex.\n\npopdata &lt;- read_csv(\"data/aspatial/respopagesextod2011to2020.csv\")\n\nRows: 984656 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): PA, SZ, AG, Sex, TOD\ndbl (2): Pop, Time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\nTo prepare a data table with year 2020 values. The data table should include the variables PA, SZ, YOUNG, ECONOMY ACTIVE, AGED, TOTAL, DEPENDENCY.\n\nYOUNG: age group 0 to 4 until age group 20 to 24,\nECONOMY ACTIVE: age group 25-29 until age group 60-64,\nAGED: age group 65 and above,\nTOTAL: all age group, and\nDEPENDENCY: the ratio between young and aged against economy active group\n\n\n\nThe following data wrangling and transformation functions will be used:\n\npivot_wider() of tidyr package, and\nmutate(), filter(), group_by() and select() of dplyr package\n\n\npopdata2020 &lt;- popdata %&gt;%\n  filter(Time == 2020) %&gt;%\n  group_by(PA, SZ, AG) %&gt;%\n  summarise(`POP` = sum(`Pop`)) %&gt;%\n  ungroup()%&gt;%\n  pivot_wider(names_from=AG, \n              values_from=POP) %&gt;%\n  mutate(YOUNG = rowSums(.[3:6])\n         +rowSums(.[12])) %&gt;%\nmutate(`ECONOMY ACTIVE` = rowSums(.[7:11])+\nrowSums(.[13:15]))%&gt;%\nmutate(`AGED`=rowSums(.[16:21])) %&gt;%\nmutate(`TOTAL`=rowSums(.[3:21])) %&gt;%  \nmutate(`DEPENDENCY` = (`YOUNG` + `AGED`)\n/`ECONOMY ACTIVE`) %&gt;%\n  select(`PA`, `SZ`, `YOUNG`, \n       `ECONOMY ACTIVE`, `AGED`, \n       `TOTAL`, `DEPENDENCY`)\n\n`summarise()` has grouped output by 'PA', 'SZ'. You can override using the\n`.groups` argument.\n\n\n\n\n\nI would convert the values in PA and SZ fields to uppercase\n\npopdata2020 &lt;- popdata2020 %&gt;%\n  mutate_at(.vars = vars(PA, SZ), \n          .funs = list(toupper)) %&gt;%\n  filter(`ECONOMY ACTIVE` &gt; 0)\n\nleft_join() of dplyr is used to join the geographical data and attribute table using planning subzone name e.g. SUBZONE_N and SZ as the common identifier.\n\nmpsz_pop2020 &lt;- left_join(mpsz, popdata2020,\n                          by = c(\"SUBZONE_N\" = \"SZ\"))\n\n** left_join() of dplyr package is used with mpsz simple feature data frame as the left data table is to ensure that the output will be a simple features data frame.\n\nwrite_rds(mpsz_pop2020, \"data/mpszpop2020.rds\")\n\nRead here to know more about rds\n\n\n\n\n\nTwo approaches can be used to prepare thematic map using tmap, they are:\n\nPlotting a thematic map quickly by using qtm().\nPlotting highly customisable thematic map by using tmap elements.\n\n\n\n\ntmap_mode(\"plot\") \n\ntmap mode set to plotting\n\nqtm(mpsz_pop2020,      \n    fill = \"DEPENDENCY\")\n\n\n\n\nThings to learn from the code chunk above:\n\ntmap_mode() with “plot” option is used to produce a static map. For interactive mode, “view” option should be used.\nfill argument is used to map the attribute (i.e. DEPENDENCY)\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Dependency ratio\") +\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2) +\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\n\n\nIn the code chunk below, tm_shape() is used to define the input data (i.e mpsz_pop2020) and tm_polygons() is used to draw the planning subzone polygons\n\ntm_shape(mpsz_pop2020) +   tm_polygons()\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+  \n  tm_polygons(\"DEPENDENCY\")\n\n\n\n\n3 learning points from tm_polygons():\n\nThe default interval binning used to draw the choropleth map is called “pretty”.\nThe default colour scheme used is YlOrRd of ColorBrewer.\nBy default, Missing value will be shaded in grey.\n\n\n\n\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\")\n\n\n\n\nTo add the boundary of the planning subzones, tm_borders will be used as shown in the code chunk below.\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\") +   \n  tm_borders(lwd = 0.1,  alpha = 1)\n\n\n\n\nTo notes: Beside alpha argument, there are three other arguments for tm_borders(), they are:\n\ncol = border colour,\nlwd = border line width. The default is 1, and\nlty = border line type. The default is “solid”.\n\n\n\n\n\ntmap provides a total ten data classification methods, namely: fixed, sd, equal, pretty (default), quantile, kmeans, hclust, bclust, fisher, and jenks.\n\n\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",          \n          n = 5,           \n          style = \"jenks\") +   \n  tm_borders(alpha = 0.5)\n\n\n\n\nIn the code chunk below, equal data classification method is used.\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",          \n          n = 5,           \n          style = \"equal\") +   \n  tm_borders(alpha = 0.5)\n\n\n\n\n\nNote that the distribution of quantile data classification method are more evenly distributed then equal data classification method.\n\nDIY\n\nUsing k-means and 10 classes\n\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",           \n          n = 10,           \n          style = \"kmeans\") +   \n  tm_borders(alpha = 0.5)\n\n\n\n\n\nUsing hclust and 20 classes\n\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",           \n          n = 20,           \n          style = \"hclust\") +   \n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\nTo get some descriptive analysis first\n\nsummary(mpsz_pop2020$DEPENDENCY)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n 0.1111  0.7147  0.7866  0.8585  0.8763 19.0000      92 \n\n\nPlot Choropleth map\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",           \n          breaks = c(0, 0.60, 0.70, 0.80, 0.90, 1.00)) +   \n  tm_borders(alpha = 0.5)\n\nWarning: Values have found that are higher than the highest break\n\n\n\n\n\n\n\n\n\n\n\nTo change the colour, we assign the preferred colour to palette argument of tm_fill() as shown in the code chunk below.\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",           \n          n = 6,           \n          style = \"quantile\",           \n          palette = \"Blues\") +   \n  tm_borders(alpha = 0.5)\n\n\n\n\nTo reverse the colour shading, add a “-” prefix.\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",           \n          style = \"quantile\",           \n          palette = \"-Greens\") +   \n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\nIn tmap, several legend options are provided to change the placement, format and appearance of the legend.\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"jenks\", \n          palette = \"Blues\", \n          legend.hist = TRUE, \n          legend.is.portrait = TRUE,\n          legend.hist.z = 0.1) +\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone \\n(Jenks classification)\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            legend.outside = FALSE,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\ntmap allows a wide variety of layout settings to be changed. They can be called by using tmap_style().\nThe code chunk below shows the classic style is used.\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"-Greens\") +\n  tm_borders(alpha = 0.5) +\n  tmap_style(\"classic\")\n\ntmap style set to \"classic\"\n\n\nother available styles are: \"white\", \"gray\", \"natural\", \"cobalt\", \"col_blind\", \"albatross\", \"beaver\", \"bw\", \"watercolor\" \n\n\n\n\n\n\n\n\nBeside map style, tmap also also provides arguments to draw other map furniture such as compass, scale bar and grid lines.\nIn the code chunk below, tm_compass(), tm_scale_bar() and tm_grid() are used to add compass, scale bar and grid lines onto the choropleth map.\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"No. of persons\") +\n  tm_layout(main.title = \"Distribution of Dependency Ratio \\nby planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.2) +\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\n** To reset to default\n\n\n\n\n\n\nIn this example, small multiple choropleth maps are created by defining ncols in tm_fill()\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(c(\"YOUNG\", \"AGED\"),\n          style = \"equal\", \n          palette = \"Blues\") +\n  tm_layout(legend.position = c(\"right\", \"bottom\")) +\n  tm_borders(alpha = 0.5) +\n  tmap_style(\"white\")\n\ntmap style set to \"white\"\n\n\nother available styles are: \"gray\", \"natural\", \"cobalt\", \"col_blind\", \"albatross\", \"beaver\", \"bw\", \"classic\", \"watercolor\" \n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+ \n  tm_polygons(c(\"DEPENDENCY\",\"AGED\"),\n          style = c(\"equal\", \"quantile\"), \n          palette = list(\"Blues\",\"Greens\")) +\n  tm_layout(legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\n\n\nMultiple small choropleth maps are created by using tm_facets().\n\ntm_shape(mpsz_pop2020) +\n  tm_fill(\"DEPENDENCY\",\n          style = \"quantile\",\n          palette = \"Blues\",\n          thres.poly = 0) + \n  tm_facets(by=\"REGION_N\", \n            free.coords=TRUE, \n            drop.shapes=TRUE) +\n  tm_layout(legend.show = FALSE,\n            title.position = c(\"center\", \"center\"), \n            title.size = 20) +\n  tm_borders(alpha = 0.5)\n\nWarning: The argument drop.shapes has been renamed to drop.units, and is\ntherefore deprecated\n\n\n\n\n\n\n\n\n\nyoungmap &lt;- tm_shape(mpsz_pop2020)+ \n  tm_polygons(\"YOUNG\", \n              style = \"quantile\", \n              palette = \"Blues\")\n\nagedmap &lt;- tm_shape(mpsz_pop2020)+ \n  tm_polygons(\"AGED\", \n              style = \"quantile\", \n              palette = \"Blues\")\n\ntmap_arrange(youngmap, agedmap, asp=1, ncol=2)\n\n\n\n\n\n\n\n\nI can also use selection funtion to map spatial objects meeting the selection criterion.\n\ntm_shape(mpsz_pop2020[mpsz_pop2020$REGION_N==\"CENTRAL REGION\", ])+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\", \n          legend.hist = TRUE, \n          legend.is.portrait = TRUE,\n          legend.hist.z = 0.1) +\n  tm_layout(legend.outside = TRUE,\n            legend.height = 0.45, \n            legend.width = 5.0,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_borders(alpha = 0.5)\n\nWarning in pre_process_gt(x, interactive = interactive, orig_crs =\ngm$shape.orig_crs): legend.width controls the width of the legend within a map.\nPlease use legend.outside.size to control the width of the outside legend"
  },
  {
    "objectID": "hands_on_ex1/hands_on_ex1.2.html#getting-started",
    "href": "hands_on_ex1/hands_on_ex1.2.html#getting-started",
    "title": "Hands-on Exercise 1.2: Choropleth Mapping with R",
    "section": "",
    "text": "The code chunk below will be used to install and load these packages in RStudio.\n\npacman::p_load(sf, tmap, tidyverse)"
  },
  {
    "objectID": "hands_on_ex1/hands_on_ex1.2.html#importing-data-into-r",
    "href": "hands_on_ex1/hands_on_ex1.2.html#importing-data-into-r",
    "title": "Hands-on Exercise 1.2: Choropleth Mapping with R",
    "section": "",
    "text": "The code chunk below uses the st_read() function of sf package to import MP14_SUBZONE_WEB_PL shapefile into R as a simple feature data frame called mpsz.\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\",layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex1\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\nExamine data\n\nmpsz\n\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\nFirst 10 features:\n   OBJECTID SUBZONE_NO       SUBZONE_N SUBZONE_C CA_IND      PLN_AREA_N\n1         1          1    MARINA SOUTH    MSSZ01      Y    MARINA SOUTH\n2         2          1    PEARL'S HILL    OTSZ01      Y          OUTRAM\n3         3          3       BOAT QUAY    SRSZ03      Y SINGAPORE RIVER\n4         4          8  HENDERSON HILL    BMSZ08      N     BUKIT MERAH\n5         5          3         REDHILL    BMSZ03      N     BUKIT MERAH\n6         6          7  ALEXANDRA HILL    BMSZ07      N     BUKIT MERAH\n7         7          9   BUKIT HO SWEE    BMSZ09      N     BUKIT MERAH\n8         8          2     CLARKE QUAY    SRSZ02      Y SINGAPORE RIVER\n9         9         13 PASIR PANJANG 1    QTSZ13      N      QUEENSTOWN\n10       10          7       QUEENSWAY    QTSZ07      N      QUEENSTOWN\n   PLN_AREA_C       REGION_N REGION_C          INC_CRC FMEL_UPD_D   X_ADDR\n1          MS CENTRAL REGION       CR 5ED7EB253F99252E 2014-12-05 31595.84\n2          OT CENTRAL REGION       CR 8C7149B9EB32EEFC 2014-12-05 28679.06\n3          SR CENTRAL REGION       CR C35FEFF02B13E0E5 2014-12-05 29654.96\n4          BM CENTRAL REGION       CR 3775D82C5DDBEFBD 2014-12-05 26782.83\n5          BM CENTRAL REGION       CR 85D9ABEF0A40678F 2014-12-05 26201.96\n6          BM CENTRAL REGION       CR 9D286521EF5E3B59 2014-12-05 25358.82\n7          BM CENTRAL REGION       CR 7839A8577144EFE2 2014-12-05 27680.06\n8          SR CENTRAL REGION       CR 48661DC0FBA09F7A 2014-12-05 29253.21\n9          QT CENTRAL REGION       CR 1F721290C421BFAB 2014-12-05 22077.34\n10         QT CENTRAL REGION       CR 3580D2AFFBEE914C 2014-12-05 24168.31\n     Y_ADDR SHAPE_Leng SHAPE_Area                       geometry\n1  29220.19   5267.381  1630379.3 MULTIPOLYGON (((31495.56 30...\n2  29782.05   3506.107   559816.2 MULTIPOLYGON (((29092.28 30...\n3  29974.66   1740.926   160807.5 MULTIPOLYGON (((29932.33 29...\n4  29933.77   3313.625   595428.9 MULTIPOLYGON (((27131.28 30...\n5  30005.70   2825.594   387429.4 MULTIPOLYGON (((26451.03 30...\n6  29991.38   4428.913  1030378.8 MULTIPOLYGON (((25899.7 297...\n7  30230.86   3275.312   551732.0 MULTIPOLYGON (((27746.95 30...\n8  30222.86   2208.619   290184.7 MULTIPOLYGON (((29351.26 29...\n9  29893.78   6571.323  1084792.3 MULTIPOLYGON (((20996.49 30...\n10 30104.18   3454.239   631644.3 MULTIPOLYGON (((24472.11 29...\n\n\n\n\nimport respopagsex2000to2018.csv file into RStudio and save the file into an R dataframe called popagsex.\n\npopdata &lt;- read_csv(\"data/aspatial/respopagesextod2011to2020.csv\")\n\nRows: 984656 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): PA, SZ, AG, Sex, TOD\ndbl (2): Pop, Time\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\nTo prepare a data table with year 2020 values. The data table should include the variables PA, SZ, YOUNG, ECONOMY ACTIVE, AGED, TOTAL, DEPENDENCY.\n\nYOUNG: age group 0 to 4 until age group 20 to 24,\nECONOMY ACTIVE: age group 25-29 until age group 60-64,\nAGED: age group 65 and above,\nTOTAL: all age group, and\nDEPENDENCY: the ratio between young and aged against economy active group\n\n\n\nThe following data wrangling and transformation functions will be used:\n\npivot_wider() of tidyr package, and\nmutate(), filter(), group_by() and select() of dplyr package\n\n\npopdata2020 &lt;- popdata %&gt;%\n  filter(Time == 2020) %&gt;%\n  group_by(PA, SZ, AG) %&gt;%\n  summarise(`POP` = sum(`Pop`)) %&gt;%\n  ungroup()%&gt;%\n  pivot_wider(names_from=AG, \n              values_from=POP) %&gt;%\n  mutate(YOUNG = rowSums(.[3:6])\n         +rowSums(.[12])) %&gt;%\nmutate(`ECONOMY ACTIVE` = rowSums(.[7:11])+\nrowSums(.[13:15]))%&gt;%\nmutate(`AGED`=rowSums(.[16:21])) %&gt;%\nmutate(`TOTAL`=rowSums(.[3:21])) %&gt;%  \nmutate(`DEPENDENCY` = (`YOUNG` + `AGED`)\n/`ECONOMY ACTIVE`) %&gt;%\n  select(`PA`, `SZ`, `YOUNG`, \n       `ECONOMY ACTIVE`, `AGED`, \n       `TOTAL`, `DEPENDENCY`)\n\n`summarise()` has grouped output by 'PA', 'SZ'. You can override using the\n`.groups` argument.\n\n\n\n\n\nI would convert the values in PA and SZ fields to uppercase\n\npopdata2020 &lt;- popdata2020 %&gt;%\n  mutate_at(.vars = vars(PA, SZ), \n          .funs = list(toupper)) %&gt;%\n  filter(`ECONOMY ACTIVE` &gt; 0)\n\nleft_join() of dplyr is used to join the geographical data and attribute table using planning subzone name e.g. SUBZONE_N and SZ as the common identifier.\n\nmpsz_pop2020 &lt;- left_join(mpsz, popdata2020,\n                          by = c(\"SUBZONE_N\" = \"SZ\"))\n\n** left_join() of dplyr package is used with mpsz simple feature data frame as the left data table is to ensure that the output will be a simple features data frame.\n\nwrite_rds(mpsz_pop2020, \"data/mpszpop2020.rds\")\n\nRead here to know more about rds"
  },
  {
    "objectID": "hands_on_ex1/hands_on_ex1.2.html#choropleth-mapping-geospatial-data-using-tmap",
    "href": "hands_on_ex1/hands_on_ex1.2.html#choropleth-mapping-geospatial-data-using-tmap",
    "title": "Hands-on Exercise 1.2: Choropleth Mapping with R",
    "section": "",
    "text": "Two approaches can be used to prepare thematic map using tmap, they are:\n\nPlotting a thematic map quickly by using qtm().\nPlotting highly customisable thematic map by using tmap elements.\n\n\n\n\ntmap_mode(\"plot\") \n\ntmap mode set to plotting\n\nqtm(mpsz_pop2020,      \n    fill = \"DEPENDENCY\")\n\n\n\n\nThings to learn from the code chunk above:\n\ntmap_mode() with “plot” option is used to produce a static map. For interactive mode, “view” option should be used.\nfill argument is used to map the attribute (i.e. DEPENDENCY)\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Dependency ratio\") +\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2) +\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\n\n\nIn the code chunk below, tm_shape() is used to define the input data (i.e mpsz_pop2020) and tm_polygons() is used to draw the planning subzone polygons\n\ntm_shape(mpsz_pop2020) +   tm_polygons()\n\n\n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+  \n  tm_polygons(\"DEPENDENCY\")\n\n\n\n\n3 learning points from tm_polygons():\n\nThe default interval binning used to draw the choropleth map is called “pretty”.\nThe default colour scheme used is YlOrRd of ColorBrewer.\nBy default, Missing value will be shaded in grey.\n\n\n\n\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\")\n\n\n\n\nTo add the boundary of the planning subzones, tm_borders will be used as shown in the code chunk below.\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\") +   \n  tm_borders(lwd = 0.1,  alpha = 1)\n\n\n\n\nTo notes: Beside alpha argument, there are three other arguments for tm_borders(), they are:\n\ncol = border colour,\nlwd = border line width. The default is 1, and\nlty = border line type. The default is “solid”.\n\n\n\n\n\ntmap provides a total ten data classification methods, namely: fixed, sd, equal, pretty (default), quantile, kmeans, hclust, bclust, fisher, and jenks.\n\n\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",          \n          n = 5,           \n          style = \"jenks\") +   \n  tm_borders(alpha = 0.5)\n\n\n\n\nIn the code chunk below, equal data classification method is used.\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",          \n          n = 5,           \n          style = \"equal\") +   \n  tm_borders(alpha = 0.5)\n\n\n\n\n\nNote that the distribution of quantile data classification method are more evenly distributed then equal data classification method.\n\nDIY\n\nUsing k-means and 10 classes\n\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",           \n          n = 10,           \n          style = \"kmeans\") +   \n  tm_borders(alpha = 0.5)\n\n\n\n\n\nUsing hclust and 20 classes\n\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",           \n          n = 20,           \n          style = \"hclust\") +   \n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\nTo get some descriptive analysis first\n\nsummary(mpsz_pop2020$DEPENDENCY)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n 0.1111  0.7147  0.7866  0.8585  0.8763 19.0000      92 \n\n\nPlot Choropleth map\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",           \n          breaks = c(0, 0.60, 0.70, 0.80, 0.90, 1.00)) +   \n  tm_borders(alpha = 0.5)\n\nWarning: Values have found that are higher than the highest break\n\n\n\n\n\n\n\n\n\n\n\nTo change the colour, we assign the preferred colour to palette argument of tm_fill() as shown in the code chunk below.\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",           \n          n = 6,           \n          style = \"quantile\",           \n          palette = \"Blues\") +   \n  tm_borders(alpha = 0.5)\n\n\n\n\nTo reverse the colour shading, add a “-” prefix.\n\ntm_shape(mpsz_pop2020)+   \n  tm_fill(\"DEPENDENCY\",           \n          style = \"quantile\",           \n          palette = \"-Greens\") +   \n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\n\n\n\nIn tmap, several legend options are provided to change the placement, format and appearance of the legend.\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"jenks\", \n          palette = \"Blues\", \n          legend.hist = TRUE, \n          legend.is.portrait = TRUE,\n          legend.hist.z = 0.1) +\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone \\n(Jenks classification)\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            legend.outside = FALSE,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\ntmap allows a wide variety of layout settings to be changed. They can be called by using tmap_style().\nThe code chunk below shows the classic style is used.\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"-Greens\") +\n  tm_borders(alpha = 0.5) +\n  tmap_style(\"classic\")\n\ntmap style set to \"classic\"\n\n\nother available styles are: \"white\", \"gray\", \"natural\", \"cobalt\", \"col_blind\", \"albatross\", \"beaver\", \"bw\", \"watercolor\" \n\n\n\n\n\n\n\n\nBeside map style, tmap also also provides arguments to draw other map furniture such as compass, scale bar and grid lines.\nIn the code chunk below, tm_compass(), tm_scale_bar() and tm_grid() are used to add compass, scale bar and grid lines onto the choropleth map.\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"No. of persons\") +\n  tm_layout(main.title = \"Distribution of Dependency Ratio \\nby planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.2) +\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\n** To reset to default\n\n\n\n\n\n\nIn this example, small multiple choropleth maps are created by defining ncols in tm_fill()\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(c(\"YOUNG\", \"AGED\"),\n          style = \"equal\", \n          palette = \"Blues\") +\n  tm_layout(legend.position = c(\"right\", \"bottom\")) +\n  tm_borders(alpha = 0.5) +\n  tmap_style(\"white\")\n\ntmap style set to \"white\"\n\n\nother available styles are: \"gray\", \"natural\", \"cobalt\", \"col_blind\", \"albatross\", \"beaver\", \"bw\", \"classic\", \"watercolor\" \n\n\n\n\n\n\ntm_shape(mpsz_pop2020)+ \n  tm_polygons(c(\"DEPENDENCY\",\"AGED\"),\n          style = c(\"equal\", \"quantile\"), \n          palette = list(\"Blues\",\"Greens\")) +\n  tm_layout(legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\n\n\nMultiple small choropleth maps are created by using tm_facets().\n\ntm_shape(mpsz_pop2020) +\n  tm_fill(\"DEPENDENCY\",\n          style = \"quantile\",\n          palette = \"Blues\",\n          thres.poly = 0) + \n  tm_facets(by=\"REGION_N\", \n            free.coords=TRUE, \n            drop.shapes=TRUE) +\n  tm_layout(legend.show = FALSE,\n            title.position = c(\"center\", \"center\"), \n            title.size = 20) +\n  tm_borders(alpha = 0.5)\n\nWarning: The argument drop.shapes has been renamed to drop.units, and is\ntherefore deprecated\n\n\n\n\n\n\n\n\n\nyoungmap &lt;- tm_shape(mpsz_pop2020)+ \n  tm_polygons(\"YOUNG\", \n              style = \"quantile\", \n              palette = \"Blues\")\n\nagedmap &lt;- tm_shape(mpsz_pop2020)+ \n  tm_polygons(\"AGED\", \n              style = \"quantile\", \n              palette = \"Blues\")\n\ntmap_arrange(youngmap, agedmap, asp=1, ncol=2)\n\n\n\n\n\n\n\n\nI can also use selection funtion to map spatial objects meeting the selection criterion.\n\ntm_shape(mpsz_pop2020[mpsz_pop2020$REGION_N==\"CENTRAL REGION\", ])+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\", \n          legend.hist = TRUE, \n          legend.is.portrait = TRUE,\n          legend.hist.z = 0.1) +\n  tm_layout(legend.outside = TRUE,\n            legend.height = 0.45, \n            legend.width = 5.0,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_borders(alpha = 0.5)\n\nWarning in pre_process_gt(x, interactive = interactive, orig_crs =\ngm$shape.orig_crs): legend.width controls the width of the legend within a map.\nPlease use legend.outside.size to control the width of the outside legend"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.1.html",
    "href": "hands_on_ex2/hands_on_ex2.1.html",
    "title": "Hands-on Exercise 2.1: Spatial Weights and Applications",
    "section": "",
    "text": "I will learn how to compute spatial weights using R. I will be using the following:\n\nimport geospatial data using appropriate function(s) of sf package,\nimport csv file using appropriate function of readr package,\nperform relational join using appropriate join function of dplyr package,\ncompute spatial weights using appropriate functions of spdep package, and\ncalculate spatially lagged variables using appropriate functions of spdep package"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.1.html#getting-the-data-to-r",
    "href": "hands_on_ex2/hands_on_ex2.1.html#getting-the-data-to-r",
    "title": "Hands-on Exercise 2.1: Spatial Weights and Applications",
    "section": "Getting the data to R",
    "text": "Getting the data to R\nThe code chunk below uses st_read() of sf package to import Hunan shapefile into R. The imported shapefile will be simple features Object of sf.\n\nImport shapefile into r environment\n\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\n\nImport csv file into r environment\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\nPerforming relational join\n\nhunan &lt;- left_join(hunan,hunan2012)%&gt;%\n  select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.1.html#visualising-regional-development-indicator",
    "href": "hands_on_ex2/hands_on_ex2.1.html#visualising-regional-development-indicator",
    "title": "Hands-on Exercise 2.1: Spatial Weights and Applications",
    "section": "Visualising Regional Development Indicator",
    "text": "Visualising Regional Development Indicator\nHere, I prepare a basemap and a choropleth map showing the distribution of GDPPC 2012 by using qtm() of tmap package.\n\nbasemap &lt;- tm_shape(hunan) +\n  tm_polygons() +\n  tm_text(\"NAME_3\", size=0.5)\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\ntmap_arrange(basemap, gdppc, asp=1, ncol=2)"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.1.html#computing-contiguity-spatial-weights",
    "href": "hands_on_ex2/hands_on_ex2.1.html#computing-contiguity-spatial-weights",
    "title": "Hands-on Exercise 2.1: Spatial Weights and Applications",
    "section": "Computing Contiguity Spatial Weights",
    "text": "Computing Contiguity Spatial Weights\nI will learn how to use poly2nb() of spdep package to compute contiguity weight matrices for the study area. This function builds a neighbours list based on regions with contiguous boundaries. \n\nComputing (QUEEN) contiguity based neighbours\nThe code chunk below is used to compute Queen contiguity weight matrix.\n\nwm_q &lt;- poly2nb(hunan, queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\n\nwm_q[[1]]\n\n[1]  2  3  4 57 85\n\n\nPolygon 1 has 5 neighbors. The numbers represent the polygon IDs as stored in hunan SpatialPolygonsDataFrame class.\nWe can retrive the county name of Polygon ID=1 by using the code chunk below:\n\nhunan$County[1]\n\n[1] \"Anxiang\"\n\n\nTo reveal the county names of the five neighboring polygons, the code chunk will be used:\n\nhunan$NAME_3[c(2,3,4,57,85)]\n\n[1] \"Hanshou\" \"Jinshi\"  \"Li\"      \"Nan\"     \"Taoyuan\"\n\n\nWe can retrieve the GDPPC of these five countries by using the code chunk below.\n\nnb1 &lt;- wm_q[[1]]\nnb1 &lt;- hunan$GDPPC[nb1]\nnb1\n\n[1] 20981 34592 24473 21311 22879\n\n\nDisplay the complete weight matrix by using str().\n\nstr(wm_q)\n\nList of 88\n $ : int [1:5] 2 3 4 57 85\n $ : int [1:5] 1 57 58 78 85\n $ : int [1:4] 1 4 5 85\n $ : int [1:4] 1 3 5 6\n $ : int [1:4] 3 4 6 85\n $ : int [1:5] 4 5 69 75 85\n $ : int [1:4] 67 71 74 84\n $ : int [1:7] 9 46 47 56 78 80 86\n $ : int [1:6] 8 66 68 78 84 86\n $ : int [1:8] 16 17 19 20 22 70 72 73\n $ : int [1:3] 14 17 72\n $ : int [1:5] 13 60 61 63 83\n $ : int [1:4] 12 15 60 83\n $ : int [1:3] 11 15 17\n $ : int [1:4] 13 14 17 83\n $ : int [1:5] 10 17 22 72 83\n $ : int [1:7] 10 11 14 15 16 72 83\n $ : int [1:5] 20 22 23 77 83\n $ : int [1:6] 10 20 21 73 74 86\n $ : int [1:7] 10 18 19 21 22 23 82\n $ : int [1:5] 19 20 35 82 86\n $ : int [1:5] 10 16 18 20 83\n $ : int [1:7] 18 20 38 41 77 79 82\n $ : int [1:5] 25 28 31 32 54\n $ : int [1:5] 24 28 31 33 81\n $ : int [1:4] 27 33 42 81\n $ : int [1:3] 26 29 42\n $ : int [1:5] 24 25 33 49 54\n $ : int [1:3] 27 37 42\n $ : int 33\n $ : int [1:8] 24 25 32 36 39 40 56 81\n $ : int [1:8] 24 31 50 54 55 56 75 85\n $ : int [1:5] 25 26 28 30 81\n $ : int [1:3] 36 45 80\n $ : int [1:6] 21 41 47 80 82 86\n $ : int [1:6] 31 34 40 45 56 80\n $ : int [1:4] 29 42 43 44\n $ : int [1:4] 23 44 77 79\n $ : int [1:5] 31 40 42 43 81\n $ : int [1:6] 31 36 39 43 45 79\n $ : int [1:6] 23 35 45 79 80 82\n $ : int [1:7] 26 27 29 37 39 43 81\n $ : int [1:6] 37 39 40 42 44 79\n $ : int [1:4] 37 38 43 79\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:3] 8 47 86\n $ : int [1:5] 8 35 46 80 86\n $ : int [1:5] 50 51 52 53 55\n $ : int [1:4] 28 51 52 54\n $ : int [1:5] 32 48 52 54 55\n $ : int [1:3] 48 49 52\n $ : int [1:5] 48 49 50 51 54\n $ : int [1:3] 48 55 75\n $ : int [1:6] 24 28 32 49 50 52\n $ : int [1:5] 32 48 50 53 75\n $ : int [1:7] 8 31 32 36 78 80 85\n $ : int [1:6] 1 2 58 64 76 85\n $ : int [1:5] 2 57 68 76 78\n $ : int [1:4] 60 61 87 88\n $ : int [1:4] 12 13 59 61\n $ : int [1:7] 12 59 60 62 63 77 87\n $ : int [1:3] 61 77 87\n $ : int [1:4] 12 61 77 83\n $ : int [1:2] 57 76\n $ : int 76\n $ : int [1:5] 9 67 68 76 84\n $ : int [1:4] 7 66 76 84\n $ : int [1:5] 9 58 66 76 78\n $ : int [1:3] 6 75 85\n $ : int [1:3] 10 72 73\n $ : int [1:3] 7 73 74\n $ : int [1:5] 10 11 16 17 70\n $ : int [1:5] 10 19 70 71 74\n $ : int [1:6] 7 19 71 73 84 86\n $ : int [1:6] 6 32 53 55 69 85\n $ : int [1:7] 57 58 64 65 66 67 68\n $ : int [1:7] 18 23 38 61 62 63 83\n $ : int [1:7] 2 8 9 56 58 68 85\n $ : int [1:7] 23 38 40 41 43 44 45\n $ : int [1:8] 8 34 35 36 41 45 47 56\n $ : int [1:6] 25 26 31 33 39 42\n $ : int [1:5] 20 21 23 35 41\n $ : int [1:9] 12 13 15 16 17 18 22 63 77\n $ : int [1:6] 7 9 66 67 74 86\n $ : int [1:11] 1 2 3 5 6 32 56 57 69 75 ...\n $ : int [1:9] 8 9 19 21 35 46 47 74 84\n $ : int [1:4] 59 61 62 88\n $ : int [1:2] 59 87\n - attr(*, \"class\")= chr \"nb\"\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language poly2nb(pl = hunan, queen = TRUE)\n - attr(*, \"type\")= chr \"queen\"\n - attr(*, \"sym\")= logi TRUE\n\n\n\n\nCreating (ROOK) contiguity based neighbours\nThe code chunk below is used to compute Rook contiguity weight matrix.\n\nwm_r &lt;- poly2nb(hunan, queen=FALSE)\nsummary(wm_r)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 440 \nPercentage nonzero weights: 5.681818 \nAverage number of links: 5 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 10 \n 2  2 12 20 21 14 11  3  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 10 links\n\n\n\n\nVisualising contiguity weights\nTo get our longitude values we map the st_centroid function over the geometry column of us.bound and access the longitude value through double bracket notation [[]] and 1. This allows us to get only the longitude, which is the first value in each centroid.\n\nlongitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[1]])\n\nWe do the same for latitude with one key difference. We access the second value per each centroid with [[2]].\n\nlatitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[2]])\n\nNow that we have latitude and longitude, we use cbind to put longitude and latitude into the same object.\n\ncoords &lt;- cbind(longitude, latitude)\n\nA check if things are formatted correctly\n\nhead(coords)\n\n     longitude latitude\n[1,]  112.1531 29.44362\n[2,]  112.0372 28.86489\n[3,]  111.8917 29.47107\n[4,]  111.7031 29.74499\n[5,]  111.6138 29.49258\n[6,]  111.0341 29.79863\n\n\n\nPlotting Queen contiguity based neighbours map\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col= \"red\")\n\n\n\n\n\n\nPlotting Rook contiguity based neighbours map\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n\n\n\n\n\n\nPlotting both Queen and Rook contiguity based neighbours maps\n\npar(mfrow=c(1,2))\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col= \"red\", main=\"Queen Contiguity\")\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\", main=\"Rook Contiguity\")"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.1.html#computing-distance-based-neighbours",
    "href": "hands_on_ex2/hands_on_ex2.1.html#computing-distance-based-neighbours",
    "title": "Hands-on Exercise 2.1: Spatial Weights and Applications",
    "section": "Computing distance based neighbours",
    "text": "Computing distance based neighbours\nI will learn how to derive distance-based weight matrices by using dnearneigh() of spdep package.\n\nDetermine the cut-off distance\nFirstly, we need to determine the upper limit for distance band by using the steps below:\n\nReturn a matrix with the indices of points belonging to the set of the k nearest neighbours of each other by using knearneigh() of spdep.\nConvert the knn object returned by knearneigh() into a neighbours list of class nb with a list of integer vectors containing neighbour region number ids by using knn2nb().\nReturn the length of neighbour relationship edges by using nbdists() of spdep. The function returns in the units of the coordinates if the coordinates are projected, in km otherwise.\nRemove the list structure of the returned object by using unlist().\n\n\n#coords &lt;- coordinates(hunan)\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24.79   32.57   38.01   39.07   44.52   61.79 \n\n\n\n\nComputing fixed distance weight matrix\nCompute the distance weight matrix by using dnearneigh() as shown in the code chunk below.\n\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \n\n\nQuiz: What is the meaning of “Average number of links: 3.681818” shown above?\nAns: On average, each region is connected to approximately 3.68 other regions. This suggests the average connectivity or the average number of neighboring regions for each individual region in this network.\nNext, we will use str() to display the content of wm_d62 weight matrix.\n\nstr(wm_d62)\n\nList of 88\n $ : int [1:5] 3 4 5 57 64\n $ : int [1:4] 57 58 78 85\n $ : int [1:4] 1 4 5 57\n $ : int [1:3] 1 3 5\n $ : int [1:4] 1 3 4 85\n $ : int 69\n $ : int [1:2] 67 84\n $ : int [1:4] 9 46 47 78\n $ : int [1:4] 8 46 68 84\n $ : int [1:4] 16 22 70 72\n $ : int [1:3] 14 17 72\n $ : int [1:5] 13 60 61 63 83\n $ : int [1:4] 12 15 60 83\n $ : int [1:2] 11 17\n $ : int 13\n $ : int [1:4] 10 17 22 83\n $ : int [1:3] 11 14 16\n $ : int [1:3] 20 22 63\n $ : int [1:5] 20 21 73 74 82\n $ : int [1:5] 18 19 21 22 82\n $ : int [1:6] 19 20 35 74 82 86\n $ : int [1:4] 10 16 18 20\n $ : int [1:3] 41 77 82\n $ : int [1:4] 25 28 31 54\n $ : int [1:4] 24 28 33 81\n $ : int [1:4] 27 33 42 81\n $ : int [1:2] 26 29\n $ : int [1:6] 24 25 33 49 52 54\n $ : int [1:2] 27 37\n $ : int 33\n $ : int [1:2] 24 36\n $ : int 50\n $ : int [1:5] 25 26 28 30 81\n $ : int [1:3] 36 45 80\n $ : int [1:6] 21 41 46 47 80 82\n $ : int [1:5] 31 34 45 56 80\n $ : int [1:2] 29 42\n $ : int [1:3] 44 77 79\n $ : int [1:4] 40 42 43 81\n $ : int [1:3] 39 45 79\n $ : int [1:5] 23 35 45 79 82\n $ : int [1:5] 26 37 39 43 81\n $ : int [1:3] 39 42 44\n $ : int [1:2] 38 43\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:5] 8 9 35 47 86\n $ : int [1:5] 8 35 46 80 86\n $ : int [1:5] 50 51 52 53 55\n $ : int [1:4] 28 51 52 54\n $ : int [1:6] 32 48 51 52 54 55\n $ : int [1:4] 48 49 50 52\n $ : int [1:6] 28 48 49 50 51 54\n $ : int [1:2] 48 55\n $ : int [1:5] 24 28 49 50 52\n $ : int [1:4] 48 50 53 75\n $ : int 36\n $ : int [1:5] 1 2 3 58 64\n $ : int [1:5] 2 57 64 66 68\n $ : int [1:3] 60 87 88\n $ : int [1:4] 12 13 59 61\n $ : int [1:5] 12 60 62 63 87\n $ : int [1:4] 61 63 77 87\n $ : int [1:5] 12 18 61 62 83\n $ : int [1:4] 1 57 58 76\n $ : int 76\n $ : int [1:5] 58 67 68 76 84\n $ : int [1:2] 7 66\n $ : int [1:4] 9 58 66 84\n $ : int [1:2] 6 75\n $ : int [1:3] 10 72 73\n $ : int [1:2] 73 74\n $ : int [1:3] 10 11 70\n $ : int [1:4] 19 70 71 74\n $ : int [1:5] 19 21 71 73 86\n $ : int [1:2] 55 69\n $ : int [1:3] 64 65 66\n $ : int [1:3] 23 38 62\n $ : int [1:2] 2 8\n $ : int [1:4] 38 40 41 45\n $ : int [1:5] 34 35 36 45 47\n $ : int [1:5] 25 26 33 39 42\n $ : int [1:6] 19 20 21 23 35 41\n $ : int [1:4] 12 13 16 63\n $ : int [1:4] 7 9 66 68\n $ : int [1:2] 2 5\n $ : int [1:4] 21 46 47 74\n $ : int [1:4] 59 61 62 88\n $ : int [1:2] 59 87\n - attr(*, \"class\")= chr \"nb\"\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language dnearneigh(x = coords, d1 = 0, d2 = 62, longlat = TRUE)\n - attr(*, \"dnn\")= num [1:2] 0 62\n - attr(*, \"bounds\")= chr [1:2] \"GE\" \"LE\"\n - attr(*, \"nbtype\")= chr \"distance\"\n - attr(*, \"sym\")= logi TRUE\n\n\nAnother way to display the structure of the weight matrix is to combine table() and card() of spdep.\n\ntable(hunan$County, card(wm_d62))\n\n               \n                1 2 3 4 5 6\n  Anhua         1 0 0 0 0 0\n  Anren         0 0 0 1 0 0\n  Anxiang       0 0 0 0 1 0\n  Baojing       0 0 0 0 1 0\n  Chaling       0 0 1 0 0 0\n  Changning     0 0 1 0 0 0\n  Changsha      0 0 0 1 0 0\n  Chengbu       0 1 0 0 0 0\n  Chenxi        0 0 0 1 0 0\n  Cili          0 1 0 0 0 0\n  Dao           0 0 0 1 0 0\n  Dongan        0 0 1 0 0 0\n  Dongkou       0 0 0 1 0 0\n  Fenghuang     0 0 0 1 0 0\n  Guidong       0 0 1 0 0 0\n  Guiyang       0 0 0 1 0 0\n  Guzhang       0 0 0 0 0 1\n  Hanshou       0 0 0 1 0 0\n  Hengdong      0 0 0 0 1 0\n  Hengnan       0 0 0 0 1 0\n  Hengshan      0 0 0 0 0 1\n  Hengyang      0 0 0 0 0 1\n  Hongjiang     0 0 0 0 1 0\n  Huarong       0 0 0 1 0 0\n  Huayuan       0 0 0 1 0 0\n  Huitong       0 0 0 1 0 0\n  Jiahe         0 0 0 0 1 0\n  Jianghua      0 0 1 0 0 0\n  Jiangyong     0 1 0 0 0 0\n  Jingzhou      0 1 0 0 0 0\n  Jinshi        0 0 0 1 0 0\n  Jishou        0 0 0 0 0 1\n  Lanshan       0 0 0 1 0 0\n  Leiyang       0 0 0 1 0 0\n  Lengshuijiang 0 0 1 0 0 0\n  Li            0 0 1 0 0 0\n  Lianyuan      0 0 0 0 1 0\n  Liling        0 1 0 0 0 0\n  Linli         0 0 0 1 0 0\n  Linwu         0 0 0 1 0 0\n  Linxiang      1 0 0 0 0 0\n  Liuyang       0 1 0 0 0 0\n  Longhui       0 0 1 0 0 0\n  Longshan      0 1 0 0 0 0\n  Luxi          0 0 0 0 1 0\n  Mayang        0 0 0 0 0 1\n  Miluo         0 0 0 0 1 0\n  Nan           0 0 0 0 1 0\n  Ningxiang     0 0 0 1 0 0\n  Ningyuan      0 0 0 0 1 0\n  Pingjiang     0 1 0 0 0 0\n  Qidong        0 0 1 0 0 0\n  Qiyang        0 0 1 0 0 0\n  Rucheng       0 1 0 0 0 0\n  Sangzhi       0 1 0 0 0 0\n  Shaodong      0 0 0 0 1 0\n  Shaoshan      0 0 0 0 1 0\n  Shaoyang      0 0 0 1 0 0\n  Shimen        1 0 0 0 0 0\n  Shuangfeng    0 0 0 0 0 1\n  Shuangpai     0 0 0 1 0 0\n  Suining       0 0 0 0 1 0\n  Taojiang      0 1 0 0 0 0\n  Taoyuan       0 1 0 0 0 0\n  Tongdao       0 1 0 0 0 0\n  Wangcheng     0 0 0 1 0 0\n  Wugang        0 0 1 0 0 0\n  Xiangtan      0 0 0 1 0 0\n  Xiangxiang    0 0 0 0 1 0\n  Xiangyin      0 0 0 1 0 0\n  Xinhua        0 0 0 0 1 0\n  Xinhuang      1 0 0 0 0 0\n  Xinning       0 1 0 0 0 0\n  Xinshao       0 0 0 0 0 1\n  Xintian       0 0 0 0 1 0\n  Xupu          0 1 0 0 0 0\n  Yanling       0 0 1 0 0 0\n  Yizhang       1 0 0 0 0 0\n  Yongshun      0 0 0 1 0 0\n  Yongxing      0 0 0 1 0 0\n  You           0 0 0 1 0 0\n  Yuanjiang     0 0 0 0 1 0\n  Yuanling      1 0 0 0 0 0\n  Yueyang       0 0 1 0 0 0\n  Zhijiang      0 0 0 0 1 0\n  Zhongfang     0 0 0 1 0 0\n  Zhuzhou       0 0 0 0 1 0\n  Zixing        0 0 1 0 0 0\n\n\n\nn_comp &lt;- n.comp.nb(wm_d62)\nn_comp$nc\n\n[1] 1\n\n\n\ntable(n_comp$comp.id)\n\n\n 1 \n88 \n\n\n\nPlotting fixed distance weight matrix\nNext, we will plot the distance weight matrix by using the code chunk below.\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_d62, coords, add=TRUE)\nplot(k1, coords, add=TRUE, col=\"red\", length=0.08)\n\n\n\n\n** The red lines show the links of 1st nearest neighbours and the black lines show the links of neighbours within the cut-off distance of 62km.\nAlternatively, we can plot both of them next to each other by using the code chunk below.\n\npar(mfrow=c(1,2))\nplot(hunan$geometry, border=\"lightgrey\")\nplot(k1, coords, add=TRUE, col=\"red\", length=0.08, main=\"1st nearest neighbours\")\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_d62, coords, add=TRUE, pch = 19, cex = 0.6, main=\"Distance link\")\n\n\n\n\n\n\n\nComputing adaptive distance weight matrix\nThe code below shows that it is possible to control the numbers of neighbours directly using k-nearest neighbours, either accepting asymmetric neighbours or imposing symmetry as shown in the code chunk below.\n\nknn6 &lt;- knn2nb(knearneigh(coords, k=6))\nknn6\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 528 \nPercentage nonzero weights: 6.818182 \nAverage number of links: 6 \nNon-symmetric neighbours list\n\n\nDisplay\n\nstr(knn6)\n\nList of 88\n $ : int [1:6] 2 3 4 5 57 64\n $ : int [1:6] 1 3 57 58 78 85\n $ : int [1:6] 1 2 4 5 57 85\n $ : int [1:6] 1 3 5 6 69 85\n $ : int [1:6] 1 3 4 6 69 85\n $ : int [1:6] 3 4 5 69 75 85\n $ : int [1:6] 9 66 67 71 74 84\n $ : int [1:6] 9 46 47 78 80 86\n $ : int [1:6] 8 46 66 68 84 86\n $ : int [1:6] 16 19 22 70 72 73\n $ : int [1:6] 10 14 16 17 70 72\n $ : int [1:6] 13 15 60 61 63 83\n $ : int [1:6] 12 15 60 61 63 83\n $ : int [1:6] 11 15 16 17 72 83\n $ : int [1:6] 12 13 14 17 60 83\n $ : int [1:6] 10 11 17 22 72 83\n $ : int [1:6] 10 11 14 16 72 83\n $ : int [1:6] 20 22 23 63 77 83\n $ : int [1:6] 10 20 21 73 74 82\n $ : int [1:6] 18 19 21 22 23 82\n $ : int [1:6] 19 20 35 74 82 86\n $ : int [1:6] 10 16 18 19 20 83\n $ : int [1:6] 18 20 41 77 79 82\n $ : int [1:6] 25 28 31 52 54 81\n $ : int [1:6] 24 28 31 33 54 81\n $ : int [1:6] 25 27 29 33 42 81\n $ : int [1:6] 26 29 30 37 42 81\n $ : int [1:6] 24 25 33 49 52 54\n $ : int [1:6] 26 27 37 42 43 81\n $ : int [1:6] 26 27 28 33 49 81\n $ : int [1:6] 24 25 36 39 40 54\n $ : int [1:6] 24 31 50 54 55 56\n $ : int [1:6] 25 26 28 30 49 81\n $ : int [1:6] 36 40 41 45 56 80\n $ : int [1:6] 21 41 46 47 80 82\n $ : int [1:6] 31 34 40 45 56 80\n $ : int [1:6] 26 27 29 42 43 44\n $ : int [1:6] 23 43 44 62 77 79\n $ : int [1:6] 25 40 42 43 44 81\n $ : int [1:6] 31 36 39 43 45 79\n $ : int [1:6] 23 35 45 79 80 82\n $ : int [1:6] 26 27 37 39 43 81\n $ : int [1:6] 37 39 40 42 44 79\n $ : int [1:6] 37 38 39 42 43 79\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:6] 8 9 35 47 78 86\n $ : int [1:6] 8 21 35 46 80 86\n $ : int [1:6] 49 50 51 52 53 55\n $ : int [1:6] 28 33 48 51 52 54\n $ : int [1:6] 32 48 51 52 54 55\n $ : int [1:6] 28 48 49 50 52 54\n $ : int [1:6] 28 48 49 50 51 54\n $ : int [1:6] 48 50 51 52 55 75\n $ : int [1:6] 24 28 49 50 51 52\n $ : int [1:6] 32 48 50 52 53 75\n $ : int [1:6] 32 34 36 78 80 85\n $ : int [1:6] 1 2 3 58 64 68\n $ : int [1:6] 2 57 64 66 68 78\n $ : int [1:6] 12 13 60 61 87 88\n $ : int [1:6] 12 13 59 61 63 87\n $ : int [1:6] 12 13 60 62 63 87\n $ : int [1:6] 12 38 61 63 77 87\n $ : int [1:6] 12 18 60 61 62 83\n $ : int [1:6] 1 3 57 58 68 76\n $ : int [1:6] 58 64 66 67 68 76\n $ : int [1:6] 9 58 67 68 76 84\n $ : int [1:6] 7 65 66 68 76 84\n $ : int [1:6] 9 57 58 66 78 84\n $ : int [1:6] 4 5 6 32 75 85\n $ : int [1:6] 10 16 19 22 72 73\n $ : int [1:6] 7 19 73 74 84 86\n $ : int [1:6] 10 11 14 16 17 70\n $ : int [1:6] 10 19 21 70 71 74\n $ : int [1:6] 19 21 71 73 84 86\n $ : int [1:6] 6 32 50 53 55 69\n $ : int [1:6] 58 64 65 66 67 68\n $ : int [1:6] 18 23 38 61 62 63\n $ : int [1:6] 2 8 9 46 58 68\n $ : int [1:6] 38 40 41 43 44 45\n $ : int [1:6] 34 35 36 41 45 47\n $ : int [1:6] 25 26 28 33 39 42\n $ : int [1:6] 19 20 21 23 35 41\n $ : int [1:6] 12 13 15 16 22 63\n $ : int [1:6] 7 9 66 68 71 74\n $ : int [1:6] 2 3 4 5 56 69\n $ : int [1:6] 8 9 21 46 47 74\n $ : int [1:6] 59 60 61 62 63 88\n $ : int [1:6] 59 60 61 62 63 87\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language knearneigh(x = coords, k = 6)\n - attr(*, \"sym\")= logi FALSE\n - attr(*, \"type\")= chr \"knn\"\n - attr(*, \"knn-k\")= num 6\n - attr(*, \"class\")= chr \"nb\"\n\n\n** To note: each county has six neighbours\n\nPlotting distance based neighbours\nWe can plot the weight matrix using the code chunk below.\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(knn6, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.1.html#weights-based-on-idw",
    "href": "hands_on_ex2/hands_on_ex2.1.html#weights-based-on-idw",
    "title": "Hands-on Exercise 2.1: Spatial Weights and Applications",
    "section": "Weights based on IDW",
    "text": "Weights based on IDW\nThis section will explore how to derive a spatial weight matrix based on Inversed Distance method.\nFirst, we will compute the distances between areas by using nbdists() of spdep.\n\ndist &lt;- nbdists(wm_q, coords, longlat = TRUE)\nids &lt;- lapply(dist, function(x) 1/(x))\nids\n\n[[1]]\n[1] 0.01535405 0.03916350 0.01820896 0.02807922 0.01145113\n\n[[2]]\n[1] 0.01535405 0.01764308 0.01925924 0.02323898 0.01719350\n\n[[3]]\n[1] 0.03916350 0.02822040 0.03695795 0.01395765\n\n[[4]]\n[1] 0.01820896 0.02822040 0.03414741 0.01539065\n\n[[5]]\n[1] 0.03695795 0.03414741 0.01524598 0.01618354\n\n[[6]]\n[1] 0.015390649 0.015245977 0.021748129 0.011883901 0.009810297\n\n[[7]]\n[1] 0.01708612 0.01473997 0.01150924 0.01872915\n\n[[8]]\n[1] 0.02022144 0.03453056 0.02529256 0.01036340 0.02284457 0.01500600 0.01515314\n\n[[9]]\n[1] 0.02022144 0.01574888 0.02109502 0.01508028 0.02902705 0.01502980\n\n[[10]]\n[1] 0.02281552 0.01387777 0.01538326 0.01346650 0.02100510 0.02631658 0.01874863\n[8] 0.01500046\n\n[[11]]\n[1] 0.01882869 0.02243492 0.02247473\n\n[[12]]\n[1] 0.02779227 0.02419652 0.02333385 0.02986130 0.02335429\n\n[[13]]\n[1] 0.02779227 0.02650020 0.02670323 0.01714243\n\n[[14]]\n[1] 0.01882869 0.01233868 0.02098555\n\n[[15]]\n[1] 0.02650020 0.01233868 0.01096284 0.01562226\n\n[[16]]\n[1] 0.02281552 0.02466962 0.02765018 0.01476814 0.01671430\n\n[[17]]\n[1] 0.01387777 0.02243492 0.02098555 0.01096284 0.02466962 0.01593341 0.01437996\n\n[[18]]\n[1] 0.02039779 0.02032767 0.01481665 0.01473691 0.01459380\n\n[[19]]\n[1] 0.01538326 0.01926323 0.02668415 0.02140253 0.01613589 0.01412874\n\n[[20]]\n[1] 0.01346650 0.02039779 0.01926323 0.01723025 0.02153130 0.01469240 0.02327034\n\n[[21]]\n[1] 0.02668415 0.01723025 0.01766299 0.02644986 0.02163800\n\n[[22]]\n[1] 0.02100510 0.02765018 0.02032767 0.02153130 0.01489296\n\n[[23]]\n[1] 0.01481665 0.01469240 0.01401432 0.02246233 0.01880425 0.01530458 0.01849605\n\n[[24]]\n[1] 0.02354598 0.01837201 0.02607264 0.01220154 0.02514180\n\n[[25]]\n[1] 0.02354598 0.02188032 0.01577283 0.01949232 0.02947957\n\n[[26]]\n[1] 0.02155798 0.01745522 0.02212108 0.02220532\n\n[[27]]\n[1] 0.02155798 0.02490625 0.01562326\n\n[[28]]\n[1] 0.01837201 0.02188032 0.02229549 0.03076171 0.02039506\n\n[[29]]\n[1] 0.02490625 0.01686587 0.01395022\n\n[[30]]\n[1] 0.02090587\n\n[[31]]\n[1] 0.02607264 0.01577283 0.01219005 0.01724850 0.01229012 0.01609781 0.01139438\n[8] 0.01150130\n\n[[32]]\n[1] 0.01220154 0.01219005 0.01712515 0.01340413 0.01280928 0.01198216 0.01053374\n[8] 0.01065655\n\n[[33]]\n[1] 0.01949232 0.01745522 0.02229549 0.02090587 0.01979045\n\n[[34]]\n[1] 0.03113041 0.03589551 0.02882915\n\n[[35]]\n[1] 0.01766299 0.02185795 0.02616766 0.02111721 0.02108253 0.01509020\n\n[[36]]\n[1] 0.01724850 0.03113041 0.01571707 0.01860991 0.02073549 0.01680129\n\n[[37]]\n[1] 0.01686587 0.02234793 0.01510990 0.01550676\n\n[[38]]\n[1] 0.01401432 0.02407426 0.02276151 0.01719415\n\n[[39]]\n[1] 0.01229012 0.02172543 0.01711924 0.02629732 0.01896385\n\n[[40]]\n[1] 0.01609781 0.01571707 0.02172543 0.01506473 0.01987922 0.01894207\n\n[[41]]\n[1] 0.02246233 0.02185795 0.02205991 0.01912542 0.01601083 0.01742892\n\n[[42]]\n[1] 0.02212108 0.01562326 0.01395022 0.02234793 0.01711924 0.01836831 0.01683518\n\n[[43]]\n[1] 0.01510990 0.02629732 0.01506473 0.01836831 0.03112027 0.01530782\n\n[[44]]\n[1] 0.01550676 0.02407426 0.03112027 0.01486508\n\n[[45]]\n[1] 0.03589551 0.01860991 0.01987922 0.02205991 0.02107101 0.01982700\n\n[[46]]\n[1] 0.03453056 0.04033752 0.02689769\n\n[[47]]\n[1] 0.02529256 0.02616766 0.04033752 0.01949145 0.02181458\n\n[[48]]\n[1] 0.02313819 0.03370576 0.02289485 0.01630057 0.01818085\n\n[[49]]\n[1] 0.03076171 0.02138091 0.02394529 0.01990000\n\n[[50]]\n[1] 0.01712515 0.02313819 0.02551427 0.02051530 0.02187179\n\n[[51]]\n[1] 0.03370576 0.02138091 0.02873854\n\n[[52]]\n[1] 0.02289485 0.02394529 0.02551427 0.02873854 0.03516672\n\n[[53]]\n[1] 0.01630057 0.01979945 0.01253977\n\n[[54]]\n[1] 0.02514180 0.02039506 0.01340413 0.01990000 0.02051530 0.03516672\n\n[[55]]\n[1] 0.01280928 0.01818085 0.02187179 0.01979945 0.01882298\n\n[[56]]\n[1] 0.01036340 0.01139438 0.01198216 0.02073549 0.01214479 0.01362855 0.01341697\n\n[[57]]\n[1] 0.028079221 0.017643082 0.031423501 0.029114131 0.013520292 0.009903702\n\n[[58]]\n[1] 0.01925924 0.03142350 0.02722997 0.01434859 0.01567192\n\n[[59]]\n[1] 0.01696711 0.01265572 0.01667105 0.01785036\n\n[[60]]\n[1] 0.02419652 0.02670323 0.01696711 0.02343040\n\n[[61]]\n[1] 0.02333385 0.01265572 0.02343040 0.02514093 0.02790764 0.01219751 0.02362452\n\n[[62]]\n[1] 0.02514093 0.02002219 0.02110260\n\n[[63]]\n[1] 0.02986130 0.02790764 0.01407043 0.01805987\n\n[[64]]\n[1] 0.02911413 0.01689892\n\n[[65]]\n[1] 0.02471705\n\n[[66]]\n[1] 0.01574888 0.01726461 0.03068853 0.01954805 0.01810569\n\n[[67]]\n[1] 0.01708612 0.01726461 0.01349843 0.01361172\n\n[[68]]\n[1] 0.02109502 0.02722997 0.03068853 0.01406357 0.01546511\n\n[[69]]\n[1] 0.02174813 0.01645838 0.01419926\n\n[[70]]\n[1] 0.02631658 0.01963168 0.02278487\n\n[[71]]\n[1] 0.01473997 0.01838483 0.03197403\n\n[[72]]\n[1] 0.01874863 0.02247473 0.01476814 0.01593341 0.01963168\n\n[[73]]\n[1] 0.01500046 0.02140253 0.02278487 0.01838483 0.01652709\n\n[[74]]\n[1] 0.01150924 0.01613589 0.03197403 0.01652709 0.01342099 0.02864567\n\n[[75]]\n[1] 0.011883901 0.010533736 0.012539774 0.018822977 0.016458383 0.008217581\n\n[[76]]\n[1] 0.01352029 0.01434859 0.01689892 0.02471705 0.01954805 0.01349843 0.01406357\n\n[[77]]\n[1] 0.014736909 0.018804247 0.022761507 0.012197506 0.020022195 0.014070428\n[7] 0.008440896\n\n[[78]]\n[1] 0.02323898 0.02284457 0.01508028 0.01214479 0.01567192 0.01546511 0.01140779\n\n[[79]]\n[1] 0.01530458 0.01719415 0.01894207 0.01912542 0.01530782 0.01486508 0.02107101\n\n[[80]]\n[1] 0.01500600 0.02882915 0.02111721 0.01680129 0.01601083 0.01982700 0.01949145\n[8] 0.01362855\n\n[[81]]\n[1] 0.02947957 0.02220532 0.01150130 0.01979045 0.01896385 0.01683518\n\n[[82]]\n[1] 0.02327034 0.02644986 0.01849605 0.02108253 0.01742892\n\n[[83]]\n[1] 0.023354289 0.017142433 0.015622258 0.016714303 0.014379961 0.014593799\n[7] 0.014892965 0.018059871 0.008440896\n\n[[84]]\n[1] 0.01872915 0.02902705 0.01810569 0.01361172 0.01342099 0.01297994\n\n[[85]]\n [1] 0.011451133 0.017193502 0.013957649 0.016183544 0.009810297 0.010656545\n [7] 0.013416965 0.009903702 0.014199260 0.008217581 0.011407794\n\n[[86]]\n[1] 0.01515314 0.01502980 0.01412874 0.02163800 0.01509020 0.02689769 0.02181458\n[8] 0.02864567 0.01297994\n\n[[87]]\n[1] 0.01667105 0.02362452 0.02110260 0.02058034\n\n[[88]]\n[1] 0.01785036 0.02058034\n\n\n\nRow-standardised weights matrix\nNext, we need to assign weights to each neighboring polygon. In our case, each neighboring polygon will be assigned equal weight (style=“W”). This is accomplished by assigning the fraction 1/(#ofneighbors) to each neighboring county then summing the weighted income values. While this is the most intuitive way to summaries the neighbors’ values it has one drawback in that polygons along the edges of the study area will base their lagged values on fewer polygons thus potentially over- or under-estimating the true nature of the spatial autocorrelation in the data. For this example, we’ll stick with the style=“W” option for simplicity’s sake but note that other more robust options are available, notably style=“B”.\n\nrswm_q &lt;- nb2listw(wm_q, style=\"W\", zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147\n\n\nTo see the weight of the first polygon’s eight neighbors type:\n\nrswm_q$weights[10]\n\n[[1]]\n[1] 0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125\n\n\nUsing the same method, we can also derive a row standardised distance weight matrix by using the code chunk below.\n\nrswm_ids &lt;- nb2listw(wm_q, glist=ids, style=\"B\", zero.policy=TRUE)\nrswm_ids\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn       S0        S1     S2\nB 88 7744 8.786867 0.3776535 3.8137\n\n\n\nrswm_ids$weights[1]\n\n[[1]]\n[1] 0.01535405 0.03916350 0.01820896 0.02807922 0.01145113\n\n\n\nsummary(unlist(rswm_ids$weights))\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n0.008218 0.015088 0.018739 0.019614 0.022823 0.040338"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.1.html#application-of-spatial-weight-matrix",
    "href": "hands_on_ex2/hands_on_ex2.1.html#application-of-spatial-weight-matrix",
    "title": "Hands-on Exercise 2.1: Spatial Weights and Applications",
    "section": "Application of Spatial Weight Matrix",
    "text": "Application of Spatial Weight Matrix\nIn this section, I will learn how to create four different spatial lagged variables, they are:\n\nspatial lag with row-standardized weights,\nspatial lag as a sum of neighbouring values,\nspatial window average, and\nspatial window sum.\n\n\nSpatial lag with row-standardized weights\nFinally, we’ll compute the average neighbor GDPPC value for each polygon. These values are often referred to as spatially lagged values.\n\nGDPPC.lag &lt;- lag.listw(rswm_q, hunan$GDPPC)\nGDPPC.lag\n\n [1] 24847.20 22724.80 24143.25 27737.50 27270.25 21248.80 43747.00 33582.71\n [9] 45651.17 32027.62 32671.00 20810.00 25711.50 30672.33 33457.75 31689.20\n[17] 20269.00 23901.60 25126.17 21903.43 22718.60 25918.80 20307.00 20023.80\n[25] 16576.80 18667.00 14394.67 19848.80 15516.33 20518.00 17572.00 15200.12\n[33] 18413.80 14419.33 24094.50 22019.83 12923.50 14756.00 13869.80 12296.67\n[41] 15775.17 14382.86 11566.33 13199.50 23412.00 39541.00 36186.60 16559.60\n[49] 20772.50 19471.20 19827.33 15466.80 12925.67 18577.17 14943.00 24913.00\n[57] 25093.00 24428.80 17003.00 21143.75 20435.00 17131.33 24569.75 23835.50\n[65] 26360.00 47383.40 55157.75 37058.00 21546.67 23348.67 42323.67 28938.60\n[73] 25880.80 47345.67 18711.33 29087.29 20748.29 35933.71 15439.71 29787.50\n[81] 18145.00 21617.00 29203.89 41363.67 22259.09 44939.56 16902.00 16930.00\n\n\nWe can append the spatially lag GDPPC values onto hunan sf data frame by using the code chunk below.\n\nlag.list &lt;- list(hunan$NAME_3, lag.listw(rswm_q, hunan$GDPPC))\nlag.res &lt;- as.data.frame(lag.list)\ncolnames(lag.res) &lt;- c(\"NAME_3\", \"lag GDPPC\")\nhunan &lt;- left_join(hunan,lag.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\nThe following table shows the average neighboring income values (stored in the Inc.lag object) for each county.\n\nhead(hunan)\n\nSimple feature collection with 6 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 110.4922 ymin: 28.61762 xmax: 112.3013 ymax: 30.12812\nGeodetic CRS:  WGS 84\n   NAME_2  ID_3  NAME_3   ENGTYPE_3  County GDPPC lag GDPPC\n1 Changde 21098 Anxiang      County Anxiang 23667  24847.20\n2 Changde 21100 Hanshou      County Hanshou 20981  22724.80\n3 Changde 21101  Jinshi County City  Jinshi 34592  24143.25\n4 Changde 21102      Li      County      Li 24473  27737.50\n5 Changde 21103   Linli      County   Linli 25554  27270.25\n6 Changde 21104  Shimen      County  Shimen 27137  21248.80\n                        geometry\n1 POLYGON ((112.0625 29.75523...\n2 POLYGON ((112.2288 29.11684...\n3 POLYGON ((111.8927 29.6013,...\n4 POLYGON ((111.3731 29.94649...\n5 POLYGON ((111.6324 29.76288...\n6 POLYGON ((110.8825 30.11675...\n\n\nNext, we will plot both the GDPPC and spatial lag GDPPC for comparison using the code chunk below.\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_gdppc &lt;- qtm(hunan, \"lag GDPPC\")\ntmap_arrange(gdppc, lag_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\nSpatial lag as a sum of neighboring values\nWe start by applying a function that will assign a value of 1 per each neighbor. This is done with lapply, which we have been using to manipulate the neighbors structure throughout the past notebooks. Basically it applies a function across each value in the neighbors structure.\n\nb_weights &lt;- lapply(wm_q, function(x) 0*x + 1)\nb_weights2 &lt;- nb2listw(wm_q, \n                       glist = b_weights, \n                       style = \"B\")\nb_weights2\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0  S1    S2\nB 88 7744 448 896 10224\n\n\nWith the proper weights assigned, we can use lag.listw to compute a lag variable from our weight and GDPPC.\n\nlag_sum &lt;- list(hunan$NAME_3, lag.listw(b_weights2, hunan$GDPPC))\nlag.res &lt;- as.data.frame(lag_sum)\ncolnames(lag.res) &lt;- c(\"NAME_3\", \"lag_sum GDPPC\")\n\nLet us examine the result by using the code chunk below.\n\nlag_sum\n\n[[1]]\n [1] \"Anxiang\"       \"Hanshou\"       \"Jinshi\"        \"Li\"           \n [5] \"Linli\"         \"Shimen\"        \"Liuyang\"       \"Ningxiang\"    \n [9] \"Wangcheng\"     \"Anren\"         \"Guidong\"       \"Jiahe\"        \n[13] \"Linwu\"         \"Rucheng\"       \"Yizhang\"       \"Yongxing\"     \n[17] \"Zixing\"        \"Changning\"     \"Hengdong\"      \"Hengnan\"      \n[21] \"Hengshan\"      \"Leiyang\"       \"Qidong\"        \"Chenxi\"       \n[25] \"Zhongfang\"     \"Huitong\"       \"Jingzhou\"      \"Mayang\"       \n[29] \"Tongdao\"       \"Xinhuang\"      \"Xupu\"          \"Yuanling\"     \n[33] \"Zhijiang\"      \"Lengshuijiang\" \"Shuangfeng\"    \"Xinhua\"       \n[37] \"Chengbu\"       \"Dongan\"        \"Dongkou\"       \"Longhui\"      \n[41] \"Shaodong\"      \"Suining\"       \"Wugang\"        \"Xinning\"      \n[45] \"Xinshao\"       \"Shaoshan\"      \"Xiangxiang\"    \"Baojing\"      \n[49] \"Fenghuang\"     \"Guzhang\"       \"Huayuan\"       \"Jishou\"       \n[53] \"Longshan\"      \"Luxi\"          \"Yongshun\"      \"Anhua\"        \n[57] \"Nan\"           \"Yuanjiang\"     \"Jianghua\"      \"Lanshan\"      \n[61] \"Ningyuan\"      \"Shuangpai\"     \"Xintian\"       \"Huarong\"      \n[65] \"Linxiang\"      \"Miluo\"         \"Pingjiang\"     \"Xiangyin\"     \n[69] \"Cili\"          \"Chaling\"       \"Liling\"        \"Yanling\"      \n[73] \"You\"           \"Zhuzhou\"       \"Sangzhi\"       \"Yueyang\"      \n[77] \"Qiyang\"        \"Taojiang\"      \"Shaoyang\"      \"Lianyuan\"     \n[81] \"Hongjiang\"     \"Hengyang\"      \"Guiyang\"       \"Changsha\"     \n[85] \"Taoyuan\"       \"Xiangtan\"      \"Dao\"           \"Jiangyong\"    \n\n[[2]]\n [1] 124236 113624  96573 110950 109081 106244 174988 235079 273907 256221\n[11]  98013 104050 102846  92017 133831 158446 141883 119508 150757 153324\n[21] 113593 129594 142149 100119  82884  74668  43184  99244  46549  20518\n[31] 140576 121601  92069  43258 144567 132119  51694  59024  69349  73780\n[41]  94651 100680  69398  52798 140472 118623 180933  82798  83090  97356\n[51]  59482  77334  38777 111463  74715 174391 150558 122144  68012  84575\n[61] 143045  51394  98279  47671  26360 236917 220631 185290  64640  70046\n[71] 126971 144693 129404 284074 112268 203611 145238 251536 108078 238300\n[81] 108870 108085 262835 248182 244850 404456  67608  33860\n\n\nNext, we will append the lag_sum GDPPC field into hunan sf data frame by using the code chunk below.\n\nhunan &lt;- left_join(hunan, lag.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\nNow, We can plot both the GDPPC and Spatial Lag Sum GDPPC for comparison using the code chunk below.\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_sum_gdppc &lt;- qtm(hunan, \"lag_sum GDPPC\")\ntmap_arrange(gdppc, lag_sum_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\nSpatial window average\nTo add the diagonal element to the neighbour list, we just need to use include.self() from spdep.\n\nwm_qs &lt;- include.self(wm_q)\n\n\nwm_qs[[1]]\n\n[1]  1  2  3  4 57 85\n\n\n\nwm_qs &lt;- nb2listw(wm_qs)\nwm_qs\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 30.90265 357.5308\n\n\nAgain, we use nb2listw() and glist() to explicitly assign weight values.\nLastly, we just need to create the lag variable from our weight structure and GDPPC variable.\n\nlag_w_avg_gpdpc &lt;- lag.listw(wm_qs, \n                             hunan$GDPPC)\nlag_w_avg_gpdpc\n\n [1] 24650.50 22434.17 26233.00 27084.60 26927.00 22230.17 47621.20 37160.12\n [9] 49224.71 29886.89 26627.50 22690.17 25366.40 25825.75 30329.00 32682.83\n[17] 25948.62 23987.67 25463.14 21904.38 23127.50 25949.83 20018.75 19524.17\n[25] 18955.00 17800.40 15883.00 18831.33 14832.50 17965.00 17159.89 16199.44\n[33] 18764.50 26878.75 23188.86 20788.14 12365.20 15985.00 13764.83 11907.43\n[41] 17128.14 14593.62 11644.29 12706.00 21712.29 43548.25 35049.00 16226.83\n[49] 19294.40 18156.00 19954.75 18145.17 12132.75 18419.29 14050.83 23619.75\n[57] 24552.71 24733.67 16762.60 20932.60 19467.75 18334.00 22541.00 26028.00\n[65] 29128.50 46569.00 47576.60 36545.50 20838.50 22531.00 42115.50 27619.00\n[73] 27611.33 44523.29 18127.43 28746.38 20734.50 33880.62 14716.38 28516.22\n[81] 18086.14 21244.50 29568.80 48119.71 22310.75 43151.60 17133.40 17009.33\n\n\nConvert the lag variable listw object into a data.frame by using as.data.frame().\n\nlag.list.wm_qs &lt;- list(hunan$NAME_3, lag.listw(wm_qs, hunan$GDPPC))\nlag_wm_qs.res &lt;- as.data.frame(lag.list.wm_qs)\ncolnames(lag_wm_qs.res) &lt;- c(\"NAME_3\", \"lag_window_avg GDPPC\")\n\nThe code chunk below will be used to append lag_window_avg GDPPC values onto hunan sf data.frame by using left_join() of dplyr package.\n\nhunan &lt;- left_join(hunan, lag_wm_qs.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\nTo compare the values of lag GDPPC and Spatial window average, kable() of Knitr package is used to prepare a table using the code chunk below.\n\nhunan %&gt;%\n  select(\"County\", \"lag GDPPC\", \"lag_window_avg GDPPC\") %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\nCounty\nlag GDPPC\nlag_window_avg GDPPC\ngeometry\n\n\n\n\nAnxiang\n24847.20\n24650.50\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n22724.80\n22434.17\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n24143.25\n26233.00\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n27737.50\n27084.60\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n27270.25\n26927.00\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n21248.80\n22230.17\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n43747.00\n47621.20\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n33582.71\n37160.12\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n45651.17\n49224.71\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n32027.62\n29886.89\nPOLYGON ((113.1757 26.82734…\n\n\nGuidong\n32671.00\n26627.50\nPOLYGON ((114.1799 26.20117…\n\n\nJiahe\n20810.00\n22690.17\nPOLYGON ((112.4425 25.74358…\n\n\nLinwu\n25711.50\n25366.40\nPOLYGON ((112.5914 25.55143…\n\n\nRucheng\n30672.33\n25825.75\nPOLYGON ((113.6759 25.87578…\n\n\nYizhang\n33457.75\n30329.00\nPOLYGON ((113.2621 25.68394…\n\n\nYongxing\n31689.20\n32682.83\nPOLYGON ((113.3169 26.41843…\n\n\nZixing\n20269.00\n25948.62\nPOLYGON ((113.7311 26.16259…\n\n\nChangning\n23901.60\n23987.67\nPOLYGON ((112.6144 26.60198…\n\n\nHengdong\n25126.17\n25463.14\nPOLYGON ((113.1056 27.21007…\n\n\nHengnan\n21903.43\n21904.38\nPOLYGON ((112.7599 26.98149…\n\n\nHengshan\n22718.60\n23127.50\nPOLYGON ((112.607 27.4689, …\n\n\nLeiyang\n25918.80\n25949.83\nPOLYGON ((112.9996 26.69276…\n\n\nQidong\n20307.00\n20018.75\nPOLYGON ((111.7818 27.0383,…\n\n\nChenxi\n20023.80\n19524.17\nPOLYGON ((110.2624 28.21778…\n\n\nZhongfang\n16576.80\n18955.00\nPOLYGON ((109.9431 27.72858…\n\n\nHuitong\n18667.00\n17800.40\nPOLYGON ((109.9419 27.10512…\n\n\nJingzhou\n14394.67\n15883.00\nPOLYGON ((109.8186 26.75842…\n\n\nMayang\n19848.80\n18831.33\nPOLYGON ((109.795 27.98008,…\n\n\nTongdao\n15516.33\n14832.50\nPOLYGON ((109.9294 26.46561…\n\n\nXinhuang\n20518.00\n17965.00\nPOLYGON ((109.227 27.43733,…\n\n\nXupu\n17572.00\n17159.89\nPOLYGON ((110.7189 28.30485…\n\n\nYuanling\n15200.12\n16199.44\nPOLYGON ((110.9652 28.99895…\n\n\nZhijiang\n18413.80\n18764.50\nPOLYGON ((109.8818 27.60661…\n\n\nLengshuijiang\n14419.33\n26878.75\nPOLYGON ((111.5307 27.81472…\n\n\nShuangfeng\n24094.50\n23188.86\nPOLYGON ((112.263 27.70421,…\n\n\nXinhua\n22019.83\n20788.14\nPOLYGON ((111.3345 28.19642…\n\n\nChengbu\n12923.50\n12365.20\nPOLYGON ((110.4455 26.69317…\n\n\nDongan\n14756.00\n15985.00\nPOLYGON ((111.4531 26.86812…\n\n\nDongkou\n13869.80\n13764.83\nPOLYGON ((110.6622 27.37305…\n\n\nLonghui\n12296.67\n11907.43\nPOLYGON ((110.985 27.65983,…\n\n\nShaodong\n15775.17\n17128.14\nPOLYGON ((111.9054 27.40254…\n\n\nSuining\n14382.86\n14593.62\nPOLYGON ((110.389 27.10006,…\n\n\nWugang\n11566.33\n11644.29\nPOLYGON ((110.9878 27.03345…\n\n\nXinning\n13199.50\n12706.00\nPOLYGON ((111.0736 26.84627…\n\n\nXinshao\n23412.00\n21712.29\nPOLYGON ((111.6013 27.58275…\n\n\nShaoshan\n39541.00\n43548.25\nPOLYGON ((112.5391 27.97742…\n\n\nXiangxiang\n36186.60\n35049.00\nPOLYGON ((112.4549 28.05783…\n\n\nBaojing\n16559.60\n16226.83\nPOLYGON ((109.7015 28.82844…\n\n\nFenghuang\n20772.50\n19294.40\nPOLYGON ((109.5239 28.19206…\n\n\nGuzhang\n19471.20\n18156.00\nPOLYGON ((109.8968 28.74034…\n\n\nHuayuan\n19827.33\n19954.75\nPOLYGON ((109.5647 28.61712…\n\n\nJishou\n15466.80\n18145.17\nPOLYGON ((109.8375 28.4696,…\n\n\nLongshan\n12925.67\n12132.75\nPOLYGON ((109.6337 29.62521…\n\n\nLuxi\n18577.17\n18419.29\nPOLYGON ((110.1067 28.41835…\n\n\nYongshun\n14943.00\n14050.83\nPOLYGON ((110.0003 29.29499…\n\n\nAnhua\n24913.00\n23619.75\nPOLYGON ((111.6034 28.63716…\n\n\nNan\n25093.00\n24552.71\nPOLYGON ((112.3232 29.46074…\n\n\nYuanjiang\n24428.80\n24733.67\nPOLYGON ((112.4391 29.1791,…\n\n\nJianghua\n17003.00\n16762.60\nPOLYGON ((111.6461 25.29661…\n\n\nLanshan\n21143.75\n20932.60\nPOLYGON ((112.2286 25.61123…\n\n\nNingyuan\n20435.00\n19467.75\nPOLYGON ((112.0715 26.09892…\n\n\nShuangpai\n17131.33\n18334.00\nPOLYGON ((111.8864 26.11957…\n\n\nXintian\n24569.75\n22541.00\nPOLYGON ((112.2578 26.0796,…\n\n\nHuarong\n23835.50\n26028.00\nPOLYGON ((112.9242 29.69134…\n\n\nLinxiang\n26360.00\n29128.50\nPOLYGON ((113.5502 29.67418…\n\n\nMiluo\n47383.40\n46569.00\nPOLYGON ((112.9902 29.02139…\n\n\nPingjiang\n55157.75\n47576.60\nPOLYGON ((113.8436 29.06152…\n\n\nXiangyin\n37058.00\n36545.50\nPOLYGON ((112.9173 28.98264…\n\n\nCili\n21546.67\n20838.50\nPOLYGON ((110.8822 29.69017…\n\n\nChaling\n23348.67\n22531.00\nPOLYGON ((113.7666 27.10573…\n\n\nLiling\n42323.67\n42115.50\nPOLYGON ((113.5673 27.94346…\n\n\nYanling\n28938.60\n27619.00\nPOLYGON ((113.9292 26.6154,…\n\n\nYou\n25880.80\n27611.33\nPOLYGON ((113.5879 27.41324…\n\n\nZhuzhou\n47345.67\n44523.29\nPOLYGON ((113.2493 28.02411…\n\n\nSangzhi\n18711.33\n18127.43\nPOLYGON ((110.556 29.40543,…\n\n\nYueyang\n29087.29\n28746.38\nPOLYGON ((113.343 29.61064,…\n\n\nQiyang\n20748.29\n20734.50\nPOLYGON ((111.5563 26.81318…\n\n\nTaojiang\n35933.71\n33880.62\nPOLYGON ((112.0508 28.67265…\n\n\nShaoyang\n15439.71\n14716.38\nPOLYGON ((111.5013 27.30207…\n\n\nLianyuan\n29787.50\n28516.22\nPOLYGON ((111.6789 28.02946…\n\n\nHongjiang\n18145.00\n18086.14\nPOLYGON ((110.1441 27.47513…\n\n\nHengyang\n21617.00\n21244.50\nPOLYGON ((112.7144 26.98613…\n\n\nGuiyang\n29203.89\n29568.80\nPOLYGON ((113.0811 26.04963…\n\n\nChangsha\n41363.67\n48119.71\nPOLYGON ((112.9421 28.03722…\n\n\nTaoyuan\n22259.09\n22310.75\nPOLYGON ((112.0612 29.32855…\n\n\nXiangtan\n44939.56\n43151.60\nPOLYGON ((113.0426 27.8942,…\n\n\nDao\n16902.00\n17133.40\nPOLYGON ((111.498 25.81679,…\n\n\nJiangyong\n16930.00\n17009.33\nPOLYGON ((111.3659 25.39472…\n\n\n\n\n\nLastly, qtm() of tmap package is used to plot the lag_gdppc and w_ave_gdppc maps next to each other for quick comparison.\n\nw_avg_gdppc &lt;- qtm(hunan, \"lag_window_avg GDPPC\")\ntmap_arrange(lag_gdppc, w_avg_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\nSpatial window sum\nThe spatial window sum is the counter part of the window average, but without using row-standardized weights.\nTo add the diagonal element to the neighbour list, we just need to use include.self() from spdep.\n\nwm_qs &lt;- include.self(wm_q)\nwm_qs\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\n\nNext, we will assign binary weights to the neighbour structure that includes the diagonal element.\n\nb_weights &lt;- lapply(wm_qs, function(x) 0*x + 1)\nb_weights[1]\n\n[[1]]\n[1] 1 1 1 1 1 1\n\n\nAgain, we use nb2listw() and glist() to explicitly assign weight values.\n\nb_weights2 &lt;- nb2listw(wm_qs, \n                       glist = b_weights, \n                       style = \"B\")\nb_weights2\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 88 7744 536 1072 14160\n\n\n\nw_sum_gdppc &lt;- list(hunan$NAME_3, lag.listw(b_weights2, hunan$GDPPC))\nw_sum_gdppc\n\n[[1]]\n [1] \"Anxiang\"       \"Hanshou\"       \"Jinshi\"        \"Li\"           \n [5] \"Linli\"         \"Shimen\"        \"Liuyang\"       \"Ningxiang\"    \n [9] \"Wangcheng\"     \"Anren\"         \"Guidong\"       \"Jiahe\"        \n[13] \"Linwu\"         \"Rucheng\"       \"Yizhang\"       \"Yongxing\"     \n[17] \"Zixing\"        \"Changning\"     \"Hengdong\"      \"Hengnan\"      \n[21] \"Hengshan\"      \"Leiyang\"       \"Qidong\"        \"Chenxi\"       \n[25] \"Zhongfang\"     \"Huitong\"       \"Jingzhou\"      \"Mayang\"       \n[29] \"Tongdao\"       \"Xinhuang\"      \"Xupu\"          \"Yuanling\"     \n[33] \"Zhijiang\"      \"Lengshuijiang\" \"Shuangfeng\"    \"Xinhua\"       \n[37] \"Chengbu\"       \"Dongan\"        \"Dongkou\"       \"Longhui\"      \n[41] \"Shaodong\"      \"Suining\"       \"Wugang\"        \"Xinning\"      \n[45] \"Xinshao\"       \"Shaoshan\"      \"Xiangxiang\"    \"Baojing\"      \n[49] \"Fenghuang\"     \"Guzhang\"       \"Huayuan\"       \"Jishou\"       \n[53] \"Longshan\"      \"Luxi\"          \"Yongshun\"      \"Anhua\"        \n[57] \"Nan\"           \"Yuanjiang\"     \"Jianghua\"      \"Lanshan\"      \n[61] \"Ningyuan\"      \"Shuangpai\"     \"Xintian\"       \"Huarong\"      \n[65] \"Linxiang\"      \"Miluo\"         \"Pingjiang\"     \"Xiangyin\"     \n[69] \"Cili\"          \"Chaling\"       \"Liling\"        \"Yanling\"      \n[73] \"You\"           \"Zhuzhou\"       \"Sangzhi\"       \"Yueyang\"      \n[77] \"Qiyang\"        \"Taojiang\"      \"Shaoyang\"      \"Lianyuan\"     \n[81] \"Hongjiang\"     \"Hengyang\"      \"Guiyang\"       \"Changsha\"     \n[85] \"Taoyuan\"       \"Xiangtan\"      \"Dao\"           \"Jiangyong\"    \n\n[[2]]\n [1] 147903 134605 131165 135423 134635 133381 238106 297281 344573 268982\n[11] 106510 136141 126832 103303 151645 196097 207589 143926 178242 175235\n[21] 138765 155699 160150 117145 113730  89002  63532 112988  59330  35930\n[31] 154439 145795 112587 107515 162322 145517  61826  79925  82589  83352\n[41] 119897 116749  81510  63530 151986 174193 210294  97361  96472 108936\n[51]  79819 108871  48531 128935  84305 188958 171869 148402  83813 104663\n[61] 155742  73336 112705  78084  58257 279414 237883 219273  83354  90124\n[71] 168462 165714 165668 311663 126892 229971 165876 271045 117731 256646\n[81] 126603 127467 295688 336838 267729 431516  85667  51028\n\n\nNext, we will convert the lag variable listw object into a data.frame by using as.data.frame().\n\nw_sum_gdppc.res &lt;- as.data.frame(w_sum_gdppc)\ncolnames(w_sum_gdppc.res) &lt;- c(\"NAME_3\", \"w_sum GDPPC\")\n\nNext, the code chunk below will be used to append w_sum GDPPC values onto hunan sf data.frame by using left_join() of dplyr package.\n\nhunan &lt;- left_join(hunan, w_sum_gdppc.res)\n\nJoining with `by = join_by(NAME_3)`\n\n\nTo compare the values of lag GDPPC and Spatial window average, kable() of Knitr package is used to prepare a table using the code chunk below.\n\nhunan %&gt;%\n  select(\"County\", \"lag_sum GDPPC\", \"w_sum GDPPC\") %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\nCounty\nlag_sum GDPPC\nw_sum GDPPC\ngeometry\n\n\n\n\nAnxiang\n124236\n147903\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n113624\n134605\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n96573\n131165\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n110950\n135423\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n109081\n134635\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n106244\n133381\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n174988\n238106\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n235079\n297281\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n273907\n344573\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n256221\n268982\nPOLYGON ((113.1757 26.82734…\n\n\nGuidong\n98013\n106510\nPOLYGON ((114.1799 26.20117…\n\n\nJiahe\n104050\n136141\nPOLYGON ((112.4425 25.74358…\n\n\nLinwu\n102846\n126832\nPOLYGON ((112.5914 25.55143…\n\n\nRucheng\n92017\n103303\nPOLYGON ((113.6759 25.87578…\n\n\nYizhang\n133831\n151645\nPOLYGON ((113.2621 25.68394…\n\n\nYongxing\n158446\n196097\nPOLYGON ((113.3169 26.41843…\n\n\nZixing\n141883\n207589\nPOLYGON ((113.7311 26.16259…\n\n\nChangning\n119508\n143926\nPOLYGON ((112.6144 26.60198…\n\n\nHengdong\n150757\n178242\nPOLYGON ((113.1056 27.21007…\n\n\nHengnan\n153324\n175235\nPOLYGON ((112.7599 26.98149…\n\n\nHengshan\n113593\n138765\nPOLYGON ((112.607 27.4689, …\n\n\nLeiyang\n129594\n155699\nPOLYGON ((112.9996 26.69276…\n\n\nQidong\n142149\n160150\nPOLYGON ((111.7818 27.0383,…\n\n\nChenxi\n100119\n117145\nPOLYGON ((110.2624 28.21778…\n\n\nZhongfang\n82884\n113730\nPOLYGON ((109.9431 27.72858…\n\n\nHuitong\n74668\n89002\nPOLYGON ((109.9419 27.10512…\n\n\nJingzhou\n43184\n63532\nPOLYGON ((109.8186 26.75842…\n\n\nMayang\n99244\n112988\nPOLYGON ((109.795 27.98008,…\n\n\nTongdao\n46549\n59330\nPOLYGON ((109.9294 26.46561…\n\n\nXinhuang\n20518\n35930\nPOLYGON ((109.227 27.43733,…\n\n\nXupu\n140576\n154439\nPOLYGON ((110.7189 28.30485…\n\n\nYuanling\n121601\n145795\nPOLYGON ((110.9652 28.99895…\n\n\nZhijiang\n92069\n112587\nPOLYGON ((109.8818 27.60661…\n\n\nLengshuijiang\n43258\n107515\nPOLYGON ((111.5307 27.81472…\n\n\nShuangfeng\n144567\n162322\nPOLYGON ((112.263 27.70421,…\n\n\nXinhua\n132119\n145517\nPOLYGON ((111.3345 28.19642…\n\n\nChengbu\n51694\n61826\nPOLYGON ((110.4455 26.69317…\n\n\nDongan\n59024\n79925\nPOLYGON ((111.4531 26.86812…\n\n\nDongkou\n69349\n82589\nPOLYGON ((110.6622 27.37305…\n\n\nLonghui\n73780\n83352\nPOLYGON ((110.985 27.65983,…\n\n\nShaodong\n94651\n119897\nPOLYGON ((111.9054 27.40254…\n\n\nSuining\n100680\n116749\nPOLYGON ((110.389 27.10006,…\n\n\nWugang\n69398\n81510\nPOLYGON ((110.9878 27.03345…\n\n\nXinning\n52798\n63530\nPOLYGON ((111.0736 26.84627…\n\n\nXinshao\n140472\n151986\nPOLYGON ((111.6013 27.58275…\n\n\nShaoshan\n118623\n174193\nPOLYGON ((112.5391 27.97742…\n\n\nXiangxiang\n180933\n210294\nPOLYGON ((112.4549 28.05783…\n\n\nBaojing\n82798\n97361\nPOLYGON ((109.7015 28.82844…\n\n\nFenghuang\n83090\n96472\nPOLYGON ((109.5239 28.19206…\n\n\nGuzhang\n97356\n108936\nPOLYGON ((109.8968 28.74034…\n\n\nHuayuan\n59482\n79819\nPOLYGON ((109.5647 28.61712…\n\n\nJishou\n77334\n108871\nPOLYGON ((109.8375 28.4696,…\n\n\nLongshan\n38777\n48531\nPOLYGON ((109.6337 29.62521…\n\n\nLuxi\n111463\n128935\nPOLYGON ((110.1067 28.41835…\n\n\nYongshun\n74715\n84305\nPOLYGON ((110.0003 29.29499…\n\n\nAnhua\n174391\n188958\nPOLYGON ((111.6034 28.63716…\n\n\nNan\n150558\n171869\nPOLYGON ((112.3232 29.46074…\n\n\nYuanjiang\n122144\n148402\nPOLYGON ((112.4391 29.1791,…\n\n\nJianghua\n68012\n83813\nPOLYGON ((111.6461 25.29661…\n\n\nLanshan\n84575\n104663\nPOLYGON ((112.2286 25.61123…\n\n\nNingyuan\n143045\n155742\nPOLYGON ((112.0715 26.09892…\n\n\nShuangpai\n51394\n73336\nPOLYGON ((111.8864 26.11957…\n\n\nXintian\n98279\n112705\nPOLYGON ((112.2578 26.0796,…\n\n\nHuarong\n47671\n78084\nPOLYGON ((112.9242 29.69134…\n\n\nLinxiang\n26360\n58257\nPOLYGON ((113.5502 29.67418…\n\n\nMiluo\n236917\n279414\nPOLYGON ((112.9902 29.02139…\n\n\nPingjiang\n220631\n237883\nPOLYGON ((113.8436 29.06152…\n\n\nXiangyin\n185290\n219273\nPOLYGON ((112.9173 28.98264…\n\n\nCili\n64640\n83354\nPOLYGON ((110.8822 29.69017…\n\n\nChaling\n70046\n90124\nPOLYGON ((113.7666 27.10573…\n\n\nLiling\n126971\n168462\nPOLYGON ((113.5673 27.94346…\n\n\nYanling\n144693\n165714\nPOLYGON ((113.9292 26.6154,…\n\n\nYou\n129404\n165668\nPOLYGON ((113.5879 27.41324…\n\n\nZhuzhou\n284074\n311663\nPOLYGON ((113.2493 28.02411…\n\n\nSangzhi\n112268\n126892\nPOLYGON ((110.556 29.40543,…\n\n\nYueyang\n203611\n229971\nPOLYGON ((113.343 29.61064,…\n\n\nQiyang\n145238\n165876\nPOLYGON ((111.5563 26.81318…\n\n\nTaojiang\n251536\n271045\nPOLYGON ((112.0508 28.67265…\n\n\nShaoyang\n108078\n117731\nPOLYGON ((111.5013 27.30207…\n\n\nLianyuan\n238300\n256646\nPOLYGON ((111.6789 28.02946…\n\n\nHongjiang\n108870\n126603\nPOLYGON ((110.1441 27.47513…\n\n\nHengyang\n108085\n127467\nPOLYGON ((112.7144 26.98613…\n\n\nGuiyang\n262835\n295688\nPOLYGON ((113.0811 26.04963…\n\n\nChangsha\n248182\n336838\nPOLYGON ((112.9421 28.03722…\n\n\nTaoyuan\n244850\n267729\nPOLYGON ((112.0612 29.32855…\n\n\nXiangtan\n404456\n431516\nPOLYGON ((113.0426 27.8942,…\n\n\nDao\n67608\n85667\nPOLYGON ((111.498 25.81679,…\n\n\nJiangyong\n33860\n51028\nPOLYGON ((111.3659 25.39472…\n\n\n\n\n\nLastly, qtm() of tmap package is used to plot the lag_sum GDPPC and w_sum_gdppc maps next to each other for quick comparison.\n\nw_sum_gdppc &lt;- qtm(hunan, \"w_sum GDPPC\")\ntmap_arrange(lag_sum_gdppc, w_sum_gdppc, asp=1, ncol=2)"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.2.html",
    "href": "hands_on_ex2/hands_on_ex2.2.html",
    "title": "Hands-on Exercise 2.2 Global Measures of Spatial Autocorrelation",
    "section": "",
    "text": "I will learn how to compute Global and Local Measure of Spatial Autocorrelation (GLSA) by using spdep package. \n\n\n\n\nTwo data sets will be used in this hands-on exercise, they are:\n\nHunan province administrative boundary layer at county level. This is a geospatial data set in ESRI shapefile format.\nHunan_2012.csv: This csv file contains selected Hunan's local development indicators in 2012.\n\n\npacman::p_load(sf, spdep, tmap, tidyverse)\n\n\n\n\n\nThe code chunk below uses st_read() of sf package to import Hunan shapefile into R. The imported shapefile will be simple features Object of sf.\n\n\n\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\n\n\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\n\nhunan &lt;- left_join(hunan,hunan2012) %&gt;%\n  select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`\n\n\n\n\n\nI prepare a basemap and a choropleth map showing the distribution of GDPPC 2012 by using qtm() of tmap package.\n\nequal &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal interval classification\")\n\nquantile &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal quantile classification\")\n\ntmap_arrange(equal, \n             quantile, \n             asp=1, \n             ncol=2)\n\n\n\n\n\n\n\n\n\n\nIn the code chunk below, poly2nb() of spdep package is used to compute contiguity weight matrices for the study area. This function builds a neighbours list based on regions with contiguous boundaries.\n\nwm_q &lt;- poly2nb(hunan, \n                queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\n\n\n\n\nrswm_q &lt;- nb2listw(wm_q, \n                   style=\"W\", \n                   zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147\n\n\n\n\n\nIn this section, I will learn how to perform Moran's I statistics testing by using moran.test() of spdep.\n\n\n\n\nmoran.test(hunan$GDPPC, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  hunan$GDPPC  \nweights: rswm_q    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\n** Conclusion\nThe Moran’s I test suggests strong evidence against the null hypothesis of spatial randomness (p-value = 1.095e-06). The Moran’s I statistic of 0.3007 indicates a significant positive spatial autocorrelation in the variable ‘GDPPC’ within the study area. Areas in this region with similar GDPPC values tend to be spatially clustered or adjacent to each other more often than expected by random chance.\n\n\nThe code chunk below performs permutation test for Moran's I statistic by using moran.mc() of spdep. A total of 1000 simulation will be performed.\n\nset.seed(1234)\nbperm= moran.mc(hunan$GDPPC, \n                listw=rswm_q, \n                nsim=999, \n                zero.policy = TRUE, \n                na.action=na.omit)\nbperm\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.30075, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\n\n** Conclusion\nThe permutation test for Moran’s I statistic indicates strong evidence against the null hypothesis of spatial randomness. The observed Moran’s I value (0.30075) falls within the highest ranks of the simulated values, and the small p-value (0.001) suggests that this value is significantly greater than what would be expected by chance alone. Therefore, it supports the conclusion that there is a significant positive spatial autocorrelation in the ‘GDPPC’ variable within the study area. Areas with similar GDPPC values tend to be spatially clustered or adjacent to each other more often than expected by random chance.\n\n\n\nIn the code chunk below hist() and abline() of R Graphics are used.\n\nmean(bperm$res[1:999])\n\n[1] -0.01504572\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.004371574\n\n\n\nsummary(bperm$res[1:999])\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.18339 -0.06168 -0.02125 -0.01505  0.02611  0.27593 \n\n\n\nhist(bperm$res, \n     freq=TRUE, \n     breaks=20, \n     xlab=\"Simulated Moran's I\")\nabline(v=0, \n       col=\"red\") \n\n\n\n\n** Observation\nSkewed distribution that is of right skewed. It peaks at -0.05\nPlot values using ggplot:\n\nbperm &lt;- list(\n  res = rnorm(1000),\n  statistic = 0.30075\n)\n\n\nplot_data &lt;- data.frame(\n  Simulation = 1:length(bperm$res),\n  Moran_I = bperm$res\n)\n\n\nplot &lt;- ggplot(plot_data, aes(x = Simulation, y = Moran_I)) +\n  geom_point(color = \"blue\", alpha = 0.6) +\n  geom_hline(yintercept = bperm$statistic, linetype = \"dashed\", color = \"red\") +\n  labs(\n    title = \"Permutation Test for Moran's I\",\n    x = \"Simulation\",\n    y = \"Moran's I Value\"\n  ) +\n  theme_minimal()\n\nplot\n\n\n\n\n\n\n\n\nI will learn how to perform Geary's c statistics testing by using appropriate functions of spdep package.\n\n\nThe code chunk below performs Geary's C test for spatial autocorrelation by using geary.test() of spdep.\n\ngeary.test(hunan$GDPPC, listw=rswm_q)\n\n\n    Geary C test under randomisation\n\ndata:  hunan$GDPPC \nweights: rswm_q \n\nGeary C statistic standard deviate = 3.6108, p-value = 0.0001526\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n        0.6907223         1.0000000         0.0073364 \n\n\n** Conclusion\nGiven the low p-value, we can conclude that there is significant evidence to reject the null hypothesis of spatial randomness. We have sufficient evidence to conclude that the alternative hypothesis that there is spatial autocorrelation present in the variable “hunan$GDPPC.” Moreover, the Geary C statistic being substantially lower than the expected value under the null hypothesis further supports this conclusion.\n\n\n\nThe code chunk below performs permutation test for Geary's C statistic by using geary.mc() of spdep.\n\nset.seed(1234)\nbperm=geary.mc(hunan$GDPPC, \n               listw=rswm_q, \n               nsim=999)\nbperm\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  hunan$GDPPC \nweights: rswm_q \nnumber of simulations + 1: 1000 \n\nstatistic = 0.69072, observed rank = 1, p-value = 0.001\nalternative hypothesis: greater\n\n\n**Conclusion\nThe very low p-value (0.001) suggests strong evidence against the null hypothesis of spatial randomness. Instead, it supports the alternative hypothesis that there is significant spatial autocorrelation present in the variable “hunan$GDPPC.”\nFurthermore, the observed rank of 1 among the 1000 simulations indicates that your observed statistic is at the extreme end of the simulated distribution. This strengthens the evidence that the observed spatial autocorrelation is significantly higher than what would be expected by chance.\n\n\n\nWe plot a histogram to reveal the distribution of the simulated values by using the code chunk below.\n\nmean(bperm$res[1:999])\n\n[1] 1.004402\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.007436493\n\n\n\nsummary(bperm$res[1:999])\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.7142  0.9502  1.0052  1.0044  1.0595  1.2722 \n\n\n\nhist(bperm$res, freq=TRUE, breaks=20, xlab=\"Simulated Geary c\")\nabline(v=1, col=\"red\") \n\n\n\n\n** Observation\nSkewed distribution that is of left skewed. It peaks at 1.05\n\n\n\n\n\n\n\nIn the code chunk below, sp.correlogram() of spdep package is used to compute a 6-lag spatial correlogram of GDPPC. The global spatial autocorrelation used in Moran's I. The plot() of base Graph is then used to plot the output.\n\nMI_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"I\", \n                          style=\"W\")\nplot(MI_corr)\n\n\n\n\nFull analysis report\n\nprint(MI_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Moran's I\n         estimate expectation   variance standard deviate Pr(I) two sided    \n1 (88)  0.3007500  -0.0114943  0.0043484           4.7351       2.189e-06 ***\n2 (88)  0.2060084  -0.0114943  0.0020962           4.7505       2.029e-06 ***\n3 (88)  0.0668273  -0.0114943  0.0014602           2.0496        0.040400 *  \n4 (88)  0.0299470  -0.0114943  0.0011717           1.2107        0.226015    \n5 (88) -0.1530471  -0.0114943  0.0012440          -4.0134       5.984e-05 ***\n6 (88) -0.1187070  -0.0114943  0.0016791          -2.6164        0.008886 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n**Conclusion\n\nIn this output, the Moran’s I statistics at various distance bands are presented.\nThe Moran’s I values at different distance classes vary and show varying levels of significance.\nFor instance, at the 1st and 2nd distance bands, the Moran’s I values are significantly positive with very low p-values (***), indicating strong positive spatial autocorrelation.\nAt farther distance bands (e.g., 5th and 6th), the Moran’s I values become negative and remain significant (**, *), suggesting negative spatial autocorrelation or dissimilarity among more distant areas.\n\n\n\n\nIn the code chunk below, sp.correlogram() of spdep package is used to compute a 6-lag spatial correlogram of GDPPC. The global spatial autocorrelation used in Geary's C. The plot() of base Graph is then used to plot the output.\n\nGC_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"C\", \n                          style=\"W\")\nplot(GC_corr)\n\n\n\n\n\nprint(GC_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Geary's C\n        estimate expectation  variance standard deviate Pr(I) two sided    \n1 (88) 0.6907223   1.0000000 0.0073364          -3.6108       0.0003052 ***\n2 (88) 0.7630197   1.0000000 0.0049126          -3.3811       0.0007220 ***\n3 (88) 0.9397299   1.0000000 0.0049005          -0.8610       0.3892612    \n4 (88) 1.0098462   1.0000000 0.0039631           0.1564       0.8757128    \n5 (88) 1.2008204   1.0000000 0.0035568           3.3673       0.0007592 ***\n6 (88) 1.0773386   1.0000000 0.0058042           1.0151       0.3100407    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n**Conclusion\n\nn this output, the Geary’s C statistics at various distance bands are presented.\nThe values in the “estimate” column fluctuate across distance classes, indicating variations in the degree of spatial autocorrelation at different distances.\nAt the 1st and 2nd distance bands, the Geary’s C values are significantly lower than 1 (***), indicating significant spatial autocorrelation.\nAs the distance bands increase (e.g., 5th and 6th), Geary’s C values move closer to or above 1, suggesting weaker evidence of spatial autocorrelation, although the 5th distance band still shows significant autocorrelation (***)."
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.2.html#getting-started",
    "href": "hands_on_ex2/hands_on_ex2.2.html#getting-started",
    "title": "Hands-on Exercise 2.2 Global Measures of Spatial Autocorrelation",
    "section": "",
    "text": "Two data sets will be used in this hands-on exercise, they are:\n\nHunan province administrative boundary layer at county level. This is a geospatial data set in ESRI shapefile format.\nHunan_2012.csv: This csv file contains selected Hunan's local development indicators in 2012.\n\n\npacman::p_load(sf, spdep, tmap, tidyverse)"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.2.html#getting-the-data-into-r-environment",
    "href": "hands_on_ex2/hands_on_ex2.2.html#getting-the-data-into-r-environment",
    "title": "Hands-on Exercise 2.2 Global Measures of Spatial Autocorrelation",
    "section": "",
    "text": "The code chunk below uses st_read() of sf package to import Hunan shapefile into R. The imported shapefile will be simple features Object of sf.\n\n\n\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\n\n\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\n\nhunan &lt;- left_join(hunan,hunan2012) %&gt;%\n  select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`\n\n\n\n\n\nI prepare a basemap and a choropleth map showing the distribution of GDPPC 2012 by using qtm() of tmap package.\n\nequal &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal interval classification\")\n\nquantile &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal quantile classification\")\n\ntmap_arrange(equal, \n             quantile, \n             asp=1, \n             ncol=2)"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.2.html#global-spatial-autocorrelation",
    "href": "hands_on_ex2/hands_on_ex2.2.html#global-spatial-autocorrelation",
    "title": "Hands-on Exercise 2.2 Global Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In the code chunk below, poly2nb() of spdep package is used to compute contiguity weight matrices for the study area. This function builds a neighbours list based on regions with contiguous boundaries.\n\nwm_q &lt;- poly2nb(hunan, \n                queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\n\n\n\n\nrswm_q &lt;- nb2listw(wm_q, \n                   style=\"W\", \n                   zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147\n\n\n\n\n\nIn this section, I will learn how to perform Moran's I statistics testing by using moran.test() of spdep.\n\n\n\n\nmoran.test(hunan$GDPPC, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  hunan$GDPPC  \nweights: rswm_q    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\n** Conclusion\nThe Moran’s I test suggests strong evidence against the null hypothesis of spatial randomness (p-value = 1.095e-06). The Moran’s I statistic of 0.3007 indicates a significant positive spatial autocorrelation in the variable ‘GDPPC’ within the study area. Areas in this region with similar GDPPC values tend to be spatially clustered or adjacent to each other more often than expected by random chance.\n\n\nThe code chunk below performs permutation test for Moran's I statistic by using moran.mc() of spdep. A total of 1000 simulation will be performed.\n\nset.seed(1234)\nbperm= moran.mc(hunan$GDPPC, \n                listw=rswm_q, \n                nsim=999, \n                zero.policy = TRUE, \n                na.action=na.omit)\nbperm\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.30075, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\n\n** Conclusion\nThe permutation test for Moran’s I statistic indicates strong evidence against the null hypothesis of spatial randomness. The observed Moran’s I value (0.30075) falls within the highest ranks of the simulated values, and the small p-value (0.001) suggests that this value is significantly greater than what would be expected by chance alone. Therefore, it supports the conclusion that there is a significant positive spatial autocorrelation in the ‘GDPPC’ variable within the study area. Areas with similar GDPPC values tend to be spatially clustered or adjacent to each other more often than expected by random chance.\n\n\n\nIn the code chunk below hist() and abline() of R Graphics are used.\n\nmean(bperm$res[1:999])\n\n[1] -0.01504572\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.004371574\n\n\n\nsummary(bperm$res[1:999])\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.18339 -0.06168 -0.02125 -0.01505  0.02611  0.27593 \n\n\n\nhist(bperm$res, \n     freq=TRUE, \n     breaks=20, \n     xlab=\"Simulated Moran's I\")\nabline(v=0, \n       col=\"red\") \n\n\n\n\n** Observation\nSkewed distribution that is of right skewed. It peaks at -0.05\nPlot values using ggplot:\n\nbperm &lt;- list(\n  res = rnorm(1000),\n  statistic = 0.30075\n)\n\n\nplot_data &lt;- data.frame(\n  Simulation = 1:length(bperm$res),\n  Moran_I = bperm$res\n)\n\n\nplot &lt;- ggplot(plot_data, aes(x = Simulation, y = Moran_I)) +\n  geom_point(color = \"blue\", alpha = 0.6) +\n  geom_hline(yintercept = bperm$statistic, linetype = \"dashed\", color = \"red\") +\n  labs(\n    title = \"Permutation Test for Moran's I\",\n    x = \"Simulation\",\n    y = \"Moran's I Value\"\n  ) +\n  theme_minimal()\n\nplot\n\n\n\n\n\n\n\n\nI will learn how to perform Geary's c statistics testing by using appropriate functions of spdep package.\n\n\nThe code chunk below performs Geary's C test for spatial autocorrelation by using geary.test() of spdep.\n\ngeary.test(hunan$GDPPC, listw=rswm_q)\n\n\n    Geary C test under randomisation\n\ndata:  hunan$GDPPC \nweights: rswm_q \n\nGeary C statistic standard deviate = 3.6108, p-value = 0.0001526\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n        0.6907223         1.0000000         0.0073364 \n\n\n** Conclusion\nGiven the low p-value, we can conclude that there is significant evidence to reject the null hypothesis of spatial randomness. We have sufficient evidence to conclude that the alternative hypothesis that there is spatial autocorrelation present in the variable “hunan$GDPPC.” Moreover, the Geary C statistic being substantially lower than the expected value under the null hypothesis further supports this conclusion.\n\n\n\nThe code chunk below performs permutation test for Geary's C statistic by using geary.mc() of spdep.\n\nset.seed(1234)\nbperm=geary.mc(hunan$GDPPC, \n               listw=rswm_q, \n               nsim=999)\nbperm\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  hunan$GDPPC \nweights: rswm_q \nnumber of simulations + 1: 1000 \n\nstatistic = 0.69072, observed rank = 1, p-value = 0.001\nalternative hypothesis: greater\n\n\n**Conclusion\nThe very low p-value (0.001) suggests strong evidence against the null hypothesis of spatial randomness. Instead, it supports the alternative hypothesis that there is significant spatial autocorrelation present in the variable “hunan$GDPPC.”\nFurthermore, the observed rank of 1 among the 1000 simulations indicates that your observed statistic is at the extreme end of the simulated distribution. This strengthens the evidence that the observed spatial autocorrelation is significantly higher than what would be expected by chance.\n\n\n\nWe plot a histogram to reveal the distribution of the simulated values by using the code chunk below.\n\nmean(bperm$res[1:999])\n\n[1] 1.004402\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.007436493\n\n\n\nsummary(bperm$res[1:999])\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.7142  0.9502  1.0052  1.0044  1.0595  1.2722 \n\n\n\nhist(bperm$res, freq=TRUE, breaks=20, xlab=\"Simulated Geary c\")\nabline(v=1, col=\"red\") \n\n\n\n\n** Observation\nSkewed distribution that is of left skewed. It peaks at 1.05"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.2.html#spatial-correlogram",
    "href": "hands_on_ex2/hands_on_ex2.2.html#spatial-correlogram",
    "title": "Hands-on Exercise 2.2 Global Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In the code chunk below, sp.correlogram() of spdep package is used to compute a 6-lag spatial correlogram of GDPPC. The global spatial autocorrelation used in Moran's I. The plot() of base Graph is then used to plot the output.\n\nMI_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"I\", \n                          style=\"W\")\nplot(MI_corr)\n\n\n\n\nFull analysis report\n\nprint(MI_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Moran's I\n         estimate expectation   variance standard deviate Pr(I) two sided    \n1 (88)  0.3007500  -0.0114943  0.0043484           4.7351       2.189e-06 ***\n2 (88)  0.2060084  -0.0114943  0.0020962           4.7505       2.029e-06 ***\n3 (88)  0.0668273  -0.0114943  0.0014602           2.0496        0.040400 *  \n4 (88)  0.0299470  -0.0114943  0.0011717           1.2107        0.226015    \n5 (88) -0.1530471  -0.0114943  0.0012440          -4.0134       5.984e-05 ***\n6 (88) -0.1187070  -0.0114943  0.0016791          -2.6164        0.008886 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n**Conclusion\n\nIn this output, the Moran’s I statistics at various distance bands are presented.\nThe Moran’s I values at different distance classes vary and show varying levels of significance.\nFor instance, at the 1st and 2nd distance bands, the Moran’s I values are significantly positive with very low p-values (***), indicating strong positive spatial autocorrelation.\nAt farther distance bands (e.g., 5th and 6th), the Moran’s I values become negative and remain significant (**, *), suggesting negative spatial autocorrelation or dissimilarity among more distant areas.\n\n\n\n\nIn the code chunk below, sp.correlogram() of spdep package is used to compute a 6-lag spatial correlogram of GDPPC. The global spatial autocorrelation used in Geary's C. The plot() of base Graph is then used to plot the output.\n\nGC_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"C\", \n                          style=\"W\")\nplot(GC_corr)\n\n\n\n\n\nprint(GC_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Geary's C\n        estimate expectation  variance standard deviate Pr(I) two sided    \n1 (88) 0.6907223   1.0000000 0.0073364          -3.6108       0.0003052 ***\n2 (88) 0.7630197   1.0000000 0.0049126          -3.3811       0.0007220 ***\n3 (88) 0.9397299   1.0000000 0.0049005          -0.8610       0.3892612    \n4 (88) 1.0098462   1.0000000 0.0039631           0.1564       0.8757128    \n5 (88) 1.2008204   1.0000000 0.0035568           3.3673       0.0007592 ***\n6 (88) 1.0773386   1.0000000 0.0058042           1.0151       0.3100407    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n**Conclusion\n\nn this output, the Geary’s C statistics at various distance bands are presented.\nThe values in the “estimate” column fluctuate across distance classes, indicating variations in the degree of spatial autocorrelation at different distances.\nAt the 1st and 2nd distance bands, the Geary’s C values are significantly lower than 1 (***), indicating significant spatial autocorrelation.\nAs the distance bands increase (e.g., 5th and 6th), Geary’s C values move closer to or above 1, suggesting weaker evidence of spatial autocorrelation, although the 5th distance band still shows significant autocorrelation (***)."
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.3.html",
    "href": "hands_on_ex2/hands_on_ex2.3.html",
    "title": "Hands-on Exercise 2.3 Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "I continue my journey to learn Local Measure of Spatial Autocorrelation (GLSA) by using spdep package.\n\n\nTwo data sets will be used in this hands-on exercise, they are:\n\nHunan province administrative boundary layer at county level. This is a geospatial data set in ESRI shapefile format.\nHunan_2012.csv: This csv file contains selected Hunan’s local development indicators in 2012.\n\n\n\n\npacman::p_load(sf, spdep, tmap, tidyverse)\n\n\n\n\n\n\n\n\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\n\n\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\n\nhunan &lt;- left_join(hunan,hunan2012) %&gt;%\n  select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`\n\n\n\n\n\nNow, we are going to prepare a basemap and a choropleth map showing the distribution of GDPPC 2012 by using qtm() of tmap package.\n\nequal &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal interval classification\")\n\nquantile &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal quantile classification\")\n\ntmap_arrange(equal, \n             quantile, \n             asp=1, \n             ncol=2)\n\n\n\n\n\n\n\n\n\n\nMore specifically, the code chunk below is used to compute Queen contiguity weight matrix.\n\nwm_q &lt;- poly2nb(hunan, \n                queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\nThe summary report above shows that there are 88 area units in Hunan. The most connected area unit has 11 neighbours. There are two area units with only one neighbours.\n\n\n\n\nrswm_q &lt;- nb2listw(wm_q, \n                   style=\"W\", \n                   zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147\n\n\n\n\n\nIn this section, I will learn how to perform Moran’s I statistics testing by using moran.test() of spdep.\n\n\n\nThe code chunk below performs Moran’s I statistical testing using moran.test() of spdep.\n\nmoran.test(hunan$GDPPC, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  hunan$GDPPC  \nweights: rswm_q    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\n** Conclusion\nThe Moran’s I test suggests strong evidence against the null hypothesis of spatial randomness (p-value = 1.095e-06). The Moran’s I statistic of 0.3007 indicates a significant positive spatial autocorrelation in the variable ‘GDPPC’ within the study area. Areas in this region with similar GDPPC values tend to be spatially clustered or adjacent to each other more often than expected by random chance.\n\n\nThe code chunk below performs permutation test for Moran’s I statistic by using moran.mc() of spdep. A total of 1000 simulation will be performed.\n\nset.seed(1234)\nbperm= moran.mc(hunan$GDPPC, \n                listw=rswm_q, \n                nsim=999, \n                zero.policy = TRUE, \n                na.action=na.omit)\nbperm\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.30075, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\n\n** Conclusion\nThe permutation test for Moran’s I statistic indicates strong evidence against the null hypothesis of spatial randomness. The observed Moran’s I value (0.30075) falls within the highest ranks of the simulated values, and the small p-value (0.001) suggests that this value is significantly greater than what would be expected by chance alone. Therefore, it supports the conclusion that there is a significant positive spatial autocorrelation in the ‘GDPPC’ variable within the study area. Areas with similar GDPPC values tend to be spatially clustered or adjacent to each other more often than expected by random chance.\n\n\n\nIn the code chunk below hist() and abline() of R Graphics are used.\n\nmean(bperm$res[1:999])\n\n[1] -0.01504572\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.004371574\n\n\n\nsummary(bperm$res[1:999])\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.18339 -0.06168 -0.02125 -0.01505  0.02611  0.27593 \n\n\n\nhist(bperm$res, \n     freq=TRUE, \n     breaks=20, \n     xlab=\"Simulated Moran's I\")\nabline(v=0, \n       col=\"red\") \n\n\n\n\n** Observation\nSkewed distribution that is of right skewed. It peaks at -0.05\n\n\n\n\nIn this section, you will learn how to perform Geary’s c statistics testing by using appropriate functions of spdep package.\n\n\nThe code chunk below performs Geary’s C test for spatial autocorrelation by using geary.test() of spdep.\n\ngeary.test(hunan$GDPPC, listw=rswm_q)\n\n\n    Geary C test under randomisation\n\ndata:  hunan$GDPPC \nweights: rswm_q \n\nGeary C statistic standard deviate = 3.6108, p-value = 0.0001526\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n        0.6907223         1.0000000         0.0073364 \n\n\n** Conclusion\nGiven the low p-value, we can conclude that there is significant evidence to reject the null hypothesis of spatial randomness. We have sufficient evidence to conclude that the alternative hypothesis that there is spatial autocorrelation present in the variable “hunan$GDPPC.” Moreover, the Geary C statistic being substantially lower than the expected value under the null hypothesis further supports this conclusion.\n\n\n\nThe code chunk below performs permutation test for Geary’s C statistic by using geary.mc() of spdep.\n\nset.seed(1234)\nbperm=geary.mc(hunan$GDPPC, \n               listw=rswm_q, \n               nsim=999)\nbperm\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  hunan$GDPPC \nweights: rswm_q \nnumber of simulations + 1: 1000 \n\nstatistic = 0.69072, observed rank = 1, p-value = 0.001\nalternative hypothesis: greater\n\n\n**Conclusion\nThe very low p-value (0.001) suggests strong evidence against the null hypothesis of spatial randomness. Instead, it supports the alternative hypothesis that there is significant spatial autocorrelation present in the variable “hunan$GDPPC.”\nFurthermore, the observed rank of 1 among the 1000 simulations indicates that your observed statistic is at the extreme end of the simulated distribution. This strengthens the evidence that the observed spatial autocorrelation is significantly higher than what would be expected by chance.\n\n\n\n\nmean(bperm$res[1:999])\n\n[1] 1.004402\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.007436493\n\n\n\nsummary(bperm$res[1:999])\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.7142  0.9502  1.0052  1.0044  1.0595  1.2722 \n\n\n\nhist(bperm$res, freq=TRUE, breaks=20, xlab=\"Simulated Geary c\")\nabline(v=1, col=\"red\") \n\n\n\n\n* Observation\nSkewed distribution that is of left skewed. It peaks at 1.05\n\n\n\n\n\n\n\n\nMI_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"I\", \n                          style=\"W\")\nplot(MI_corr)\n\n\n\n\n\nprint(MI_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Moran's I\n         estimate expectation   variance standard deviate Pr(I) two sided    \n1 (88)  0.3007500  -0.0114943  0.0043484           4.7351       2.189e-06 ***\n2 (88)  0.2060084  -0.0114943  0.0020962           4.7505       2.029e-06 ***\n3 (88)  0.0668273  -0.0114943  0.0014602           2.0496        0.040400 *  \n4 (88)  0.0299470  -0.0114943  0.0011717           1.2107        0.226015    \n5 (88) -0.1530471  -0.0114943  0.0012440          -4.0134       5.984e-05 ***\n6 (88) -0.1187070  -0.0114943  0.0016791          -2.6164        0.008886 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n\n\nGC_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"C\", \n                          style=\"W\")\nplot(GC_corr)\n\n\n\n\n\nprint(GC_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Geary's C\n        estimate expectation  variance standard deviate Pr(I) two sided    \n1 (88) 0.6907223   1.0000000 0.0073364          -3.6108       0.0003052 ***\n2 (88) 0.7630197   1.0000000 0.0049126          -3.3811       0.0007220 ***\n3 (88) 0.9397299   1.0000000 0.0049005          -0.8610       0.3892612    \n4 (88) 1.0098462   1.0000000 0.0039631           0.1564       0.8757128    \n5 (88) 1.2008204   1.0000000 0.0035568           3.3673       0.0007592 ***\n6 (88) 1.0773386   1.0000000 0.0058042           1.0151       0.3100407    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n\n\nIn this section, I will learn how to apply appropriate Local Indicators for Spatial Association (LISA), especially local Moran’I to detect cluster and/or outlier from GDP per capita 2012 of Hunan Province, PRC.\nThe code chunks below are used to compute local Moran’s I of GDPPC2012 at the county level.\n\nfips &lt;- order(hunan$County)\nlocalMI &lt;- localmoran(hunan$GDPPC, rswm_q)\nhead(localMI)\n\n            Ii          E.Ii       Var.Ii        Z.Ii Pr(z != E(Ii))\n1 -0.001468468 -2.815006e-05 4.723841e-04 -0.06626904      0.9471636\n2  0.025878173 -6.061953e-04 1.016664e-02  0.26266425      0.7928094\n3 -0.011987646 -5.366648e-03 1.133362e-01 -0.01966705      0.9843090\n4  0.001022468 -2.404783e-07 5.105969e-06  0.45259801      0.6508382\n5  0.014814881 -6.829362e-05 1.449949e-03  0.39085814      0.6959021\n6 -0.038793829 -3.860263e-04 6.475559e-03 -0.47728835      0.6331568\n\n\nlocalmoran() function returns a matrix of values whose columns are:\n\nIi: the local Moran’s I statistics\nE.Ii: the expectation of local moran statistic under the randomisation hypothesis\nVar.Ii: the variance of local moran statistic under the randomisation hypothesis\nZ.Ii:the standard deviate of local moran statistic\nPr(): the p-value of local moran statistic\n\nThe code chunk below list the content of the local Moran matrix derived by using printCoefmat().\n\nprintCoefmat(data.frame(\n  localMI[fips,], \n  row.names=hunan$County[fips]),\n  check.names=FALSE)\n\n                       Ii        E.Ii      Var.Ii        Z.Ii Pr.z....E.Ii..\nAnhua         -2.2493e-02 -5.0048e-03  5.8235e-02 -7.2467e-02         0.9422\nAnren         -3.9932e-01 -7.0111e-03  7.0348e-02 -1.4791e+00         0.1391\nAnxiang       -1.4685e-03 -2.8150e-05  4.7238e-04 -6.6269e-02         0.9472\nBaojing        3.4737e-01 -5.0089e-03  8.3636e-02  1.2185e+00         0.2230\nChaling        2.0559e-02 -9.6812e-04  2.7711e-02  1.2932e-01         0.8971\nChangning     -2.9868e-05 -9.0010e-09  1.5105e-07 -7.6828e-02         0.9388\nChangsha       4.9022e+00 -2.1348e-01  2.3194e+00  3.3590e+00         0.0008\nChengbu        7.3725e-01 -1.0534e-02  2.2132e-01  1.5895e+00         0.1119\nChenxi         1.4544e-01 -2.8156e-03  4.7116e-02  6.8299e-01         0.4946\nCili           7.3176e-02 -1.6747e-03  4.7902e-02  3.4200e-01         0.7324\nDao            2.1420e-01 -2.0824e-03  4.4123e-02  1.0297e+00         0.3032\nDongan         1.5210e-01 -6.3485e-04  1.3471e-02  1.3159e+00         0.1882\nDongkou        5.2918e-01 -6.4461e-03  1.0748e-01  1.6338e+00         0.1023\nFenghuang      1.8013e-01 -6.2832e-03  1.3257e-01  5.1198e-01         0.6087\nGuidong       -5.9160e-01 -1.3086e-02  3.7003e-01 -9.5104e-01         0.3416\nGuiyang        1.8240e-01 -3.6908e-03  3.2610e-02  1.0305e+00         0.3028\nGuzhang        2.8466e-01 -8.5054e-03  1.4152e-01  7.7931e-01         0.4358\nHanshou        2.5878e-02 -6.0620e-04  1.0167e-02  2.6266e-01         0.7928\nHengdong       9.9964e-03 -4.9063e-04  6.7742e-03  1.2742e-01         0.8986\nHengnan        2.8064e-02 -3.2160e-04  3.7597e-03  4.6294e-01         0.6434\nHengshan      -5.8201e-03 -3.0437e-05  5.1076e-04 -2.5618e-01         0.7978\nHengyang       6.2997e-02 -1.3046e-03  2.1865e-02  4.3486e-01         0.6637\nHongjiang      1.8790e-01 -2.3019e-03  3.1725e-02  1.0678e+00         0.2856\nHuarong       -1.5389e-02 -1.8667e-03  8.1030e-02 -4.7503e-02         0.9621\nHuayuan        8.3772e-02 -8.5569e-04  2.4495e-02  5.4072e-01         0.5887\nHuitong        2.5997e-01 -5.2447e-03  1.1077e-01  7.9685e-01         0.4255\nJiahe         -1.2431e-01 -3.0550e-03  5.1111e-02 -5.3633e-01         0.5917\nJianghua       2.8651e-01 -3.8280e-03  8.0968e-02  1.0204e+00         0.3076\nJiangyong      2.4337e-01 -2.7082e-03  1.1746e-01  7.1800e-01         0.4728\nJingzhou       1.8270e-01 -8.5106e-04  2.4363e-02  1.1759e+00         0.2396\nJinshi        -1.1988e-02 -5.3666e-03  1.1334e-01 -1.9667e-02         0.9843\nJishou        -2.8680e-01 -2.6305e-03  4.4028e-02 -1.3543e+00         0.1756\nLanshan        6.3334e-02 -9.6365e-04  2.0441e-02  4.4972e-01         0.6529\nLeiyang        1.1581e-02 -1.4948e-04  2.5082e-03  2.3422e-01         0.8148\nLengshuijiang -1.7903e+00 -8.2129e-02  2.1598e+00 -1.1623e+00         0.2451\nLi             1.0225e-03 -2.4048e-07  5.1060e-06  4.5260e-01         0.6508\nLianyuan      -1.4672e-01 -1.8983e-03  1.9145e-02 -1.0467e+00         0.2952\nLiling         1.3774e+00 -1.5097e-02  4.2601e-01  2.1335e+00         0.0329\nLinli          1.4815e-02 -6.8294e-05  1.4499e-03  3.9086e-01         0.6959\nLinwu         -2.4621e-03 -9.0703e-06  1.9258e-04 -1.7676e-01         0.8597\nLinxiang       6.5904e-02 -2.9028e-03  2.5470e-01  1.3634e-01         0.8916\nLiuyang        3.3688e+00 -7.7502e-02  1.5180e+00  2.7972e+00         0.0052\nLonghui        8.0801e-01 -1.1377e-02  1.5538e-01  2.0787e+00         0.0376\nLongshan       7.5663e-01 -1.1100e-02  3.1449e-01  1.3690e+00         0.1710\nLuxi           1.8177e-01 -2.4855e-03  3.4249e-02  9.9561e-01         0.3194\nMayang         2.1852e-01 -5.8773e-03  9.8049e-02  7.1663e-01         0.4736\nMiluo          1.8704e+00 -1.6927e-02  2.7925e-01  3.5715e+00         0.0004\nNan           -9.5789e-03 -4.9497e-04  6.8341e-03 -1.0988e-01         0.9125\nNingxiang      1.5607e+00 -7.3878e-02  8.0012e-01  1.8274e+00         0.0676\nNingyuan       2.0910e-01 -7.0884e-03  8.2306e-02  7.5356e-01         0.4511\nPingjiang     -9.8964e-01 -2.6457e-03  5.6027e-02 -4.1698e+00         0.0000\nQidong         1.1806e-01 -2.1207e-03  2.4747e-02  7.6396e-01         0.4449\nQiyang         6.1966e-02 -7.3374e-04  8.5743e-03  6.7712e-01         0.4983\nRucheng       -3.6992e-01 -8.8999e-03  2.5272e-01 -7.1814e-01         0.4727\nSangzhi        2.5053e-01 -4.9470e-03  6.8000e-02  9.7972e-01         0.3272\nShaodong      -3.2659e-02 -3.6592e-05  5.0546e-04 -1.4510e+00         0.1468\nShaoshan       2.1223e+00 -5.0227e-02  1.3668e+00  1.8583e+00         0.0631\nShaoyang       5.9499e-01 -1.1253e-02  1.3012e-01  1.6807e+00         0.0928\nShimen        -3.8794e-02 -3.8603e-04  6.4756e-03 -4.7729e-01         0.6332\nShuangfeng     9.2835e-03 -2.2867e-03  3.1516e-02  6.5174e-02         0.9480\nShuangpai      8.0591e-02 -3.1366e-04  8.9838e-03  8.5358e-01         0.3933\nSuining        3.7585e-01 -3.5933e-03  4.1870e-02  1.8544e+00         0.0637\nTaojiang      -2.5394e-01 -1.2395e-03  1.4477e-02 -2.1002e+00         0.0357\nTaoyuan        1.4729e-02 -1.2039e-04  8.5103e-04  5.0903e-01         0.6107\nTongdao        4.6482e-01 -6.9870e-03  1.9879e-01  1.0582e+00         0.2900\nWangcheng      4.4220e+00 -1.1067e-01  1.3596e+00  3.8873e+00         0.0001\nWugang         7.1003e-01 -7.8144e-03  1.0710e-01  2.1935e+00         0.0283\nXiangtan       2.4530e-01 -3.6457e-04  3.2319e-03  4.3213e+00         0.0000\nXiangxiang     2.6271e-01 -1.2703e-03  2.1290e-02  1.8092e+00         0.0704\nXiangyin       5.4525e-01 -4.7442e-03  7.9236e-02  1.9539e+00         0.0507\nXinhua         1.1810e-01 -6.2649e-03  8.6001e-02  4.2409e-01         0.6715\nXinhuang       1.5725e-01 -4.1820e-03  3.6648e-01  2.6667e-01         0.7897\nXinning        6.8928e-01 -9.6674e-03  2.0328e-01  1.5502e+00         0.1211\nXinshao        5.7578e-02 -8.5932e-03  1.1769e-01  1.9289e-01         0.8470\nXintian       -7.4050e-03 -5.1493e-03  1.0877e-01 -6.8395e-03         0.9945\nXupu           3.2406e-01 -5.7468e-03  5.7735e-02  1.3726e+00         0.1699\nYanling       -6.9021e-02 -5.9211e-04  9.9306e-03 -6.8667e-01         0.4923\nYizhang       -2.6844e-01 -2.2463e-03  4.7588e-02 -1.2202e+00         0.2224\nYongshun       6.3064e-01 -1.1350e-02  1.8830e-01  1.4795e+00         0.1390\nYongxing       4.3411e-01 -9.0735e-03  1.5088e-01  1.1409e+00         0.2539\nYou            7.8750e-02 -7.2728e-03  1.2116e-01  2.4714e-01         0.8048\nYuanjiang      2.0004e-04 -1.7760e-04  2.9798e-03  6.9181e-03         0.9945\nYuanling       8.7298e-03 -2.2981e-06  2.3221e-05  1.8121e+00         0.0700\nYueyang        4.1189e-02 -1.9768e-04  2.3113e-03  8.6085e-01         0.3893\nZhijiang       1.0476e-01 -7.8123e-04  1.3100e-02  9.2214e-01         0.3565\nZhongfang     -2.2685e-01 -2.1455e-03  3.5927e-02 -1.1855e+00         0.2358\nZhuzhou        3.2864e-01 -5.2432e-04  7.2391e-03  3.8688e+00         0.0001\nZixing        -7.6849e-01 -8.8210e-02  9.4057e-01 -7.0144e-01         0.4830\n\n\n\n\nThe code chunks below can be used to perform the task. The out SpatialPolygonDataFrame is called hunan.localMI.\n\nhunan.localMI &lt;- cbind(hunan,localMI) %&gt;%\n  rename(Pr.Ii = Pr.z....E.Ii..)\n\n\n\n\nUsing choropleth mapping functions of tmap package, we can plot the local Moran’s I values by using the code chinks below.\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\",\n          palette = \"RdBu\",\n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\nThe code chunks below produce a choropleth map of Moran’s I p-values by using functions of tmap package.\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\nThe code chunk below will be used to create such visualisation.\n\nlocalMI.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\", \n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\npvalue.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(localMI.map, pvalue.map, asp=1, ncol=2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\n\n\n\nThe Moran scatterplot is an illustration of the relationship between the values of the chosen attribute at each location and the average value of the same attribute at neighboring locations.\nThe code chunk below plots the Moran scatterplot of GDPPC 2012 by using moran.plot() of spdep.\n\nnci &lt;- moran.plot(hunan$GDPPC, rswm_q,\n                  labels=as.character(hunan$County), \n                  xlab=\"GDPPC 2012\", \n                  ylab=\"Spatially Lag GDPPC 2012\")\n\n\n\n\nNotice that the plot is split in 4 quadrants. The top right corner belongs to areas that have high GDPPC and are surrounded by other areas that have the average level of GDPPC. This are the high-high locations in the lesson slide.\n\n\n\nScaling is done by dividing the (centered) variable by their standard deviations.\n\nhunan$Z.GDPPC &lt;- scale(hunan$GDPPC) %&gt;% \n  as.vector \n\nThe as.vector() added to the end is to make sure that the data type we get out of this is a vector, that map neatly into out dataframe.\nNow, we are ready to plot the Moran scatterplot again by using the code chunk below.\n\nnci2 &lt;- moran.plot(hunan$Z.GDPPC, rswm_q,\n                   labels=as.character(hunan$County),\n                   xlab=\"z-GDPPC 2012\", \n                   ylab=\"Spatially Lag z-GDPPC 2012\")\n\n\n\n\n\n\n\nThe code chunks below show the steps to prepare a LISA cluster map.\n\nquadrant &lt;- vector(mode=\"numeric\",length=nrow(localMI))\n\nNext, derives the spatially lagged variable of interest (i.e. GDPPC) and centers the spatially lagged variable around its mean.\n\nhunan$lag_GDPPC &lt;- lag.listw(rswm_q, hunan$GDPPC)\nDV &lt;- hunan$lag_GDPPC - mean(hunan$lag_GDPPC)     \n\nThis is follow by centering the local Moran’s around the mean.\n\nLM_I &lt;- localMI[,1] - mean(localMI[,1])    \n\nNext, we will set a statistical significance level for the local Moran.\n\nsignif &lt;- 0.05       \n\nThese four command lines define the low-low (1), low-high (2), high-low (3) and high-high (4) categories.\n\nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4      \n\nLastly, places non-significant Moran in the category 0\n\nquadrant[localMI[,5]&gt;signif] &lt;- 0\n\n\n\n\n\nhunan.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\n\n\n\n\nFor effective interpretation, it is better to plot both the local Moran’s I values map and its corresponding p-values map next to each other.\nThe code chunk below will be used to create such visualisation.\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\n\nhunan.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\nLISAmap &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\n\ntmap_arrange(gdppc, LISAmap, \n             asp=1, ncol=2)\n\n\n\n\n\nlocalMI.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\", \n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\npvalue.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(localMI.map, pvalue.map, asp=1, ncol=2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\nObservation\n\nLow p value, high local moran statistics, high-high quadrant, high GDPPC\n\n\n\n\n\nThe term ‘hot spot’ has been used generically across disciplines to describe a region or value that is higher relative to its surroundings (Lepers et al 2005, Aben et al 2012, Isobe et al 2015).\n\n\nThe analysis consists of three steps:\n\nDeriving spatial weight matrix\nComputing Gi statistics\nMapping Gi statistics\n\n\n\n\nThere are two type of distance-based proximity matrix, they are:\n\nfixed distance weight matrix; and\nadaptive distance weight matrix.\n\n\n\n\nlongitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[1]])\n\n\nlatitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[2]])\n\n\ncoords &lt;- cbind(longitude, latitude)\n\n\n\n\n\n#coords &lt;- coordinates(hunan)\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24.79   32.57   38.01   39.07   44.52   61.79 \n\n\n\n\n\n\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \n\n\n\nwm62_lw &lt;- nb2listw(wm_d62, style = 'B')\nsummary(wm62_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \nLink number distribution:\n\n 1  2  3  4  5  6 \n 6 15 14 26 20  7 \n6 least connected regions:\n6 15 30 32 56 65 with 1 link\n7 most connected regions:\n21 28 35 45 50 52 82 with 6 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0  S1   S2\nB 88 7744 324 648 5440\n\n\n\n\n\n\n\nknn &lt;- knn2nb(knearneigh(coords, k=8))\nknn\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 704 \nPercentage nonzero weights: 9.090909 \nAverage number of links: 8 \nNon-symmetric neighbours list\n\n\n\nknn_lw &lt;- nb2listw(knn, style = 'B')\nsummary(knn_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 704 \nPercentage nonzero weights: 9.090909 \nAverage number of links: 8 \nNon-symmetric neighbours list\nLink number distribution:\n\n 8 \n88 \n88 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 8 links\n88 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 8 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 88 7744 704 1300 23014\n\n\n\n\n\n\n\n\n\nfips &lt;- order(hunan$County)\ngi.fixed &lt;- localG(hunan$GDPPC, wm62_lw)\ngi.fixed\n\n [1]  0.436075843 -0.265505650 -0.073033665  0.413017033  0.273070579\n [6] -0.377510776  2.863898821  2.794350420  5.216125401  0.228236603\n[11]  0.951035346 -0.536334231  0.176761556  1.195564020 -0.033020610\n[16]  1.378081093 -0.585756761 -0.419680565  0.258805141  0.012056111\n[21] -0.145716531 -0.027158687 -0.318615290 -0.748946051 -0.961700582\n[26] -0.796851342 -1.033949773 -0.460979158 -0.885240161 -0.266671512\n[31] -0.886168613 -0.855476971 -0.922143185 -1.162328599  0.735582222\n[36] -0.003358489 -0.967459309 -1.259299080 -1.452256513 -1.540671121\n[41] -1.395011407 -1.681505286 -1.314110709 -0.767944457 -0.192889342\n[46]  2.720804542  1.809191360 -1.218469473 -0.511984469 -0.834546363\n[51] -0.908179070 -1.541081516 -1.192199867 -1.075080164 -1.631075961\n[56] -0.743472246  0.418842387  0.832943753 -0.710289083 -0.449718820\n[61] -0.493238743 -1.083386776  0.042979051  0.008596093  0.136337469\n[66]  2.203411744  2.690329952  4.453703219 -0.340842743 -0.129318589\n[71]  0.737806634 -1.246912658  0.666667559  1.088613505 -0.985792573\n[76]  1.233609606 -0.487196415  1.626174042 -1.060416797  0.425361422\n[81] -0.837897118 -0.314565243  0.371456331  4.424392623 -0.109566928\n[86]  1.364597995 -1.029658605 -0.718000620\nattr(,\"internals\")\n               Gi      E(Gi)        V(Gi)        Z(Gi) Pr(z != E(Gi))\n [1,] 0.064192949 0.05747126 2.375922e-04  0.436075843   6.627817e-01\n [2,] 0.042300020 0.04597701 1.917951e-04 -0.265505650   7.906200e-01\n [3,] 0.044961480 0.04597701 1.933486e-04 -0.073033665   9.417793e-01\n [4,] 0.039475779 0.03448276 1.461473e-04  0.413017033   6.795941e-01\n [5,] 0.049767939 0.04597701 1.927263e-04  0.273070579   7.847990e-01\n [6,] 0.008825335 0.01149425 4.998177e-05 -0.377510776   7.057941e-01\n [7,] 0.050807266 0.02298851 9.435398e-05  2.863898821   4.184617e-03\n [8,] 0.083966739 0.04597701 1.848292e-04  2.794350420   5.200409e-03\n [9,] 0.115751554 0.04597701 1.789361e-04  5.216125401   1.827045e-07\n[10,] 0.049115587 0.04597701 1.891013e-04  0.228236603   8.194623e-01\n[11,] 0.045819180 0.03448276 1.420884e-04  0.951035346   3.415864e-01\n[12,] 0.049183846 0.05747126 2.387633e-04 -0.536334231   5.917276e-01\n[13,] 0.048429181 0.04597701 1.924532e-04  0.176761556   8.596957e-01\n[14,] 0.034733752 0.02298851 9.651140e-05  1.195564020   2.318667e-01\n[15,] 0.011262043 0.01149425 4.945294e-05 -0.033020610   9.736582e-01\n[16,] 0.065131196 0.04597701 1.931870e-04  1.378081093   1.681783e-01\n[17,] 0.027587075 0.03448276 1.385862e-04 -0.585756761   5.580390e-01\n[18,] 0.029409313 0.03448276 1.461397e-04 -0.419680565   6.747188e-01\n[19,] 0.061466754 0.05747126 2.383385e-04  0.258805141   7.957856e-01\n[20,] 0.057656917 0.05747126 2.371303e-04  0.012056111   9.903808e-01\n[21,] 0.066518379 0.06896552 2.820326e-04 -0.145716531   8.841452e-01\n[22,] 0.045599896 0.04597701 1.928108e-04 -0.027158687   9.783332e-01\n[23,] 0.030646753 0.03448276 1.449523e-04 -0.318615290   7.500183e-01\n[24,] 0.035635552 0.04597701 1.906613e-04 -0.748946051   4.538897e-01\n[25,] 0.032606647 0.04597701 1.932888e-04 -0.961700582   3.362000e-01\n[26,] 0.035001352 0.04597701 1.897172e-04 -0.796851342   4.255374e-01\n[27,] 0.012746354 0.02298851 9.812587e-05 -1.033949773   3.011596e-01\n[28,] 0.061287917 0.06896552 2.773884e-04 -0.460979158   6.448136e-01\n[29,] 0.014277403 0.02298851 9.683314e-05 -0.885240161   3.760271e-01\n[30,] 0.009622875 0.01149425 4.924586e-05 -0.266671512   7.897221e-01\n[31,] 0.014258398 0.02298851 9.705244e-05 -0.886168613   3.755267e-01\n[32,] 0.005453443 0.01149425 4.986245e-05 -0.855476971   3.922871e-01\n[33,] 0.043283712 0.05747126 2.367109e-04 -0.922143185   3.564539e-01\n[34,] 0.020763514 0.03448276 1.393165e-04 -1.162328599   2.451020e-01\n[35,] 0.081261843 0.06896552 2.794398e-04  0.735582222   4.619850e-01\n[36,] 0.057419907 0.05747126 2.338437e-04 -0.003358489   9.973203e-01\n[37,] 0.013497133 0.02298851 9.624821e-05 -0.967459309   3.333145e-01\n[38,] 0.019289310 0.03448276 1.455643e-04 -1.259299080   2.079223e-01\n[39,] 0.025996272 0.04597701 1.892938e-04 -1.452256513   1.464303e-01\n[40,] 0.016092694 0.03448276 1.424776e-04 -1.540671121   1.233968e-01\n[41,] 0.035952614 0.05747126 2.379439e-04 -1.395011407   1.630124e-01\n[42,] 0.031690963 0.05747126 2.350604e-04 -1.681505286   9.266481e-02\n[43,] 0.018750079 0.03448276 1.433314e-04 -1.314110709   1.888090e-01\n[44,] 0.015449080 0.02298851 9.638666e-05 -0.767944457   4.425202e-01\n[45,] 0.065760689 0.06896552 2.760533e-04 -0.192889342   8.470456e-01\n[46,] 0.098966900 0.05747126 2.326002e-04  2.720804542   6.512325e-03\n[47,] 0.085415780 0.05747126 2.385746e-04  1.809191360   7.042128e-02\n[48,] 0.038816536 0.05747126 2.343951e-04 -1.218469473   2.230456e-01\n[49,] 0.038931873 0.04597701 1.893501e-04 -0.511984469   6.086619e-01\n[50,] 0.055098610 0.06896552 2.760948e-04 -0.834546363   4.039732e-01\n[51,] 0.033405005 0.04597701 1.916312e-04 -0.908179070   3.637836e-01\n[52,] 0.043040784 0.06896552 2.829941e-04 -1.541081516   1.232969e-01\n[53,] 0.011297699 0.02298851 9.615920e-05 -1.192199867   2.331829e-01\n[54,] 0.040968457 0.05747126 2.356318e-04 -1.075080164   2.823388e-01\n[55,] 0.023629663 0.04597701 1.877170e-04 -1.631075961   1.028743e-01\n[56,] 0.006281129 0.01149425 4.916619e-05 -0.743472246   4.571958e-01\n[57,] 0.063918654 0.05747126 2.369553e-04  0.418842387   6.753313e-01\n[58,] 0.070325003 0.05747126 2.381374e-04  0.832943753   4.048765e-01\n[59,] 0.025947288 0.03448276 1.444058e-04 -0.710289083   4.775249e-01\n[60,] 0.039752578 0.04597701 1.915656e-04 -0.449718820   6.529132e-01\n[61,] 0.049934283 0.05747126 2.334965e-04 -0.493238743   6.218439e-01\n[62,] 0.030964195 0.04597701 1.920248e-04 -1.083386776   2.786368e-01\n[63,] 0.058129184 0.05747126 2.343319e-04  0.042979051   9.657182e-01\n[64,] 0.046096514 0.04597701 1.932637e-04  0.008596093   9.931414e-01\n[65,] 0.012459080 0.01149425 5.008051e-05  0.136337469   8.915545e-01\n[66,] 0.091447733 0.05747126 2.377744e-04  2.203411744   2.756574e-02\n[67,] 0.049575872 0.02298851 9.766513e-05  2.690329952   7.138140e-03\n[68,] 0.107907212 0.04597701 1.933581e-04  4.453703219   8.440175e-06\n[69,] 0.019616151 0.02298851 9.789454e-05 -0.340842743   7.332220e-01\n[70,] 0.032923393 0.03448276 1.454032e-04 -0.129318589   8.971056e-01\n[71,] 0.030317663 0.02298851 9.867859e-05  0.737806634   4.606320e-01\n[72,] 0.019437582 0.03448276 1.455870e-04 -1.246912658   2.124295e-01\n[73,] 0.055245460 0.04597701 1.932838e-04  0.666667559   5.049845e-01\n[74,] 0.074278054 0.05747126 2.383538e-04  1.088613505   2.763244e-01\n[75,] 0.013269580 0.02298851 9.719982e-05 -0.985792573   3.242349e-01\n[76,] 0.049407829 0.03448276 1.463785e-04  1.233609606   2.173484e-01\n[77,] 0.028605749 0.03448276 1.455139e-04 -0.487196415   6.261191e-01\n[78,] 0.039087662 0.02298851 9.801040e-05  1.626174042   1.039126e-01\n[79,] 0.031447120 0.04597701 1.877464e-04 -1.060416797   2.889550e-01\n[80,] 0.064005294 0.05747126 2.359641e-04  0.425361422   6.705732e-01\n[81,] 0.044606529 0.05747126 2.357330e-04 -0.837897118   4.020885e-01\n[82,] 0.063700493 0.06896552 2.801427e-04 -0.314565243   7.530918e-01\n[83,] 0.051142205 0.04597701 1.933560e-04  0.371456331   7.102977e-01\n[84,] 0.102121112 0.04597701 1.610278e-04  4.424392623   9.671399e-06\n[85,] 0.021901462 0.02298851 9.843172e-05 -0.109566928   9.127528e-01\n[86,] 0.064931813 0.04597701 1.929430e-04  1.364597995   1.723794e-01\n[87,] 0.031747344 0.04597701 1.909867e-04 -1.029658605   3.031703e-01\n[88,] 0.015893319 0.02298851 9.765131e-05 -0.718000620   4.727569e-01\nattr(,\"cluster\")\n [1] Low  Low  High High High High High High High Low  Low  High Low  Low  Low \n[16] High High High High Low  High High Low  Low  High Low  Low  Low  Low  Low \n[31] Low  Low  Low  High Low  Low  Low  Low  Low  Low  High Low  Low  Low  Low \n[46] High High Low  Low  Low  Low  High Low  Low  Low  Low  Low  High Low  Low \n[61] Low  Low  Low  High High High Low  High Low  Low  High Low  High High Low \n[76] High Low  Low  Low  Low  Low  Low  High High Low  High Low  Low \nLevels: Low High\nattr(,\"gstari\")\n[1] FALSE\nattr(,\"call\")\nlocalG(x = hunan$GDPPC, listw = wm62_lw)\nattr(,\"class\")\n[1] \"localG\"\n\n\nNext, we will join the Gi values to their corresponding hunan sf data frame by using the code chunk below.\n\nhunan.gi &lt;- cbind(hunan, as.matrix(gi.fixed)) %&gt;%\n  rename(gstat_fixed = as.matrix.gi.fixed.)\n\nThe code chunk above performs three tasks. First, it convert the output vector (i.e. gi.fixed) into r matrix object by using as.matrix(). Next, cbind() is used to join hunan@data and gi.fixed matrix to produce a new SpatialPolygonDataFrame called hunan.gi. Lastly, the field name of the gi values is renamed to gstat_fixed by using rename().\n\n\n\nThe code chunk below shows the functions used to map the Gi values derived using fixed distance weight matrix.\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\n\nGimap &lt;-tm_shape(hunan.gi) +\n  tm_fill(col = \"gstat_fixed\", \n          style = \"pretty\",\n          palette=\"-RdBu\",\n          title = \"local Gi\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(gdppc, Gimap, asp=1, ncol=2)\n\nVariable(s) \"gstat_fixed\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\nThe code chunk below are used to compute the Gi values for GDPPC2012 by using an adaptive distance weight matrix (i.e knb_lw).\n\nfips &lt;- order(hunan$County)\ngi.adaptive &lt;- localG(hunan$GDPPC, knn_lw)\nhunan.gi &lt;- cbind(hunan, as.matrix(gi.adaptive)) %&gt;%\n  rename(gstat_adaptive = as.matrix.gi.adaptive.)\n\n\n\n\nThe code chunk below shows the functions used to map the Gi values derived using fixed distance weight matrix.\n\ngdppc&lt;- qtm(hunan, \"GDPPC\")\n\nGimap &lt;- tm_shape(hunan.gi) + \n  tm_fill(col = \"gstat_adaptive\", \n          style = \"pretty\", \n          palette=\"-RdBu\", \n          title = \"local Gi\") + \n  tm_borders(alpha = 0.5)\n\ntmap_arrange(gdppc, \n             Gimap, \n             asp=1, \n             ncol=2)\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\nObservation - High local GI, High GDPPC. Low local GI, low GDPPC"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.3.html#getting-started",
    "href": "hands_on_ex2/hands_on_ex2.3.html#getting-started",
    "title": "Hands-on Exercise 2.3 Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "Two data sets will be used in this hands-on exercise, they are:\n\nHunan province administrative boundary layer at county level. This is a geospatial data set in ESRI shapefile format.\nHunan_2012.csv: This csv file contains selected Hunan’s local development indicators in 2012.\n\n\n\n\npacman::p_load(sf, spdep, tmap, tidyverse)"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.3.html#getting-the-data-into-r-environment",
    "href": "hands_on_ex2/hands_on_ex2.3.html#getting-the-data-into-r-environment",
    "title": "Hands-on Exercise 2.3 Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "hunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\n\n\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\n\n\n\n\nhunan &lt;- left_join(hunan,hunan2012) %&gt;%\n  select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`\n\n\n\n\n\nNow, we are going to prepare a basemap and a choropleth map showing the distribution of GDPPC 2012 by using qtm() of tmap package.\n\nequal &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal interval classification\")\n\nquantile &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal quantile classification\")\n\ntmap_arrange(equal, \n             quantile, \n             asp=1, \n             ncol=2)"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.3.html#global-spatial-autocorrelation",
    "href": "hands_on_ex2/hands_on_ex2.3.html#global-spatial-autocorrelation",
    "title": "Hands-on Exercise 2.3 Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "More specifically, the code chunk below is used to compute Queen contiguity weight matrix.\n\nwm_q &lt;- poly2nb(hunan, \n                queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\nThe summary report above shows that there are 88 area units in Hunan. The most connected area unit has 11 neighbours. There are two area units with only one neighbours.\n\n\n\n\nrswm_q &lt;- nb2listw(wm_q, \n                   style=\"W\", \n                   zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147\n\n\n\n\n\nIn this section, I will learn how to perform Moran’s I statistics testing by using moran.test() of spdep.\n\n\n\nThe code chunk below performs Moran’s I statistical testing using moran.test() of spdep.\n\nmoran.test(hunan$GDPPC, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  hunan$GDPPC  \nweights: rswm_q    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\n** Conclusion\nThe Moran’s I test suggests strong evidence against the null hypothesis of spatial randomness (p-value = 1.095e-06). The Moran’s I statistic of 0.3007 indicates a significant positive spatial autocorrelation in the variable ‘GDPPC’ within the study area. Areas in this region with similar GDPPC values tend to be spatially clustered or adjacent to each other more often than expected by random chance.\n\n\nThe code chunk below performs permutation test for Moran’s I statistic by using moran.mc() of spdep. A total of 1000 simulation will be performed.\n\nset.seed(1234)\nbperm= moran.mc(hunan$GDPPC, \n                listw=rswm_q, \n                nsim=999, \n                zero.policy = TRUE, \n                na.action=na.omit)\nbperm\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.30075, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\n\n** Conclusion\nThe permutation test for Moran’s I statistic indicates strong evidence against the null hypothesis of spatial randomness. The observed Moran’s I value (0.30075) falls within the highest ranks of the simulated values, and the small p-value (0.001) suggests that this value is significantly greater than what would be expected by chance alone. Therefore, it supports the conclusion that there is a significant positive spatial autocorrelation in the ‘GDPPC’ variable within the study area. Areas with similar GDPPC values tend to be spatially clustered or adjacent to each other more often than expected by random chance.\n\n\n\nIn the code chunk below hist() and abline() of R Graphics are used.\n\nmean(bperm$res[1:999])\n\n[1] -0.01504572\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.004371574\n\n\n\nsummary(bperm$res[1:999])\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.18339 -0.06168 -0.02125 -0.01505  0.02611  0.27593 \n\n\n\nhist(bperm$res, \n     freq=TRUE, \n     breaks=20, \n     xlab=\"Simulated Moran's I\")\nabline(v=0, \n       col=\"red\") \n\n\n\n\n** Observation\nSkewed distribution that is of right skewed. It peaks at -0.05\n\n\n\n\nIn this section, you will learn how to perform Geary’s c statistics testing by using appropriate functions of spdep package.\n\n\nThe code chunk below performs Geary’s C test for spatial autocorrelation by using geary.test() of spdep.\n\ngeary.test(hunan$GDPPC, listw=rswm_q)\n\n\n    Geary C test under randomisation\n\ndata:  hunan$GDPPC \nweights: rswm_q \n\nGeary C statistic standard deviate = 3.6108, p-value = 0.0001526\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n        0.6907223         1.0000000         0.0073364 \n\n\n** Conclusion\nGiven the low p-value, we can conclude that there is significant evidence to reject the null hypothesis of spatial randomness. We have sufficient evidence to conclude that the alternative hypothesis that there is spatial autocorrelation present in the variable “hunan$GDPPC.” Moreover, the Geary C statistic being substantially lower than the expected value under the null hypothesis further supports this conclusion.\n\n\n\nThe code chunk below performs permutation test for Geary’s C statistic by using geary.mc() of spdep.\n\nset.seed(1234)\nbperm=geary.mc(hunan$GDPPC, \n               listw=rswm_q, \n               nsim=999)\nbperm\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  hunan$GDPPC \nweights: rswm_q \nnumber of simulations + 1: 1000 \n\nstatistic = 0.69072, observed rank = 1, p-value = 0.001\nalternative hypothesis: greater\n\n\n**Conclusion\nThe very low p-value (0.001) suggests strong evidence against the null hypothesis of spatial randomness. Instead, it supports the alternative hypothesis that there is significant spatial autocorrelation present in the variable “hunan$GDPPC.”\nFurthermore, the observed rank of 1 among the 1000 simulations indicates that your observed statistic is at the extreme end of the simulated distribution. This strengthens the evidence that the observed spatial autocorrelation is significantly higher than what would be expected by chance.\n\n\n\n\nmean(bperm$res[1:999])\n\n[1] 1.004402\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.007436493\n\n\n\nsummary(bperm$res[1:999])\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.7142  0.9502  1.0052  1.0044  1.0595  1.2722 \n\n\n\nhist(bperm$res, freq=TRUE, breaks=20, xlab=\"Simulated Geary c\")\nabline(v=1, col=\"red\") \n\n\n\n\n* Observation\nSkewed distribution that is of left skewed. It peaks at 1.05"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.3.html#spatial-correlogram",
    "href": "hands_on_ex2/hands_on_ex2.3.html#spatial-correlogram",
    "title": "Hands-on Exercise 2.3 Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "MI_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"I\", \n                          style=\"W\")\nplot(MI_corr)\n\n\n\n\n\nprint(MI_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Moran's I\n         estimate expectation   variance standard deviate Pr(I) two sided    \n1 (88)  0.3007500  -0.0114943  0.0043484           4.7351       2.189e-06 ***\n2 (88)  0.2060084  -0.0114943  0.0020962           4.7505       2.029e-06 ***\n3 (88)  0.0668273  -0.0114943  0.0014602           2.0496        0.040400 *  \n4 (88)  0.0299470  -0.0114943  0.0011717           1.2107        0.226015    \n5 (88) -0.1530471  -0.0114943  0.0012440          -4.0134       5.984e-05 ***\n6 (88) -0.1187070  -0.0114943  0.0016791          -2.6164        0.008886 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\n\n\nGC_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"C\", \n                          style=\"W\")\nplot(GC_corr)\n\n\n\n\n\nprint(GC_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Geary's C\n        estimate expectation  variance standard deviate Pr(I) two sided    \n1 (88) 0.6907223   1.0000000 0.0073364          -3.6108       0.0003052 ***\n2 (88) 0.7630197   1.0000000 0.0049126          -3.3811       0.0007220 ***\n3 (88) 0.9397299   1.0000000 0.0049005          -0.8610       0.3892612    \n4 (88) 1.0098462   1.0000000 0.0039631           0.1564       0.8757128    \n5 (88) 1.2008204   1.0000000 0.0035568           3.3673       0.0007592 ***\n6 (88) 1.0773386   1.0000000 0.0058042           1.0151       0.3100407    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.3.html#cluster-and-outlier-analysis",
    "href": "hands_on_ex2/hands_on_ex2.3.html#cluster-and-outlier-analysis",
    "title": "Hands-on Exercise 2.3 Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "In this section, I will learn how to apply appropriate Local Indicators for Spatial Association (LISA), especially local Moran’I to detect cluster and/or outlier from GDP per capita 2012 of Hunan Province, PRC.\nThe code chunks below are used to compute local Moran’s I of GDPPC2012 at the county level.\n\nfips &lt;- order(hunan$County)\nlocalMI &lt;- localmoran(hunan$GDPPC, rswm_q)\nhead(localMI)\n\n            Ii          E.Ii       Var.Ii        Z.Ii Pr(z != E(Ii))\n1 -0.001468468 -2.815006e-05 4.723841e-04 -0.06626904      0.9471636\n2  0.025878173 -6.061953e-04 1.016664e-02  0.26266425      0.7928094\n3 -0.011987646 -5.366648e-03 1.133362e-01 -0.01966705      0.9843090\n4  0.001022468 -2.404783e-07 5.105969e-06  0.45259801      0.6508382\n5  0.014814881 -6.829362e-05 1.449949e-03  0.39085814      0.6959021\n6 -0.038793829 -3.860263e-04 6.475559e-03 -0.47728835      0.6331568\n\n\nlocalmoran() function returns a matrix of values whose columns are:\n\nIi: the local Moran’s I statistics\nE.Ii: the expectation of local moran statistic under the randomisation hypothesis\nVar.Ii: the variance of local moran statistic under the randomisation hypothesis\nZ.Ii:the standard deviate of local moran statistic\nPr(): the p-value of local moran statistic\n\nThe code chunk below list the content of the local Moran matrix derived by using printCoefmat().\n\nprintCoefmat(data.frame(\n  localMI[fips,], \n  row.names=hunan$County[fips]),\n  check.names=FALSE)\n\n                       Ii        E.Ii      Var.Ii        Z.Ii Pr.z....E.Ii..\nAnhua         -2.2493e-02 -5.0048e-03  5.8235e-02 -7.2467e-02         0.9422\nAnren         -3.9932e-01 -7.0111e-03  7.0348e-02 -1.4791e+00         0.1391\nAnxiang       -1.4685e-03 -2.8150e-05  4.7238e-04 -6.6269e-02         0.9472\nBaojing        3.4737e-01 -5.0089e-03  8.3636e-02  1.2185e+00         0.2230\nChaling        2.0559e-02 -9.6812e-04  2.7711e-02  1.2932e-01         0.8971\nChangning     -2.9868e-05 -9.0010e-09  1.5105e-07 -7.6828e-02         0.9388\nChangsha       4.9022e+00 -2.1348e-01  2.3194e+00  3.3590e+00         0.0008\nChengbu        7.3725e-01 -1.0534e-02  2.2132e-01  1.5895e+00         0.1119\nChenxi         1.4544e-01 -2.8156e-03  4.7116e-02  6.8299e-01         0.4946\nCili           7.3176e-02 -1.6747e-03  4.7902e-02  3.4200e-01         0.7324\nDao            2.1420e-01 -2.0824e-03  4.4123e-02  1.0297e+00         0.3032\nDongan         1.5210e-01 -6.3485e-04  1.3471e-02  1.3159e+00         0.1882\nDongkou        5.2918e-01 -6.4461e-03  1.0748e-01  1.6338e+00         0.1023\nFenghuang      1.8013e-01 -6.2832e-03  1.3257e-01  5.1198e-01         0.6087\nGuidong       -5.9160e-01 -1.3086e-02  3.7003e-01 -9.5104e-01         0.3416\nGuiyang        1.8240e-01 -3.6908e-03  3.2610e-02  1.0305e+00         0.3028\nGuzhang        2.8466e-01 -8.5054e-03  1.4152e-01  7.7931e-01         0.4358\nHanshou        2.5878e-02 -6.0620e-04  1.0167e-02  2.6266e-01         0.7928\nHengdong       9.9964e-03 -4.9063e-04  6.7742e-03  1.2742e-01         0.8986\nHengnan        2.8064e-02 -3.2160e-04  3.7597e-03  4.6294e-01         0.6434\nHengshan      -5.8201e-03 -3.0437e-05  5.1076e-04 -2.5618e-01         0.7978\nHengyang       6.2997e-02 -1.3046e-03  2.1865e-02  4.3486e-01         0.6637\nHongjiang      1.8790e-01 -2.3019e-03  3.1725e-02  1.0678e+00         0.2856\nHuarong       -1.5389e-02 -1.8667e-03  8.1030e-02 -4.7503e-02         0.9621\nHuayuan        8.3772e-02 -8.5569e-04  2.4495e-02  5.4072e-01         0.5887\nHuitong        2.5997e-01 -5.2447e-03  1.1077e-01  7.9685e-01         0.4255\nJiahe         -1.2431e-01 -3.0550e-03  5.1111e-02 -5.3633e-01         0.5917\nJianghua       2.8651e-01 -3.8280e-03  8.0968e-02  1.0204e+00         0.3076\nJiangyong      2.4337e-01 -2.7082e-03  1.1746e-01  7.1800e-01         0.4728\nJingzhou       1.8270e-01 -8.5106e-04  2.4363e-02  1.1759e+00         0.2396\nJinshi        -1.1988e-02 -5.3666e-03  1.1334e-01 -1.9667e-02         0.9843\nJishou        -2.8680e-01 -2.6305e-03  4.4028e-02 -1.3543e+00         0.1756\nLanshan        6.3334e-02 -9.6365e-04  2.0441e-02  4.4972e-01         0.6529\nLeiyang        1.1581e-02 -1.4948e-04  2.5082e-03  2.3422e-01         0.8148\nLengshuijiang -1.7903e+00 -8.2129e-02  2.1598e+00 -1.1623e+00         0.2451\nLi             1.0225e-03 -2.4048e-07  5.1060e-06  4.5260e-01         0.6508\nLianyuan      -1.4672e-01 -1.8983e-03  1.9145e-02 -1.0467e+00         0.2952\nLiling         1.3774e+00 -1.5097e-02  4.2601e-01  2.1335e+00         0.0329\nLinli          1.4815e-02 -6.8294e-05  1.4499e-03  3.9086e-01         0.6959\nLinwu         -2.4621e-03 -9.0703e-06  1.9258e-04 -1.7676e-01         0.8597\nLinxiang       6.5904e-02 -2.9028e-03  2.5470e-01  1.3634e-01         0.8916\nLiuyang        3.3688e+00 -7.7502e-02  1.5180e+00  2.7972e+00         0.0052\nLonghui        8.0801e-01 -1.1377e-02  1.5538e-01  2.0787e+00         0.0376\nLongshan       7.5663e-01 -1.1100e-02  3.1449e-01  1.3690e+00         0.1710\nLuxi           1.8177e-01 -2.4855e-03  3.4249e-02  9.9561e-01         0.3194\nMayang         2.1852e-01 -5.8773e-03  9.8049e-02  7.1663e-01         0.4736\nMiluo          1.8704e+00 -1.6927e-02  2.7925e-01  3.5715e+00         0.0004\nNan           -9.5789e-03 -4.9497e-04  6.8341e-03 -1.0988e-01         0.9125\nNingxiang      1.5607e+00 -7.3878e-02  8.0012e-01  1.8274e+00         0.0676\nNingyuan       2.0910e-01 -7.0884e-03  8.2306e-02  7.5356e-01         0.4511\nPingjiang     -9.8964e-01 -2.6457e-03  5.6027e-02 -4.1698e+00         0.0000\nQidong         1.1806e-01 -2.1207e-03  2.4747e-02  7.6396e-01         0.4449\nQiyang         6.1966e-02 -7.3374e-04  8.5743e-03  6.7712e-01         0.4983\nRucheng       -3.6992e-01 -8.8999e-03  2.5272e-01 -7.1814e-01         0.4727\nSangzhi        2.5053e-01 -4.9470e-03  6.8000e-02  9.7972e-01         0.3272\nShaodong      -3.2659e-02 -3.6592e-05  5.0546e-04 -1.4510e+00         0.1468\nShaoshan       2.1223e+00 -5.0227e-02  1.3668e+00  1.8583e+00         0.0631\nShaoyang       5.9499e-01 -1.1253e-02  1.3012e-01  1.6807e+00         0.0928\nShimen        -3.8794e-02 -3.8603e-04  6.4756e-03 -4.7729e-01         0.6332\nShuangfeng     9.2835e-03 -2.2867e-03  3.1516e-02  6.5174e-02         0.9480\nShuangpai      8.0591e-02 -3.1366e-04  8.9838e-03  8.5358e-01         0.3933\nSuining        3.7585e-01 -3.5933e-03  4.1870e-02  1.8544e+00         0.0637\nTaojiang      -2.5394e-01 -1.2395e-03  1.4477e-02 -2.1002e+00         0.0357\nTaoyuan        1.4729e-02 -1.2039e-04  8.5103e-04  5.0903e-01         0.6107\nTongdao        4.6482e-01 -6.9870e-03  1.9879e-01  1.0582e+00         0.2900\nWangcheng      4.4220e+00 -1.1067e-01  1.3596e+00  3.8873e+00         0.0001\nWugang         7.1003e-01 -7.8144e-03  1.0710e-01  2.1935e+00         0.0283\nXiangtan       2.4530e-01 -3.6457e-04  3.2319e-03  4.3213e+00         0.0000\nXiangxiang     2.6271e-01 -1.2703e-03  2.1290e-02  1.8092e+00         0.0704\nXiangyin       5.4525e-01 -4.7442e-03  7.9236e-02  1.9539e+00         0.0507\nXinhua         1.1810e-01 -6.2649e-03  8.6001e-02  4.2409e-01         0.6715\nXinhuang       1.5725e-01 -4.1820e-03  3.6648e-01  2.6667e-01         0.7897\nXinning        6.8928e-01 -9.6674e-03  2.0328e-01  1.5502e+00         0.1211\nXinshao        5.7578e-02 -8.5932e-03  1.1769e-01  1.9289e-01         0.8470\nXintian       -7.4050e-03 -5.1493e-03  1.0877e-01 -6.8395e-03         0.9945\nXupu           3.2406e-01 -5.7468e-03  5.7735e-02  1.3726e+00         0.1699\nYanling       -6.9021e-02 -5.9211e-04  9.9306e-03 -6.8667e-01         0.4923\nYizhang       -2.6844e-01 -2.2463e-03  4.7588e-02 -1.2202e+00         0.2224\nYongshun       6.3064e-01 -1.1350e-02  1.8830e-01  1.4795e+00         0.1390\nYongxing       4.3411e-01 -9.0735e-03  1.5088e-01  1.1409e+00         0.2539\nYou            7.8750e-02 -7.2728e-03  1.2116e-01  2.4714e-01         0.8048\nYuanjiang      2.0004e-04 -1.7760e-04  2.9798e-03  6.9181e-03         0.9945\nYuanling       8.7298e-03 -2.2981e-06  2.3221e-05  1.8121e+00         0.0700\nYueyang        4.1189e-02 -1.9768e-04  2.3113e-03  8.6085e-01         0.3893\nZhijiang       1.0476e-01 -7.8123e-04  1.3100e-02  9.2214e-01         0.3565\nZhongfang     -2.2685e-01 -2.1455e-03  3.5927e-02 -1.1855e+00         0.2358\nZhuzhou        3.2864e-01 -5.2432e-04  7.2391e-03  3.8688e+00         0.0001\nZixing        -7.6849e-01 -8.8210e-02  9.4057e-01 -7.0144e-01         0.4830\n\n\n\n\nThe code chunks below can be used to perform the task. The out SpatialPolygonDataFrame is called hunan.localMI.\n\nhunan.localMI &lt;- cbind(hunan,localMI) %&gt;%\n  rename(Pr.Ii = Pr.z....E.Ii..)\n\n\n\n\nUsing choropleth mapping functions of tmap package, we can plot the local Moran’s I values by using the code chinks below.\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\",\n          palette = \"RdBu\",\n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\nThe code chunks below produce a choropleth map of Moran’s I p-values by using functions of tmap package.\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\n\n\nThe code chunk below will be used to create such visualisation.\n\nlocalMI.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\", \n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\npvalue.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(localMI.map, pvalue.map, asp=1, ncol=2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette."
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.3.html#creating-a-lisa-cluster-map",
    "href": "hands_on_ex2/hands_on_ex2.3.html#creating-a-lisa-cluster-map",
    "title": "Hands-on Exercise 2.3 Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "The Moran scatterplot is an illustration of the relationship between the values of the chosen attribute at each location and the average value of the same attribute at neighboring locations.\nThe code chunk below plots the Moran scatterplot of GDPPC 2012 by using moran.plot() of spdep.\n\nnci &lt;- moran.plot(hunan$GDPPC, rswm_q,\n                  labels=as.character(hunan$County), \n                  xlab=\"GDPPC 2012\", \n                  ylab=\"Spatially Lag GDPPC 2012\")\n\n\n\n\nNotice that the plot is split in 4 quadrants. The top right corner belongs to areas that have high GDPPC and are surrounded by other areas that have the average level of GDPPC. This are the high-high locations in the lesson slide.\n\n\n\nScaling is done by dividing the (centered) variable by their standard deviations.\n\nhunan$Z.GDPPC &lt;- scale(hunan$GDPPC) %&gt;% \n  as.vector \n\nThe as.vector() added to the end is to make sure that the data type we get out of this is a vector, that map neatly into out dataframe.\nNow, we are ready to plot the Moran scatterplot again by using the code chunk below.\n\nnci2 &lt;- moran.plot(hunan$Z.GDPPC, rswm_q,\n                   labels=as.character(hunan$County),\n                   xlab=\"z-GDPPC 2012\", \n                   ylab=\"Spatially Lag z-GDPPC 2012\")\n\n\n\n\n\n\n\nThe code chunks below show the steps to prepare a LISA cluster map.\n\nquadrant &lt;- vector(mode=\"numeric\",length=nrow(localMI))\n\nNext, derives the spatially lagged variable of interest (i.e. GDPPC) and centers the spatially lagged variable around its mean.\n\nhunan$lag_GDPPC &lt;- lag.listw(rswm_q, hunan$GDPPC)\nDV &lt;- hunan$lag_GDPPC - mean(hunan$lag_GDPPC)     \n\nThis is follow by centering the local Moran’s around the mean.\n\nLM_I &lt;- localMI[,1] - mean(localMI[,1])    \n\nNext, we will set a statistical significance level for the local Moran.\n\nsignif &lt;- 0.05       \n\nThese four command lines define the low-low (1), low-high (2), high-low (3) and high-high (4) categories.\n\nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4      \n\nLastly, places non-significant Moran in the category 0\n\nquadrant[localMI[,5]&gt;signif] &lt;- 0\n\n\n\n\n\nhunan.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\n\n\n\n\nFor effective interpretation, it is better to plot both the local Moran’s I values map and its corresponding p-values map next to each other.\nThe code chunk below will be used to create such visualisation.\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\n\nhunan.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\nLISAmap &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\n\ntmap_arrange(gdppc, LISAmap, \n             asp=1, ncol=2)\n\n\n\n\n\nlocalMI.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\", \n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\npvalue.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(localMI.map, pvalue.map, asp=1, ncol=2)\n\nVariable(s) \"Ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\nObservation\n\nLow p value, high local moran statistics, high-high quadrant, high GDPPC"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.3.html#hot-spot-and-cold-spot-area-analysis",
    "href": "hands_on_ex2/hands_on_ex2.3.html#hot-spot-and-cold-spot-area-analysis",
    "title": "Hands-on Exercise 2.3 Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "The term ‘hot spot’ has been used generically across disciplines to describe a region or value that is higher relative to its surroundings (Lepers et al 2005, Aben et al 2012, Isobe et al 2015).\n\n\nThe analysis consists of three steps:\n\nDeriving spatial weight matrix\nComputing Gi statistics\nMapping Gi statistics\n\n\n\n\nThere are two type of distance-based proximity matrix, they are:\n\nfixed distance weight matrix; and\nadaptive distance weight matrix.\n\n\n\n\nlongitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[1]])\n\n\nlatitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[2]])\n\n\ncoords &lt;- cbind(longitude, latitude)\n\n\n\n\n\n#coords &lt;- coordinates(hunan)\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24.79   32.57   38.01   39.07   44.52   61.79 \n\n\n\n\n\n\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \n\n\n\nwm62_lw &lt;- nb2listw(wm_d62, style = 'B')\nsummary(wm62_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \nLink number distribution:\n\n 1  2  3  4  5  6 \n 6 15 14 26 20  7 \n6 least connected regions:\n6 15 30 32 56 65 with 1 link\n7 most connected regions:\n21 28 35 45 50 52 82 with 6 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0  S1   S2\nB 88 7744 324 648 5440\n\n\n\n\n\n\n\nknn &lt;- knn2nb(knearneigh(coords, k=8))\nknn\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 704 \nPercentage nonzero weights: 9.090909 \nAverage number of links: 8 \nNon-symmetric neighbours list\n\n\n\nknn_lw &lt;- nb2listw(knn, style = 'B')\nsummary(knn_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 704 \nPercentage nonzero weights: 9.090909 \nAverage number of links: 8 \nNon-symmetric neighbours list\nLink number distribution:\n\n 8 \n88 \n88 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 8 links\n88 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 8 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 88 7744 704 1300 23014"
  },
  {
    "objectID": "hands_on_ex2/hands_on_ex2.3.html#computing-gi-statistics",
    "href": "hands_on_ex2/hands_on_ex2.3.html#computing-gi-statistics",
    "title": "Hands-on Exercise 2.3 Local Measures of Spatial Autocorrelation",
    "section": "",
    "text": "fips &lt;- order(hunan$County)\ngi.fixed &lt;- localG(hunan$GDPPC, wm62_lw)\ngi.fixed\n\n [1]  0.436075843 -0.265505650 -0.073033665  0.413017033  0.273070579\n [6] -0.377510776  2.863898821  2.794350420  5.216125401  0.228236603\n[11]  0.951035346 -0.536334231  0.176761556  1.195564020 -0.033020610\n[16]  1.378081093 -0.585756761 -0.419680565  0.258805141  0.012056111\n[21] -0.145716531 -0.027158687 -0.318615290 -0.748946051 -0.961700582\n[26] -0.796851342 -1.033949773 -0.460979158 -0.885240161 -0.266671512\n[31] -0.886168613 -0.855476971 -0.922143185 -1.162328599  0.735582222\n[36] -0.003358489 -0.967459309 -1.259299080 -1.452256513 -1.540671121\n[41] -1.395011407 -1.681505286 -1.314110709 -0.767944457 -0.192889342\n[46]  2.720804542  1.809191360 -1.218469473 -0.511984469 -0.834546363\n[51] -0.908179070 -1.541081516 -1.192199867 -1.075080164 -1.631075961\n[56] -0.743472246  0.418842387  0.832943753 -0.710289083 -0.449718820\n[61] -0.493238743 -1.083386776  0.042979051  0.008596093  0.136337469\n[66]  2.203411744  2.690329952  4.453703219 -0.340842743 -0.129318589\n[71]  0.737806634 -1.246912658  0.666667559  1.088613505 -0.985792573\n[76]  1.233609606 -0.487196415  1.626174042 -1.060416797  0.425361422\n[81] -0.837897118 -0.314565243  0.371456331  4.424392623 -0.109566928\n[86]  1.364597995 -1.029658605 -0.718000620\nattr(,\"internals\")\n               Gi      E(Gi)        V(Gi)        Z(Gi) Pr(z != E(Gi))\n [1,] 0.064192949 0.05747126 2.375922e-04  0.436075843   6.627817e-01\n [2,] 0.042300020 0.04597701 1.917951e-04 -0.265505650   7.906200e-01\n [3,] 0.044961480 0.04597701 1.933486e-04 -0.073033665   9.417793e-01\n [4,] 0.039475779 0.03448276 1.461473e-04  0.413017033   6.795941e-01\n [5,] 0.049767939 0.04597701 1.927263e-04  0.273070579   7.847990e-01\n [6,] 0.008825335 0.01149425 4.998177e-05 -0.377510776   7.057941e-01\n [7,] 0.050807266 0.02298851 9.435398e-05  2.863898821   4.184617e-03\n [8,] 0.083966739 0.04597701 1.848292e-04  2.794350420   5.200409e-03\n [9,] 0.115751554 0.04597701 1.789361e-04  5.216125401   1.827045e-07\n[10,] 0.049115587 0.04597701 1.891013e-04  0.228236603   8.194623e-01\n[11,] 0.045819180 0.03448276 1.420884e-04  0.951035346   3.415864e-01\n[12,] 0.049183846 0.05747126 2.387633e-04 -0.536334231   5.917276e-01\n[13,] 0.048429181 0.04597701 1.924532e-04  0.176761556   8.596957e-01\n[14,] 0.034733752 0.02298851 9.651140e-05  1.195564020   2.318667e-01\n[15,] 0.011262043 0.01149425 4.945294e-05 -0.033020610   9.736582e-01\n[16,] 0.065131196 0.04597701 1.931870e-04  1.378081093   1.681783e-01\n[17,] 0.027587075 0.03448276 1.385862e-04 -0.585756761   5.580390e-01\n[18,] 0.029409313 0.03448276 1.461397e-04 -0.419680565   6.747188e-01\n[19,] 0.061466754 0.05747126 2.383385e-04  0.258805141   7.957856e-01\n[20,] 0.057656917 0.05747126 2.371303e-04  0.012056111   9.903808e-01\n[21,] 0.066518379 0.06896552 2.820326e-04 -0.145716531   8.841452e-01\n[22,] 0.045599896 0.04597701 1.928108e-04 -0.027158687   9.783332e-01\n[23,] 0.030646753 0.03448276 1.449523e-04 -0.318615290   7.500183e-01\n[24,] 0.035635552 0.04597701 1.906613e-04 -0.748946051   4.538897e-01\n[25,] 0.032606647 0.04597701 1.932888e-04 -0.961700582   3.362000e-01\n[26,] 0.035001352 0.04597701 1.897172e-04 -0.796851342   4.255374e-01\n[27,] 0.012746354 0.02298851 9.812587e-05 -1.033949773   3.011596e-01\n[28,] 0.061287917 0.06896552 2.773884e-04 -0.460979158   6.448136e-01\n[29,] 0.014277403 0.02298851 9.683314e-05 -0.885240161   3.760271e-01\n[30,] 0.009622875 0.01149425 4.924586e-05 -0.266671512   7.897221e-01\n[31,] 0.014258398 0.02298851 9.705244e-05 -0.886168613   3.755267e-01\n[32,] 0.005453443 0.01149425 4.986245e-05 -0.855476971   3.922871e-01\n[33,] 0.043283712 0.05747126 2.367109e-04 -0.922143185   3.564539e-01\n[34,] 0.020763514 0.03448276 1.393165e-04 -1.162328599   2.451020e-01\n[35,] 0.081261843 0.06896552 2.794398e-04  0.735582222   4.619850e-01\n[36,] 0.057419907 0.05747126 2.338437e-04 -0.003358489   9.973203e-01\n[37,] 0.013497133 0.02298851 9.624821e-05 -0.967459309   3.333145e-01\n[38,] 0.019289310 0.03448276 1.455643e-04 -1.259299080   2.079223e-01\n[39,] 0.025996272 0.04597701 1.892938e-04 -1.452256513   1.464303e-01\n[40,] 0.016092694 0.03448276 1.424776e-04 -1.540671121   1.233968e-01\n[41,] 0.035952614 0.05747126 2.379439e-04 -1.395011407   1.630124e-01\n[42,] 0.031690963 0.05747126 2.350604e-04 -1.681505286   9.266481e-02\n[43,] 0.018750079 0.03448276 1.433314e-04 -1.314110709   1.888090e-01\n[44,] 0.015449080 0.02298851 9.638666e-05 -0.767944457   4.425202e-01\n[45,] 0.065760689 0.06896552 2.760533e-04 -0.192889342   8.470456e-01\n[46,] 0.098966900 0.05747126 2.326002e-04  2.720804542   6.512325e-03\n[47,] 0.085415780 0.05747126 2.385746e-04  1.809191360   7.042128e-02\n[48,] 0.038816536 0.05747126 2.343951e-04 -1.218469473   2.230456e-01\n[49,] 0.038931873 0.04597701 1.893501e-04 -0.511984469   6.086619e-01\n[50,] 0.055098610 0.06896552 2.760948e-04 -0.834546363   4.039732e-01\n[51,] 0.033405005 0.04597701 1.916312e-04 -0.908179070   3.637836e-01\n[52,] 0.043040784 0.06896552 2.829941e-04 -1.541081516   1.232969e-01\n[53,] 0.011297699 0.02298851 9.615920e-05 -1.192199867   2.331829e-01\n[54,] 0.040968457 0.05747126 2.356318e-04 -1.075080164   2.823388e-01\n[55,] 0.023629663 0.04597701 1.877170e-04 -1.631075961   1.028743e-01\n[56,] 0.006281129 0.01149425 4.916619e-05 -0.743472246   4.571958e-01\n[57,] 0.063918654 0.05747126 2.369553e-04  0.418842387   6.753313e-01\n[58,] 0.070325003 0.05747126 2.381374e-04  0.832943753   4.048765e-01\n[59,] 0.025947288 0.03448276 1.444058e-04 -0.710289083   4.775249e-01\n[60,] 0.039752578 0.04597701 1.915656e-04 -0.449718820   6.529132e-01\n[61,] 0.049934283 0.05747126 2.334965e-04 -0.493238743   6.218439e-01\n[62,] 0.030964195 0.04597701 1.920248e-04 -1.083386776   2.786368e-01\n[63,] 0.058129184 0.05747126 2.343319e-04  0.042979051   9.657182e-01\n[64,] 0.046096514 0.04597701 1.932637e-04  0.008596093   9.931414e-01\n[65,] 0.012459080 0.01149425 5.008051e-05  0.136337469   8.915545e-01\n[66,] 0.091447733 0.05747126 2.377744e-04  2.203411744   2.756574e-02\n[67,] 0.049575872 0.02298851 9.766513e-05  2.690329952   7.138140e-03\n[68,] 0.107907212 0.04597701 1.933581e-04  4.453703219   8.440175e-06\n[69,] 0.019616151 0.02298851 9.789454e-05 -0.340842743   7.332220e-01\n[70,] 0.032923393 0.03448276 1.454032e-04 -0.129318589   8.971056e-01\n[71,] 0.030317663 0.02298851 9.867859e-05  0.737806634   4.606320e-01\n[72,] 0.019437582 0.03448276 1.455870e-04 -1.246912658   2.124295e-01\n[73,] 0.055245460 0.04597701 1.932838e-04  0.666667559   5.049845e-01\n[74,] 0.074278054 0.05747126 2.383538e-04  1.088613505   2.763244e-01\n[75,] 0.013269580 0.02298851 9.719982e-05 -0.985792573   3.242349e-01\n[76,] 0.049407829 0.03448276 1.463785e-04  1.233609606   2.173484e-01\n[77,] 0.028605749 0.03448276 1.455139e-04 -0.487196415   6.261191e-01\n[78,] 0.039087662 0.02298851 9.801040e-05  1.626174042   1.039126e-01\n[79,] 0.031447120 0.04597701 1.877464e-04 -1.060416797   2.889550e-01\n[80,] 0.064005294 0.05747126 2.359641e-04  0.425361422   6.705732e-01\n[81,] 0.044606529 0.05747126 2.357330e-04 -0.837897118   4.020885e-01\n[82,] 0.063700493 0.06896552 2.801427e-04 -0.314565243   7.530918e-01\n[83,] 0.051142205 0.04597701 1.933560e-04  0.371456331   7.102977e-01\n[84,] 0.102121112 0.04597701 1.610278e-04  4.424392623   9.671399e-06\n[85,] 0.021901462 0.02298851 9.843172e-05 -0.109566928   9.127528e-01\n[86,] 0.064931813 0.04597701 1.929430e-04  1.364597995   1.723794e-01\n[87,] 0.031747344 0.04597701 1.909867e-04 -1.029658605   3.031703e-01\n[88,] 0.015893319 0.02298851 9.765131e-05 -0.718000620   4.727569e-01\nattr(,\"cluster\")\n [1] Low  Low  High High High High High High High Low  Low  High Low  Low  Low \n[16] High High High High Low  High High Low  Low  High Low  Low  Low  Low  Low \n[31] Low  Low  Low  High Low  Low  Low  Low  Low  Low  High Low  Low  Low  Low \n[46] High High Low  Low  Low  Low  High Low  Low  Low  Low  Low  High Low  Low \n[61] Low  Low  Low  High High High Low  High Low  Low  High Low  High High Low \n[76] High Low  Low  Low  Low  Low  Low  High High Low  High Low  Low \nLevels: Low High\nattr(,\"gstari\")\n[1] FALSE\nattr(,\"call\")\nlocalG(x = hunan$GDPPC, listw = wm62_lw)\nattr(,\"class\")\n[1] \"localG\"\n\n\nNext, we will join the Gi values to their corresponding hunan sf data frame by using the code chunk below.\n\nhunan.gi &lt;- cbind(hunan, as.matrix(gi.fixed)) %&gt;%\n  rename(gstat_fixed = as.matrix.gi.fixed.)\n\nThe code chunk above performs three tasks. First, it convert the output vector (i.e. gi.fixed) into r matrix object by using as.matrix(). Next, cbind() is used to join hunan@data and gi.fixed matrix to produce a new SpatialPolygonDataFrame called hunan.gi. Lastly, the field name of the gi values is renamed to gstat_fixed by using rename().\n\n\n\nThe code chunk below shows the functions used to map the Gi values derived using fixed distance weight matrix.\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\n\nGimap &lt;-tm_shape(hunan.gi) +\n  tm_fill(col = \"gstat_fixed\", \n          style = \"pretty\",\n          palette=\"-RdBu\",\n          title = \"local Gi\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(gdppc, Gimap, asp=1, ncol=2)\n\nVariable(s) \"gstat_fixed\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n\nThe code chunk below are used to compute the Gi values for GDPPC2012 by using an adaptive distance weight matrix (i.e knb_lw).\n\nfips &lt;- order(hunan$County)\ngi.adaptive &lt;- localG(hunan$GDPPC, knn_lw)\nhunan.gi &lt;- cbind(hunan, as.matrix(gi.adaptive)) %&gt;%\n  rename(gstat_adaptive = as.matrix.gi.adaptive.)\n\n\n\n\nThe code chunk below shows the functions used to map the Gi values derived using fixed distance weight matrix.\n\ngdppc&lt;- qtm(hunan, \"GDPPC\")\n\nGimap &lt;- tm_shape(hunan.gi) + \n  tm_fill(col = \"gstat_adaptive\", \n          style = \"pretty\", \n          palette=\"-RdBu\", \n          title = \"local Gi\") + \n  tm_borders(alpha = 0.5)\n\ntmap_arrange(gdppc, \n             Gimap, \n             asp=1, \n             ncol=2)\n\nVariable(s) \"gstat_adaptive\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\nObservation - High local GI, High GDPPC. Low local GI, low GDPPC"
  },
  {
    "objectID": "hands_on_ex3/data/geospatial/MPSZ-2019.html",
    "href": "hands_on_ex3/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "hands_on_ex3/hands_on_ex3.html",
    "href": "hands_on_ex3/hands_on_ex3.html",
    "title": "Hands-on Exercise 3 Processing and Visualising Flow Data",
    "section": "",
    "text": "In this hands-on exercise, I will learn how to build an OD matrix by using Passenger Volume by Origin Destination Bus Stops data set downloaded from LTA DataMall. By the end of this hands-on exercise, I learn how to:\n\nto import and extract OD data for a selected time interval,\nto import and save geospatial data (i.e. bus stops and mpsz) into sf tibble data frame objects,\nto populate planning subzone code into bus stops sf tibble data frame,\nto construct desire lines geospatial data from the OD data, and\nto visualise passenger volume by origin and destination bus stops by using the desire lines data."
  },
  {
    "objectID": "hands_on_ex3/hands_on_ex3.html#importing-the-od-data",
    "href": "hands_on_ex3/hands_on_ex3.html#importing-the-od-data",
    "title": "Hands-on Exercise 3 Processing and Visualising Flow Data",
    "section": "Importing the OD data",
    "text": "Importing the OD data\nFirstly, I will import the Passenger Volume by Origin Destination Bus Stops data set downloaded from LTA DataMall by using read_csv() of readr package. Oct 2023 data is used in this hands on exercise.\n\nodbus &lt;- read_csv(\"data/aspatial/origin_destination_bus_202310.csv\")\n\nRows: 5694297 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): YEAR_MONTH, DAY_TYPE, PT_TYPE, ORIGIN_PT_CODE, DESTINATION_PT_CODE\ndbl (2): TIME_PER_HOUR, TOTAL_TRIPS\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nLet use display the odbus tibble data table by using the code chunk below.\n\nglimpse(odbus)\n\nRows: 5,694,297\nColumns: 7\n$ YEAR_MONTH          &lt;chr&gt; \"2023-10\", \"2023-10\", \"2023-10\", \"2023-10\", \"2023-…\n$ DAY_TYPE            &lt;chr&gt; \"WEEKENDS/HOLIDAY\", \"WEEKDAY\", \"WEEKENDS/HOLIDAY\",…\n$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 7, 14, 14, 10, 20, 20,…\n$ PT_TYPE             &lt;chr&gt; \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"…\n$ ORIGIN_PT_CODE      &lt;chr&gt; \"04168\", \"04168\", \"80119\", \"80119\", \"44069\", \"2028…\n$ DESTINATION_PT_CODE &lt;chr&gt; \"10051\", \"10051\", \"90079\", \"90079\", \"17229\", \"2014…\n$ TOTAL_TRIPS         &lt;dbl&gt; 3, 5, 3, 5, 4, 1, 24, 2, 1, 7, 3, 2, 5, 1, 1, 1, 1…\n\n\nA quick check of odbus tibble data frame shows that the values in OROGIN_PT_CODE and DESTINATON_PT_CODE are in numeric data type. Hence, the code chunk below is used to convert these data values into character data type.\n\nodbus$ORIGIN_PT_CODE &lt;- as.factor(odbus$ORIGIN_PT_CODE)\nodbus$DESTINATION_PT_CODE &lt;- as.factor(odbus$DESTINATION_PT_CODE)"
  },
  {
    "objectID": "hands_on_ex3/hands_on_ex3.html#extracting-the-study-data",
    "href": "hands_on_ex3/hands_on_ex3.html#extracting-the-study-data",
    "title": "Hands-on Exercise 3 Processing and Visualising Flow Data",
    "section": "Extracting the study data",
    "text": "Extracting the study data\nFor the purpose of this exercise, we will extract commuting flows on weekday and between 6 and 9 o’clock.\n\nodbus6_9 &lt;- odbus %&gt;%\n  filter(DAY_TYPE == \"WEEKDAY\") %&gt;%\n  filter(TIME_PER_HOUR &gt;= 6 &\n           TIME_PER_HOUR &lt;= 9) %&gt;%\n  group_by(ORIGIN_PT_CODE,\n           DESTINATION_PT_CODE) %&gt;%\n  summarise(TRIPS = sum(TOTAL_TRIPS))\n\n`summarise()` has grouped output by 'ORIGIN_PT_CODE'. You can override using\nthe `.groups` argument.\n\n\nTable below shows the content of odbus6_9\n\ndatatable(odbus6_9)\n\nWarning in instance$preRenderHook(instance): It seems your data is too big for\nclient-side DataTables. You may consider server-side processing:\nhttps://rstudio.github.io/DT/server.html\n\n\n\n\n\n\n\nWe will save the output in rds format for future used.\n\nwrite_rds(odbus6_9, \"data/rds/odbus6_9.rds\")\n\n\nodbus6_9 &lt;- read_rds(\"data/rds/odbus6_9.rds\")"
  },
  {
    "objectID": "hands_on_ex3/hands_on_ex3.html#importing-geospatial-data",
    "href": "hands_on_ex3/hands_on_ex3.html#importing-geospatial-data",
    "title": "Hands-on Exercise 3 Processing and Visualising Flow Data",
    "section": "Importing geospatial data",
    "text": "Importing geospatial data\nTwo geospatial data will be used in this exercise, they are:\n\nbusstop &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"BusStop\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `BusStop' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex3\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 5161 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82\nProjected CRS: SVY21\n\n\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"MPSZ-2019\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `MPSZ-2019' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex3\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\n\nmpsz\n\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N\n1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION\n2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION\n3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION\n4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION\n5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION\n6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION\n7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION\n8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION\n9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION\n10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION\n   REGION_C                       geometry\n1        CR MULTIPOLYGON (((33222.98 29...\n2        CR MULTIPOLYGON (((28481.45 30...\n3        CR MULTIPOLYGON (((28087.34 30...\n4        WR MULTIPOLYGON (((14557.7 304...\n5        CR MULTIPOLYGON (((29542.53 31...\n6        CR MULTIPOLYGON (((35279.55 30...\n7        WR MULTIPOLYGON (((15772.59 21...\n8        WR MULTIPOLYGON (((19843.41 21...\n9        CR MULTIPOLYGON (((30870.53 22...\n10       CR MULTIPOLYGON (((26879.04 26..."
  },
  {
    "objectID": "hands_on_ex3/hands_on_ex3.html#combining-busstop-and-mpsz",
    "href": "hands_on_ex3/hands_on_ex3.html#combining-busstop-and-mpsz",
    "title": "Hands-on Exercise 3 Processing and Visualising Flow Data",
    "section": "Combining Busstop and mpsz",
    "text": "Combining Busstop and mpsz\nCode chunk below populates the planning subzone code (i.e. SUBZONE_C) of mpsz sf data frame into busstop sf data frame.\n\nbusstop_mpsz &lt;- st_intersection(busstop, mpsz) %&gt;%\n  select(BUS_STOP_N, SUBZONE_C) %&gt;%\n  st_drop_geometry()\n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\n\n\ndatatable(busstop_mpsz)\n\n\n\n\n\n\nBefore moving to the next step, it is wise to save the output into rds format.\n\nwrite_rds(busstop_mpsz, \"data/rds/busstop_mpsz.rds\")  \n\nNext, we are going to append the planning subzone code from busstop_mpsz data frame onto odbus6_9 data frame.\n\nod_data &lt;- left_join(odbus6_9 , busstop_mpsz,\n            by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\")) %&gt;%\n  rename(ORIGIN_BS = ORIGIN_PT_CODE,\n         ORIGIN_SZ = SUBZONE_C,\n         DESTIN_BS = DESTINATION_PT_CODE)\n\nWarning in left_join(odbus6_9, busstop_mpsz, by = c(ORIGIN_PT_CODE = \"BUS_STOP_N\")): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 25632 of `x` matches multiple rows in `y`.\nℹ Row 673 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\nBefore continue, it is a good practice for us to check for duplicating records.\n\nduplicate &lt;- od_data %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\nIf duplicated records are found, the code chunk below will be used to retain the unique records.\n\nod_data &lt;- unique(od_data)\n\nIt will be a good practice to confirm if the duplicating records issue has been addressed fully.\nNext, we will update od_data data frame cwith the planning subzone codes.\n\nod_data &lt;- left_join(od_data , busstop_mpsz,\n            by = c(\"DESTIN_BS\" = \"BUS_STOP_N\")) \n\nWarning in left_join(od_data, busstop_mpsz, by = c(DESTIN_BS = \"BUS_STOP_N\")): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 167 of `x` matches multiple rows in `y`.\nℹ Row 672 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\n\nduplicate &lt;- od_data %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\n\nod_data &lt;- unique(od_data)\n\n\nod_data &lt;- od_data %&gt;%\n  rename(DESTIN_SZ = SUBZONE_C) %&gt;%\n  drop_na() %&gt;%\n  group_by(ORIGIN_SZ, DESTIN_SZ) %&gt;%\n  summarise(MORNING_PEAK = sum(TRIPS))\n\n`summarise()` has grouped output by 'ORIGIN_SZ'. You can override using the\n`.groups` argument.\n\n\nIt is time to save the output into an rds file format.\n\nwrite_rds(od_data, \"data/rds/od_data.rds\")\n\n\nod_data &lt;- read_rds(\"data/rds/od_data.rds\")"
  },
  {
    "objectID": "hands_on_ex3/hands_on_ex3.html#removing-intra-zonal-flows",
    "href": "hands_on_ex3/hands_on_ex3.html#removing-intra-zonal-flows",
    "title": "Hands-on Exercise 3 Processing and Visualising Flow Data",
    "section": "Removing intra-zonal flows",
    "text": "Removing intra-zonal flows\nWe will not plot the intra-zonal flows. The code chunk below will be used to remove intra-zonal flows.\n\nod_data1 &lt;- od_data[od_data$ORIGIN_SZ!=od_data$DESTIN_SZ,]"
  },
  {
    "objectID": "hands_on_ex3/hands_on_ex3.html#creating-desire-lines",
    "href": "hands_on_ex3/hands_on_ex3.html#creating-desire-lines",
    "title": "Hands-on Exercise 3 Processing and Visualising Flow Data",
    "section": "Creating desire lines",
    "text": "Creating desire lines\nIn this code chunk below, od2line() of stplanr package is used to create the desire lines.\n\nflowLine &lt;- od2line(flow = od_data1, \n                    zones = mpsz,\n                    zone_code = \"SUBZONE_C\")\n\nCreating centroids representing desire line start and end points."
  },
  {
    "objectID": "hands_on_ex3/hands_on_ex3.html#visualising-the-desire-lines",
    "href": "hands_on_ex3/hands_on_ex3.html#visualising-the-desire-lines",
    "title": "Hands-on Exercise 3 Processing and Visualising Flow Data",
    "section": "Visualising the desire lines",
    "text": "Visualising the desire lines\n\ntm_shape(mpsz) +\n  tm_polygons() +\nflowLine %&gt;%  \ntm_shape() +\n  tm_lines(lwd = \"MORNING_PEAK\",\n           style = \"quantile\",\n           scale = c(0.1, 1, 3, 5, 7, 10),\n           n = 6,\n           alpha = 0.3)\n\nWarning in g$scale * (w_legend/maxW): longer object length is not a multiple of\nshorter object length\n\n\nWarning in g$scale * (x/maxW): longer object length is not a multiple of\nshorter object length\n\n\n\n\n\nWhen the flow data are very messy and highly skewed like the one shown above, it is wiser to focus on selected flows, for example flow greater than or equal to 5000 as shown below.\n\ntm_shape(mpsz) +\n  tm_polygons() +\nflowLine %&gt;%  \n  filter(MORNING_PEAK &gt;= 5000) %&gt;%\ntm_shape() +\n  tm_lines(lwd = \"MORNING_PEAK\",\n           style = \"quantile\",\n           scale = c(0.1, 1, 3, 5, 7, 10),\n           n = 6,\n           alpha = 0.3)\n\nWarning in g$scale * (w_legend/maxW): longer object length is not a multiple of\nshorter object length\n\n\nWarning in g$scale * (x/maxW): longer object length is not a multiple of\nshorter object length"
  },
  {
    "objectID": "hands_on_ex4/hands_on_ex4.html",
    "href": "hands_on_ex4/hands_on_ex4.html",
    "title": "Hands-on Exercise 4 Calibrating Hedonic Pricing Model for Private Highrise Property with GWR Method",
    "section": "",
    "text": "Geographically weighted regression (GWR) is a spatial statistical technique that takes non-stationary variables into consideration (e.g., climate; demographic factors; physical environment characteristics) and models the local relationships between these independent variables and an outcome of interest (also known as dependent variable). In this hands-on exercise, you will learn how to build hedonic pricing models by using GWR methods. The dependent variable is the resale prices of condominium in 2015. The independent variables are divided into either structural and locational."
  },
  {
    "objectID": "hands_on_ex4/hands_on_ex4.html#geospatial-data-wrangling",
    "href": "hands_on_ex4/hands_on_ex4.html#geospatial-data-wrangling",
    "title": "Hands-on Exercise 4 Calibrating Hedonic Pricing Model for Private Highrise Property with GWR Method",
    "section": "Geospatial Data Wrangling",
    "text": "Geospatial Data Wrangling\n\nImporting geospatial data\nThe code chunk below is used to import MP_SUBZONE_WEB_PL shapefile by using st_read() of sf packages.\n\nmpsz = st_read(dsn = \"data/geospatial\", layer = \"MP14_SUBZONE_WEB_PL\")\n\nReading layer `MP14_SUBZONE_WEB_PL' from data source \n  `C:\\czx0727\\ISSS624_\\hands_on_ex4\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 323 features and 15 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21\n\n\nThe report above shows that the R object used to contain the imported MP14_SUBZONE_WEB_PL shapefile is called mpsz and it is a simple feature object. The geometry type is multipolygon. it is also important to note that mpsz simple feature object does not have EPSG information.\n\n\nUpdating CRS information\nThe code chunk below updates the newly imported mpsz with the correct ESPG code (i.e. 3414)\n\nmpsz_svy21 &lt;- st_transform(mpsz, 3414)\n\nAfter transforming the projection metadata, you can varify the projection of the newly transformed mpsz_svy21 by using st_crs() of sf package.\nThe code chunk below will be used to varify the newly transformed mpsz_svy21.\n\nst_crs(mpsz_svy21)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\nNext, you will reveal the extent of mpsz_svy21 by using st_bbox() of sf package.\n\nst_bbox(mpsz_svy21) #view extent\n\n     xmin      ymin      xmax      ymax \n 2667.538 15748.721 56396.440 50256.334"
  },
  {
    "objectID": "hands_on_ex4/hands_on_ex4.html#aspatial-data-wrangling",
    "href": "hands_on_ex4/hands_on_ex4.html#aspatial-data-wrangling",
    "title": "Hands-on Exercise 4 Calibrating Hedonic Pricing Model for Private Highrise Property with GWR Method",
    "section": "Aspatial Data Wrangling",
    "text": "Aspatial Data Wrangling\n\nImporting the aspatial data\n\ncondo_resale = read_csv(\"data/aspatial/Condo_resale_2015.csv\")\n\nRows: 1436 Columns: 23\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\ndbl (23): LATITUDE, LONGITUDE, POSTCODE, SELLING_PRICE, AREA_SQM, AGE, PROX_...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nAfter importing the data file into R, it is important for us to examine if the data file has been imported correctly.\nThe codes chunks below uses glimpse() to display the data structure of will do the job.\n\nglimpse(condo_resale)\n\nRows: 1,436\nColumns: 23\n$ LATITUDE             &lt;dbl&gt; 1.287145, 1.328698, 1.313727, 1.308563, 1.321437,…\n$ LONGITUDE            &lt;dbl&gt; 103.7802, 103.8123, 103.7971, 103.8247, 103.9505,…\n$ POSTCODE             &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472, 3…\n$ SELLING_PRICE        &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1320…\n$ AREA_SQM             &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 168,…\n$ AGE                  &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22, 6,…\n$ PROX_CBD             &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783402…\n$ PROX_CHILDCARE       &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543, 0…\n$ PROX_ELDERLYCARE     &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.121…\n$ PROX_URA_GROWTH_AREA &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.410632,…\n$ PROX_HAWKER_MARKET   &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969, 0…\n$ PROX_KINDERGARTEN    &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076, 0…\n$ PROX_MRT             &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.528…\n$ PROX_PARK            &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.116…\n$ PROX_PRIMARY_SCH     &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.709…\n$ PROX_TOP_PRIMARY_SCH &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.709…\n$ PROX_SHOPPING_MALL   &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.307…\n$ PROX_SUPERMARKET     &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.581…\n$ PROX_BUS_STOP        &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340, 0…\n$ NO_Of_UNITS          &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34, 3…\n$ FAMILY_FRIENDLY      &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD             &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n\n\n\nhead(condo_resale$LONGITUDE) #see the data in XCOORD column\n\n[1] 103.7802 103.8123 103.7971 103.8247 103.9505 103.9386\n\n\n\nhead(condo_resale$LATITUDE) #see the data in YCOORD column\n\n[1] 1.287145 1.328698 1.313727 1.308563 1.321437 1.314198\n\n\nNext, summary() of base R is used to display the summary statistics of cond_resale tibble data frame.\n\nsummary(condo_resale)\n\n    LATITUDE       LONGITUDE        POSTCODE      SELLING_PRICE     \n Min.   :1.240   Min.   :103.7   Min.   : 18965   Min.   :  540000  \n 1st Qu.:1.309   1st Qu.:103.8   1st Qu.:259849   1st Qu.: 1100000  \n Median :1.328   Median :103.8   Median :469298   Median : 1383222  \n Mean   :1.334   Mean   :103.8   Mean   :440439   Mean   : 1751211  \n 3rd Qu.:1.357   3rd Qu.:103.9   3rd Qu.:589486   3rd Qu.: 1950000  \n Max.   :1.454   Max.   :104.0   Max.   :828833   Max.   :18000000  \n    AREA_SQM          AGE           PROX_CBD       PROX_CHILDCARE    \n Min.   : 34.0   Min.   : 0.00   Min.   : 0.3869   Min.   :0.004927  \n 1st Qu.:103.0   1st Qu.: 5.00   1st Qu.: 5.5574   1st Qu.:0.174481  \n Median :121.0   Median :11.00   Median : 9.3567   Median :0.258135  \n Mean   :136.5   Mean   :12.14   Mean   : 9.3254   Mean   :0.326313  \n 3rd Qu.:156.0   3rd Qu.:18.00   3rd Qu.:12.6661   3rd Qu.:0.368293  \n Max.   :619.0   Max.   :37.00   Max.   :19.1804   Max.   :3.465726  \n PROX_ELDERLYCARE  PROX_URA_GROWTH_AREA PROX_HAWKER_MARKET PROX_KINDERGARTEN \n Min.   :0.05451   Min.   :0.2145       Min.   :0.05182    Min.   :0.004927  \n 1st Qu.:0.61254   1st Qu.:3.1643       1st Qu.:0.55245    1st Qu.:0.276345  \n Median :0.94179   Median :4.6186       Median :0.90842    Median :0.413385  \n Mean   :1.05351   Mean   :4.5981       Mean   :1.27987    Mean   :0.458903  \n 3rd Qu.:1.35122   3rd Qu.:5.7550       3rd Qu.:1.68578    3rd Qu.:0.578474  \n Max.   :3.94916   Max.   :9.1554       Max.   :5.37435    Max.   :2.229045  \n    PROX_MRT         PROX_PARK       PROX_PRIMARY_SCH  PROX_TOP_PRIMARY_SCH\n Min.   :0.05278   Min.   :0.02906   Min.   :0.07711   Min.   :0.07711     \n 1st Qu.:0.34646   1st Qu.:0.26211   1st Qu.:0.44024   1st Qu.:1.34451     \n Median :0.57430   Median :0.39926   Median :0.63505   Median :1.88213     \n Mean   :0.67316   Mean   :0.49802   Mean   :0.75471   Mean   :2.27347     \n 3rd Qu.:0.84844   3rd Qu.:0.65592   3rd Qu.:0.95104   3rd Qu.:2.90954     \n Max.   :3.48037   Max.   :2.16105   Max.   :3.92899   Max.   :6.74819     \n PROX_SHOPPING_MALL PROX_SUPERMARKET PROX_BUS_STOP       NO_Of_UNITS    \n Min.   :0.0000     Min.   :0.0000   Min.   :0.001595   Min.   :  18.0  \n 1st Qu.:0.5258     1st Qu.:0.3695   1st Qu.:0.098356   1st Qu.: 188.8  \n Median :0.9357     Median :0.5687   Median :0.151710   Median : 360.0  \n Mean   :1.0455     Mean   :0.6141   Mean   :0.193974   Mean   : 409.2  \n 3rd Qu.:1.3994     3rd Qu.:0.7862   3rd Qu.:0.220466   3rd Qu.: 590.0  \n Max.   :3.4774     Max.   :2.2441   Max.   :2.476639   Max.   :1703.0  \n FAMILY_FRIENDLY     FREEHOLD      LEASEHOLD_99YR  \n Min.   :0.0000   Min.   :0.0000   Min.   :0.0000  \n 1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:0.0000  \n Median :0.0000   Median :0.0000   Median :0.0000  \n Mean   :0.4868   Mean   :0.4227   Mean   :0.4882  \n 3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.:1.0000  \n Max.   :1.0000   Max.   :1.0000   Max.   :1.0000  \n\n\n\n\nConverting aspatial data frame into a sf object\nCurrently, the condo_resale tibble data frame is aspatial. We will convert it to a sf object. The code chunk below converts condo_resale data frame into a simple feature data frame by using st_as_sf() of sf packages.\n\ncondo_resale.sf &lt;- st_as_sf(condo_resale,\n                            coords = c(\"LONGITUDE\", \"LATITUDE\"),\n                            crs=4326) %&gt;%\n  st_transform(crs=3414)\n\nNotice that st_transform() of sf package is used to convert the coordinates from wgs84 (i.e. crs:4326) to svy21 (i.e. crs=3414).\nNext, head() is used to list the content of condo_resale.sf object.\n\nhead(condo_resale.sf)\n\nSimple feature collection with 6 features and 21 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 22085.12 ymin: 29951.54 xmax: 41042.56 ymax: 34546.2\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 6 × 22\n  POSTCODE SELLING_PRICE AREA_SQM   AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n     &lt;dbl&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;\n1   118635       3000000      309    30     7.94          0.166            2.52 \n2   288420       3880000      290    32     6.61          0.280            1.93 \n3   267833       3325000      248    33     6.90          0.429            0.502\n4   258380       4250000      127     7     4.04          0.395            1.99 \n5   467169       1400000      145    28    11.8           0.119            1.12 \n6   466472       1320000      139    22    10.3           0.125            0.789\n# ℹ 15 more variables: PROX_URA_GROWTH_AREA &lt;dbl&gt;, PROX_HAWKER_MARKET &lt;dbl&gt;,\n#   PROX_KINDERGARTEN &lt;dbl&gt;, PROX_MRT &lt;dbl&gt;, PROX_PARK &lt;dbl&gt;,\n#   PROX_PRIMARY_SCH &lt;dbl&gt;, PROX_TOP_PRIMARY_SCH &lt;dbl&gt;,\n#   PROX_SHOPPING_MALL &lt;dbl&gt;, PROX_SUPERMARKET &lt;dbl&gt;, PROX_BUS_STOP &lt;dbl&gt;,\n#   NO_Of_UNITS &lt;dbl&gt;, FAMILY_FRIENDLY &lt;dbl&gt;, FREEHOLD &lt;dbl&gt;,\n#   LEASEHOLD_99YR &lt;dbl&gt;, geometry &lt;POINT [m]&gt;\n\n\nNotice that the output is in point feature data frame."
  },
  {
    "objectID": "hands_on_ex4/hands_on_ex4.html#exploratory-data-analysis-eda",
    "href": "hands_on_ex4/hands_on_ex4.html#exploratory-data-analysis-eda",
    "title": "Hands-on Exercise 4 Calibrating Hedonic Pricing Model for Private Highrise Property with GWR Method",
    "section": "Exploratory Data Analysis (EDA)",
    "text": "Exploratory Data Analysis (EDA)\n\nEDA using statistical graphics\nWe can plot the distribution of SELLING_PRICE by using appropriate Exploratory Data Analysis (EDA) as shown in the code chunk below.\n\nggplot(data=condo_resale.sf, aes(x=`SELLING_PRICE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\n\n\n\nThe figure above reveals a right skewed distribution. This means that more condominium units were transacted at relative lower prices.\nStatistically, the skewed distribution can be normalised by using log transformation. The code chunk below is used to derive a new variable called LOG_SELLING_PRICE by using a log transformation on the variable SELLING_PRICE. It is performed using mutate() of dplyr package.\n\ncondo_resale.sf &lt;- condo_resale.sf %&gt;%\n  mutate(`LOG_SELLING_PRICE` = log(SELLING_PRICE))\n\nNow, you can plot the LOG_SELLING_PRICE using the code chunk below\n\nggplot(data=condo_resale.sf, aes(x=`LOG_SELLING_PRICE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\n\n\n\n\n\nMultiple Histogram Plots distribution of variables\nIn this section, I learn how to draw a small multiple histograms (also known as trellis plot) by using ggarrange() of ggpubr package.\nThe code chunk below is used to create 12 histograms. Then, ggarrange() is used to organised these histogram into a 3 columns by 4 rows small multiple plot.\n\nAREA_SQM &lt;- ggplot(data=condo_resale.sf, aes(x= `AREA_SQM`)) + \n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nAGE &lt;- ggplot(data=condo_resale.sf, aes(x= `AGE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_CBD &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_CBD`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_CHILDCARE &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_CHILDCARE`)) + \n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_ELDERLYCARE &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_ELDERLYCARE`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_URA_GROWTH_AREA &lt;- ggplot(data=condo_resale.sf, \n                               aes(x= `PROX_URA_GROWTH_AREA`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_HAWKER_MARKET &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_HAWKER_MARKET`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_KINDERGARTEN &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_KINDERGARTEN`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_MRT &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_MRT`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_PARK &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_PARK`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_PRIMARY_SCH &lt;- ggplot(data=condo_resale.sf, aes(x= `PROX_PRIMARY_SCH`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nPROX_TOP_PRIMARY_SCH &lt;- ggplot(data=condo_resale.sf, \n                               aes(x= `PROX_TOP_PRIMARY_SCH`)) +\n  geom_histogram(bins=20, color=\"black\", fill=\"light blue\")\n\nggarrange(AREA_SQM, AGE, PROX_CBD, PROX_CHILDCARE, PROX_ELDERLYCARE, \n          PROX_URA_GROWTH_AREA, PROX_HAWKER_MARKET, PROX_KINDERGARTEN, PROX_MRT,\n          PROX_PARK, PROX_PRIMARY_SCH, PROX_TOP_PRIMARY_SCH,  \n          ncol = 3, nrow = 4)\n\n\n\n\n\n\nDrawing Statistical Point Map\nLastly, we want to reveal the geospatial distribution condominium resale prices in Singapore. The map will be prepared by using tmap package.\nFirst, we will turn on the interactive mode of tmap by using the code chunk below.\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\n\nNext, the code chunks below is used to create an interactive point symbol map.\n\ntmap_options(check.and.fix = TRUE)\n\ntm_shape(mpsz_svy21)+\n  tm_polygons() +\ntm_shape(condo_resale.sf) +  \n  tm_dots(col = \"SELLING_PRICE\",\n          alpha = 0.6,\n          style=\"quantile\") +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting"
  },
  {
    "objectID": "hands_on_ex4/hands_on_ex4.html#hedonic-pricing-modelling-in-r",
    "href": "hands_on_ex4/hands_on_ex4.html#hedonic-pricing-modelling-in-r",
    "title": "Hands-on Exercise 4 Calibrating Hedonic Pricing Model for Private Highrise Property with GWR Method",
    "section": "Hedonic Pricing Modelling in R",
    "text": "Hedonic Pricing Modelling in R\n\nSimple Linear Regression Method\nFirst, we will build a simple linear regression model by using SELLING_PRICE as the dependent variable and AREA_SQM as the independent variable.\n\ncondo.slr &lt;- lm(formula=SELLING_PRICE ~ AREA_SQM, data = condo_resale.sf)\n\n\nsummary(condo.slr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM, data = condo_resale.sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3695815  -391764   -87517   258900 13503875 \n\nCoefficients:\n             Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept) -258121.1    63517.2  -4.064 5.09e-05 ***\nAREA_SQM      14719.0      428.1  34.381  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 942700 on 1434 degrees of freedom\nMultiple R-squared:  0.4518,    Adjusted R-squared:  0.4515 \nF-statistic:  1182 on 1 and 1434 DF,  p-value: &lt; 2.2e-16\n\n\nThe output report reveals that the SELLING_PRICE can be explained by using the formula:\n      *y = -258121.1 + 14719x1*\nThe R-squared of 0.4518 reveals that the simple regression model built is able to explain about 45% of the resale prices.\nSince p-value is much smaller than 0.0001, we will reject the null hypothesis that mean is a good estimator of SELLING_PRICE. This will allow us to infer that simple linear regression model above is a good estimator of SELLING_PRICE.\nThe Coefficients: section of the report reveals that the p-values of both the estimates of the Intercept and ARA_SQM are smaller than 0.001. In view of this, the null hypothesis of the B0 and B1 are equal to 0 will be rejected. As a results, we will be able to infer that the B0 and B1 are good parameter estimates.\nTo visualise the best fit curve on a scatterplot, we can incorporate lm() as a method function in ggplot’s geometry as shown in the code chunk below.\n\nggplot(data=condo_resale.sf,  \n       aes(x=`AREA_SQM`, y=`SELLING_PRICE`)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\n\n\nMultiple Linear Regression Method\n\nVisualising the relationships of the independent variables\n\ncorrplot(cor(condo_resale[, 5:23]), diag = FALSE, order = \"AOE\",\n         tl.pos = \"td\", tl.cex = 0.5, method = \"number\", type = \"upper\")\n\n\n\n\nFrom the scatterplot matrix, it is clear that Freehold is highly correlated to LEASE_99YEAR. In view of this, it is wiser to only include either one of them in the subsequent model building. As a result, LEASE_99YEAR is excluded in the subsequent model building.\n\n\n\nBuilding a hedonic pricing model using multiple linear regression method\nThe code chunk below using lm() to calibrate the multiple linear regression model.\n\ncondo.mlr &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE    + \n                  PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                  PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + PROX_KINDERGARTEN + \n                  PROX_MRT  + PROX_PARK + PROX_PRIMARY_SCH + \n                  PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n                  PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                data=condo_resale.sf)\nsummary(condo.mlr)\n\n\nCall:\nlm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + PROX_CHILDCARE + \n    PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_HAWKER_MARKET + \n    PROX_KINDERGARTEN + PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + \n    PROX_TOP_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_SUPERMARKET + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sf)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-3475964  -293923   -23069   241043 12260381 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(&gt;|t|)    \n(Intercept)           481728.40  121441.01   3.967 7.65e-05 ***\nAREA_SQM               12708.32     369.59  34.385  &lt; 2e-16 ***\nAGE                   -24440.82    2763.16  -8.845  &lt; 2e-16 ***\nPROX_CBD              -78669.78    6768.97 -11.622  &lt; 2e-16 ***\nPROX_CHILDCARE       -351617.91  109467.25  -3.212  0.00135 ** \nPROX_ELDERLYCARE      171029.42   42110.51   4.061 5.14e-05 ***\nPROX_URA_GROWTH_AREA   38474.53   12523.57   3.072  0.00217 ** \nPROX_HAWKER_MARKET     23746.10   29299.76   0.810  0.41782    \nPROX_KINDERGARTEN     147468.99   82668.87   1.784  0.07466 .  \nPROX_MRT             -314599.68   57947.44  -5.429 6.66e-08 ***\nPROX_PARK             563280.50   66551.68   8.464  &lt; 2e-16 ***\nPROX_PRIMARY_SCH      180186.08   65237.95   2.762  0.00582 ** \nPROX_TOP_PRIMARY_SCH    2280.04   20410.43   0.112  0.91107    \nPROX_SHOPPING_MALL   -206604.06   42840.60  -4.823 1.57e-06 ***\nPROX_SUPERMARKET      -44991.80   77082.64  -0.584  0.55953    \nPROX_BUS_STOP         683121.35  138353.28   4.938 8.85e-07 ***\nNO_Of_UNITS             -231.18      89.03  -2.597  0.00951 ** \nFAMILY_FRIENDLY       140340.77   47020.55   2.985  0.00289 ** \nFREEHOLD              359913.01   49220.22   7.312 4.38e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 755800 on 1417 degrees of freedom\nMultiple R-squared:  0.6518,    Adjusted R-squared:  0.6474 \nF-statistic: 147.4 on 18 and 1417 DF,  p-value: &lt; 2.2e-16\n\n\n\n\nPreparing Publication Quality Table: olsrr method\nWith reference to the report above, it is clear that not all the independent variables are statistically significant. We will revised the model by removing those variables which are not statistically significant.\nNow, we are ready to calibrate the revised model by using the code chunk below.\n\ncondo.mlr1 &lt;- lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                   PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE +\n                   PROX_URA_GROWTH_AREA + PROX_MRT  + PROX_PARK + \n                   PROX_PRIMARY_SCH + PROX_SHOPPING_MALL    + PROX_BUS_STOP + \n                   NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD,\n                 data=condo_resale.sf)\nols_regress(condo.mlr1)\n\n                             Model Summary                               \n------------------------------------------------------------------------\nR                       0.807       RMSE                     755957.289 \nR-Squared               0.651       Coef. Var                    43.168 \nAdj. R-Squared          0.647       MSE                571471422208.591 \nPred R-Squared          0.638       MAE                      414819.628 \n------------------------------------------------------------------------\n RMSE: Root Mean Square Error \n MSE: Mean Square Error \n MAE: Mean Absolute Error \n\n                                     ANOVA                                       \n--------------------------------------------------------------------------------\n                    Sum of                                                      \n                   Squares          DF         Mean Square       F         Sig. \n--------------------------------------------------------------------------------\nRegression    1.512586e+15          14        1.080418e+14    189.059    0.0000 \nResidual      8.120609e+14        1421    571471422208.591                      \nTotal         2.324647e+15        1435                                          \n--------------------------------------------------------------------------------\n\n                                               Parameter Estimates                                                \n-----------------------------------------------------------------------------------------------------------------\n               model           Beta    Std. Error    Std. Beta       t        Sig           lower          upper \n-----------------------------------------------------------------------------------------------------------------\n         (Intercept)     527633.222    108183.223                   4.877    0.000     315417.244     739849.200 \n            AREA_SQM      12777.523       367.479        0.584     34.771    0.000      12056.663      13498.382 \n                 AGE     -24687.739      2754.845       -0.167     -8.962    0.000     -30091.739     -19283.740 \n            PROX_CBD     -77131.323      5763.125       -0.263    -13.384    0.000     -88436.469     -65826.176 \n      PROX_CHILDCARE    -318472.751    107959.512       -0.084     -2.950    0.003    -530249.889    -106695.613 \n    PROX_ELDERLYCARE     185575.623     39901.864        0.090      4.651    0.000     107302.737     263848.510 \nPROX_URA_GROWTH_AREA      39163.254     11754.829        0.060      3.332    0.001      16104.571      62221.936 \n            PROX_MRT    -294745.107     56916.367       -0.112     -5.179    0.000    -406394.234    -183095.980 \n           PROX_PARK     570504.807     65507.029        0.150      8.709    0.000     442003.938     699005.677 \n    PROX_PRIMARY_SCH     159856.136     60234.599        0.062      2.654    0.008      41697.849     278014.424 \n  PROX_SHOPPING_MALL    -220947.251     36561.832       -0.115     -6.043    0.000    -292668.213    -149226.288 \n       PROX_BUS_STOP     682482.221    134513.243        0.134      5.074    0.000     418616.359     946348.082 \n         NO_Of_UNITS       -245.480        87.947       -0.053     -2.791    0.005       -418.000        -72.961 \n     FAMILY_FRIENDLY     146307.576     46893.021        0.057      3.120    0.002      54320.593     238294.560 \n            FREEHOLD     350599.812     48506.485        0.136      7.228    0.000     255447.802     445751.821 \n-----------------------------------------------------------------------------------------------------------------\n\n\n\n\nPreparing Publication Quality Table: gtsummary method\nThe gtsummary package provides an elegant and flexible way to create publication-ready summary tables in R.\nIn the code chunk below, tbl_regression() is used to create a well formatted regression report.\n\ntbl_regression(condo.mlr1, intercept = TRUE)\n\n\n\n\n\n  \n    \n    \n      Characteristic\n      Beta\n      95% CI1\n      p-value\n    \n  \n  \n    (Intercept)\n527,633\n315,417, 739,849\n&lt;0.001\n    AREA_SQM\n12,778\n12,057, 13,498\n&lt;0.001\n    AGE\n-24,688\n-30,092, -19,284\n&lt;0.001\n    PROX_CBD\n-77,131\n-88,436, -65,826\n&lt;0.001\n    PROX_CHILDCARE\n-318,473\n-530,250, -106,696\n0.003\n    PROX_ELDERLYCARE\n185,576\n107,303, 263,849\n&lt;0.001\n    PROX_URA_GROWTH_AREA\n39,163\n16,105, 62,222\n&lt;0.001\n    PROX_MRT\n-294,745\n-406,394, -183,096\n&lt;0.001\n    PROX_PARK\n570,505\n442,004, 699,006\n&lt;0.001\n    PROX_PRIMARY_SCH\n159,856\n41,698, 278,014\n0.008\n    PROX_SHOPPING_MALL\n-220,947\n-292,668, -149,226\n&lt;0.001\n    PROX_BUS_STOP\n682,482\n418,616, 946,348\n&lt;0.001\n    NO_Of_UNITS\n-245\n-418, -73\n0.005\n    FAMILY_FRIENDLY\n146,308\n54,321, 238,295\n0.002\n    FREEHOLD\n350,600\n255,448, 445,752\n&lt;0.001\n  \n  \n  \n    \n      1 CI = Confidence Interval\n    \n  \n\n\n\n\nWith gtsummary package, model statistics can be included in the report by either appending them to the report table by using add_glance_table() or adding as a table source note by using add_glance_source_note() as shown in the code chunk below.\n\ntbl_regression(condo.mlr1, \n               intercept = TRUE) %&gt;% \n  add_glance_source_note(\n    label = list(sigma ~ \"\\U03C3\"),\n    include = c(r.squared, adj.r.squared, \n                AIC, statistic,\n                p.value, sigma))\n\n\n\n\n\n  \n    \n    \n      Characteristic\n      Beta\n      95% CI1\n      p-value\n    \n  \n  \n    (Intercept)\n527,633\n315,417, 739,849\n&lt;0.001\n    AREA_SQM\n12,778\n12,057, 13,498\n&lt;0.001\n    AGE\n-24,688\n-30,092, -19,284\n&lt;0.001\n    PROX_CBD\n-77,131\n-88,436, -65,826\n&lt;0.001\n    PROX_CHILDCARE\n-318,473\n-530,250, -106,696\n0.003\n    PROX_ELDERLYCARE\n185,576\n107,303, 263,849\n&lt;0.001\n    PROX_URA_GROWTH_AREA\n39,163\n16,105, 62,222\n&lt;0.001\n    PROX_MRT\n-294,745\n-406,394, -183,096\n&lt;0.001\n    PROX_PARK\n570,505\n442,004, 699,006\n&lt;0.001\n    PROX_PRIMARY_SCH\n159,856\n41,698, 278,014\n0.008\n    PROX_SHOPPING_MALL\n-220,947\n-292,668, -149,226\n&lt;0.001\n    PROX_BUS_STOP\n682,482\n418,616, 946,348\n&lt;0.001\n    NO_Of_UNITS\n-245\n-418, -73\n0.005\n    FAMILY_FRIENDLY\n146,308\n54,321, 238,295\n0.002\n    FREEHOLD\n350,600\n255,448, 445,752\n&lt;0.001\n  \n  \n    \n      R² = 0.651; Adjusted R² = 0.647; AIC = 42,967; Statistic = 189; p-value = &lt;0.001; σ = 755,957\n    \n  \n  \n    \n      1 CI = Confidence Interval\n    \n  \n\n\n\n\n\nChecking for multicolinearity\nIn this section, I learn a fantastic R package specially programmed for performing OLS regression. It is called olsrr. It provides a collection of very useful methods for building better multiple linear regression models:\n\ncomprehensive regression output\nresidual diagnostics\nmeasures of influence\nheteroskedasticity tests\ncollinearity diagnostics\nmodel fit assessment\nvariable contribution assessment\nvariable selection procedures\n\nIn the code chunk below, the ols_vif_tol() of olsrr package is used to test if there are sign of multicollinearity.\n\nols_vif_tol(condo.mlr1)\n\n              Variables Tolerance      VIF\n1              AREA_SQM 0.8728554 1.145665\n2                   AGE 0.7071275 1.414172\n3              PROX_CBD 0.6356147 1.573280\n4        PROX_CHILDCARE 0.3066019 3.261559\n5      PROX_ELDERLYCARE 0.6598479 1.515501\n6  PROX_URA_GROWTH_AREA 0.7510311 1.331503\n7              PROX_MRT 0.5236090 1.909822\n8             PROX_PARK 0.8279261 1.207837\n9      PROX_PRIMARY_SCH 0.4524628 2.210126\n10   PROX_SHOPPING_MALL 0.6738795 1.483945\n11        PROX_BUS_STOP 0.3514118 2.845664\n12          NO_Of_UNITS 0.6901036 1.449058\n13      FAMILY_FRIENDLY 0.7244157 1.380423\n14             FREEHOLD 0.6931163 1.442759\n\n\nSince the VIF of the independent variables are less than 10. We can safely conclude that there are no sign of multicollinearity among the independent variables.\n\n\nTest for Non-Linearity\nIn multiple linear regression, it is important for us to test the assumption that linearity and additivity of the relationship between dependent and independent variables.\nIn the code chunk below, the ols_plot_resid_fit() of olsrr package is used to perform linearity assumption test.\n\nols_plot_resid_fit(condo.mlr1)\n\n\n\n\nThe figure above reveals that most of the data poitns are scattered around the 0 line, hence we can safely conclude that the relationships between the dependent variable and independent variables are linear.\n\n\nTest for Normality Assumption\nLastly, the code chunk below uses ols_plot_resid_hist() of olsrr package to perform normality assumption test.\n\nols_plot_resid_hist(condo.mlr1)\n\n\n\n\nThe figure reveals that the residual of the multiple linear regression model (i.e. condo.mlr1) is resemble normal distribution.\nIf I prefer formal statistical test methods, the ols_test_normality() of olsrr package can be used as shown in the code chun below.\n\nols_test_normality(condo.mlr1)\n\nWarning in ks.test.default(y, \"pnorm\", mean(y), sd(y)): ties should not be\npresent for the Kolmogorov-Smirnov test\n\n\n-----------------------------------------------\n       Test             Statistic       pvalue  \n-----------------------------------------------\nShapiro-Wilk              0.6856         0.0000 \nKolmogorov-Smirnov        0.1366         0.0000 \nCramer-von Mises         121.0768        0.0000 \nAnderson-Darling         67.9551         0.0000 \n-----------------------------------------------\n\n\nThe summary table above reveals that the p-values of the four tests are way smaller than the alpha value of 0.05. Hence we will reject the null hypothesis and infer that there is statistical evidence that the residual are not normally distributed.\n\n\nTesting for Spatial Autocorrelation\nThe hedonic model we try to build are using geographically referenced attributes, hence it is also important for us to visual the residual of the hedonic pricing model.\nIn order to perform spatial autocorrelation test, we need to convert condo_resale.sf from sf data frame into a SpatialPointsDataFrame.\nFirst, we will export the residual of the hedonic pricing model and save it as a data frame.\n\nmlr.output &lt;- as.data.frame(condo.mlr1$residuals)\n\nNext, we will join the newly created data frame with condo_resale.sf object.\n\ncondo_resale.res.sf &lt;- cbind(condo_resale.sf, \n                        condo.mlr1$residuals) %&gt;%\nrename(`MLR_RES` = `condo.mlr1.residuals`)\n\nNext, we will convert condo_resale.res.sf from simple feature object into a SpatialPointsDataFrame because spdep package can only process sp conformed spatial data objects.\nThe code chunk below will be used to perform the data conversion process.\n\ncondo_resale.sp &lt;- as_Spatial(condo_resale.res.sf)\ncondo_resale.sp\n\nclass       : SpatialPointsDataFrame \nfeatures    : 1436 \nextent      : 14940.85, 43352.45, 24765.67, 48382.81  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 23\nnames       : POSTCODE, SELLING_PRICE, AREA_SQM, AGE,    PROX_CBD, PROX_CHILDCARE, PROX_ELDERLYCARE, PROX_URA_GROWTH_AREA, PROX_HAWKER_MARKET, PROX_KINDERGARTEN,    PROX_MRT,   PROX_PARK, PROX_PRIMARY_SCH, PROX_TOP_PRIMARY_SCH, PROX_SHOPPING_MALL, ... \nmin values  :    18965,        540000,       34,   0, 0.386916393,    0.004927023,      0.054508623,          0.214539508,        0.051817113,       0.004927023, 0.052779424, 0.029064164,      0.077106132,          0.077106132,                  0, ... \nmax values  :   828833,       1.8e+07,      619,  37, 19.18042832,     3.46572633,      3.949157205,           9.15540001,        5.374348075,       2.229045366,  3.48037319,  2.16104919,      3.928989144,          6.748192062,        3.477433767, ... \n\n\next, we will use tmap package to display the distribution of the residuals on an interactive map.\nThe code churn below will turn on the interactive mode of tmap.\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\n\nThe code chunks below is used to create an interactive point symbol map.\n\ntm_shape(mpsz_svy21)+\n  tmap_options(check.and.fix = TRUE) +\n  tm_polygons(alpha = 0.4) +\ntm_shape(condo_resale.res.sf) +  \n  tm_dots(col = \"MLR_RES\",\n          alpha = 0.6,\n          style=\"quantile\") +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\nVariable(s) \"MLR_RES\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\nRemember to switch back to “plot” mode before continue.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\nThe figure above reveal that there is sign of spatial autocorrelation.\nTo proof that our observation is indeed true, the Moran’s I test will be performed\nFirst, we will compute the distance-based weight matrix by using dnearneigh() function of spdep.\n\nnb &lt;- dnearneigh(coordinates(condo_resale.sp), 0, 1500, longlat = FALSE)\nsummary(nb)\n\nNeighbour list object:\nNumber of regions: 1436 \nNumber of nonzero links: 66266 \nPercentage nonzero weights: 3.213526 \nAverage number of links: 46.14624 \n10 disjoint connected subgraphs\nLink number distribution:\n\n  1   3   5   7   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24 \n  3   3   9   4   3  15  10  19  17  45  19   5  14  29  19   6  35  45  18  47 \n 25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44 \n 16  43  22  26  21  11   9  23  22  13  16  25  21  37  16  18   8  21   4  12 \n 45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64 \n  8  36  18  14  14  43  11  12   8  13  12  13   4   5   6  12  11  20  29  33 \n 65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 \n 15  20  10  14  15  15  11  16  12  10   8  19  12  14   9   8   4  13  11   6 \n 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 \n  4   9   4   4   4   6   2  16   9   4   5   9   3   9   4   2   1   2   1   1 \n105 106 107 108 109 110 112 116 125 \n  1   5   9   2   1   3   1   1   1 \n3 least connected regions:\n193 194 277 with 1 link\n1 most connected region:\n285 with 125 links\n\n\nNext, nb2listw() of spdep packge will be used to convert the output neighbours lists (i.e. nb) into a spatial weights\n\nnb_lw &lt;- nb2listw(nb, style = 'W')\nsummary(nb_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 1436 \nNumber of nonzero links: 66266 \nPercentage nonzero weights: 3.213526 \nAverage number of links: 46.14624 \n10 disjoint connected subgraphs\nLink number distribution:\n\n  1   3   5   7   9  10  11  12  13  14  15  16  17  18  19  20  21  22  23  24 \n  3   3   9   4   3  15  10  19  17  45  19   5  14  29  19   6  35  45  18  47 \n 25  26  27  28  29  30  31  32  33  34  35  36  37  38  39  40  41  42  43  44 \n 16  43  22  26  21  11   9  23  22  13  16  25  21  37  16  18   8  21   4  12 \n 45  46  47  48  49  50  51  52  53  54  55  56  57  58  59  60  61  62  63  64 \n  8  36  18  14  14  43  11  12   8  13  12  13   4   5   6  12  11  20  29  33 \n 65  66  67  68  69  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84 \n 15  20  10  14  15  15  11  16  12  10   8  19  12  14   9   8   4  13  11   6 \n 85  86  87  88  89  90  91  92  93  94  95  96  97  98  99 100 101 102 103 104 \n  4   9   4   4   4   6   2  16   9   4   5   9   3   9   4   2   1   2   1   1 \n105 106 107 108 109 110 112 116 125 \n  1   5   9   2   1   3   1   1   1 \n3 least connected regions:\n193 194 277 with 1 link\n1 most connected region:\n285 with 125 links\n\nWeights style: W \nWeights constants summary:\n     n      nn   S0       S1       S2\nW 1436 2062096 1436 94.81916 5798.341\n\n\nNext, lm.morantest() of spdep package will be used to perform Moran’s I test for residual spatial autocorrelation\n\nlm.morantest(condo.mlr1, nb_lw)\n\n\n    Global Moran I for regression residuals\n\ndata:  \nmodel: lm(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD +\nPROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + PROX_MRT +\nPROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP +\nNO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, data = condo_resale.sf)\nweights: nb_lw\n\nMoran I statistic standard deviate = 24.366, p-value &lt; 2.2e-16\nalternative hypothesis: greater\nsample estimates:\nObserved Moran I      Expectation         Variance \n    1.438876e-01    -5.487594e-03     3.758259e-05 \n\n\nThe Global Moran’s I test for residual spatial autocorrelation shows that it’s p-value is less than 0.00000000000000022 which is less than the alpha value of 0.05. Hence, we will reject the null hypothesis that the residuals are randomly distributed.\nSince the Observed Global Moran I = 0.1424418 which is greater than 0, we can infer than the residuals resemble cluster distribution."
  },
  {
    "objectID": "hands_on_ex4/hands_on_ex4.html#building-hedonic-pricing-models-using-gwmodel",
    "href": "hands_on_ex4/hands_on_ex4.html#building-hedonic-pricing-models-using-gwmodel",
    "title": "Hands-on Exercise 4 Calibrating Hedonic Pricing Model for Private Highrise Property with GWR Method",
    "section": "Building Hedonic Pricing Models using GWmodel",
    "text": "Building Hedonic Pricing Models using GWmodel\nIn this section, I learn how to modelling hedonic pricing using both the fixed and adaptive bandwidth schemes.\n\nBuilding Fixed Bandwidth GWR Model\n\nComputing fixed bandwith\nIn the code chunk below bw.gwr() of GWModel package is used to determine the optimal fixed bandwidth to use in the model. Notice that the argument adaptive is set to FALSE indicates that we are interested to compute the fixed bandwidth.\nThere are two possible approaches can be uused to determine the stopping rule, they are: CV cross-validation approach and AIC corrected (AICc) approach. We define the stopping rule using approach argeement.\n\nbw.fixed &lt;- bw.gwr(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n                     PROX_CHILDCARE + PROX_ELDERLYCARE  + PROX_URA_GROWTH_AREA + \n                     PROX_MRT   + PROX_PARK + PROX_PRIMARY_SCH + \n                     PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_Of_UNITS + \n                     FAMILY_FRIENDLY + FREEHOLD, \n                   data=condo_resale.sp, \n                   approach=\"CV\", \n                   kernel=\"gaussian\", \n                   adaptive=FALSE, \n                   longlat=FALSE)\n\nFixed bandwidth: 17660.96 CV score: 8.259118e+14 \nFixed bandwidth: 10917.26 CV score: 7.970454e+14 \nFixed bandwidth: 6749.419 CV score: 7.273273e+14 \nFixed bandwidth: 4173.553 CV score: 6.300006e+14 \nFixed bandwidth: 2581.58 CV score: 5.404958e+14 \nFixed bandwidth: 1597.687 CV score: 4.857515e+14 \nFixed bandwidth: 989.6077 CV score: 4.722431e+14 \nFixed bandwidth: 613.7939 CV score: 1.378294e+16 \nFixed bandwidth: 1221.873 CV score: 4.778717e+14 \nFixed bandwidth: 846.0596 CV score: 4.791629e+14 \nFixed bandwidth: 1078.325 CV score: 4.751406e+14 \nFixed bandwidth: 934.7772 CV score: 4.72518e+14 \nFixed bandwidth: 1023.495 CV score: 4.730305e+14 \nFixed bandwidth: 968.6643 CV score: 4.721317e+14 \nFixed bandwidth: 955.7206 CV score: 4.722072e+14 \nFixed bandwidth: 976.6639 CV score: 4.721387e+14 \nFixed bandwidth: 963.7202 CV score: 4.721484e+14 \nFixed bandwidth: 971.7199 CV score: 4.721293e+14 \nFixed bandwidth: 973.6083 CV score: 4.721309e+14 \nFixed bandwidth: 970.5527 CV score: 4.721295e+14 \nFixed bandwidth: 972.4412 CV score: 4.721296e+14 \nFixed bandwidth: 971.2741 CV score: 4.721292e+14 \nFixed bandwidth: 970.9985 CV score: 4.721293e+14 \nFixed bandwidth: 971.4443 CV score: 4.721292e+14 \nFixed bandwidth: 971.5496 CV score: 4.721293e+14 \nFixed bandwidth: 971.3793 CV score: 4.721292e+14 \nFixed bandwidth: 971.3391 CV score: 4.721292e+14 \nFixed bandwidth: 971.3143 CV score: 4.721292e+14 \nFixed bandwidth: 971.3545 CV score: 4.721292e+14 \nFixed bandwidth: 971.3296 CV score: 4.721292e+14 \nFixed bandwidth: 971.345 CV score: 4.721292e+14 \nFixed bandwidth: 971.3355 CV score: 4.721292e+14 \nFixed bandwidth: 971.3413 CV score: 4.721292e+14 \nFixed bandwidth: 971.3377 CV score: 4.721292e+14 \nFixed bandwidth: 971.34 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \nFixed bandwidth: 971.3408 CV score: 4.721292e+14 \nFixed bandwidth: 971.3403 CV score: 4.721292e+14 \nFixed bandwidth: 971.3406 CV score: 4.721292e+14 \nFixed bandwidth: 971.3404 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \nFixed bandwidth: 971.3405 CV score: 4.721292e+14 \n\n\n\n\n\n\n\n\nNote\n\n\n\nThe result shows that the recommended bandwidth is 971.3405 metres. (Quiz: Do you know why it is in metre?)\nThe bandwidth value is in meters because it represents a spatial distance or scale within which the neighboring data points are considered to have an impact on the prediction or estimation of the dependent variable (SELLING_PRICE in this case) in this model.\n\n\n\n\nGWModel method - fixed bandwith\nNow we can use the code chunk below to calibrate the gwr model using fixed bandwidth and gaussian kernel.\n\ngwr.fixed &lt;- gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n                         PROX_CHILDCARE + PROX_ELDERLYCARE  + PROX_URA_GROWTH_AREA + \n                         PROX_MRT   + PROX_PARK + PROX_PRIMARY_SCH + \n                         PROX_SHOPPING_MALL + PROX_BUS_STOP + NO_Of_UNITS + \n                         FAMILY_FRIENDLY + FREEHOLD, \n                       data=condo_resale.sp, \n                       bw=bw.fixed, \n                       kernel = 'gaussian', \n                       longlat = FALSE)\n\nThe output is saved in a list of class “gwrm”. The code below can be used to display the model output.\n\ngwr.fixed\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2023-12-16 16:39:23.320807 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sp, bw = bw.fixed, kernel = \"gaussian\", \n    longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_Of_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_Of_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Fixed bandwidth: 971.3405 \n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -3.5988e+07 -5.1998e+05  7.6780e+05  1.7412e+06\n   AREA_SQM              1.0003e+03  5.2758e+03  7.4740e+03  1.2301e+04\n   AGE                  -1.3475e+05 -2.0813e+04 -8.6260e+03 -3.7784e+03\n   PROX_CBD             -7.7047e+07 -2.3608e+05 -8.3600e+04  3.4646e+04\n   PROX_CHILDCARE       -6.0097e+06 -3.3667e+05 -9.7425e+04  2.9007e+05\n   PROX_ELDERLYCARE     -3.5000e+06 -1.5970e+05  3.1971e+04  1.9577e+05\n   PROX_URA_GROWTH_AREA -3.0170e+06 -8.2013e+04  7.0749e+04  2.2612e+05\n   PROX_MRT             -3.5282e+06 -6.5836e+05 -1.8833e+05  3.6922e+04\n   PROX_PARK            -1.2062e+06 -2.1732e+05  3.5383e+04  4.1335e+05\n   PROX_PRIMARY_SCH     -2.2695e+07 -1.7066e+05  4.8472e+04  5.1555e+05\n   PROX_SHOPPING_MALL   -7.2585e+06 -1.6684e+05 -1.0517e+04  1.5923e+05\n   PROX_BUS_STOP        -1.4676e+06 -4.5207e+04  3.7601e+05  1.1664e+06\n   NO_Of_UNITS          -1.3170e+03 -2.4822e+02 -3.0846e+01  2.5496e+02\n   FAMILY_FRIENDLY      -2.2749e+06 -1.1140e+05  7.6214e+03  1.6107e+05\n   FREEHOLD             -9.2067e+06  3.8073e+04  1.5169e+05  3.7528e+05\n                             Max.\n   Intercept            112793548\n   AREA_SQM                 21575\n   AGE                     434201\n   PROX_CBD               2704596\n   PROX_CHILDCARE         1654087\n   PROX_ELDERLYCARE      38867814\n   PROX_URA_GROWTH_AREA  78515730\n   PROX_MRT               3124316\n   PROX_PARK             18122425\n   PROX_PRIMARY_SCH       4637503\n   PROX_SHOPPING_MALL     1529952\n   PROX_BUS_STOP         11342182\n   NO_Of_UNITS              12907\n   FAMILY_FRIENDLY        1720744\n   FREEHOLD               6073636\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 438.3804 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 997.6196 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 42263.61 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 41632.36 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 42515.71 \n   Residual sum of squares: 2.53407e+14 \n   R-square value:  0.8909912 \n   Adjusted R-square value:  0.8430417 \n\n   ***********************************************************************\n   Program stops at: 2023-12-16 16:39:24.056934 \n\n\n\n\n\nBuilding Adaptive Bandwidth GWR Model\nIn this section, I will calibrate the gwr-based hedonic pricing model by using adaptive bandwidth approach.\n\nComputing the adaptive bandwidth\nSimilar to the earlier section, we will first use bw.gwr() to determine the recommended data point to use.\nThe code chunk used look very similar to the one used to compute the fixed bandwidth except the adaptive argument has changed to TRUE.\n\nbw.adaptive &lt;- bw.gwr(formula = SELLING_PRICE ~ AREA_SQM + AGE  + \n                        PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE    + \n                        PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                        PROX_PRIMARY_SCH + PROX_SHOPPING_MALL   + PROX_BUS_STOP + \n                        NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                      data=condo_resale.sp, \n                      approach=\"CV\", \n                      kernel=\"gaussian\", \n                      adaptive=TRUE, \n                      longlat=FALSE)\n\nAdaptive bandwidth: 895 CV score: 7.952401e+14 \nAdaptive bandwidth: 561 CV score: 7.667364e+14 \nAdaptive bandwidth: 354 CV score: 6.953454e+14 \nAdaptive bandwidth: 226 CV score: 6.15223e+14 \nAdaptive bandwidth: 147 CV score: 5.674373e+14 \nAdaptive bandwidth: 98 CV score: 5.426745e+14 \nAdaptive bandwidth: 68 CV score: 5.168117e+14 \nAdaptive bandwidth: 49 CV score: 4.859631e+14 \nAdaptive bandwidth: 37 CV score: 4.646518e+14 \nAdaptive bandwidth: 30 CV score: 4.422088e+14 \nAdaptive bandwidth: 25 CV score: 4.430816e+14 \nAdaptive bandwidth: 32 CV score: 4.505602e+14 \nAdaptive bandwidth: 27 CV score: 4.462172e+14 \nAdaptive bandwidth: 30 CV score: 4.422088e+14 \n\n\nThe result shows that the 30 is the recommended data points to be used.\n\n\nConstructing the adaptive bandwidth gwr model\nNow, we can go ahead to calibrate the gwr-based hedonic pricing model by using adaptive bandwidth and gaussian kernel as shown in the code chunk below.\n\ngwr.adaptive &lt;- gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + \n                            PROX_CBD + PROX_CHILDCARE + PROX_ELDERLYCARE + \n                            PROX_URA_GROWTH_AREA + PROX_MRT + PROX_PARK + \n                            PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + PROX_BUS_STOP + \n                            NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n                          data=condo_resale.sp, bw=bw.adaptive, \n                          kernel = 'gaussian', \n                          adaptive=TRUE, \n                          longlat = FALSE)\n\nThe code below can be used to display the model output.\n\ngwr.adaptive\n\n   ***********************************************************************\n   *                       Package   GWmodel                             *\n   ***********************************************************************\n   Program starts at: 2023-12-16 16:39:29.761012 \n   Call:\n   gwr.basic(formula = SELLING_PRICE ~ AREA_SQM + AGE + PROX_CBD + \n    PROX_CHILDCARE + PROX_ELDERLYCARE + PROX_URA_GROWTH_AREA + \n    PROX_MRT + PROX_PARK + PROX_PRIMARY_SCH + PROX_SHOPPING_MALL + \n    PROX_BUS_STOP + NO_Of_UNITS + FAMILY_FRIENDLY + FREEHOLD, \n    data = condo_resale.sp, bw = bw.adaptive, kernel = \"gaussian\", \n    adaptive = TRUE, longlat = FALSE)\n\n   Dependent (y) variable:  SELLING_PRICE\n   Independent variables:  AREA_SQM AGE PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE PROX_URA_GROWTH_AREA PROX_MRT PROX_PARK PROX_PRIMARY_SCH PROX_SHOPPING_MALL PROX_BUS_STOP NO_Of_UNITS FAMILY_FRIENDLY FREEHOLD\n   Number of data points: 1436\n   ***********************************************************************\n   *                    Results of Global Regression                     *\n   ***********************************************************************\n\n   Call:\n    lm(formula = formula, data = data)\n\n   Residuals:\n     Min       1Q   Median       3Q      Max \n-3470778  -298119   -23481   248917 12234210 \n\n   Coefficients:\n                          Estimate Std. Error t value Pr(&gt;|t|)    \n   (Intercept)           527633.22  108183.22   4.877 1.20e-06 ***\n   AREA_SQM               12777.52     367.48  34.771  &lt; 2e-16 ***\n   AGE                   -24687.74    2754.84  -8.962  &lt; 2e-16 ***\n   PROX_CBD              -77131.32    5763.12 -13.384  &lt; 2e-16 ***\n   PROX_CHILDCARE       -318472.75  107959.51  -2.950 0.003231 ** \n   PROX_ELDERLYCARE      185575.62   39901.86   4.651 3.61e-06 ***\n   PROX_URA_GROWTH_AREA   39163.25   11754.83   3.332 0.000885 ***\n   PROX_MRT             -294745.11   56916.37  -5.179 2.56e-07 ***\n   PROX_PARK             570504.81   65507.03   8.709  &lt; 2e-16 ***\n   PROX_PRIMARY_SCH      159856.14   60234.60   2.654 0.008046 ** \n   PROX_SHOPPING_MALL   -220947.25   36561.83  -6.043 1.93e-09 ***\n   PROX_BUS_STOP         682482.22  134513.24   5.074 4.42e-07 ***\n   NO_Of_UNITS             -245.48      87.95  -2.791 0.005321 ** \n   FAMILY_FRIENDLY       146307.58   46893.02   3.120 0.001845 ** \n   FREEHOLD              350599.81   48506.48   7.228 7.98e-13 ***\n\n   ---Significance stars\n   Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 \n   Residual standard error: 756000 on 1421 degrees of freedom\n   Multiple R-squared: 0.6507\n   Adjusted R-squared: 0.6472 \n   F-statistic: 189.1 on 14 and 1421 DF,  p-value: &lt; 2.2e-16 \n   ***Extra Diagnostic information\n   Residual sum of squares: 8.120609e+14\n   Sigma(hat): 752522.9\n   AIC:  42966.76\n   AICc:  42967.14\n   BIC:  41731.39\n   ***********************************************************************\n   *          Results of Geographically Weighted Regression              *\n   ***********************************************************************\n\n   *********************Model calibration information*********************\n   Kernel function: gaussian \n   Adaptive bandwidth: 30 (number of nearest neighbours)\n   Regression points: the same locations as observations are used.\n   Distance metric: Euclidean distance metric is used.\n\n   ****************Summary of GWR coefficient estimates:******************\n                               Min.     1st Qu.      Median     3rd Qu.\n   Intercept            -1.3487e+08 -2.4669e+05  7.7928e+05  1.6194e+06\n   AREA_SQM              3.3188e+03  5.6285e+03  7.7825e+03  1.2738e+04\n   AGE                  -9.6746e+04 -2.9288e+04 -1.4043e+04 -5.6119e+03\n   PROX_CBD             -2.5330e+06 -1.6256e+05 -7.7242e+04  2.6624e+03\n   PROX_CHILDCARE       -1.2790e+06 -2.0175e+05  8.7158e+03  3.7778e+05\n   PROX_ELDERLYCARE     -1.6212e+06 -9.2050e+04  6.1029e+04  2.8184e+05\n   PROX_URA_GROWTH_AREA -7.2686e+06 -3.0350e+04  4.5869e+04  2.4613e+05\n   PROX_MRT             -4.3781e+07 -6.7282e+05 -2.2115e+05 -7.4593e+04\n   PROX_PARK            -2.9020e+06 -1.6782e+05  1.1601e+05  4.6572e+05\n   PROX_PRIMARY_SCH     -8.6418e+05 -1.6627e+05 -7.7853e+03  4.3222e+05\n   PROX_SHOPPING_MALL   -1.8272e+06 -1.3175e+05 -1.4049e+04  1.3799e+05\n   PROX_BUS_STOP        -2.0579e+06 -7.1461e+04  4.1104e+05  1.2071e+06\n   NO_Of_UNITS          -2.1993e+03 -2.3685e+02 -3.4699e+01  1.1657e+02\n   FAMILY_FRIENDLY      -5.9879e+05 -5.0927e+04  2.6173e+04  2.2481e+05\n   FREEHOLD             -1.6340e+05  4.0765e+04  1.9023e+05  3.7960e+05\n                            Max.\n   Intercept            18758355\n   AREA_SQM                23064\n   AGE                     13303\n   PROX_CBD             11346650\n   PROX_CHILDCARE        2892127\n   PROX_ELDERLYCARE      2465671\n   PROX_URA_GROWTH_AREA  7384059\n   PROX_MRT              1186242\n   PROX_PARK             2588497\n   PROX_PRIMARY_SCH      3381462\n   PROX_SHOPPING_MALL   38038564\n   PROX_BUS_STOP        12081592\n   NO_Of_UNITS              1010\n   FAMILY_FRIENDLY       2072414\n   FREEHOLD              1813995\n   ************************Diagnostic information*************************\n   Number of data points: 1436 \n   Effective number of parameters (2trace(S) - trace(S'S)): 350.3088 \n   Effective degrees of freedom (n-2trace(S) + trace(S'S)): 1085.691 \n   AICc (GWR book, Fotheringham, et al. 2002, p. 61, eq 2.33): 41982.22 \n   AIC (GWR book, Fotheringham, et al. 2002,GWR p. 96, eq. 4.22): 41546.74 \n   BIC (GWR book, Fotheringham, et al. 2002,GWR p. 61, eq. 2.34): 41914.08 \n   Residual sum of squares: 2.528227e+14 \n   R-square value:  0.8912425 \n   Adjusted R-square value:  0.8561185 \n\n   ***********************************************************************\n   Program stops at: 2023-12-16 16:39:30.791218 \n\n\nThe report shows that the AICc the adaptive distance gwr is 41982.22 which is even smaller than the AICc of the fixed distance gwr of 42263.61.\n\n\n\nVisualising GWR Output\n\n\nConverting SDF into sf data.frame\nTo visualise the fields in SDF, we need to first covert it into sf data.frame by using the code chunk below.\n\ncondo_resale.sf.adaptive &lt;- st_as_sf(gwr.adaptive$SDF) %&gt;%\n  st_transform(crs=3414)\n\n\ncondo_resale.sf.adaptive.svy21 &lt;- st_transform(condo_resale.sf.adaptive, 3414)\ncondo_resale.sf.adaptive.svy21  \n\nSimple feature collection with 1436 features and 51 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14940.85 ymin: 24765.67 xmax: 43352.45 ymax: 48382.81\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n    Intercept  AREA_SQM        AGE  PROX_CBD PROX_CHILDCARE PROX_ELDERLYCARE\n1   2050011.7  9561.892  -9514.634 -120681.9      319266.92       -393417.79\n2   1633128.2 16576.853 -58185.479 -149434.2      441102.18        325188.74\n3   3433608.2 13091.861 -26707.386 -259397.8     -120116.82        535855.81\n4    234358.9 20730.601 -93308.988 2426853.7      480825.28        314783.72\n5   2285804.9  6722.836 -17608.018 -316835.5       90764.78       -137384.61\n6  -3568877.4  6039.581 -26535.592  327306.1     -152531.19       -700392.85\n7  -2874842.4 16843.575 -59166.727 -983577.2     -177810.50       -122384.02\n8   2038086.0  6905.135 -17681.897 -285076.6       70259.40        -96012.78\n9   1718478.4  9580.703 -14401.128  105803.4     -657698.02       -123276.00\n10  3457054.0 14072.011 -31579.884 -234895.4       79961.45        548581.04\n   PROX_URA_GROWTH_AREA    PROX_MRT  PROX_PARK PROX_PRIMARY_SCH\n1            -159980.20  -299742.96 -172104.47        242668.03\n2            -142290.39 -2510522.23  523379.72       1106830.66\n3            -253621.21  -936853.28  209099.85        571462.33\n4           -2679297.89 -2039479.50 -759153.26       3127477.21\n5             303714.81   -44567.05  -10284.62         30413.56\n6             -28051.25   733566.47 1511488.92        320878.23\n7            1397676.38 -2745430.34  710114.74       1786570.95\n8             269368.71   -14552.99   73533.34         53359.73\n9            -361974.72  -476785.32 -132067.59        -40128.92\n10           -150024.38 -1503835.53  574155.47        108996.67\n   PROX_SHOPPING_MALL PROX_BUS_STOP  NO_Of_UNITS FAMILY_FRIENDLY  FREEHOLD\n1          300881.390     1210615.4  104.8290640       -9075.370  303955.6\n2          -87693.378     1843587.2 -288.3441183      310074.664  396221.3\n3         -126732.712     1411924.9   -9.5532945        5949.746  168821.7\n4          -29593.342     7225577.5 -161.3551620     1556178.531 1212515.6\n5           -7490.586      677577.0   42.2659674       58986.951  328175.2\n6          258583.881     1086012.6 -214.3671271      201992.641  471873.1\n7         -384251.210     5094060.5   -0.9212521      359659.512  408871.9\n8          -39634.902      735767.1   30.1741069       55602.506  347075.0\n9          276718.757     2815772.4  675.1615559      -30453.297  503872.8\n10        -454726.822     2123557.0  -21.3044311     -100935.586  213324.6\n         y    yhat    residual CV_Score Stud_residual Intercept_SE AREA_SQM_SE\n1  3000000 2886532   113468.16        0    0.38207013     516105.5    823.2860\n2  3880000 3466801   413198.52        0    1.01433140     488083.5    825.2380\n3  3325000 3616527  -291527.20        0   -0.83780678     963711.4    988.2240\n4  4250000 5435482 -1185481.63        0   -2.84614670     444185.5    617.4007\n5  1400000 1388166    11834.26        0    0.03404453    2119620.6   1376.2778\n6  1320000 1516702  -196701.94        0   -0.72065800   28572883.7   2348.0091\n7  3410000 3266881   143118.77        0    0.41291992     679546.6    893.5893\n8  1420000 1431955   -11955.27        0   -0.03033109    2217773.1   1415.2604\n9  2025000 1832799   192200.83        0    0.52018109     814281.8    943.8434\n10 2550000 2223364   326635.53        0    1.10559735    2410252.0   1271.4073\n      AGE_SE PROX_CBD_SE PROX_CHILDCARE_SE PROX_ELDERLYCARE_SE\n1   5889.782    37411.22          319111.1           120633.34\n2   6226.916    23615.06          299705.3            84546.69\n3   6510.236    56103.77          349128.5           129687.07\n4   6010.511   469337.41          304965.2           127150.69\n5   8180.361   410644.47          698720.6           327371.55\n6  14601.909  5272846.47         1141599.8          1653002.19\n7   8970.629   346164.20          530101.1           148598.71\n8   8661.309   438035.69          742532.8           399221.05\n9  11791.208    89148.35          704630.7           329683.30\n10  9941.980   173532.77          500976.2           281876.74\n   PROX_URA_GROWTH_AREA_SE PROX_MRT_SE PROX_PARK_SE PROX_PRIMARY_SCH_SE\n1                 56207.39    185181.3     205499.6            152400.7\n2                 76956.50    281133.9     229358.7            165150.7\n3                 95774.60    275483.7     314124.3            196662.6\n4                470762.12    279877.1     227249.4            240878.9\n5                474339.56    363830.0     364580.9            249087.7\n6               5496627.21    730453.2    1741712.0            683265.5\n7                371692.97    375511.9     297400.9            344602.8\n8                517977.91    423155.4     440984.4            261251.2\n9                153436.22    285325.4     304998.4            278258.5\n10               239182.57    571355.7     599131.8            331284.8\n   PROX_SHOPPING_MALL_SE PROX_BUS_STOP_SE NO_Of_UNITS_SE FAMILY_FRIENDLY_SE\n1               109268.8         600668.6       218.1258           131474.7\n2                98906.8         410222.1       208.9410           114989.1\n3               119913.3         464156.7       210.9828           146607.2\n4               177104.1         562810.8       361.7767           108726.6\n5               301032.9         740922.4       299.5034           160663.7\n6              2931208.6        1418333.3       602.5571           331727.0\n7               249969.5         821236.4       532.1978           129241.2\n8               351634.0         775038.4       338.6777           171895.1\n9               289872.7         850095.5       439.9037           220223.4\n10              265529.7         631399.2       259.0169           189125.5\n   FREEHOLD_SE Intercept_TV AREA_SQM_TV     AGE_TV PROX_CBD_TV\n1     115954.0    3.9720784   11.614302  -1.615447 -3.22582173\n2     130110.0    3.3460017   20.087361  -9.344188 -6.32792021\n3     141031.5    3.5629010   13.247868  -4.102368 -4.62353528\n4     138239.1    0.5276150   33.577223 -15.524302  5.17080808\n5     210641.1    1.0784029    4.884795  -2.152474 -0.77155660\n6     374347.3   -0.1249043    2.572214  -1.817269  0.06207388\n7     182216.9   -4.2305303   18.849348  -6.595605 -2.84136028\n8     216649.4    0.9189786    4.879056  -2.041481 -0.65080678\n9     220473.7    2.1104224   10.150733  -1.221345  1.18682383\n10    206346.2    1.4343123   11.068059  -3.176418 -1.35360852\n   PROX_CHILDCARE_TV PROX_ELDERLYCARE_TV PROX_URA_GROWTH_AREA_TV PROX_MRT_TV\n1         1.00048819          -3.2612693            -2.846248368 -1.61864578\n2         1.47178634           3.8462625            -1.848971738 -8.92998600\n3        -0.34404755           4.1319138            -2.648105057 -3.40075727\n4         1.57665606           2.4756745            -5.691404992 -7.28705261\n5         0.12990138          -0.4196596             0.640289855 -0.12249416\n6        -0.13361179          -0.4237096            -0.005103357  1.00426206\n7        -0.33542751          -0.8235874             3.760298131 -7.31116712\n8         0.09462126          -0.2405003             0.520038994 -0.03439159\n9        -0.93339393          -0.3739225            -2.359121712 -1.67102293\n10        0.15961128           1.9461735            -0.627237944 -2.63204802\n   PROX_PARK_TV PROX_PRIMARY_SCH_TV PROX_SHOPPING_MALL_TV PROX_BUS_STOP_TV\n1   -0.83749312           1.5923022            2.75358842        2.0154464\n2    2.28192684           6.7019454           -0.88662640        4.4941192\n3    0.66565951           2.9058009           -1.05686949        3.0419145\n4   -3.34061770          12.9836105           -0.16709578       12.8383775\n5   -0.02820944           0.1220998           -0.02488294        0.9145046\n6    0.86781794           0.4696245            0.08821750        0.7656963\n7    2.38773567           5.1844351           -1.53719231        6.2029165\n8    0.16674816           0.2042469           -0.11271635        0.9493299\n9   -0.43301073          -0.1442145            0.95462153        3.3123012\n10   0.95831249           0.3290120           -1.71252687        3.3632555\n   NO_Of_UNITS_TV FAMILY_FRIENDLY_TV FREEHOLD_TV  Local_R2\n1     0.480589953        -0.06902748    2.621347 0.8846744\n2    -1.380026395         2.69655779    3.045280 0.8899773\n3    -0.045279967         0.04058290    1.197050 0.8947007\n4    -0.446007570        14.31276425    8.771149 0.9073605\n5     0.141120178         0.36714544    1.557983 0.9510057\n6    -0.355762335         0.60891234    1.260522 0.9247586\n7    -0.001731033         2.78285441    2.243875 0.8310458\n8     0.089093858         0.32346758    1.602012 0.9463936\n9     1.534793921        -0.13828365    2.285410 0.8380365\n10   -0.082251138        -0.53369623    1.033819 0.9080753\n                    geometry\n1  POINT (22085.12 29951.54)\n2   POINT (25656.84 34546.2)\n3   POINT (23963.99 32890.8)\n4  POINT (27044.28 32319.77)\n5  POINT (41042.56 33743.64)\n6   POINT (39717.04 32943.1)\n7   POINT (28419.1 33513.37)\n8  POINT (40763.57 33879.61)\n9  POINT (23595.63 28884.78)\n10 POINT (24586.56 33194.31)\n\n\n\ngwr.adaptive.output &lt;- as.data.frame(gwr.adaptive$SDF)\ncondo_resale.sf.adaptive &lt;- cbind(condo_resale.res.sf, as.matrix(gwr.adaptive.output))\n\n\nglimpse(condo_resale.sf.adaptive)\n\nRows: 1,436\nColumns: 77\n$ POSTCODE                &lt;dbl&gt; 118635, 288420, 267833, 258380, 467169, 466472…\n$ SELLING_PRICE           &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1…\n$ AREA_SQM                &lt;dbl&gt; 309, 290, 248, 127, 145, 139, 218, 141, 165, 1…\n$ AGE                     &lt;dbl&gt; 30, 32, 33, 7, 28, 22, 24, 24, 27, 31, 17, 22,…\n$ PROX_CBD                &lt;dbl&gt; 7.941259, 6.609797, 6.898000, 4.038861, 11.783…\n$ PROX_CHILDCARE          &lt;dbl&gt; 0.16597932, 0.28027246, 0.42922669, 0.39473543…\n$ PROX_ELDERLYCARE        &lt;dbl&gt; 2.5198118, 1.9333338, 0.5021395, 1.9910316, 1.…\n$ PROX_URA_GROWTH_AREA    &lt;dbl&gt; 6.618741, 7.505109, 6.463887, 4.906512, 6.4106…\n$ PROX_HAWKER_MARKET      &lt;dbl&gt; 1.76542207, 0.54507614, 0.37789301, 1.68259969…\n$ PROX_KINDERGARTEN       &lt;dbl&gt; 0.05835552, 0.61592412, 0.14120309, 0.38200076…\n$ PROX_MRT                &lt;dbl&gt; 0.5607188, 0.6584461, 0.3053433, 0.6910183, 0.…\n$ PROX_PARK               &lt;dbl&gt; 1.1710446, 0.1992269, 0.2779886, 0.9832843, 0.…\n$ PROX_PRIMARY_SCH        &lt;dbl&gt; 1.6340256, 0.9747834, 1.4715016, 1.4546324, 0.…\n$ PROX_TOP_PRIMARY_SCH    &lt;dbl&gt; 3.3273195, 0.9747834, 1.4715016, 2.3006394, 0.…\n$ PROX_SHOPPING_MALL      &lt;dbl&gt; 2.2102717, 2.9374279, 1.2256850, 0.3525671, 1.…\n$ PROX_SUPERMARKET        &lt;dbl&gt; 0.9103958, 0.5900617, 0.4135583, 0.4162219, 0.…\n$ PROX_BUS_STOP           &lt;dbl&gt; 0.10336166, 0.28673408, 0.28504777, 0.29872340…\n$ NO_Of_UNITS             &lt;dbl&gt; 18, 20, 27, 30, 30, 31, 32, 32, 32, 32, 34, 34…\n$ FAMILY_FRIENDLY         &lt;dbl&gt; 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 0, 0, 0, 0…\n$ FREEHOLD                &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1…\n$ LEASEHOLD_99YR          &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ LOG_SELLING_PRICE       &lt;dbl&gt; 14.91412, 15.17135, 15.01698, 15.26243, 14.151…\n$ MLR_RES                 &lt;dbl&gt; -1489099.55, 415494.57, 194129.69, 1088992.71,…\n$ Intercept               &lt;dbl&gt; 2050011.67, 1633128.24, 3433608.17, 234358.91,…\n$ AREA_SQM.1              &lt;dbl&gt; 9561.892, 16576.853, 13091.861, 20730.601, 672…\n$ AGE.1                   &lt;dbl&gt; -9514.634, -58185.479, -26707.386, -93308.988,…\n$ PROX_CBD.1              &lt;dbl&gt; -120681.94, -149434.22, -259397.77, 2426853.66…\n$ PROX_CHILDCARE.1        &lt;dbl&gt; 319266.925, 441102.177, -120116.816, 480825.28…\n$ PROX_ELDERLYCARE.1      &lt;dbl&gt; -393417.795, 325188.741, 535855.806, 314783.72…\n$ PROX_URA_GROWTH_AREA.1  &lt;dbl&gt; -159980.203, -142290.389, -253621.206, -267929…\n$ PROX_MRT.1              &lt;dbl&gt; -299742.96, -2510522.23, -936853.28, -2039479.…\n$ PROX_PARK.1             &lt;dbl&gt; -172104.47, 523379.72, 209099.85, -759153.26, …\n$ PROX_PRIMARY_SCH.1      &lt;dbl&gt; 242668.03, 1106830.66, 571462.33, 3127477.21, …\n$ PROX_SHOPPING_MALL.1    &lt;dbl&gt; 300881.390, -87693.378, -126732.712, -29593.34…\n$ PROX_BUS_STOP.1         &lt;dbl&gt; 1210615.44, 1843587.22, 1411924.90, 7225577.51…\n$ NO_Of_UNITS.1           &lt;dbl&gt; 104.8290640, -288.3441183, -9.5532945, -161.35…\n$ FAMILY_FRIENDLY.1       &lt;dbl&gt; -9075.370, 310074.664, 5949.746, 1556178.531, …\n$ FREEHOLD.1              &lt;dbl&gt; 303955.61, 396221.27, 168821.75, 1212515.58, 3…\n$ y                       &lt;dbl&gt; 3000000, 3880000, 3325000, 4250000, 1400000, 1…\n$ yhat                    &lt;dbl&gt; 2886531.8, 3466801.5, 3616527.2, 5435481.6, 13…\n$ residual                &lt;dbl&gt; 113468.16, 413198.52, -291527.20, -1185481.63,…\n$ CV_Score                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…\n$ Stud_residual           &lt;dbl&gt; 0.38207013, 1.01433140, -0.83780678, -2.846146…\n$ Intercept_SE            &lt;dbl&gt; 516105.5, 488083.5, 963711.4, 444185.5, 211962…\n$ AREA_SQM_SE             &lt;dbl&gt; 823.2860, 825.2380, 988.2240, 617.4007, 1376.2…\n$ AGE_SE                  &lt;dbl&gt; 5889.782, 6226.916, 6510.236, 6010.511, 8180.3…\n$ PROX_CBD_SE             &lt;dbl&gt; 37411.22, 23615.06, 56103.77, 469337.41, 41064…\n$ PROX_CHILDCARE_SE       &lt;dbl&gt; 319111.1, 299705.3, 349128.5, 304965.2, 698720…\n$ PROX_ELDERLYCARE_SE     &lt;dbl&gt; 120633.34, 84546.69, 129687.07, 127150.69, 327…\n$ PROX_URA_GROWTH_AREA_SE &lt;dbl&gt; 56207.39, 76956.50, 95774.60, 470762.12, 47433…\n$ PROX_MRT_SE             &lt;dbl&gt; 185181.3, 281133.9, 275483.7, 279877.1, 363830…\n$ PROX_PARK_SE            &lt;dbl&gt; 205499.6, 229358.7, 314124.3, 227249.4, 364580…\n$ PROX_PRIMARY_SCH_SE     &lt;dbl&gt; 152400.7, 165150.7, 196662.6, 240878.9, 249087…\n$ PROX_SHOPPING_MALL_SE   &lt;dbl&gt; 109268.8, 98906.8, 119913.3, 177104.1, 301032.…\n$ PROX_BUS_STOP_SE        &lt;dbl&gt; 600668.6, 410222.1, 464156.7, 562810.8, 740922…\n$ NO_Of_UNITS_SE          &lt;dbl&gt; 218.1258, 208.9410, 210.9828, 361.7767, 299.50…\n$ FAMILY_FRIENDLY_SE      &lt;dbl&gt; 131474.73, 114989.07, 146607.22, 108726.62, 16…\n$ FREEHOLD_SE             &lt;dbl&gt; 115954.0, 130110.0, 141031.5, 138239.1, 210641…\n$ Intercept_TV            &lt;dbl&gt; 3.9720784, 3.3460017, 3.5629010, 0.5276150, 1.…\n$ AREA_SQM_TV             &lt;dbl&gt; 11.614302, 20.087361, 13.247868, 33.577223, 4.…\n$ AGE_TV                  &lt;dbl&gt; -1.6154474, -9.3441881, -4.1023685, -15.524301…\n$ PROX_CBD_TV             &lt;dbl&gt; -3.22582173, -6.32792021, -4.62353528, 5.17080…\n$ PROX_CHILDCARE_TV       &lt;dbl&gt; 1.000488185, 1.471786337, -0.344047555, 1.5766…\n$ PROX_ELDERLYCARE_TV     &lt;dbl&gt; -3.26126929, 3.84626245, 4.13191383, 2.4756745…\n$ PROX_URA_GROWTH_AREA_TV &lt;dbl&gt; -2.846248368, -1.848971738, -2.648105057, -5.6…\n$ PROX_MRT_TV             &lt;dbl&gt; -1.61864578, -8.92998600, -3.40075727, -7.2870…\n$ PROX_PARK_TV            &lt;dbl&gt; -0.83749312, 2.28192684, 0.66565951, -3.340617…\n$ PROX_PRIMARY_SCH_TV     &lt;dbl&gt; 1.59230221, 6.70194543, 2.90580089, 12.9836104…\n$ PROX_SHOPPING_MALL_TV   &lt;dbl&gt; 2.753588422, -0.886626400, -1.056869486, -0.16…\n$ PROX_BUS_STOP_TV        &lt;dbl&gt; 2.0154464, 4.4941192, 3.0419145, 12.8383775, 0…\n$ NO_Of_UNITS_TV          &lt;dbl&gt; 0.480589953, -1.380026395, -0.045279967, -0.44…\n$ FAMILY_FRIENDLY_TV      &lt;dbl&gt; -0.06902748, 2.69655779, 0.04058290, 14.312764…\n$ FREEHOLD_TV             &lt;dbl&gt; 2.6213469, 3.0452799, 1.1970499, 8.7711485, 1.…\n$ Local_R2                &lt;dbl&gt; 0.8846744, 0.8899773, 0.8947007, 0.9073605, 0.…\n$ coords.x1               &lt;dbl&gt; 22085.12, 25656.84, 23963.99, 27044.28, 41042.…\n$ coords.x2               &lt;dbl&gt; 29951.54, 34546.20, 32890.80, 32319.77, 33743.…\n$ geometry                &lt;POINT [m]&gt; POINT (22085.12 29951.54), POINT (25656.…\n\n\n\nsummary(gwr.adaptive$SDF$yhat)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n  171347  1102001  1385528  1751842  1982307 13887901 \n\n\n\n\nVisualising local R2\nThe code chunks below is used to create an interactive point symbol map.\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\ntm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"Local_R2\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\n\n\n\n\n\n\n\nVisualising coefficient estimates\nThe code chunks below is used to create an interactive point symbol map.\n\ntmap_mode(\"view\")\n\ntmap mode set to interactive viewing\n\nAREA_SQM_SE &lt;- tm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"AREA_SQM_SE\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\nAREA_SQM_TV &lt;- tm_shape(mpsz_svy21)+\n  tm_polygons(alpha = 0.1) +\ntm_shape(condo_resale.sf.adaptive) +  \n  tm_dots(col = \"AREA_SQM_TV\",\n          border.col = \"gray60\",\n          border.lwd = 1) +\n  tm_view(set.zoom.limits = c(11,14))\n\ntmap_arrange(AREA_SQM_SE, AREA_SQM_TV, \n             asp=1, ncol=2,\n             sync = TRUE)\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\nWarning: The shape mpsz_svy21 is invalid (after reprojection). See\nsf::st_is_valid\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\n\n\nBy URA Plannign Region\n\ntm_shape(mpsz_svy21[mpsz_svy21$REGION_N==\"CENTRAL REGION\", ])+\n  tm_polygons()+\ntm_shape(condo_resale.sf.adaptive) + \n  tm_bubbles(col = \"Local_R2\",\n           size = 0.15,\n           border.col = \"gray60\",\n           border.lwd = 1)\n\nWarning: The shape mpsz_svy21[mpsz_svy21$REGION_N == \"CENTRAL REGION\", ] is\ninvalid. See sf::st_is_valid"
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ISSS624",
    "section": "",
    "text": "Welcome to ISSS624 Geospatial Analytics Application.\nIn this webpage, I am going to share with you my learning journey!"
  },
  {
    "objectID": "in_class_ex1/data/geospatial/MPSZ-2019.html",
    "href": "in_class_ex1/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "in_class_ex1/in_class_ex1.html",
    "href": "in_class_ex1/in_class_ex1.html",
    "title": "In-Class_Ex1",
    "section": "",
    "text": "The code chunk below load the following packages:\n\ntmap for thematic mapping\nsf for geospatial data handling\ntidyverse for non-spatial data handling\n**Pacman**\n\n\npacman::p_load(tmap, sf, tidyverse)"
  },
  {
    "objectID": "in_class_ex1/in_class_ex1.html#getting-started",
    "href": "in_class_ex1/in_class_ex1.html#getting-started",
    "title": "In-Class_Ex1",
    "section": "",
    "text": "The code chunk below load the following packages:\n\ntmap for thematic mapping\nsf for geospatial data handling\ntidyverse for non-spatial data handling\n**Pacman**\n\n\npacman::p_load(tmap, sf, tidyverse)"
  },
  {
    "objectID": "in_class_ex1/in_class_ex1.html#preparing-the-data",
    "href": "in_class_ex1/in_class_ex1.html#preparing-the-data",
    "title": "In-Class_Ex1",
    "section": "Preparing the data",
    "text": "Preparing the data"
  },
  {
    "objectID": "in_class_ex1/in_class_ex1.html#importing-the-00-data",
    "href": "in_class_ex1/in_class_ex1.html#importing-the-00-data",
    "title": "In-Class_Ex1",
    "section": "Importing the 00 data",
    "text": "Importing the 00 data\nFirstly, we will import the “Passenger Volume by Origin Destination Bus Stops” data set downloaded from LTA Datamall by using ‘read.csv()’ of readr package\n\nobus &lt;- read.csv(\"data/aspatial/origin_destination_bus_202308.csv\")\n\n\nobus$ORIGIN_PT_CODE &lt;- as.factor(obus$ORIGIN_PT_CODE)\nobus$DESTINATION_PT_CODE &lt;- as.factor(obus$DESTINATION_PT_CODE)\n\n\noritrip_7_9 &lt;- obus %&gt;% filter(DAY_TYPE == \"WEEKDAY\") %&gt;%   \n  filter(TIME_PER_HOUR &gt;= 7 & TIME_PER_HOUR &lt;=9) %&gt;%   \n  group_by(ORIGIN_PT_CODE)%&gt;%   summarise(TRIPS = sum(TOTAL_TRIPS))\n\nImport bus stop\n\nbusstop &lt;- st_read(dsn = \"data/geospatial\", layer = \"BusStop\") %&gt;%   st_transform(crs = 3414)\n\nReading layer `BusStop' from data source \n  `C:\\czx0727\\ISSS624_\\in_class_ex1\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 5161 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82\nProjected CRS: SVY21\n\n\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MPSZ-2019\") %&gt;%   st_transform(crs = 3414)\n\nReading layer `MPSZ-2019' from data source \n  `C:\\czx0727\\ISSS624_\\in_class_ex1\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\n\nmpsz\n\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N\n1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION\n2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION\n3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION\n4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION\n5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION\n6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION\n7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION\n8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION\n9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION\n10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION\n   REGION_C                       geometry\n1        CR MULTIPOLYGON (((33222.98 29...\n2        CR MULTIPOLYGON (((28481.45 30...\n3        CR MULTIPOLYGON (((28087.34 30...\n4        WR MULTIPOLYGON (((14557.7 304...\n5        CR MULTIPOLYGON (((29542.53 31...\n6        CR MULTIPOLYGON (((35279.55 30...\n7        WR MULTIPOLYGON (((15772.59 21...\n8        WR MULTIPOLYGON (((19843.41 21...\n9        CR MULTIPOLYGON (((30870.53 22...\n10       CR MULTIPOLYGON (((26879.04 26..."
  },
  {
    "objectID": "in_class_ex1/in_class_ex1_updated.html",
    "href": "in_class_ex1/in_class_ex1_updated.html",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Science",
    "section": "",
    "text": "In this in-class exercise, you are required to prepare a choropleth map showing the distribution of passenger trips at planning sub-zone by integrating Passenger Volume by Origin Destination Bus Stops and bus stop data sets downloaded from LTA DataMall and Planning Sub-zone boundary of URA Master Plan 2019 downloaded from data.gov.sg.\nThe specific task of this in-class exercise are as follows:\n\nto import Passenger Volume by Origin Destination Bus Stops data set downloaded from LTA DataMall in to RStudio environment,\nto import geospatial data in ESRI shapefile format into sf data frame format,\nto perform data wrangling by using appropriate functions from tidyverse and sf pakcges, and\nto visualise the distribution of passenger trip by using tmap methods and functions."
  },
  {
    "objectID": "in_class_ex1/in_class_ex1_updated.html#the-task",
    "href": "in_class_ex1/in_class_ex1_updated.html#the-task",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Science",
    "section": "",
    "text": "In this in-class exercise, you are required to prepare a choropleth map showing the distribution of passenger trips at planning sub-zone by integrating Passenger Volume by Origin Destination Bus Stops and bus stop data sets downloaded from LTA DataMall and Planning Sub-zone boundary of URA Master Plan 2019 downloaded from data.gov.sg.\nThe specific task of this in-class exercise are as follows:\n\nto import Passenger Volume by Origin Destination Bus Stops data set downloaded from LTA DataMall in to RStudio environment,\nto import geospatial data in ESRI shapefile format into sf data frame format,\nto perform data wrangling by using appropriate functions from tidyverse and sf pakcges, and\nto visualise the distribution of passenger trip by using tmap methods and functions."
  },
  {
    "objectID": "in_class_ex1/in_class_ex1_updated.html#getting-started",
    "href": "in_class_ex1/in_class_ex1_updated.html#getting-started",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Science",
    "section": "Getting Started",
    "text": "Getting Started\nThree R packages will be used in this in-class exercise, they are:\n\ntidyverse for non-spatial data handling,\nsf for geospatial data handling,\ntmap for thematic mapping, and\nknitr for creating html table.\n\n\npacman::p_load(tmap, sf, tidyverse, knitr)"
  },
  {
    "objectID": "in_class_ex1/in_class_ex1_updated.html#importing-the-od-data",
    "href": "in_class_ex1/in_class_ex1_updated.html#importing-the-od-data",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Science",
    "section": "Importing the OD data",
    "text": "Importing the OD data\nFirstly, we will import the Passenger Volume by Origin Destination Bus Stops data set downloaded from LTA DataMall by using read_csv() of readr package.\n\nodbus &lt;- read_csv(\"data/aspatial/origin_destination_bus_202308.csv\")\n\nRows: 5709512 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): YEAR_MONTH, DAY_TYPE, PT_TYPE, ORIGIN_PT_CODE, DESTINATION_PT_CODE\ndbl (2): TIME_PER_HOUR, TOTAL_TRIPS\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nA quick check of odbus tibble data frame shows that the values in OROGIN_PT_CODE and DESTINATON_PT_CODE are in numeric data type.\n\nglimpse(odbus)\n\nRows: 5,709,512\nColumns: 7\n$ YEAR_MONTH          &lt;chr&gt; \"2023-08\", \"2023-08\", \"2023-08\", \"2023-08\", \"2023-…\n$ DAY_TYPE            &lt;chr&gt; \"WEEKDAY\", \"WEEKENDS/HOLIDAY\", \"WEEKENDS/HOLIDAY\",…\n$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 17, 7, 17, 14, 10, 10,…\n$ PT_TYPE             &lt;chr&gt; \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"…\n$ ORIGIN_PT_CODE      &lt;chr&gt; \"04168\", \"04168\", \"80119\", \"80119\", \"44069\", \"4406…\n$ DESTINATION_PT_CODE &lt;chr&gt; \"10051\", \"10051\", \"90079\", \"90079\", \"17229\", \"1722…\n$ TOTAL_TRIPS         &lt;dbl&gt; 7, 2, 3, 10, 5, 4, 3, 22, 3, 3, 7, 1, 3, 1, 3, 1, …\n\n\n\nodbus$ORIGIN_PT_CODE &lt;- as.factor(odbus$ORIGIN_PT_CODE)\nodbus$DESTINATION_PT_CODE &lt;- as.factor(odbus$DESTINATION_PT_CODE) \n\nNotice that both of them are in factor data type now.\n\nglimpse(odbus)\n\nRows: 5,709,512\nColumns: 7\n$ YEAR_MONTH          &lt;chr&gt; \"2023-08\", \"2023-08\", \"2023-08\", \"2023-08\", \"2023-…\n$ DAY_TYPE            &lt;chr&gt; \"WEEKDAY\", \"WEEKENDS/HOLIDAY\", \"WEEKENDS/HOLIDAY\",…\n$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 17, 7, 17, 14, 10, 10,…\n$ PT_TYPE             &lt;chr&gt; \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"…\n$ ORIGIN_PT_CODE      &lt;fct&gt; 04168, 04168, 80119, 80119, 44069, 44069, 20281, 2…\n$ DESTINATION_PT_CODE &lt;fct&gt; 10051, 10051, 90079, 90079, 17229, 17229, 20141, 2…\n$ TOTAL_TRIPS         &lt;dbl&gt; 7, 2, 3, 10, 5, 4, 3, 22, 3, 3, 7, 1, 3, 1, 3, 1, …\n\n\n\nExtracting the study data\n\norigin7_9 &lt;- odbus %&gt;%\n  filter(DAY_TYPE == \"WEEKDAY\") %&gt;%\n  filter(TIME_PER_HOUR &gt;= 7 &\n           TIME_PER_HOUR &lt;= 9) %&gt;%\n  group_by(ORIGIN_PT_CODE) %&gt;%\n  summarise(TRIPS = sum(TOTAL_TRIPS))\n\nIt should look similar to the data table below.\n\nkable(head(origin7_9))\n\n\n\n\nORIGIN_PT_CODE\nTRIPS\n\n\n\n\n01012\n1617\n\n\n01013\n813\n\n\n01019\n1620\n\n\n01029\n2383\n\n\n01039\n2727\n\n\n01059\n1415\n\n\n\n\n\nWe will save the output in rds format for future used.\n\nwrite_rds(origin7_9, \"data/origin7_9.rds\")\n\nThe code chunk below will be used to import the save origin7_9.rds into R environment.\n\norigin7_9 &lt;- read_rds(\"data/origin7_9.rds\")"
  },
  {
    "objectID": "in_class_ex1/in_class_ex1_updated.html#working-with-geospatial-data",
    "href": "in_class_ex1/in_class_ex1_updated.html#working-with-geospatial-data",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Science",
    "section": "Working with Geospatial Data",
    "text": "Working with Geospatial Data\nIn this section, you are required to import two shapefile into RStudio, they are:\n\nBusStop: This data provides the location of bus stop as at last quarter of 2022.\nMPSZ-2019: This data provides the sub-zone boundary of URA Master Plan 2019.\n\n\nImporting geospatial data\n\nbusstop &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"BusStop\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `BusStop' from data source \n  `C:\\czx0727\\ISSS624_\\in_class_ex1\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 5161 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82\nProjected CRS: SVY21\n\n\n\nglimpse(busstop)\n\nRows: 5,161\nColumns: 4\n$ BUS_STOP_N &lt;chr&gt; \"22069\", \"32071\", \"44331\", \"96081\", \"11561\", \"66191\", \"2338…\n$ BUS_ROOF_N &lt;chr&gt; \"B06\", \"B23\", \"B01\", \"B05\", \"B05\", \"B03\", \"B02A\", \"B02\", \"B…\n$ LOC_DESC   &lt;chr&gt; \"OPP CEVA LOGISTICS\", \"AFT TRACK 13\", \"BLK 239\", \"GRACE IND…\n$ geometry   &lt;POINT [m]&gt; POINT (13576.31 32883.65), POINT (13228.59 44206.38),…\n\n\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"MPSZ-2019\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `MPSZ-2019' from data source \n  `C:\\czx0727\\ISSS624_\\in_class_ex1\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\nThe structure of mpsz sf tibble data frame should look as below.\n\nglimpse(mpsz)\n\nRows: 332\nColumns: 7\n$ SUBZONE_N  &lt;chr&gt; \"MARINA EAST\", \"INSTITUTION HILL\", \"ROBERTSON QUAY\", \"JURON…\n$ SUBZONE_C  &lt;chr&gt; \"MESZ01\", \"RVSZ05\", \"SRSZ01\", \"WISZ01\", \"MUSZ02\", \"MPSZ05\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA EAST\", \"RIVER VALLEY\", \"SINGAPORE RIVER\", \"WESTERN …\n$ PLN_AREA_C &lt;chr&gt; \"ME\", \"RV\", \"SR\", \"WI\", \"MU\", \"MP\", \"WI\", \"WI\", \"SI\", \"SI\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"WEST…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"WR\", \"CR\", \"CR\", \"WR\", \"WR\", \"CR\", \"CR\",…\n$ geometry   &lt;MULTIPOLYGON [m]&gt; MULTIPOLYGON (((33222.98 29..., MULTIPOLYGON (…"
  },
  {
    "objectID": "in_class_ex1/in_class_ex1_updated.html#geospatial-data-wrangling",
    "href": "in_class_ex1/in_class_ex1_updated.html#geospatial-data-wrangling",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Science",
    "section": "Geospatial data wrangling",
    "text": "Geospatial data wrangling\n\nCombining Busstop and mpsz\n\nbusstop_mpsz &lt;- st_intersection(busstop, mpsz) %&gt;%\n  select(BUS_STOP_N, SUBZONE_C) %&gt;%\n  st_drop_geometry()\n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\n\nBefore moving to the next step, it is wise to save the output into rds format.\n\nwrite_rds(busstop_mpsz, \"data/busstop_mpsz.csv\")  \n\n\norigin_data &lt;- left_join(origin7_9 , busstop_mpsz,\n            by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\")) %&gt;%\n  rename(ORIGIN_BS = ORIGIN_PT_CODE,\n         ORIGIN_SZ = SUBZONE_C)\n\nBefore continue, it is a good practice for us to check for duplicating records.\n\nduplicate &lt;- origin_data %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\nIf duplicated records are found, the code chunk below will be used to retain the unique records.\n\norigin_data &lt;- unique(origin_data)\n\n\nmpsz_origtrip &lt;- left_join(mpsz, \n                           origin_data,\n                           by = c(\"SUBZONE_C\" = \"ORIGIN_SZ\"))"
  },
  {
    "objectID": "in_class_ex1/in_class_ex1_updated.html#choropleth-visualisation",
    "href": "in_class_ex1/in_class_ex1_updated.html#choropleth-visualisation",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Science",
    "section": "Choropleth Visualisation",
    "text": "Choropleth Visualisation\n\ntm_shape(mpsz_origtrip)+\n  tm_fill(\"TRIPS\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Passenger trips\") +\n  tm_layout(main.title = \"Passenger trips generated at planning sub-zone level\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2) +\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \n             position = c(\"left\", \"bottom\"))"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.1.html",
    "href": "in_class_ex2/in_class_ex2.1.html",
    "title": "In Class Exercise 2: Emerging Hot Spot Analysis: sfdep methods",
    "section": "",
    "text": "Five R packages will be used in this in-class exercise.\nPlease note that plotly is used in this hands-on exercise:\n\npacman::p_load(tmap, sf, tidyverse, knitr, sfdep, plotly)\n\nTo take note on the learning points for this hands-on exercise\nEmerging Hot Spot Analysis (EHSA) is a spatio-temporal analysis method for revealing and describing how hot spot and cold spot areas evolve over time. The analysis consist of four main steps:\n\nBuilding a space-time cube,\nCalculating Getis-Ord local Gi* statistic for each bin by using an FDR correction,\nEvaluating these hot and cold spot trends by using Mann-Kendall trend test,\nCategorising each study area location by referring to the resultant trend z-score and p-value for each location with data, and with the hot spot z-score and p-value for each bin."
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.1.html#import-geospatial-data",
    "href": "in_class_ex2/in_class_ex2.1.html#import-geospatial-data",
    "title": "In Class Exercise 2: Emerging Hot Spot Analysis: sfdep methods",
    "section": "Import geospatial data",
    "text": "Import geospatial data\n\nhunan &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\czx0727\\ISSS624_\\in_class_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.1.html#import-apatial-data",
    "href": "in_class_ex2/in_class_ex2.1.html#import-apatial-data",
    "title": "In Class Exercise 2: Emerging Hot Spot Analysis: sfdep methods",
    "section": "Import apatial data",
    "text": "Import apatial data\n\nGDPPC &lt;- read_csv(\"data/aspatial/Hunan_GDPPC.csv\")\n\nRows: 1496 Columns: 3\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (1): County\ndbl (2): Year, GDPPC\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.1.html#creating-a-time-series-cube",
    "href": "in_class_ex2/in_class_ex2.1.html#creating-a-time-series-cube",
    "title": "In Class Exercise 2: Emerging Hot Spot Analysis: sfdep methods",
    "section": "Creating a Time Series Cube",
    "text": "Creating a Time Series Cube\nIn the code chunk below, spacetime() of sfdep is used to create an spacetime cube.\n\nGDPPC_st &lt;- spacetime(GDPPC, hunan,\n                      .loc_col = \"County\",\n                      .time_col = \"Year\")\n\nNext, is_spacetime_cube() of sfdep package will be used to varify if GDPPC_st is indeed an space-time cube object.\n\nis_spacetime_cube(GDPPC_st)\n\n[1] TRUE\n\n\nTo note: The TRUE return confirms that GDPPC_st object is indeed an time-space cube.\nIf it is FALSE, it will have complications"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.1.html#computing-gi",
    "href": "in_class_ex2/in_class_ex2.1.html#computing-gi",
    "title": "In Class Exercise 2: Emerging Hot Spot Analysis: sfdep methods",
    "section": "Computing GI*",
    "text": "Computing GI*\nThe code chunk below will be used to identify neighbors and to derive an inverse distance weights.\n\nGDPPC_nb &lt;- GDPPC_st %&gt;%\n  activate(\"geometry\") %&gt;%\n  mutate(nb = include_self(st_contiguity(geometry)),\n         wt = st_inverse_distance(nb, geometry,\n                                  scale = 1,\n                                  alpha = 1),\n         .before = 1) %&gt;%\n  set_nbs(\"nb\") %&gt;%\n  set_wts(\"wt\")\n\n! Polygon provided. Using point on surface.\n\n\nWarning: There was 1 warning in `stopifnot()`.\nℹ In argument: `wt = st_inverse_distance(nb, geometry, scale = 1, alpha = 1)`.\nCaused by warning in `st_point_on_surface.sfc()`:\n! st_point_on_surface may not give correct results for longitude/latitude data\n\n\nNote that this dataset now has neighbors and weights for each time-slice.\n\nhead(GDPPC_nb)\n\nspacetime ────\n\n\nContext:`data`\n\n\n88 locations `County`\n\n\n17 time periods `Year`\n\n\n── data context ────────────────────────────────────────────────────────────────\n\n\n# A tibble: 6 × 5\n   Year County  GDPPC nb        wt       \n  &lt;dbl&gt; &lt;chr&gt;   &lt;dbl&gt; &lt;list&gt;    &lt;list&gt;   \n1  2005 Anxiang  8184 &lt;int [6]&gt; &lt;dbl [6]&gt;\n2  2005 Hanshou  6560 &lt;int [6]&gt; &lt;dbl [6]&gt;\n3  2005 Jinshi   9956 &lt;int [5]&gt; &lt;dbl [5]&gt;\n4  2005 Li       8394 &lt;int [5]&gt; &lt;dbl [5]&gt;\n5  2005 Linli    8850 &lt;int [5]&gt; &lt;dbl [5]&gt;\n6  2005 Shimen   9244 &lt;int [6]&gt; &lt;dbl [6]&gt;\n\n\nWe can use these new columns to manually calculate the local Gi* for each location. We can do this by grouping by Year and using local_gstar_perm() of sfdep package. After which, we use unnest() to unnest gi_star column of the newly created gi_starts data.frame.\n\ngi_stars &lt;- GDPPC_nb %&gt;% \n  group_by(Year) %&gt;% \n  mutate(gi_star = local_gstar_perm(\n    GDPPC, nb, wt)) %&gt;% \n  tidyr::unnest(gi_star)"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.1.html#mann-kendall-test",
    "href": "in_class_ex2/in_class_ex2.1.html#mann-kendall-test",
    "title": "In Class Exercise 2: Emerging Hot Spot Analysis: sfdep methods",
    "section": "Mann-Kendall Test",
    "text": "Mann-Kendall Test\nWith these Gi* measures we can then evaluate each location for a trend using the Mann-Kendall test. The code chunk below uses Changsha county.\n\ncbg &lt;- gi_stars %&gt;% \n  ungroup() %&gt;% \n  filter(County == \"Changsha\") |&gt; \n  select(County, Year, gi_star)\n\nNext, we plot the result by using ggplot2 functions.\n\nggplot(data = cbg, \n       aes(x = Year, \n           y = gi_star)) +\n  geom_line() +\n  theme_light()\n\n\n\n\nTo take note: We can also create an interactive plot by using ggplotly() of plotly package.\n\np &lt;- ggplot(data = cbg, \n       aes(x = Year, \n           y = gi_star)) +\n  geom_line() +\n  theme_light()\n\nggplotly(p)\n\n\n\n\n\n\ncbg %&gt;%\n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;% \n  tidyr::unnest_wider(mk)\n\n# A tibble: 1 × 5\n    tau      sl     S     D  varS\n  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;\n1 0.485 0.00742    66  136.  589.\n\n\nIn the above result, sl is the p-value. This result tells us that there is a slight upward but insignificant trend.\nWe can replicate this for each location by using group_by() of dplyr package.\n\nehsa &lt;- gi_stars %&gt;%\n  group_by(County) %&gt;%\n  summarise(mk = list(\n    unclass(\n      Kendall::MannKendall(gi_star)))) %&gt;%\n  tidyr::unnest_wider(mk)"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.1.html#arrange-to-show-significant-emerging-hotcold-spots",
    "href": "in_class_ex2/in_class_ex2.1.html#arrange-to-show-significant-emerging-hotcold-spots",
    "title": "In Class Exercise 2: Emerging Hot Spot Analysis: sfdep methods",
    "section": "Arrange to show significant emerging hot/cold spots",
    "text": "Arrange to show significant emerging hot/cold spots\n\nemerging &lt;- ehsa %&gt;% \n  arrange(sl, abs(tau)) %&gt;% \n  slice(1:5)"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.1.html#performing-emerging-hotspot-analysis",
    "href": "in_class_ex2/in_class_ex2.1.html#performing-emerging-hotspot-analysis",
    "title": "In Class Exercise 2: Emerging Hot Spot Analysis: sfdep methods",
    "section": "Performing Emerging Hotspot Analysis",
    "text": "Performing Emerging Hotspot Analysis\nLastly, we will perform EHSA analysis by using emerging_hotspot_analysis() of sfdep package.\nTo note: It takes a spacetime object x (i.e. GDPPC_st), and the quoted name of the variable of interest (i.e. GDPPC) for .var argument. The k argument is used to specify the number of time lags which is set to 1 by default. Lastly, nsim map numbers of simulation to be performed.\n\nehsa &lt;- emerging_hotspot_analysis(\n  x = GDPPC_st, \n  .var = \"GDPPC\", \n  k = 1, \n  nsim = 99\n)"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.1.html#visualising-the-distribution-of-ehsa-classes",
    "href": "in_class_ex2/in_class_ex2.1.html#visualising-the-distribution-of-ehsa-classes",
    "title": "In Class Exercise 2: Emerging Hot Spot Analysis: sfdep methods",
    "section": "Visualising the distribution of EHSA classes",
    "text": "Visualising the distribution of EHSA classes\nIn the code chunk below, ggplot2 functions ised used to reveal the distribution of EHSA classes as a bar chart.\n\nggplot(data = ehsa,\n       aes(x = classification)) +\n  geom_bar()"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.1.html#visualising-ehsa",
    "href": "in_class_ex2/in_class_ex2.1.html#visualising-ehsa",
    "title": "In Class Exercise 2: Emerging Hot Spot Analysis: sfdep methods",
    "section": "Visualising EHSA",
    "text": "Visualising EHSA\nIn this section, I will learn how to visualise the geographic distribution EHSA classes. However, before I can do so, I need to join both hunan and ehsa together by using the code chunk below.\n\nhunan_ehsa &lt;- hunan %&gt;%\n  left_join(ehsa,\n            by = join_by(County == location))\n\nNext, tmap functions will be used to plot a categorical choropleth map by using the code chunk below.\n\nehsa_sig &lt;- hunan_ehsa  %&gt;%\n  filter(p_value &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(hunan_ehsa) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(ehsa_sig) +\n  tm_fill(\"classification\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them)."
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html",
    "href": "in_class_ex2/in_class_ex2.html",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "",
    "text": "Four R packages will be used in this in-class exercise.\nTo understand sfdep better, click on this link.\n*Note: sfdep is not covered in the hands on exercise and will be used in the take home exercise\n\npacman::p_load(tmap, sf, tidyverse, knitr, sfdep)"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#importing-apatial-data",
    "href": "in_class_ex2/in_class_ex2.html#importing-apatial-data",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Importing apatial data",
    "text": "Importing apatial data\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nRows: 88 Columns: 29\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): County, City\ndbl (27): avg_wage, deposite, FAI, Gov_Rev, Gov_Exp, GDP, GDPPC, GIO, Loan, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#importing-geospatial-data",
    "href": "in_class_ex2/in_class_ex2.html#importing-geospatial-data",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Importing geospatial data",
    "text": "Importing geospatial data\n\nhunan &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\czx0727\\ISSS624_\\in_class_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\nhead(hunan)\n\nSimple feature collection with 6 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 110.4922 ymin: 28.61762 xmax: 112.3013 ymax: 30.12812\nGeodetic CRS:  WGS 84\n   NAME_2  ID_3  NAME_3   ENGTYPE_3 Shape_Leng Shape_Area  County\n1 Changde 21098 Anxiang      County   1.869074 0.10056190 Anxiang\n2 Changde 21100 Hanshou      County   2.360691 0.19978745 Hanshou\n3 Changde 21101  Jinshi County City   1.425620 0.05302413  Jinshi\n4 Changde 21102      Li      County   3.474325 0.18908121      Li\n5 Changde 21103   Linli      County   2.289506 0.11450357   Linli\n6 Changde 21104  Shimen      County   4.171918 0.37194707  Shimen\n                        geometry\n1 POLYGON ((112.0625 29.75523...\n2 POLYGON ((112.2288 29.11684...\n3 POLYGON ((111.8927 29.6013,...\n4 POLYGON ((111.3731 29.94649...\n5 POLYGON ((111.6324 29.76288...\n6 POLYGON ((110.8825 30.11675..."
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#performing-relational-join",
    "href": "in_class_ex2/in_class_ex2.html#performing-relational-join",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Performing relational join",
    "text": "Performing relational join\nTwo datasets are joined and select columns are retained in the resulting table.\nDo an intermediate step to see the resulting table and choose the columns to retain. “Geometry” column will be automatically bring it in.\nRefer to the link here for the information for left join in dplyr.\nCode is as shown below:\n\nhunan &lt;- left_join(hunan,hunan2012)%&gt;%\n  select(1:4, 7, 15)\n\nJoining with `by = join_by(County)`"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#plotting-a-choropleth-map",
    "href": "in_class_ex2/in_class_ex2.html#plotting-a-choropleth-map",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Plotting a choropleth map",
    "text": "Plotting a choropleth map\nThe choropleth should look similar to ther figure below.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(hunan) +\n  tm_fill(\"GDPPC\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"GDPPC\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Distribution of GDP per capita by district, Hunan Province\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2)"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#deriving-contiguity-weights-queens-method",
    "href": "in_class_ex2/in_class_ex2.html#deriving-contiguity-weights-queens-method",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Deriving contiguity weights: Queen’s method",
    "text": "Deriving contiguity weights: Queen’s method\nBelow shows the method to compute the contiguity weights by using st_weights() of sfdep package.\nIn the code chunk below, queen method is used to derive the contiguity weights.\n\nwm_q &lt;- hunan%&gt;%\n  mutate(nb = st_contiguity(geometry),\n         wt = st_weights(nb,\n                         style = \"W\"),\n         .before =1)\n\nWhat we can learn from st_weights(). It provides tree arguments, they are:\n\nnb: A neighbor list object as created by st_neighbors().\nstyle: Default \"W\" for row standardized weights. This value can also be \"B\", \"C\", \"U\", \"minmax\", and \"S\". B is the basic binary coding, W is row standardised (sums over all links to n), C is globally standardised (sums over all links to n), U is equal to C divided by the number of neighbours (sums over all links to unity), while S is the variance-stabilizing coding scheme proposed by Tiefelsdorf et al. 1999, p. 167-168 (sums over all links to n).\nallow_zero: If TRUE, assigns zero as lagged value to zone without neighbors.\n\n\nwm_q\n\nSimple feature collection with 88 features and 8 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\nFirst 10 features:\n                               nb\n1                 2, 3, 4, 57, 85\n2               1, 57, 58, 78, 85\n3                     1, 4, 5, 85\n4                      1, 3, 5, 6\n5                     3, 4, 6, 85\n6                4, 5, 69, 75, 85\n7                  67, 71, 74, 84\n8       9, 46, 47, 56, 78, 80, 86\n9           8, 66, 68, 78, 84, 86\n10 16, 17, 19, 20, 22, 70, 72, 73\n                                                                            wt\n1                                                      0.2, 0.2, 0.2, 0.2, 0.2\n2                                                      0.2, 0.2, 0.2, 0.2, 0.2\n3                                                       0.25, 0.25, 0.25, 0.25\n4                                                       0.25, 0.25, 0.25, 0.25\n5                                                       0.25, 0.25, 0.25, 0.25\n6                                                      0.2, 0.2, 0.2, 0.2, 0.2\n7                                                       0.25, 0.25, 0.25, 0.25\n8  0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571, 0.1428571\n9             0.1666667, 0.1666667, 0.1666667, 0.1666667, 0.1666667, 0.1666667\n10                      0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125, 0.125\n     NAME_2  ID_3    NAME_3   ENGTYPE_3    County GDPPC\n1   Changde 21098   Anxiang      County   Anxiang 23667\n2   Changde 21100   Hanshou      County   Hanshou 20981\n3   Changde 21101    Jinshi County City    Jinshi 34592\n4   Changde 21102        Li      County        Li 24473\n5   Changde 21103     Linli      County     Linli 25554\n6   Changde 21104    Shimen      County    Shimen 27137\n7  Changsha 21109   Liuyang County City   Liuyang 63118\n8  Changsha 21110 Ningxiang      County Ningxiang 62202\n9  Changsha 21111 Wangcheng      County Wangcheng 70666\n10 Chenzhou 21112     Anren      County     Anren 12761\n                         geometry\n1  POLYGON ((112.0625 29.75523...\n2  POLYGON ((112.2288 29.11684...\n3  POLYGON ((111.8927 29.6013,...\n4  POLYGON ((111.3731 29.94649...\n5  POLYGON ((111.6324 29.76288...\n6  POLYGON ((110.8825 30.11675...\n7  POLYGON ((113.9905 28.5682,...\n8  POLYGON ((112.7181 28.38299...\n9  POLYGON ((112.7914 28.52688...\n10 POLYGON ((113.1757 26.82734..."
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#computing-local-morans-i",
    "href": "in_class_ex2/in_class_ex2.html#computing-local-morans-i",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Computing local Moran’s I",
    "text": "Computing local Moran’s I\nIn this section, I learn how to compute Local Moran's I of GDPPC at county level by using local_moran() of sfdep package:\n\nlisa &lt;- wm_q %&gt;%\n  mutate(local_moran = local_moran(\n    GDPPC, nb, wt, nsim = 99),\n    .before =1) %&gt;%\n  unnest(local_moran)\n\nTo take note:\nThe output of local_moran() is a sf data.frame containing the columns ii, eii, var_ii, z_ii, p_ii, p_ii_sim, and p_folded_sim.\n\nii: local moran statistic\neii: expectation of local moran statistic; for localmoran_permthe permutation sample means\nvar_ii: variance of local moran statistic; for localmoran_permthe permutation sample standard deviations\nz_ii: standard deviate of local moran statistic; for localmoran_perm based on permutation sample means and standard deviations p_ii: p-value of local moran statistic using pnorm(); for localmoran_perm using standard deviatse based on permutation sample means and standard deviations p_ii_sim: For localmoran_perm(), rank() and punif() of observed statistic rank for [0, 1] p-values using alternative= -p_folded_sim: the simulation folded [0, 0.5] range ranked p-value (based on https://github.com/pysal/esda/blob/4a63e0b5df1e754b17b5f1205b cadcbecc5e061/esda/crand.py#L211-L213)\nskewness: For localmoran_perm, the output of e1071::skewness() for the permutation samples underlying the standard deviates\nkurtosis: For localmoran_perm, the output of e1071::kurtosis() for the permutation samples underlying the standard deviates."
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#visualising-local-morans-i",
    "href": "in_class_ex2/in_class_ex2.html#visualising-local-morans-i",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Visualising local Moran's I",
    "text": "Visualising local Moran's I\nIn this code chunk below, tmap functions are used prepare a choropleth map by using value in the ii field.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_fill(\"ii\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n  tm_layout(main.title = \"local Moran's I of GDPPC\",\n            main.title.size = 0.8)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette."
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#visualising-p-value-of-local-morans-i",
    "href": "in_class_ex2/in_class_ex2.html#visualising-p-value-of-local-morans-i",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Visualising p-value of local Moran's I",
    "text": "Visualising p-value of local Moran's I\nIn the code chunk below, tmap functions are used prepare a choropleth map by using value in the p_ii_sim field.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_fill(\"p_ii_sim\") + \n  tm_borders(alpha = 0.5) +\n   tm_layout(main.title = \"p-value of local Moran's I\",\n            main.title.size = 0.8)"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#visuaising-local-morans-i-and-p-value",
    "href": "in_class_ex2/in_class_ex2.html#visuaising-local-morans-i-and-p-value",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Visuaising local Moran's I and p-value",
    "text": "Visuaising local Moran's I and p-value\nFor effective comparison, it will be better for us to plot both maps next to each other as shown below.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nmap1 &lt;- tm_shape(lisa) +\n  tm_fill(\"ii\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n  tm_layout(main.title = \"local Moran's I of GDPPC\",\n            main.title.size = 0.8)\n\nmap2 &lt;- tm_shape(lisa) +\n  tm_fill(\"p_ii\",\n          breaks = c(0, 0.001, 0.01, 0.05, 1),\n              labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) + \n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-value of local Moran's I\",\n            main.title.size = 0.8)\n\ntmap_arrange(map1, map2, ncol = 2)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette."
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#visualising-lisa-map",
    "href": "in_class_ex2/in_class_ex2.html#visualising-lisa-map",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Visualising LISA map",
    "text": "Visualising LISA map\nLISA map is a categorical map showing outliers and clusters. There are two types of outliers namely: High-Low and Low-High outliers. Likewise, there are two type of clusters namely: High-High and Low-Low cluaters. In fact, LISA map is an interpreted map by combining local Moran's I of geographical areas and their respective p-values.\nIn lisa sf data.frame, we can find three fields contain the LISA categories. They are mean, median and pysal. In general, classification in mean will be used as shown in the code chunk below.\n\nlisa_sig &lt;- lisa  %&gt;%\n  filter(p_ii &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(lisa_sig) +\n  tm_fill(\"mean\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them)."
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#hot-spot-and-cold-spot-area-analysis-hcsa",
    "href": "in_class_ex2/in_class_ex2.html#hot-spot-and-cold-spot-area-analysis-hcsa",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Hot Spot and Cold Spot Area Analysis (HCSA)",
    "text": "Hot Spot and Cold Spot Area Analysis (HCSA)\nHCSA uses spatial weights to identify locations of statistically significant hot spots and cold spots in an spatially weighted attribute that are in proximity to one another based on a calculated distance. The analysis groups features when similar high (hot) or low (cold) values are found in a cluster. The polygon features usually represent administration boundaries or a custom grid structure.\n\nwm_idw &lt;- hunan %&gt;%\n  mutate(nb = st_contiguity(geometry),\n         wts = st_inverse_distance(nb, geometry,\n                                   scale = 1,\n                                   alpha = 1),\n         .before = 1)\n\n! Polygon provided. Using point on surface.\n\n\nWarning: There was 1 warning in `stopifnot()`.\nℹ In argument: `wts = st_inverse_distance(nb, geometry, scale = 1, alpha = 1)`.\nCaused by warning in `st_point_on_surface.sfc()`:\n! st_point_on_surface may not give correct results for longitude/latitude data\n\n\nNext, local_gstar_perm() of sfdep package will be used to compute local Gi* statistics as shown in the code chunk below.\n\nHCSA &lt;- wm_idw %&gt;% \n  mutate(local_Gi = local_gstar_perm(\n    GDPPC, nb, wt, nsim = 99),\n         .before = 1) %&gt;%\n  unnest(local_Gi)\nHCSA\n\nSimple feature collection with 88 features and 16 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n# A tibble: 88 × 17\n   gi_star   e_gi   var_gi  p_value   p_sim p_folded_sim skewness kurtosis nb   \n     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;nb&gt; \n 1  0.0416 0.0114  6.27e-6  0.0122  9.90e-1         0.94     0.47    0.313 &lt;int&gt;\n 2 -0.333  0.0113  6.65e-6 -0.343   7.32e-1         0.94     0.47    0.851 &lt;int&gt;\n 3  0.281  0.0122  9.56e-6  0.00543 9.96e-1         0.82     0.41    1.64  &lt;int&gt;\n 4  0.411  0.0117  7.08e-6  0.327   7.44e-1         0.76     0.38    0.770 &lt;int&gt;\n 5  0.387  0.0115  9.05e-6  0.354   7.23e-1         0.58     0.29    0.840 &lt;int&gt;\n 6 -0.368  0.0109  3.88e-6 -0.279   7.80e-1         0.86     0.43    0.692 &lt;int&gt;\n 7  3.56   0.0147  8.03e-6  2.65    8.09e-3         0.06     0.03    1.19  &lt;int&gt;\n 8  2.52   0.0131  3.99e-6  2.11    3.46e-2         0.06     0.03    0.839 &lt;int&gt;\n 9  4.56   0.0145  5.48e-6  3.60    3.13e-4         0.02     0.01    0.636 &lt;int&gt;\n10  1.16   0.0110  4.25e-6  1.40    1.61e-1         0.2      0.1     0.534 &lt;int&gt;\n# ℹ 78 more rows\n# ℹ 8 more variables: wts &lt;list&gt;, NAME_2 &lt;chr&gt;, ID_3 &lt;int&gt;, NAME_3 &lt;chr&gt;,\n#   ENGTYPE_3 &lt;chr&gt;, County &lt;chr&gt;, GDPPC &lt;dbl&gt;, geometry &lt;POLYGON [°]&gt;"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#visualising-gi",
    "href": "in_class_ex2/in_class_ex2.html#visualising-gi",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Visualising Gi*",
    "text": "Visualising Gi*\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8))\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette."
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#visualising-p-value-of-hcsa",
    "href": "in_class_ex2/in_class_ex2.html#visualising-p-value-of-hcsa",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Visualising p-value of HCSA",
    "text": "Visualising p-value of HCSA\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_fill(\"p_sim\") + \n  tm_borders(alpha = 0.5)"
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#visuaising-local-hcsa",
    "href": "in_class_ex2/in_class_ex2.html#visuaising-local-hcsa",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Visuaising local HCSA",
    "text": "Visuaising local HCSA\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nmap1 &lt;- tm_shape(HCSA) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n  tm_layout(main.title = \"Gi* of GDPPC\",\n            main.title.size = 0.8)\n\nmap2 &lt;- tm_shape(HCSA) +\n  tm_fill(\"p_value\",\n          breaks = c(0, 0.001, 0.01, 0.05, 1),\n          labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) + \n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-value of Gi*\",\n            main.title.size = 0.8)\n\ntmap_arrange(map1, map2, ncol = 2)\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\nWarning: Values have found that are less than the lowest break\n\n\nWarning: Values have found that are higher than the highest break\n\n\nVariable(s) \"p_value\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette."
  },
  {
    "objectID": "in_class_ex2/in_class_ex2.html#visualising-hot-spot-and-cold-spot-areas",
    "href": "in_class_ex2/in_class_ex2.html#visualising-hot-spot-and-cold-spot-areas",
    "title": "In Class Exercise 2: Spatial Weights - sfdep methods and Local Measures of Spatial Association",
    "section": "Visualising hot spot and cold spot areas",
    "text": "Visualising hot spot and cold spot areas\nWe plot the significant (i.e. p-values less than 0.05) hot spot and cold spot areas by using appropriate tmap functions as shown below.\n\nHCSA_sig &lt;- HCSA  %&gt;%\n  filter(p_sim &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(HCSA) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(HCSA_sig) +\n  tm_fill(\"gi_star\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\nVariable(s) \"gi_star\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\nTo notes (from hands on): Figure above reveals that there is one hot spot area and two cold spot areas. Interestingly, the hot spot areas coincide with the High-high cluster identifies by using local Moran's I method in the earlier sub-section"
  },
  {
    "objectID": "in_class_ex3/data/geospatial/MPSZ-2019.html",
    "href": "in_class_ex3/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html",
    "href": "in_class_ex3/in_class_ex3.html",
    "title": "In Class Exercise 3",
    "section": "",
    "text": "Spatial Interaction Models (SIMs) are mathematical models for estimating flows between spatial entities developed by Alan Wilson in the late 1960s and early 1970, with considerable uptake and refinement for transport modelling since then Boyce and Williams (2015).\nThere are four main types of traditional SIMs (Wilson 1971):\n\nUnconstrained\nProduction-constrained\nAttraction-constrained\nDoubly-constrained\n\nOrdinary least square (OLS), log-normal, Poisson and negative binomial (NB) regression methods have been used extensively to calibrate OD flow models by processing flow data as different types of dependent variables. In this chapter, you will gain hands-on experiences on using appropriate R packages to calibrate SIM by using there four regression methods."
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#converting-from-sf-data.table-to-spatialpolygonsdataframe",
    "href": "in_class_ex3/in_class_ex3.html#converting-from-sf-data.table-to-spatialpolygonsdataframe",
    "title": "In Class Exercise 3",
    "section": "Converting from sf data.table to SpatialPolygonsDataFrame",
    "text": "Converting from sf data.table to SpatialPolygonsDataFrame\n\nmpsz_sp &lt;- as(mpsz, \"Spatial\")\nmpsz_sp\n\nclass       : SpatialPolygonsDataFrame \nfeatures    : 332 \nextent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 6\nnames       : SUBZONE_N, SUBZONE_C, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C \nmin values  : ADMIRALTY,    AMSZ01, ANG MO KIO,         AM, CENTRAL REGION,       CR \nmax values  :    YUNNAN,    YSSZ09,     YISHUN,         YS,    WEST REGION,       WR"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#computing-the-distance-matrix",
    "href": "in_class_ex3/in_class_ex3.html#computing-the-distance-matrix",
    "title": "In Class Exercise 3",
    "section": "Computing the distance matrix",
    "text": "Computing the distance matrix\n\ndist &lt;- spDists(mpsz_sp, \n                longlat = FALSE)\n\n\nhead(dist, n=c(10, 10))\n\n           [,1]       [,2]      [,3]      [,4]       [,5]      [,6]      [,7]\n [1,]     0.000  3926.0025  3939.108 20252.964  2989.9839  1431.330 19211.836\n [2,]  3926.003     0.0000   305.737 16513.865   951.8314  5254.066 16242.523\n [3,]  3939.108   305.7370     0.000 16412.062  1045.9088  5299.849 16026.146\n [4,] 20252.964 16513.8648 16412.062     0.000 17450.3044 21665.795  7229.017\n [5,]  2989.984   951.8314  1045.909 17450.304     0.0000  4303.232 17020.916\n [6,]  1431.330  5254.0664  5299.849 21665.795  4303.2323     0.000 20617.082\n [7,] 19211.836 16242.5230 16026.146  7229.017 17020.9161 20617.082     0.000\n [8,] 14960.942 12749.4101 12477.871 11284.279 13336.0421 16281.453  5606.082\n [9,]  7515.256  7934.8082  7649.776 18427.503  7801.6163  8403.896 14810.930\n[10,]  6391.342  4975.0021  4669.295 15469.566  5226.8731  7707.091 13111.391\n           [,8]      [,9]     [,10]\n [1,] 14960.942  7515.256  6391.342\n [2,] 12749.410  7934.808  4975.002\n [3,] 12477.871  7649.776  4669.295\n [4,] 11284.279 18427.503 15469.566\n [5,] 13336.042  7801.616  5226.873\n [6,] 16281.453  8403.896  7707.091\n [7,]  5606.082 14810.930 13111.391\n [8,]     0.000  9472.024  8575.490\n [9,]  9472.024     0.000  3780.800\n[10,]  8575.490  3780.800     0.000"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#labelling-column-and-row-heanders-of-a-distance-matrix",
    "href": "in_class_ex3/in_class_ex3.html#labelling-column-and-row-heanders-of-a-distance-matrix",
    "title": "In Class Exercise 3",
    "section": "Labelling column and row heanders of a distance matrix",
    "text": "Labelling column and row heanders of a distance matrix\nFirst, we will create a list sorted according to the the distance matrix by planning sub-zone code.\n\nsz_names &lt;- mpsz$SUBZONE_C\n\n\n\n\n\n\n\nNote\n\n\n\nThis is to copy the names from the column subzone_c\n\n\nNext we will attach SUBZONE_C to row and column for distance matrix matching ahead\n\ncolnames(dist) &lt;- paste0(sz_names)\nrownames(dist) &lt;- paste0(sz_names)"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#pivoting-distance-value-by-subzone_c",
    "href": "in_class_ex3/in_class_ex3.html#pivoting-distance-value-by-subzone_c",
    "title": "In Class Exercise 3",
    "section": "Pivoting distance value by SUBZONE_C",
    "text": "Pivoting distance value by SUBZONE_C\n\ndistPair &lt;- melt(dist) %&gt;%\n  rename(dist = value)\nhead(distPair, 10)\n\n     Var1   Var2      dist\n1  MESZ01 MESZ01     0.000\n2  RVSZ05 MESZ01  3926.003\n3  SRSZ01 MESZ01  3939.108\n4  WISZ01 MESZ01 20252.964\n5  MUSZ02 MESZ01  2989.984\n6  MPSZ05 MESZ01  1431.330\n7  WISZ03 MESZ01 19211.836\n8  WISZ02 MESZ01 14960.942\n9  SISZ02 MESZ01  7515.256\n10 SISZ01 MESZ01  6391.342\n\n\n\n\n\n\n\n\nNote\n\n\n\nThis is to change to a format that can be easily dealt with for poisson regression"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#updating-intra-zonal-distances",
    "href": "in_class_ex3/in_class_ex3.html#updating-intra-zonal-distances",
    "title": "In Class Exercise 3",
    "section": "Updating intra-zonal distances",
    "text": "Updating intra-zonal distances\nIn this section, we are going to append a constant value to replace the intra-zonal distance of 0.\nFirst, we will select and find out the minimum value of the distance by using summary().\n\ndistPair %&gt;%\n  filter(dist &gt; 0) %&gt;%\n  summary()\n\n      Var1             Var2             dist        \n MESZ01 :   331   MESZ01 :   331   Min.   :  173.8  \n RVSZ05 :   331   RVSZ05 :   331   1st Qu.: 7149.5  \n SRSZ01 :   331   SRSZ01 :   331   Median :11890.0  \n WISZ01 :   331   WISZ01 :   331   Mean   :12229.4  \n MUSZ02 :   331   MUSZ02 :   331   3rd Qu.:16401.7  \n MPSZ05 :   331   MPSZ05 :   331   Max.   :49894.4  \n (Other):107906   (Other):107906                    \n\n\nNext, a constant distance value of 50m is added into intra-zones distance.\n\n\n\n\n\n\nNote\n\n\n\nMin distance is about 175.\n175 divides by 2. So use 50m to replace 0m as poisson should not have 0\n\n\n\ndistPair$dist &lt;- ifelse(distPair$dist == 0,\n                        50, distPair$dist)\n\nThe code chunk below will be used to check the result data.frame.\n\ndistPair %&gt;%\n  summary()\n\n      Var1             Var2             dist      \n MESZ01 :   332   MESZ01 :   332   Min.   :   50  \n RVSZ05 :   332   RVSZ05 :   332   1st Qu.: 7097  \n SRSZ01 :   332   SRSZ01 :   332   Median :11864  \n WISZ01 :   332   WISZ01 :   332   Mean   :12193  \n MUSZ02 :   332   MUSZ02 :   332   3rd Qu.:16388  \n MPSZ05 :   332   MPSZ05 :   332   Max.   :49894  \n (Other):108232   (Other):108232                  \n\n\nThe code chunk below is used to rename the origin and destination fields.\n\ndistPair &lt;- distPair %&gt;%\n  rename(orig = Var1,\n         dest = Var2)\n\nLastly, the code chunk below is used to save the dataframe for future use\n\nwrite_rds(distPair, \"data/rds/distPair.rds\")"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#separating-intra-flow-from-passenger-volume-df",
    "href": "in_class_ex3/in_class_ex3.html#separating-intra-flow-from-passenger-volume-df",
    "title": "In Class Exercise 3",
    "section": "Separating intra-flow from passenger volume df",
    "text": "Separating intra-flow from passenger volume df\nCode chunk below is used to add three new fields in flow_data dataframe.\n\nflow_data$FlowNoIntra &lt;- ifelse(\n  flow_data$ORIGIN_SZ == flow_data$DESTIN_SZ, \n  0, flow_data$TRIPS)\nflow_data$offset &lt;- ifelse(\n  flow_data$ORIGIN_SZ == flow_data$DESTIN_SZ, \n  0.000001, 1)"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#combining-passenger-volume-data-with-distance-value",
    "href": "in_class_ex3/in_class_ex3.html#combining-passenger-volume-data-with-distance-value",
    "title": "In Class Exercise 3",
    "section": "Combining passenger volume data with distance value",
    "text": "Combining passenger volume data with distance value\nBefore we can join flow_data and distPair, we need to convert data value type of ORIGIN_SZ and DESTIN_SZ fields of flow_data dataframe into factor data type.\n\nflow_data$ORIGIN_SZ &lt;- as.factor(flow_data$ORIGIN_SZ)\nflow_data$DESTIN_SZ &lt;- as.factor(flow_data$DESTIN_SZ)\n\nNow, left_join() of dplyr will be used to flow_data dataframe and distPair dataframe. The output is called flow_data1.\n\nflow_data1 &lt;- flow_data %&gt;%\n  left_join (distPair,\n             by = c(\"ORIGIN_SZ\" = \"orig\",\n                    \"DESTIN_SZ\" = \"dest\"))"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#importing-population-data",
    "href": "in_class_ex3/in_class_ex3.html#importing-population-data",
    "title": "In Class Exercise 3",
    "section": "Importing population data",
    "text": "Importing population data\n\npop &lt;- read_csv(\"data/aspatial/pop.csv\")\n\nRows: 332 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): PA, SZ\ndbl (3): AGE7_12, AGE13_24, AGE25_64\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message."
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#geospatial-data-wrangling",
    "href": "in_class_ex3/in_class_ex3.html#geospatial-data-wrangling",
    "title": "In Class Exercise 3",
    "section": "Geospatial data wrangling",
    "text": "Geospatial data wrangling\n\npop &lt;- pop %&gt;%\n  left_join(mpsz,\n            by = c(\"PA\" = \"PLN_AREA_N\",\n                   \"SZ\" = \"SUBZONE_N\")) %&gt;%\n  select(1:6) %&gt;%\n  rename(SZ_NAME = SZ,\n         SZ = SUBZONE_C)\n\nReference below:\nFrom mpsz\n\npop:\n\n2 set of data: origin and destination attribute."
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#preparing-origin-attribute",
    "href": "in_class_ex3/in_class_ex3.html#preparing-origin-attribute",
    "title": "In Class Exercise 3",
    "section": "Preparing origin attribute",
    "text": "Preparing origin attribute\n\nflow_data1 &lt;- flow_data1 %&gt;%\n  left_join(pop,\n            by = c(ORIGIN_SZ = \"SZ\")) %&gt;%\n  rename(ORIGIN_AGE7_12 = AGE7_12,\n         ORIGIN_AGE13_24 = AGE13_24,\n         ORIGIN_AGE25_64 = AGE25_64) %&gt;%\n  select(-c(PA, SZ_NAME))"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#preparing-destination-attribute",
    "href": "in_class_ex3/in_class_ex3.html#preparing-destination-attribute",
    "title": "In Class Exercise 3",
    "section": "Preparing destination attribute",
    "text": "Preparing destination attribute\n\nflow_data1 &lt;- flow_data1 %&gt;%\n  left_join(pop,\n            by = c(DESTIN_SZ = \"SZ\")) %&gt;%\n  rename(DESTIN_AGE7_12 = AGE7_12,\n         DESTIN_AGE13_24 = AGE13_24,\n         DESTIN_AGE25_64 = AGE25_64) %&gt;%\n  select(-c(PA, SZ_NAME))\n\nWe will called the output data file SIM_data. it is in rds data file format.\n\nwrite_rds(flow_data1, \"data/rds/SIM_data\")"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#importing-the-modelling-data",
    "href": "in_class_ex3/in_class_ex3.html#importing-the-modelling-data",
    "title": "In Class Exercise 3",
    "section": "Importing the modelling data",
    "text": "Importing the modelling data\n\nSIM_data &lt;- read_rds(\"data/rds/SIM_data.rds\")"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#visualising-the-dependent-variable",
    "href": "in_class_ex3/in_class_ex3.html#visualising-the-dependent-variable",
    "title": "In Class Exercise 3",
    "section": "Visualising the dependent variable",
    "text": "Visualising the dependent variable\nFirstly, let us plot the distribution of the dependent variable (i.e. TRIPS) by using histogram method by using the code chunk below.\n\nggplot(data = SIM_data,\n       aes(x = TRIPS)) +\n  geom_histogram()\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\nNotice that the distribution is highly skewed and not resemble bell shape or also known as normal distribution.\nNext, let us visualise the relation between the dependent variable and one of the key independent variable in Spatial Interaction Model, namely distance.\n\nggplot(data = SIM_data,\n       aes(x = dist,\n           y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\n\n\n\nNotice that their relationship hardly resemble linear relationship.\nOn the other hand, if we plot the scatter plot by using the log transformed version of both variables, we can see that their relationship is more resemble linear relationship.\n\nggplot(data = SIM_data,\n       aes(x = log(dist),\n           y = log(TRIPS))) +\n  geom_point() +\n  geom_smooth(method = lm)\n\n`geom_smooth()` using formula = 'y ~ x'"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#checking-for-variables-with-zero-values",
    "href": "in_class_ex3/in_class_ex3.html#checking-for-variables-with-zero-values",
    "title": "In Class Exercise 3",
    "section": "Checking for variables with zero values",
    "text": "Checking for variables with zero values\nSince Poisson Regression is based of log and log 0 is undefined, it is important for us to ensure that no 0 values in the explanatory variables.\nIn the code chunk below, summary() of Base R is used to compute the summary statistics of all variables in SIM_data data frame.\n\nsummary(SIM_data)\n\n  ORIGIN_SZ          DESTIN_SZ             TRIPS           FlowNoIntra      \n Length:14274       Length:14274       Min.   :     1.0   Min.   :     1.0  \n Class :character   Class :character   1st Qu.:    11.0   1st Qu.:    11.0  \n Mode  :character   Mode  :character   Median :    56.0   Median :    56.0  \n                                       Mean   :   664.3   Mean   :   664.3  \n                                       3rd Qu.:   296.0   3rd Qu.:   296.0  \n                                       Max.   :104167.0   Max.   :104167.0  \n     offset       dist         ORIGIN_AGE7_12 ORIGIN_AGE13_24 ORIGIN_AGE25_64\n Min.   :1   Min.   :  173.8   Min.   :   0   Min.   :    0   Min.   :    0  \n 1st Qu.:1   1st Qu.: 3465.4   1st Qu.: 240   1st Qu.:  460   1st Qu.: 2210  \n Median :1   Median : 6121.0   Median : 710   Median : 1400   Median : 7030  \n Mean   :1   Mean   : 6951.8   Mean   :1037   Mean   : 2278   Mean   :10536  \n 3rd Qu.:1   3rd Qu.: 9725.1   3rd Qu.:1500   3rd Qu.: 3282   3rd Qu.:15830  \n Max.   :1   Max.   :26135.8   Max.   :6340   Max.   :16380   Max.   :74610  \n DESTIN_AGE7_12 DESTIN_AGE13_24 DESTIN_AGE25_64\n Min.   :   0   Min.   :    0   Min.   :    0  \n 1st Qu.: 250   1st Qu.:  460   1st Qu.: 2210  \n Median : 720   Median : 1430   Median : 7120  \n Mean   :1040   Mean   : 2305   Mean   :10648  \n 3rd Qu.:1500   3rd Qu.: 3290   3rd Qu.:15830  \n Max.   :6340   Max.   :16380   Max.   :74610  \n\n\nThe print report above reveals that variables ORIGIN_AGE7_12, ORIGIN_AGE13_24, ORIGIN_AGE25_64,DESTIN_AGE7_12, DESTIN_AGE13_24, DESTIN_AGE25_64 consist of 0 values.\nIn view of this, code chunk below will be used to replace zero values to 0.99.\nNote: Poission Regression does not have 1 or 0.\n\nSIM_data$DESTIN_AGE7_12 &lt;- ifelse(\n  SIM_data$DESTIN_AGE7_12 == 0,\n  0.99, SIM_data$DESTIN_AGE7_12)\nSIM_data$DESTIN_AGE13_24 &lt;- ifelse(\n  SIM_data$DESTIN_AGE13_24 == 0,\n  0.99, SIM_data$DESTIN_AGE13_24)\nSIM_data$DESTIN_AGE25_64 &lt;- ifelse(\n  SIM_data$DESTIN_AGE25_64 == 0,\n  0.99, SIM_data$DESTIN_AGE25_64)\nSIM_data$ORIGIN_AGE7_12 &lt;- ifelse(\n  SIM_data$ORIGIN_AGE7_12 == 0,\n  0.99, SIM_data$ORIGIN_AGE7_12)\nSIM_data$ORIGIN_AGE13_24 &lt;- ifelse(\n  SIM_data$ORIGIN_AGE13_24 == 0,\n  0.99, SIM_data$ORIGIN_AGE13_24)\nSIM_data$ORIGIN_AGE25_64 &lt;- ifelse(\n  SIM_data$ORIGIN_AGE25_64 == 0,\n  0.99, SIM_data$ORIGIN_AGE25_64)\n\nYou can run the summary() again.\n\nsummary(SIM_data)\n\n  ORIGIN_SZ          DESTIN_SZ             TRIPS           FlowNoIntra      \n Length:14274       Length:14274       Min.   :     1.0   Min.   :     1.0  \n Class :character   Class :character   1st Qu.:    11.0   1st Qu.:    11.0  \n Mode  :character   Mode  :character   Median :    56.0   Median :    56.0  \n                                       Mean   :   664.3   Mean   :   664.3  \n                                       3rd Qu.:   296.0   3rd Qu.:   296.0  \n                                       Max.   :104167.0   Max.   :104167.0  \n     offset       dist         ORIGIN_AGE7_12    ORIGIN_AGE13_24   \n Min.   :1   Min.   :  173.8   Min.   :   0.99   Min.   :    0.99  \n 1st Qu.:1   1st Qu.: 3465.4   1st Qu.: 240.00   1st Qu.:  460.00  \n Median :1   Median : 6121.0   Median : 710.00   Median : 1400.00  \n Mean   :1   Mean   : 6951.8   Mean   :1036.73   Mean   : 2278.59  \n 3rd Qu.:1   3rd Qu.: 9725.1   3rd Qu.:1500.00   3rd Qu.: 3282.50  \n Max.   :1   Max.   :26135.8   Max.   :6340.00   Max.   :16380.00  \n ORIGIN_AGE25_64    DESTIN_AGE7_12    DESTIN_AGE13_24    DESTIN_AGE25_64   \n Min.   :    0.99   Min.   :   0.99   Min.   :    0.99   Min.   :    0.99  \n 1st Qu.: 2210.00   1st Qu.: 250.00   1st Qu.:  460.00   1st Qu.: 2210.00  \n Median : 7030.00   Median : 720.00   Median : 1430.00   Median : 7120.00  \n Mean   :10535.93   Mean   :1039.98   Mean   : 2305.33   Mean   :10647.95  \n 3rd Qu.:15830.00   3rd Qu.:1500.00   3rd Qu.: 3290.00   3rd Qu.:15830.00  \n Max.   :74610.00   Max.   :6340.00   Max.   :16380.00   Max.   :74610.00"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#unconstrained-spatial-interaction-model",
    "href": "in_class_ex3/in_class_ex3.html#unconstrained-spatial-interaction-model",
    "title": "In Class Exercise 3",
    "section": "Unconstrained Spatial Interaction Model",
    "text": "Unconstrained Spatial Interaction Model\nIn this section, you will learn how to calibrate an unconstrained spatial interaction model by using glm() of Base Stats. The explanatory variables are origin population by different age cohort, destination population by different age cohort (i.e. ORIGIN_AGE25_64) and distance between origin and destination in km (i.e. dist).\nThe general formula of Unconstrained Spatial Interaction Model\n\nuncSIM &lt;- glm(formula = TRIPS ~ \n                log(ORIGIN_AGE25_64) + \n                log(DESTIN_AGE25_64) +\n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nuncSIM\n\n\nCall:  glm(formula = TRIPS ~ log(ORIGIN_AGE25_64) + log(DESTIN_AGE25_64) + \n    log(dist), family = poisson(link = \"log\"), data = SIM_data, \n    na.action = na.exclude)\n\nCoefficients:\n         (Intercept)  log(ORIGIN_AGE25_64)  log(DESTIN_AGE25_64)  \n            17.00287               0.21001               0.01289  \n           log(dist)  \n            -1.51785  \n\nDegrees of Freedom: 14273 Total (i.e. Null);  14270 Residual\nNull Deviance:      36120000 \nResidual Deviance: 19960000     AIC: 20040000"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#r-squared-function",
    "href": "in_class_ex3/in_class_ex3.html#r-squared-function",
    "title": "In Class Exercise 3",
    "section": "R-squared function",
    "text": "R-squared function\nIn order to measure how much variation of the trips can be accounted by the model we will write a function to calculate R-Squared value as shown below.\n\nCalcRSquared &lt;- function(observed,estimated){\n  r &lt;- cor(observed,estimated)\n  R2 &lt;- r^2\n  R2\n}\n\n\nCalcRSquared(uncSIM$data$TRIPS, uncSIM$fitted.values)\n\n[1] 0.1694734\n\n\n\nr2_mcfadden(uncSIM)\n\n# R2 for Generalized Linear Regression\n       R2: 0.446\n  adj. R2: 0.446"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#origin-production-constrained-sim",
    "href": "in_class_ex3/in_class_ex3.html#origin-production-constrained-sim",
    "title": "In Class Exercise 3",
    "section": "Origin (Production) constrained SIM",
    "text": "Origin (Production) constrained SIM\n\norcSIM &lt;- glm(formula = TRIPS ~ \n                 ORIGIN_SZ +\n                 log(DESTIN_AGE25_64) +\n                 log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nsummary(orcSIM)\n\n\nCall:\nglm(formula = TRIPS ~ ORIGIN_SZ + log(DESTIN_AGE25_64) + log(dist), \n    family = poisson(link = \"log\"), data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n                       Estimate Std. Error   z value Pr(&gt;|z|)    \n(Intercept)          19.9309957  0.0054015  3689.887  &lt; 2e-16 ***\nORIGIN_SZAMSZ02       0.6805710  0.0052686   129.175  &lt; 2e-16 ***\nORIGIN_SZAMSZ03       0.3597850  0.0054884    65.554  &lt; 2e-16 ***\nORIGIN_SZAMSZ04      -0.1106566  0.0060027   -18.434  &lt; 2e-16 ***\nORIGIN_SZAMSZ05      -0.3140561  0.0067998   -46.186  &lt; 2e-16 ***\nORIGIN_SZAMSZ06       0.0634425  0.0060258    10.528  &lt; 2e-16 ***\nORIGIN_SZAMSZ07      -1.1301580  0.0110298  -102.464  &lt; 2e-16 ***\nORIGIN_SZAMSZ08      -0.6330394  0.0102949   -61.491  &lt; 2e-16 ***\nORIGIN_SZAMSZ09       0.1064915  0.0063450    16.784  &lt; 2e-16 ***\nORIGIN_SZAMSZ10       0.5061899  0.0053889    93.931  &lt; 2e-16 ***\nORIGIN_SZAMSZ11      -1.3167911  0.0144870   -90.895  &lt; 2e-16 ***\nORIGIN_SZAMSZ12      -1.5103004  0.0127453  -118.499  &lt; 2e-16 ***\nORIGIN_SZBDSZ01       1.3626004  0.0051433   264.929  &lt; 2e-16 ***\nORIGIN_SZBDSZ02       0.9554084  0.0059655   160.156  &lt; 2e-16 ***\nORIGIN_SZBDSZ03       1.1476190  0.0054278   211.433  &lt; 2e-16 ***\nORIGIN_SZBDSZ04       2.0110410  0.0046344   433.940  &lt; 2e-16 ***\nORIGIN_SZBDSZ05       1.0658940  0.0053976   197.477  &lt; 2e-16 ***\nORIGIN_SZBDSZ06       1.2719222  0.0054774   232.213  &lt; 2e-16 ***\nORIGIN_SZBDSZ07      -0.5053039  0.0111553   -45.297  &lt; 2e-16 ***\nORIGIN_SZBDSZ08      -0.3556193  0.0102947   -34.544  &lt; 2e-16 ***\nORIGIN_SZBKSZ01      -0.3606399  0.0075473   -47.784  &lt; 2e-16 ***\nORIGIN_SZBKSZ02       0.1357265  0.0061394    22.107  &lt; 2e-16 ***\nORIGIN_SZBKSZ03       0.4101999  0.0058983    69.545  &lt; 2e-16 ***\nORIGIN_SZBKSZ04      -0.3418645  0.0070764   -48.310  &lt; 2e-16 ***\nORIGIN_SZBKSZ05      -0.2986750  0.0074073   -40.322  &lt; 2e-16 ***\nORIGIN_SZBKSZ06      -0.2637855  0.0068739   -38.375  &lt; 2e-16 ***\nORIGIN_SZBKSZ07       0.5498323  0.0051476   106.813  &lt; 2e-16 ***\nORIGIN_SZBKSZ08      -0.0527393  0.0061457    -8.582  &lt; 2e-16 ***\nORIGIN_SZBKSZ09      -0.1564691  0.0067300   -23.249  &lt; 2e-16 ***\nORIGIN_SZBLSZ01      -1.7551329  0.0176599   -99.385  &lt; 2e-16 ***\nORIGIN_SZBLSZ02      -1.9493637  0.0213859   -91.152  &lt; 2e-16 ***\nORIGIN_SZBLSZ03      -2.9057732  0.0535995   -54.213  &lt; 2e-16 ***\nORIGIN_SZBLSZ04      -1.4672066  0.0254726   -57.599  &lt; 2e-16 ***\nORIGIN_SZBMSZ01       0.1806064  0.0060563    29.821  &lt; 2e-16 ***\nORIGIN_SZBMSZ02      -1.4026549  0.0078244  -179.267  &lt; 2e-16 ***\nORIGIN_SZBMSZ03      -0.5976236  0.0063808   -93.660  &lt; 2e-16 ***\nORIGIN_SZBMSZ04      -0.5456513  0.0059061   -92.388  &lt; 2e-16 ***\nORIGIN_SZBMSZ05      -3.1095195  0.0188118  -165.297  &lt; 2e-16 ***\nORIGIN_SZBMSZ06      -3.0273827  0.0194319  -155.794  &lt; 2e-16 ***\nORIGIN_SZBMSZ07      -0.7378197  0.0066865  -110.345  &lt; 2e-16 ***\nORIGIN_SZBMSZ08      -0.9306150  0.0067188  -138.510  &lt; 2e-16 ***\nORIGIN_SZBMSZ09      -1.4137345  0.0101071  -139.876  &lt; 2e-16 ***\nORIGIN_SZBMSZ10      -1.7054195  0.0101582  -167.886  &lt; 2e-16 ***\nORIGIN_SZBMSZ11      -1.2418380  0.0076792  -161.714  &lt; 2e-16 ***\nORIGIN_SZBMSZ12      -1.3746537  0.0109769  -125.231  &lt; 2e-16 ***\nORIGIN_SZBMSZ13      -0.4339494  0.0069335   -62.587  &lt; 2e-16 ***\nORIGIN_SZBMSZ14      -0.9950458  0.0076302  -130.410  &lt; 2e-16 ***\nORIGIN_SZBMSZ15      -0.6544196  0.0068964   -94.892  &lt; 2e-16 ***\nORIGIN_SZBMSZ16      -1.5193747  0.0105329  -144.250  &lt; 2e-16 ***\nORIGIN_SZBMSZ17      -1.6536771  0.0180672   -91.529  &lt; 2e-16 ***\nORIGIN_SZBPSZ01       0.1484355  0.0064734    22.930  &lt; 2e-16 ***\nORIGIN_SZBPSZ02      -0.3602094  0.0073902   -48.741  &lt; 2e-16 ***\nORIGIN_SZBPSZ03      -0.1567975  0.0072226   -21.709  &lt; 2e-16 ***\nORIGIN_SZBPSZ04       0.4504873  0.0058418    77.115  &lt; 2e-16 ***\nORIGIN_SZBPSZ05       0.5028646  0.0053682    93.675  &lt; 2e-16 ***\nORIGIN_SZBPSZ06      -1.0125668  0.0105638   -95.853  &lt; 2e-16 ***\nORIGIN_SZBPSZ07      -0.3859065  0.0098561   -39.154  &lt; 2e-16 ***\nORIGIN_SZBSSZ01       0.1488497  0.0065504    22.724  &lt; 2e-16 ***\nORIGIN_SZBSSZ02       0.4269498  0.0055893    76.387  &lt; 2e-16 ***\nORIGIN_SZBSSZ03      -0.2437385  0.0062020   -39.300  &lt; 2e-16 ***\nORIGIN_SZBTSZ01       0.1987940  0.0066672    29.817  &lt; 2e-16 ***\nORIGIN_SZBTSZ02      -0.4571546  0.0090784   -50.356  &lt; 2e-16 ***\nORIGIN_SZBTSZ03      -0.2697243  0.0077941   -34.606  &lt; 2e-16 ***\nORIGIN_SZBTSZ04      -1.0997236  0.0115225   -95.441  &lt; 2e-16 ***\nORIGIN_SZBTSZ05      -1.0053122  0.0132594   -75.819  &lt; 2e-16 ***\nORIGIN_SZBTSZ06      -1.0841201  0.0102242  -106.035  &lt; 2e-16 ***\nORIGIN_SZBTSZ07      -2.3134497  0.0158499  -145.960  &lt; 2e-16 ***\nORIGIN_SZBTSZ08      -1.1581618  0.0121161   -95.589  &lt; 2e-16 ***\nORIGIN_SZCBSZ01      -1.0805930  0.0577831   -18.701  &lt; 2e-16 ***\nORIGIN_SZCCSZ01      -0.8145372  0.0152638   -53.364  &lt; 2e-16 ***\nORIGIN_SZCHSZ01       0.0377079  0.0133240     2.830 0.004654 ** \nORIGIN_SZCHSZ02      -0.6209553  0.0096388   -64.422  &lt; 2e-16 ***\nORIGIN_SZCHSZ03       1.6790244  0.0069559   241.381  &lt; 2e-16 ***\nORIGIN_SZCKSZ01       0.0839586  0.0059934    14.008  &lt; 2e-16 ***\nORIGIN_SZCKSZ02       0.4379511  0.0062289    70.309  &lt; 2e-16 ***\nORIGIN_SZCKSZ03       0.7956950  0.0051892   153.335  &lt; 2e-16 ***\nORIGIN_SZCKSZ04       1.2740323  0.0053165   239.637  &lt; 2e-16 ***\nORIGIN_SZCKSZ05       0.9326213  0.0061807   150.893  &lt; 2e-16 ***\nORIGIN_SZCKSZ06       0.3976273  0.0085639    46.431  &lt; 2e-16 ***\nORIGIN_SZCLSZ01      -0.7522917  0.0094655   -79.477  &lt; 2e-16 ***\nORIGIN_SZCLSZ02      -1.3937450  0.0153260   -90.940  &lt; 2e-16 ***\nORIGIN_SZCLSZ03      -0.7898683  0.0091016   -86.784  &lt; 2e-16 ***\nORIGIN_SZCLSZ04       0.8451512  0.0051258   164.882  &lt; 2e-16 ***\nORIGIN_SZCLSZ05      -1.6573818  0.0166091   -99.788  &lt; 2e-16 ***\nORIGIN_SZCLSZ06       0.9478181  0.0048182   196.716  &lt; 2e-16 ***\nORIGIN_SZCLSZ07      -0.2499753  0.0064632   -38.677  &lt; 2e-16 ***\nORIGIN_SZCLSZ08       0.1350119  0.0069296    19.483  &lt; 2e-16 ***\nORIGIN_SZCLSZ09      -1.3868782  0.0192743   -71.955  &lt; 2e-16 ***\nORIGIN_SZDTSZ02      -3.7535792  0.0871325   -43.079  &lt; 2e-16 ***\nORIGIN_SZDTSZ03      -3.8462041  0.0840156   -45.780  &lt; 2e-16 ***\nORIGIN_SZDTSZ13      -2.9738127  0.0349241   -85.151  &lt; 2e-16 ***\nORIGIN_SZGLSZ01      -1.5175198  0.0110135  -137.787  &lt; 2e-16 ***\nORIGIN_SZGLSZ02       0.2405712  0.0058742    40.954  &lt; 2e-16 ***\nORIGIN_SZGLSZ03       0.1940241  0.0061989    31.300  &lt; 2e-16 ***\nORIGIN_SZGLSZ04       1.0292572  0.0049028   209.931  &lt; 2e-16 ***\nORIGIN_SZGLSZ05       0.9864552  0.0050898   193.811  &lt; 2e-16 ***\nORIGIN_SZHGSZ01       0.3073609  0.0054307    56.597  &lt; 2e-16 ***\nORIGIN_SZHGSZ02       0.3827293  0.0054555    70.154  &lt; 2e-16 ***\nORIGIN_SZHGSZ03       0.2342580  0.0059240    39.544  &lt; 2e-16 ***\nORIGIN_SZHGSZ04       0.8750090  0.0049639   176.275  &lt; 2e-16 ***\nORIGIN_SZHGSZ05       1.1695280  0.0049468   236.420  &lt; 2e-16 ***\nORIGIN_SZHGSZ06      -0.0462411  0.0063805    -7.247 4.25e-13 ***\nORIGIN_SZHGSZ07       0.4488583  0.0055139    81.404  &lt; 2e-16 ***\nORIGIN_SZHGSZ08       0.2236095  0.0061279    36.490  &lt; 2e-16 ***\nORIGIN_SZHGSZ09      -1.6376674  0.0084442  -193.941  &lt; 2e-16 ***\nORIGIN_SZHGSZ10      -2.9849025  0.0501042   -59.574  &lt; 2e-16 ***\nORIGIN_SZJESZ01       0.3926525  0.0056268    69.783  &lt; 2e-16 ***\nORIGIN_SZJESZ02       0.1230160  0.0056864    21.633  &lt; 2e-16 ***\nORIGIN_SZJESZ03       0.0188276  0.0061020     3.085 0.002032 ** \nORIGIN_SZJESZ04      -1.3611618  0.0117184  -116.156  &lt; 2e-16 ***\nORIGIN_SZJESZ05      -2.0643662  0.0157083  -131.419  &lt; 2e-16 ***\nORIGIN_SZJESZ06       0.1556368  0.0055245    28.172  &lt; 2e-16 ***\nORIGIN_SZJESZ07      -1.7664532  0.0133171  -132.646  &lt; 2e-16 ***\nORIGIN_SZJESZ08      -0.9115981  0.0138203   -65.961  &lt; 2e-16 ***\nORIGIN_SZJESZ09       0.6121916  0.0060381   101.388  &lt; 2e-16 ***\nORIGIN_SZJESZ10      -1.1953045  0.0233216   -51.253  &lt; 2e-16 ***\nORIGIN_SZJESZ11      -1.4088748  0.0220921   -63.773  &lt; 2e-16 ***\nORIGIN_SZJWSZ01       0.5759093  0.0077741    74.081  &lt; 2e-16 ***\nORIGIN_SZJWSZ02       0.9769314  0.0053029   184.227  &lt; 2e-16 ***\nORIGIN_SZJWSZ03       1.3242695  0.0049068   269.882  &lt; 2e-16 ***\nORIGIN_SZJWSZ04       0.5621088  0.0057831    97.199  &lt; 2e-16 ***\nORIGIN_SZJWSZ05      -1.5744341  0.0146904  -107.174  &lt; 2e-16 ***\nORIGIN_SZJWSZ06      -0.9113320  0.0126913   -71.807  &lt; 2e-16 ***\nORIGIN_SZJWSZ07      -2.3083419  0.0357843   -64.507  &lt; 2e-16 ***\nORIGIN_SZJWSZ08       2.0114225  0.0047956   419.429  &lt; 2e-16 ***\nORIGIN_SZJWSZ09       1.9086705  0.0045255   421.759  &lt; 2e-16 ***\nORIGIN_SZKLSZ01       0.2743166  0.0056908    48.204  &lt; 2e-16 ***\nORIGIN_SZKLSZ02      -0.6443386  0.0074521   -86.463  &lt; 2e-16 ***\nORIGIN_SZKLSZ03      -0.3990113  0.0067213   -59.366  &lt; 2e-16 ***\nORIGIN_SZKLSZ04      -2.1413876  0.0138405  -154.719  &lt; 2e-16 ***\nORIGIN_SZKLSZ05      -1.0913697  0.0121512   -89.816  &lt; 2e-16 ***\nORIGIN_SZKLSZ06      -5.6240764  0.1857405   -30.279  &lt; 2e-16 ***\nORIGIN_SZKLSZ07      -1.1885897  0.0096830  -122.750  &lt; 2e-16 ***\nORIGIN_SZKLSZ08      -1.7018593  0.0114317  -148.872  &lt; 2e-16 ***\nORIGIN_SZLKSZ01      -1.6659670  0.0446420   -37.318  &lt; 2e-16 ***\nORIGIN_SZMDSZ01      -1.1210505  0.0318834   -35.161  &lt; 2e-16 ***\nORIGIN_SZMDSZ02      -0.5096299  0.0116645   -43.691  &lt; 2e-16 ***\nORIGIN_SZMDSZ03      -1.9187039  0.0198291   -96.762  &lt; 2e-16 ***\nORIGIN_SZMPSZ01      -0.5260512  0.0094201   -55.844  &lt; 2e-16 ***\nORIGIN_SZMPSZ02      -0.2905084  0.0077974   -37.257  &lt; 2e-16 ***\nORIGIN_SZMPSZ03       0.3342293  0.0063715    52.457  &lt; 2e-16 ***\nORIGIN_SZMUSZ02      -3.8337096  0.1105053   -34.693  &lt; 2e-16 ***\nORIGIN_SZNTSZ01      -2.9845040  0.0397028   -75.171  &lt; 2e-16 ***\nORIGIN_SZNTSZ02      -3.1812985  0.0249470  -127.522  &lt; 2e-16 ***\nORIGIN_SZNTSZ03      -0.9742991  0.0085424  -114.054  &lt; 2e-16 ***\nORIGIN_SZNTSZ05      -4.2086932  0.0579737   -72.597  &lt; 2e-16 ***\nORIGIN_SZNTSZ06      -4.5831822  0.0583494   -78.547  &lt; 2e-16 ***\nORIGIN_SZNVSZ01       0.3186962  0.0052944    60.195  &lt; 2e-16 ***\nORIGIN_SZNVSZ02      -0.5321136  0.0073747   -72.154  &lt; 2e-16 ***\nORIGIN_SZNVSZ03      -0.9911852  0.0090560  -109.451  &lt; 2e-16 ***\nORIGIN_SZNVSZ04      -0.8329721  0.0099590   -83.640  &lt; 2e-16 ***\nORIGIN_SZNVSZ05      -2.1460777  0.0182401  -117.657  &lt; 2e-16 ***\nORIGIN_SZPGSZ01      -0.5604078  0.0151515   -36.987  &lt; 2e-16 ***\nORIGIN_SZPGSZ02      -0.4025139  0.0085135   -47.279  &lt; 2e-16 ***\nORIGIN_SZPGSZ03       0.6975483  0.0055534   125.608  &lt; 2e-16 ***\nORIGIN_SZPGSZ04       1.2175486  0.0051080   238.363  &lt; 2e-16 ***\nORIGIN_SZPGSZ05       0.3895354  0.0069851    55.767  &lt; 2e-16 ***\nORIGIN_SZPLSZ01      -0.5572701  0.0134473   -41.441  &lt; 2e-16 ***\nORIGIN_SZPLSZ02      -0.9854214  0.0172337   -57.180  &lt; 2e-16 ***\nORIGIN_SZPLSZ03      -1.6991954  0.0472629   -35.952  &lt; 2e-16 ***\nORIGIN_SZPLSZ04      -2.2000217  0.0373580   -58.890  &lt; 2e-16 ***\nORIGIN_SZPLSZ05      -1.7086663  0.0260920   -65.486  &lt; 2e-16 ***\nORIGIN_SZPNSZ01       1.5292867  0.0055102   277.535  &lt; 2e-16 ***\nORIGIN_SZPNSZ02       0.7457519  0.0127815    58.346  &lt; 2e-16 ***\nORIGIN_SZPNSZ03      -1.3659046  0.0216180   -63.184  &lt; 2e-16 ***\nORIGIN_SZPNSZ04      -2.0025379  0.0360655   -55.525  &lt; 2e-16 ***\nORIGIN_SZPNSZ05      -0.9157959  0.0320955   -28.533  &lt; 2e-16 ***\nORIGIN_SZPRSZ01       0.0522611  0.0139142     3.756 0.000173 ***\nORIGIN_SZPRSZ02       1.3063371  0.0053809   242.774  &lt; 2e-16 ***\nORIGIN_SZPRSZ03       0.9963670  0.0054293   183.516  &lt; 2e-16 ***\nORIGIN_SZPRSZ04      -0.0300950  0.0088010    -3.419 0.000627 ***\nORIGIN_SZPRSZ05       1.6840313  0.0050839   331.245  &lt; 2e-16 ***\nORIGIN_SZPRSZ06      -0.8277202  0.0131296   -63.042  &lt; 2e-16 ***\nORIGIN_SZPRSZ07      -2.1698449  0.0177362  -122.340  &lt; 2e-16 ***\nORIGIN_SZPRSZ08       0.4559353  0.0072609    62.793  &lt; 2e-16 ***\nORIGIN_SZQTSZ01      -0.3517047  0.0078770   -44.650  &lt; 2e-16 ***\nORIGIN_SZQTSZ02      -0.8199353  0.0071544  -114.605  &lt; 2e-16 ***\nORIGIN_SZQTSZ03      -0.2457614  0.0065555   -37.490  &lt; 2e-16 ***\nORIGIN_SZQTSZ04      -1.2216614  0.0084050  -145.349  &lt; 2e-16 ***\nORIGIN_SZQTSZ05      -0.7219952  0.0072360   -99.778  &lt; 2e-16 ***\nORIGIN_SZQTSZ06      -0.6729363  0.0076658   -87.784  &lt; 2e-16 ***\nORIGIN_SZQTSZ07      -1.4497690  0.0109365  -132.563  &lt; 2e-16 ***\nORIGIN_SZQTSZ08      -0.2770151  0.0070193   -39.465  &lt; 2e-16 ***\nORIGIN_SZQTSZ09      -0.6157554  0.0078739   -78.202  &lt; 2e-16 ***\nORIGIN_SZQTSZ10      -0.3091547  0.0075471   -40.963  &lt; 2e-16 ***\nORIGIN_SZQTSZ11      -1.9698881  0.0151247  -130.243  &lt; 2e-16 ***\nORIGIN_SZQTSZ12      -2.6449643  0.0205857  -128.485  &lt; 2e-16 ***\nORIGIN_SZQTSZ13      -0.3754107  0.0088433   -42.452  &lt; 2e-16 ***\nORIGIN_SZQTSZ14      -1.6537473  0.0134378  -123.067  &lt; 2e-16 ***\nORIGIN_SZQTSZ15      -0.3435351  0.0131956   -26.034  &lt; 2e-16 ***\nORIGIN_SZRCSZ01      -1.7104390  0.0141179  -121.154  &lt; 2e-16 ***\nORIGIN_SZRCSZ06      -1.1250727  0.0094909  -118.542  &lt; 2e-16 ***\nORIGIN_SZRVSZ01      -3.0220116  0.0339694   -88.963  &lt; 2e-16 ***\nORIGIN_SZRVSZ02      -3.6040075  0.0297641  -121.086  &lt; 2e-16 ***\nORIGIN_SZRVSZ03      -3.2345594  0.0259149  -124.814  &lt; 2e-16 ***\nORIGIN_SZRVSZ04      -3.6900313  0.0575908   -64.073  &lt; 2e-16 ***\nORIGIN_SZRVSZ05      -2.9527570  0.0178582  -165.344  &lt; 2e-16 ***\nORIGIN_SZSBSZ01       0.0238445  0.0078563     3.035 0.002405 ** \nORIGIN_SZSBSZ02      -0.5780602  0.0093054   -62.121  &lt; 2e-16 ***\nORIGIN_SZSBSZ03       0.8961719  0.0054586   164.175  &lt; 2e-16 ***\nORIGIN_SZSBSZ04       0.8421798  0.0061888   136.080  &lt; 2e-16 ***\nORIGIN_SZSBSZ05      -0.1682984  0.0078342   -21.482  &lt; 2e-16 ***\nORIGIN_SZSBSZ06      -1.1482701  0.0196421   -58.460  &lt; 2e-16 ***\nORIGIN_SZSBSZ07      -0.8830317  0.0160709   -54.946  &lt; 2e-16 ***\nORIGIN_SZSBSZ08      -1.1039492  0.0174602   -63.226  &lt; 2e-16 ***\nORIGIN_SZSBSZ09      -0.5946691  0.0101961   -58.323  &lt; 2e-16 ***\nORIGIN_SZSESZ02       1.1144933  0.0050948   218.749  &lt; 2e-16 ***\nORIGIN_SZSESZ03       1.1058963  0.0049026   225.574  &lt; 2e-16 ***\nORIGIN_SZSESZ04       0.7427975  0.0056948   130.433  &lt; 2e-16 ***\nORIGIN_SZSESZ05      -0.2812684  0.0069596   -40.414  &lt; 2e-16 ***\nORIGIN_SZSESZ06       0.8168315  0.0055800   146.387  &lt; 2e-16 ***\nORIGIN_SZSESZ07      -2.2842043  0.0231232   -98.784  &lt; 2e-16 ***\nORIGIN_SZSGSZ01      -0.7313790  0.0098957   -73.909  &lt; 2e-16 ***\nORIGIN_SZSGSZ02      -1.1185406  0.0110919  -100.843  &lt; 2e-16 ***\nORIGIN_SZSGSZ03       0.1752618  0.0060508    28.965  &lt; 2e-16 ***\nORIGIN_SZSGSZ04       0.3764395  0.0056165    67.023  &lt; 2e-16 ***\nORIGIN_SZSGSZ05      -1.7203916  0.0118945  -144.637  &lt; 2e-16 ***\nORIGIN_SZSGSZ06       0.4630857  0.0052886    87.563  &lt; 2e-16 ***\nORIGIN_SZSGSZ07      -0.7051233  0.0073133   -96.417  &lt; 2e-16 ***\nORIGIN_SZSKSZ01       0.2053928  0.0100710    20.395  &lt; 2e-16 ***\nORIGIN_SZSKSZ02       1.2630428  0.0063490   198.935  &lt; 2e-16 ***\nORIGIN_SZSKSZ03      -0.3035297  0.0096788   -31.360  &lt; 2e-16 ***\nORIGIN_SZSKSZ04      -1.7952886  0.0359225   -49.977  &lt; 2e-16 ***\nORIGIN_SZSKSZ05      -0.3836861  0.0176686   -21.716  &lt; 2e-16 ***\nORIGIN_SZSLSZ01      -2.5916326  0.0348001   -74.472  &lt; 2e-16 ***\nORIGIN_SZSLSZ04      -0.2251549  0.0088517   -25.436  &lt; 2e-16 ***\nORIGIN_SZSRSZ01      -2.9590365  0.0173638  -170.414  &lt; 2e-16 ***\nORIGIN_SZTHSZ01      -1.9639893  0.0570321   -34.437  &lt; 2e-16 ***\nORIGIN_SZTHSZ03      -1.7281304  0.0272797   -63.349  &lt; 2e-16 ***\nORIGIN_SZTHSZ04      -2.7837906  0.0343179   -81.118  &lt; 2e-16 ***\nORIGIN_SZTHSZ06      -2.1800693  0.0205491  -106.091  &lt; 2e-16 ***\nORIGIN_SZTMSZ01       0.8228136  0.0066824   123.131  &lt; 2e-16 ***\nORIGIN_SZTMSZ02       2.3174781  0.0044978   515.243  &lt; 2e-16 ***\nORIGIN_SZTMSZ03       1.7061757  0.0048615   350.957  &lt; 2e-16 ***\nORIGIN_SZTMSZ04       1.2407899  0.0058389   212.504  &lt; 2e-16 ***\nORIGIN_SZTMSZ05      -0.1000526  0.0124079    -8.064 7.41e-16 ***\nORIGIN_SZTNSZ01      -2.0347519  0.0139596  -145.760  &lt; 2e-16 ***\nORIGIN_SZTNSZ02      -1.8682671  0.0107901  -173.146  &lt; 2e-16 ***\nORIGIN_SZTNSZ03      -2.1737183  0.0146759  -148.115  &lt; 2e-16 ***\nORIGIN_SZTNSZ04      -0.5006452  0.0081501   -61.428  &lt; 2e-16 ***\nORIGIN_SZTPSZ01      -0.6722487  0.0075606   -88.914  &lt; 2e-16 ***\nORIGIN_SZTPSZ02       0.4552916  0.0050191    90.711  &lt; 2e-16 ***\nORIGIN_SZTPSZ03      -0.7865781  0.0072250  -108.869  &lt; 2e-16 ***\nORIGIN_SZTPSZ04      -0.7049044  0.0066456  -106.071  &lt; 2e-16 ***\nORIGIN_SZTPSZ05      -0.5574925  0.0070366   -79.227  &lt; 2e-16 ***\nORIGIN_SZTPSZ06      -0.4247282  0.0068709   -61.815  &lt; 2e-16 ***\nORIGIN_SZTPSZ07      -0.2846984  0.0071030   -40.081  &lt; 2e-16 ***\nORIGIN_SZTPSZ08      -1.0898051  0.0110046   -99.031  &lt; 2e-16 ***\nORIGIN_SZTPSZ09      -0.8092746  0.0079160  -102.232  &lt; 2e-16 ***\nORIGIN_SZTPSZ10      -0.9332072  0.0086809  -107.502  &lt; 2e-16 ***\nORIGIN_SZTPSZ11      -0.0421981  0.0064343    -6.558 5.44e-11 ***\nORIGIN_SZTPSZ12      -0.6330081  0.0078324   -80.819  &lt; 2e-16 ***\nORIGIN_SZTSSZ01      -1.7650409  0.0517357   -34.116  &lt; 2e-16 ***\nORIGIN_SZTSSZ02       1.1707267  0.0094178   124.310  &lt; 2e-16 ***\nORIGIN_SZTSSZ03       0.6581679  0.0095894    68.635  &lt; 2e-16 ***\nORIGIN_SZTSSZ04       0.8736493  0.0104965    83.233  &lt; 2e-16 ***\nORIGIN_SZTSSZ05       0.0957248  0.0178709     5.356 8.49e-08 ***\nORIGIN_SZTSSZ06       1.7581609  0.0206810    85.013  &lt; 2e-16 ***\nORIGIN_SZWCSZ01       0.8097950  0.0105622    76.669  &lt; 2e-16 ***\nORIGIN_SZWCSZ02      -1.9966163  0.0345747   -57.748  &lt; 2e-16 ***\nORIGIN_SZWCSZ03      -5.0687420  0.1474971   -34.365  &lt; 2e-16 ***\nORIGIN_SZWDSZ01       1.4926003  0.0047216   316.124  &lt; 2e-16 ***\nORIGIN_SZWDSZ02       0.9916597  0.0055755   177.859  &lt; 2e-16 ***\nORIGIN_SZWDSZ03       1.5918065  0.0052180   305.062  &lt; 2e-16 ***\nORIGIN_SZWDSZ04       1.3717152  0.0060516   226.669  &lt; 2e-16 ***\nORIGIN_SZWDSZ05       0.6700111  0.0062287   107.569  &lt; 2e-16 ***\nORIGIN_SZWDSZ06       0.8115996  0.0060947   133.165  &lt; 2e-16 ***\nORIGIN_SZWDSZ07      -0.6488914  0.0093567   -69.351  &lt; 2e-16 ***\nORIGIN_SZWDSZ08      -0.3610234  0.0096440   -37.435  &lt; 2e-16 ***\nORIGIN_SZWDSZ09       1.4445461  0.0052279   276.317  &lt; 2e-16 ***\nORIGIN_SZYSSZ01      -0.2039272  0.0069548   -29.322  &lt; 2e-16 ***\nORIGIN_SZYSSZ02       0.8707707  0.0058957   147.697  &lt; 2e-16 ***\nORIGIN_SZYSSZ03       1.8348842  0.0050377   364.231  &lt; 2e-16 ***\nORIGIN_SZYSSZ04       1.0780641  0.0052960   203.564  &lt; 2e-16 ***\nORIGIN_SZYSSZ05       0.3222765  0.0069700    46.237  &lt; 2e-16 ***\nORIGIN_SZYSSZ06      -0.4424689  0.0124866   -35.435  &lt; 2e-16 ***\nORIGIN_SZYSSZ07      -1.0267883  0.0155821   -65.895  &lt; 2e-16 ***\nORIGIN_SZYSSZ08       0.1833117  0.0070935    25.842  &lt; 2e-16 ***\nORIGIN_SZYSSZ09       1.0766070  0.0050451   213.396  &lt; 2e-16 ***\nlog(DESTIN_AGE25_64)  0.0295428  0.0001051   280.998  &lt; 2e-16 ***\nlog(dist)            -1.7024691  0.0004625 -3681.042  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 36117615  on 14273  degrees of freedom\nResidual deviance: 12983718  on 13993  degrees of freedom\nAIC: 13068835\n\nNumber of Fisher Scoring iterations: 6\n\n\nWe can examine how the constraints hold for destinations this time.\n\nCalcRSquared(orcSIM$data$TRIPS, orcSIM$fitted.values)\n\n[1] 0.4029115"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#destination-constrained",
    "href": "in_class_ex3/in_class_ex3.html#destination-constrained",
    "title": "In Class Exercise 3",
    "section": "Destination constrained",
    "text": "Destination constrained\n\ndecSIM &lt;- glm(formula = TRIPS ~ \n                DESTIN_SZ + \n                log(ORIGIN_AGE25_64) + \n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nsummary(decSIM)\n\n\nCall:\nglm(formula = TRIPS ~ DESTIN_SZ + log(ORIGIN_AGE25_64) + log(dist), \n    family = poisson(link = \"log\"), data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n                       Estimate Std. Error   z value Pr(&gt;|z|)    \n(Intercept)          19.4822997  0.0050784  3836.298  &lt; 2e-16 ***\nDESTIN_SZAMSZ02       0.1263056  0.0049743    25.392  &lt; 2e-16 ***\nDESTIN_SZAMSZ03       0.0421788  0.0049859     8.460  &lt; 2e-16 ***\nDESTIN_SZAMSZ04      -1.1668479  0.0074254  -157.143  &lt; 2e-16 ***\nDESTIN_SZAMSZ05      -1.2586639  0.0075854  -165.931  &lt; 2e-16 ***\nDESTIN_SZAMSZ06      -1.1414791  0.0073474  -155.359  &lt; 2e-16 ***\nDESTIN_SZAMSZ07      -1.5565804  0.0109476  -142.185  &lt; 2e-16 ***\nDESTIN_SZAMSZ08      -0.3990754  0.0074159   -53.813  &lt; 2e-16 ***\nDESTIN_SZAMSZ09      -1.0109118  0.0076802  -131.626  &lt; 2e-16 ***\nDESTIN_SZAMSZ10       0.0159285  0.0051765     3.077  0.00209 ** \nDESTIN_SZAMSZ11      -0.3653273  0.0094866   -38.510  &lt; 2e-16 ***\nDESTIN_SZAMSZ12       0.5297606  0.0053243    99.500  &lt; 2e-16 ***\nDESTIN_SZBDSZ01       1.0394822  0.0044226   235.037  &lt; 2e-16 ***\nDESTIN_SZBDSZ02       0.1956964  0.0059564    32.855  &lt; 2e-16 ***\nDESTIN_SZBDSZ03       0.3209267  0.0053718    59.742  &lt; 2e-16 ***\nDESTIN_SZBDSZ04       1.2429874  0.0043104   288.370  &lt; 2e-16 ***\nDESTIN_SZBDSZ05       0.8535842  0.0046360   184.122  &lt; 2e-16 ***\nDESTIN_SZBDSZ06       0.5181443  0.0053736    96.423  &lt; 2e-16 ***\nDESTIN_SZBDSZ07      -0.5849371  0.0110468   -52.951  &lt; 2e-16 ***\nDESTIN_SZBDSZ08      -1.2871050  0.0128623  -100.068  &lt; 2e-16 ***\nDESTIN_SZBKSZ01      -1.0633560  0.0077771  -136.730  &lt; 2e-16 ***\nDESTIN_SZBKSZ02      -0.4065316  0.0066712   -60.938  &lt; 2e-16 ***\nDESTIN_SZBKSZ03      -0.6815674  0.0066509  -102.477  &lt; 2e-16 ***\nDESTIN_SZBKSZ04      -0.4185485  0.0058306   -71.785  &lt; 2e-16 ***\nDESTIN_SZBKSZ05      -0.8887654  0.0073867  -120.319  &lt; 2e-16 ***\nDESTIN_SZBKSZ06      -0.9436078  0.0068625  -137.501  &lt; 2e-16 ***\nDESTIN_SZBKSZ07      -0.0067325  0.0048408    -1.391  0.16430    \nDESTIN_SZBKSZ08      -1.2680903  0.0079177  -160.160  &lt; 2e-16 ***\nDESTIN_SZBKSZ09      -0.0350151  0.0054287    -6.450 1.12e-10 ***\nDESTIN_SZBLSZ01      -0.3045203  0.0081978   -37.146  &lt; 2e-16 ***\nDESTIN_SZBLSZ02       0.6432424  0.0074449    86.400  &lt; 2e-16 ***\nDESTIN_SZBLSZ03       1.9595113  0.0084705   231.333  &lt; 2e-16 ***\nDESTIN_SZBLSZ04       0.0149756  0.0172081     0.870  0.38415    \nDESTIN_SZBMSZ01      -0.0378127  0.0055294    -6.838 8.00e-12 ***\nDESTIN_SZBMSZ02      -0.8458055  0.0054043  -156.505  &lt; 2e-16 ***\nDESTIN_SZBMSZ03      -1.1334399  0.0063720  -177.878  &lt; 2e-16 ***\nDESTIN_SZBMSZ04      -1.1164759  0.0057743  -193.353  &lt; 2e-16 ***\nDESTIN_SZBMSZ05      -1.1078742  0.0078703  -140.766  &lt; 2e-16 ***\nDESTIN_SZBMSZ06      -2.2787234  0.0155126  -146.895  &lt; 2e-16 ***\nDESTIN_SZBMSZ07      -0.2739089  0.0051924   -52.752  &lt; 2e-16 ***\nDESTIN_SZBMSZ08      -1.6825978  0.0071842  -234.209  &lt; 2e-16 ***\nDESTIN_SZBMSZ09      -3.0047801  0.0159980  -187.823  &lt; 2e-16 ***\nDESTIN_SZBMSZ10      -2.2232689  0.0096907  -229.423  &lt; 2e-16 ***\nDESTIN_SZBMSZ11      -1.9657136  0.0086445  -227.394  &lt; 2e-16 ***\nDESTIN_SZBMSZ12      -1.5359286  0.0089658  -171.310  &lt; 2e-16 ***\nDESTIN_SZBMSZ13      -0.5657561  0.0059960   -94.355  &lt; 2e-16 ***\nDESTIN_SZBMSZ14      -1.6904858  0.0084858  -199.214  &lt; 2e-16 ***\nDESTIN_SZBMSZ15      -1.5268383  0.0079959  -190.953  &lt; 2e-16 ***\nDESTIN_SZBMSZ16      -2.2045600  0.0130872  -168.452  &lt; 2e-16 ***\nDESTIN_SZBMSZ17      -2.2992381  0.0184895  -124.353  &lt; 2e-16 ***\nDESTIN_SZBPSZ01      -0.8549497  0.0065168  -131.191  &lt; 2e-16 ***\nDESTIN_SZBPSZ02      -1.7470549  0.0095751  -182.457  &lt; 2e-16 ***\nDESTIN_SZBPSZ03      -1.4015145  0.0090888  -154.203  &lt; 2e-16 ***\nDESTIN_SZBPSZ04      -0.5250632  0.0066496   -78.962  &lt; 2e-16 ***\nDESTIN_SZBPSZ05       0.3413171  0.0046404    73.553  &lt; 2e-16 ***\nDESTIN_SZBPSZ06      -0.8569188  0.0090795   -94.380  &lt; 2e-16 ***\nDESTIN_SZBPSZ07      -0.0751284  0.0089704    -8.375  &lt; 2e-16 ***\nDESTIN_SZBSSZ01       0.1015228  0.0055735    18.215  &lt; 2e-16 ***\nDESTIN_SZBSSZ02      -0.7066412  0.0063845  -110.682  &lt; 2e-16 ***\nDESTIN_SZBSSZ03       0.1622730  0.0046689    34.756  &lt; 2e-16 ***\nDESTIN_SZBTSZ01       0.5470615  0.0047984   114.009  &lt; 2e-16 ***\nDESTIN_SZBTSZ02      -0.1393371  0.0078266   -17.803  &lt; 2e-16 ***\nDESTIN_SZBTSZ03       0.1474771  0.0059428    24.816  &lt; 2e-16 ***\nDESTIN_SZBTSZ04      -1.2857827  0.0122000  -105.392  &lt; 2e-16 ***\nDESTIN_SZBTSZ05      -0.2629188  0.0081769   -32.154  &lt; 2e-16 ***\nDESTIN_SZBTSZ06      -0.8319920  0.0081401  -102.209  &lt; 2e-16 ***\nDESTIN_SZBTSZ07      -1.8829448  0.0121227  -155.324  &lt; 2e-16 ***\nDESTIN_SZBTSZ08      -1.5732123  0.0116752  -134.748  &lt; 2e-16 ***\nDESTIN_SZCBSZ01      -3.5334327  0.3333510   -10.600  &lt; 2e-16 ***\nDESTIN_SZCCSZ01      -0.2129306  0.0093782   -22.705  &lt; 2e-16 ***\nDESTIN_SZCHSZ01      -0.1494972  0.0113078   -13.221  &lt; 2e-16 ***\nDESTIN_SZCHSZ02       0.0041774  0.0063195     0.661  0.50860    \nDESTIN_SZCHSZ03       2.5565450  0.0046495   549.857  &lt; 2e-16 ***\nDESTIN_SZCKSZ01       0.0489719  0.0053801     9.102  &lt; 2e-16 ***\nDESTIN_SZCKSZ02      -0.3548993  0.0060671   -58.496  &lt; 2e-16 ***\nDESTIN_SZCKSZ03       0.5386351  0.0044913   119.928  &lt; 2e-16 ***\nDESTIN_SZCKSZ04      -0.4425512  0.0073837   -59.936  &lt; 2e-16 ***\nDESTIN_SZCKSZ05      -0.4092591  0.0077267   -52.967  &lt; 2e-16 ***\nDESTIN_SZCKSZ06       0.2207041  0.0074252    29.724  &lt; 2e-16 ***\nDESTIN_SZCLSZ01       0.2851460  0.0052362    54.457  &lt; 2e-16 ***\nDESTIN_SZCLSZ02      -1.9270528  0.0147688  -130.482  &lt; 2e-16 ***\nDESTIN_SZCLSZ03      -0.6266521  0.0086780   -72.212  &lt; 2e-16 ***\nDESTIN_SZCLSZ04      -0.1335581  0.0054216   -24.634  &lt; 2e-16 ***\nDESTIN_SZCLSZ05      -0.8912963  0.0096015   -92.829  &lt; 2e-16 ***\nDESTIN_SZCLSZ06       0.1781234  0.0048150    36.993  &lt; 2e-16 ***\nDESTIN_SZCLSZ07      -0.5609619  0.0062277   -90.075  &lt; 2e-16 ***\nDESTIN_SZCLSZ08      -0.3875308  0.0068390   -56.665  &lt; 2e-16 ***\nDESTIN_SZCLSZ09       0.2539453  0.0072623    34.968  &lt; 2e-16 ***\nDESTIN_SZDTSZ02      -2.5036295  0.0373421   -67.046  &lt; 2e-16 ***\nDESTIN_SZDTSZ03      -0.8956407  0.0149971   -59.721  &lt; 2e-16 ***\nDESTIN_SZDTSZ13      -1.6562176  0.0175441   -94.403  &lt; 2e-16 ***\nDESTIN_SZGLSZ01      -0.2716152  0.0056553   -48.029  &lt; 2e-16 ***\nDESTIN_SZGLSZ02      -0.1735665  0.0055548   -31.246  &lt; 2e-16 ***\nDESTIN_SZGLSZ03       0.7029507  0.0044934   156.441  &lt; 2e-16 ***\nDESTIN_SZGLSZ04       0.5788027  0.0045449   127.351  &lt; 2e-16 ***\nDESTIN_SZGLSZ05       0.6865291  0.0045131   152.118  &lt; 2e-16 ***\nDESTIN_SZHGSZ01       0.3275950  0.0043866    74.681  &lt; 2e-16 ***\nDESTIN_SZHGSZ02      -0.6326974  0.0063517   -99.610  &lt; 2e-16 ***\nDESTIN_SZHGSZ03      -1.0597982  0.0073914  -143.382  &lt; 2e-16 ***\nDESTIN_SZHGSZ04      -0.2267013  0.0052178   -43.448  &lt; 2e-16 ***\nDESTIN_SZHGSZ05      -0.3063050  0.0055452   -55.238  &lt; 2e-16 ***\nDESTIN_SZHGSZ06      -0.7483961  0.0065544  -114.182  &lt; 2e-16 ***\nDESTIN_SZHGSZ07       0.1096958  0.0051309    21.379  &lt; 2e-16 ***\nDESTIN_SZHGSZ08      -0.1374201  0.0056692   -24.240  &lt; 2e-16 ***\nDESTIN_SZHGSZ09       0.0775400  0.0060230    12.874  &lt; 2e-16 ***\nDESTIN_SZHGSZ10      -3.3017475  0.0289292  -114.132  &lt; 2e-16 ***\nDESTIN_SZJESZ01      -0.0489065  0.0057246    -8.543  &lt; 2e-16 ***\nDESTIN_SZJESZ02      -0.5101614  0.0060074   -84.921  &lt; 2e-16 ***\nDESTIN_SZJESZ03      -0.5328921  0.0064129   -83.097  &lt; 2e-16 ***\nDESTIN_SZJESZ04      -0.7348953  0.0082249   -89.351  &lt; 2e-16 ***\nDESTIN_SZJESZ05      -1.0864570  0.0111740   -97.231  &lt; 2e-16 ***\nDESTIN_SZJESZ06       0.2407920  0.0046801    51.451  &lt; 2e-16 ***\nDESTIN_SZJESZ07      -1.1523093  0.0090103  -127.888  &lt; 2e-16 ***\nDESTIN_SZJESZ08      -0.4627356  0.0094529   -48.952  &lt; 2e-16 ***\nDESTIN_SZJESZ09       0.0528616  0.0068126     7.759 8.53e-15 ***\nDESTIN_SZJESZ10       1.0240660  0.0084045   121.848  &lt; 2e-16 ***\nDESTIN_SZJESZ11       0.7875517  0.0076251   103.284  &lt; 2e-16 ***\nDESTIN_SZJWSZ01      -0.1533418  0.0076198   -20.124  &lt; 2e-16 ***\nDESTIN_SZJWSZ02      -0.0011019  0.0059389    -0.186  0.85280    \nDESTIN_SZJWSZ03       0.9063789  0.0046747   193.892  &lt; 2e-16 ***\nDESTIN_SZJWSZ04       0.7019286  0.0049743   141.112  &lt; 2e-16 ***\nDESTIN_SZJWSZ05      -0.5197057  0.0072971   -71.220  &lt; 2e-16 ***\nDESTIN_SZJWSZ06       0.3350986  0.0061171    54.780  &lt; 2e-16 ***\nDESTIN_SZJWSZ07      -0.5961960  0.0328336   -18.158  &lt; 2e-16 ***\nDESTIN_SZJWSZ08       0.8054662  0.0056006   143.819  &lt; 2e-16 ***\nDESTIN_SZJWSZ09       1.5860146  0.0040282   393.723  &lt; 2e-16 ***\nDESTIN_SZKLSZ01      -0.6500838  0.0063560  -102.279  &lt; 2e-16 ***\nDESTIN_SZKLSZ02      -0.7039434  0.0064465  -109.197  &lt; 2e-16 ***\nDESTIN_SZKLSZ03      -1.1972384  0.0075577  -158.413  &lt; 2e-16 ***\nDESTIN_SZKLSZ04      -1.7172228  0.0097573  -175.993  &lt; 2e-16 ***\nDESTIN_SZKLSZ05      -0.6042386  0.0093730   -64.466  &lt; 2e-16 ***\nDESTIN_SZKLSZ06      -3.0201496  0.0389503   -77.539  &lt; 2e-16 ***\nDESTIN_SZKLSZ07      -1.1522413  0.0076607  -150.409  &lt; 2e-16 ***\nDESTIN_SZKLSZ08      -0.6977825  0.0057610  -121.122  &lt; 2e-16 ***\nDESTIN_SZLKSZ01      -0.6895952  0.0268661   -25.668  &lt; 2e-16 ***\nDESTIN_SZMDSZ01      -0.7155951  0.0228203   -31.358  &lt; 2e-16 ***\nDESTIN_SZMDSZ02      -0.8153643  0.0123003   -66.288  &lt; 2e-16 ***\nDESTIN_SZMDSZ03      -2.7745226  0.0301326   -92.077  &lt; 2e-16 ***\nDESTIN_SZMPSZ01      -0.5492095  0.0087198   -62.984  &lt; 2e-16 ***\nDESTIN_SZMPSZ02      -0.6104744  0.0069346   -88.033  &lt; 2e-16 ***\nDESTIN_SZMPSZ03       0.2775047  0.0054964    50.489  &lt; 2e-16 ***\nDESTIN_SZMUSZ02      -2.6322870  0.0214943  -122.464  &lt; 2e-16 ***\nDESTIN_SZNTSZ01      -4.0762008  0.0531046   -76.758  &lt; 2e-16 ***\nDESTIN_SZNTSZ02      -1.9765545  0.0125659  -157.296  &lt; 2e-16 ***\nDESTIN_SZNTSZ03      -1.4563069  0.0085433  -170.462  &lt; 2e-16 ***\nDESTIN_SZNTSZ05      -2.0125598  0.0270737   -74.336  &lt; 2e-16 ***\nDESTIN_SZNTSZ06      -3.0145357  0.0504986   -59.695  &lt; 2e-16 ***\nDESTIN_SZNVSZ01      -0.4693625  0.0053866   -87.135  &lt; 2e-16 ***\nDESTIN_SZNVSZ02      -0.4525631  0.0060428   -74.894  &lt; 2e-16 ***\nDESTIN_SZNVSZ03      -0.4821492  0.0064725   -74.492  &lt; 2e-16 ***\nDESTIN_SZNVSZ04      -1.8929756  0.0128397  -147.432  &lt; 2e-16 ***\nDESTIN_SZNVSZ05      -1.4501752  0.0099737  -145.400  &lt; 2e-16 ***\nDESTIN_SZPGSZ01      -1.2305867  0.0174321   -70.593  &lt; 2e-16 ***\nDESTIN_SZPGSZ02      -0.8232919  0.0080153  -102.715  &lt; 2e-16 ***\nDESTIN_SZPGSZ03       0.2138480  0.0050850    42.054  &lt; 2e-16 ***\nDESTIN_SZPGSZ04       0.1045757  0.0053579    19.518  &lt; 2e-16 ***\nDESTIN_SZPGSZ05      -0.7542450  0.0088883   -84.858  &lt; 2e-16 ***\nDESTIN_SZPLSZ01      -0.0098642  0.0080428    -1.226  0.22003    \nDESTIN_SZPLSZ02      -1.2630412  0.0152594   -82.771  &lt; 2e-16 ***\nDESTIN_SZPLSZ03      -0.1554479  0.0108611   -14.312  &lt; 2e-16 ***\nDESTIN_SZPLSZ04      -1.5505819  0.0114768  -135.105  &lt; 2e-16 ***\nDESTIN_SZPLSZ05      -0.2417805  0.0130391   -18.543  &lt; 2e-16 ***\nDESTIN_SZPNSZ01       0.7926715  0.0073628   107.659  &lt; 2e-16 ***\nDESTIN_SZPNSZ02       2.1914920  0.0073537   298.013  &lt; 2e-16 ***\nDESTIN_SZPNSZ03       1.0246845  0.0086874   117.951  &lt; 2e-16 ***\nDESTIN_SZPNSZ04       2.5522612  0.0091789   278.057  &lt; 2e-16 ***\nDESTIN_SZPNSZ05       1.7995301  0.0138562   129.872  &lt; 2e-16 ***\nDESTIN_SZPRSZ01      -0.6576686  0.0096037   -68.481  &lt; 2e-16 ***\nDESTIN_SZPRSZ02       0.3113532  0.0059851    52.021  &lt; 2e-16 ***\nDESTIN_SZPRSZ03       0.9255296  0.0044779   206.687  &lt; 2e-16 ***\nDESTIN_SZPRSZ04      -0.0028578  0.0093218    -0.307  0.75917    \nDESTIN_SZPRSZ05       0.2457863  0.0058261    42.187  &lt; 2e-16 ***\nDESTIN_SZPRSZ06       0.3692137  0.0064542    57.205  &lt; 2e-16 ***\nDESTIN_SZPRSZ07      -1.6733306  0.0138440  -120.871  &lt; 2e-16 ***\nDESTIN_SZPRSZ08      -0.2221048  0.0074846   -29.675  &lt; 2e-16 ***\nDESTIN_SZQTSZ01      -1.0185488  0.0093179  -109.311  &lt; 2e-16 ***\nDESTIN_SZQTSZ02      -1.2802688  0.0081670  -156.761  &lt; 2e-16 ***\nDESTIN_SZQTSZ03      -1.3322708  0.0079106  -168.415  &lt; 2e-16 ***\nDESTIN_SZQTSZ04      -1.1803631  0.0077366  -152.568  &lt; 2e-16 ***\nDESTIN_SZQTSZ05      -1.2215818  0.0072829  -167.734  &lt; 2e-16 ***\nDESTIN_SZQTSZ06      -1.3213145  0.0074858  -176.509  &lt; 2e-16 ***\nDESTIN_SZQTSZ07      -1.6426306  0.0123347  -133.171  &lt; 2e-16 ***\nDESTIN_SZQTSZ08      -0.2224169  0.0058405   -38.082  &lt; 2e-16 ***\nDESTIN_SZQTSZ09      -0.8142678  0.0069796  -116.665  &lt; 2e-16 ***\nDESTIN_SZQTSZ10      -0.1090496  0.0062573   -17.428  &lt; 2e-16 ***\nDESTIN_SZQTSZ11      -0.0108951  0.0061145    -1.782  0.07477 .  \nDESTIN_SZQTSZ12      -0.8582515  0.0090243   -95.105  &lt; 2e-16 ***\nDESTIN_SZQTSZ13       0.1834409  0.0065231    28.122  &lt; 2e-16 ***\nDESTIN_SZQTSZ14       0.1994454  0.0073615    27.093  &lt; 2e-16 ***\nDESTIN_SZQTSZ15       0.6740197  0.0088699    75.990  &lt; 2e-16 ***\nDESTIN_SZRCSZ01      -0.7746427  0.0079375   -97.593  &lt; 2e-16 ***\nDESTIN_SZRCSZ06      -1.4394098  0.0209931   -68.566  &lt; 2e-16 ***\nDESTIN_SZRVSZ01      -2.6060495  0.0175759  -148.274  &lt; 2e-16 ***\nDESTIN_SZRVSZ02      -2.5823769  0.0354706   -72.803  &lt; 2e-16 ***\nDESTIN_SZRVSZ03      -2.5890601  0.0152644  -169.614  &lt; 2e-16 ***\nDESTIN_SZRVSZ04      -2.2277482  0.0165661  -134.477  &lt; 2e-16 ***\nDESTIN_SZRVSZ05      -3.8610445  0.0298251  -129.456  &lt; 2e-16 ***\nDESTIN_SZSBSZ01      -1.2035529  0.0103954  -115.777  &lt; 2e-16 ***\nDESTIN_SZSBSZ02      -1.0267199  0.0085239  -120.452  &lt; 2e-16 ***\nDESTIN_SZSBSZ03       0.5977382  0.0050336   118.750  &lt; 2e-16 ***\nDESTIN_SZSBSZ04       0.5362769  0.0060573    88.534  &lt; 2e-16 ***\nDESTIN_SZSBSZ05      -1.0440525  0.0089622  -116.495  &lt; 2e-16 ***\nDESTIN_SZSBSZ06      -1.3939595  0.0246679   -56.509  &lt; 2e-16 ***\nDESTIN_SZSBSZ07       0.1029116  0.0235414     4.372 1.23e-05 ***\nDESTIN_SZSBSZ08       1.3564902  0.0060529   224.105  &lt; 2e-16 ***\nDESTIN_SZSBSZ09       0.4573712  0.0056585    80.829  &lt; 2e-16 ***\nDESTIN_SZSESZ02      -0.1553609  0.0056716   -27.393  &lt; 2e-16 ***\nDESTIN_SZSESZ03       0.5412776  0.0043801   123.576  &lt; 2e-16 ***\nDESTIN_SZSESZ04      -0.6382091  0.0065411   -97.568  &lt; 2e-16 ***\nDESTIN_SZSESZ05      -0.3332093  0.0055002   -60.581  &lt; 2e-16 ***\nDESTIN_SZSESZ06      -0.3085951  0.0072340   -42.659  &lt; 2e-16 ***\nDESTIN_SZSESZ07      -2.6237684  0.0245753  -106.764  &lt; 2e-16 ***\nDESTIN_SZSGSZ01      -0.1062372  0.0066634   -15.943  &lt; 2e-16 ***\nDESTIN_SZSGSZ02      -0.0475568  0.0058908    -8.073 6.85e-16 ***\nDESTIN_SZSGSZ03      -0.2118402  0.0055056   -38.477  &lt; 2e-16 ***\nDESTIN_SZSGSZ04      -0.1099618  0.0054841   -20.051  &lt; 2e-16 ***\nDESTIN_SZSGSZ05      -2.1556963  0.0113821  -189.394  &lt; 2e-16 ***\nDESTIN_SZSGSZ06       0.4416352  0.0043842   100.734  &lt; 2e-16 ***\nDESTIN_SZSGSZ07      -0.3949335  0.0059250   -66.655  &lt; 2e-16 ***\nDESTIN_SZSISZ01      -1.2847094  0.0288610   -44.514  &lt; 2e-16 ***\nDESTIN_SZSKSZ01       0.3089834  0.0082924    37.261  &lt; 2e-16 ***\nDESTIN_SZSKSZ02       1.4139309  0.0059981   235.729  &lt; 2e-16 ***\nDESTIN_SZSKSZ03       0.2427688  0.0067373    36.034  &lt; 2e-16 ***\nDESTIN_SZSKSZ04      -0.2527488  0.0161286   -15.671  &lt; 2e-16 ***\nDESTIN_SZSKSZ05       0.6046051  0.0122766    49.249  &lt; 2e-16 ***\nDESTIN_SZSLSZ01      -0.3927387  0.0099790   -39.356  &lt; 2e-16 ***\nDESTIN_SZSLSZ04      -0.5942110  0.0086225   -68.914  &lt; 2e-16 ***\nDESTIN_SZSRSZ01      -2.6855766  0.0138707  -193.615  &lt; 2e-16 ***\nDESTIN_SZTHSZ01      -3.2750084  0.0402668   -81.333  &lt; 2e-16 ***\nDESTIN_SZTHSZ03      -1.7964408  0.0261810   -68.616  &lt; 2e-16 ***\nDESTIN_SZTHSZ04      -2.6323994  0.0241831  -108.853  &lt; 2e-16 ***\nDESTIN_SZTHSZ06      -1.9444390  0.0166052  -117.098  &lt; 2e-16 ***\nDESTIN_SZTMSZ01       0.3856054  0.0063086    61.123  &lt; 2e-16 ***\nDESTIN_SZTMSZ02       1.8586526  0.0039229   473.790  &lt; 2e-16 ***\nDESTIN_SZTMSZ03       1.2601385  0.0044018   286.278  &lt; 2e-16 ***\nDESTIN_SZTMSZ04       1.5884327  0.0043362   366.316  &lt; 2e-16 ***\nDESTIN_SZTMSZ05       1.0377553  0.0063271   164.018  &lt; 2e-16 ***\nDESTIN_SZTNSZ01      -0.9954275  0.0080345  -123.895  &lt; 2e-16 ***\nDESTIN_SZTNSZ02      -2.1032696  0.0109228  -192.557  &lt; 2e-16 ***\nDESTIN_SZTNSZ03      -2.0044892  0.0129215  -155.128  &lt; 2e-16 ***\nDESTIN_SZTNSZ04      -0.9750326  0.0081677  -119.377  &lt; 2e-16 ***\nDESTIN_SZTPSZ01      -0.7788383  0.0068769  -113.254  &lt; 2e-16 ***\nDESTIN_SZTPSZ02       0.2866080  0.0042843    66.898  &lt; 2e-16 ***\nDESTIN_SZTPSZ03      -0.8749841  0.0065470  -133.646  &lt; 2e-16 ***\nDESTIN_SZTPSZ04      -1.6852792  0.0081488  -206.812  &lt; 2e-16 ***\nDESTIN_SZTPSZ05      -1.3721346  0.0068230  -201.104  &lt; 2e-16 ***\nDESTIN_SZTPSZ06      -0.7832133  0.0069164  -113.239  &lt; 2e-16 ***\nDESTIN_SZTPSZ07      -2.3109126  0.0130830  -176.635  &lt; 2e-16 ***\nDESTIN_SZTPSZ08      -1.6406531  0.0104897  -156.406  &lt; 2e-16 ***\nDESTIN_SZTPSZ09      -0.5636273  0.0076848   -73.343  &lt; 2e-16 ***\nDESTIN_SZTPSZ10      -1.5640843  0.0099984  -156.433  &lt; 2e-16 ***\nDESTIN_SZTPSZ11      -0.3700482  0.0059834   -61.846  &lt; 2e-16 ***\nDESTIN_SZTPSZ12      -0.8828228  0.0072302  -122.102  &lt; 2e-16 ***\nDESTIN_SZTSSZ01       0.3529526  0.0221887    15.907  &lt; 2e-16 ***\nDESTIN_SZTSSZ02       1.0265792  0.0153515    66.871  &lt; 2e-16 ***\nDESTIN_SZTSSZ03       1.9647347  0.0092388   212.662  &lt; 2e-16 ***\nDESTIN_SZTSSZ04       1.8649836  0.0089976   207.275  &lt; 2e-16 ***\nDESTIN_SZTSSZ05       2.8437058  0.0085738   331.673  &lt; 2e-16 ***\nDESTIN_SZTSSZ06       3.4238870  0.0161304   212.263  &lt; 2e-16 ***\nDESTIN_SZWCSZ01       2.9550693  0.0051690   571.689  &lt; 2e-16 ***\nDESTIN_SZWCSZ02      -0.8214103  0.0129213   -63.570  &lt; 2e-16 ***\nDESTIN_SZWCSZ03      -1.7393427  0.0347472   -50.057  &lt; 2e-16 ***\nDESTIN_SZWDSZ01       1.3424417  0.0039957   335.972  &lt; 2e-16 ***\nDESTIN_SZWDSZ02      -0.2103694  0.0068601   -30.666  &lt; 2e-16 ***\nDESTIN_SZWDSZ03       0.8268551  0.0051363   160.983  &lt; 2e-16 ***\nDESTIN_SZWDSZ04      -0.0643997  0.0079076    -8.144 3.82e-16 ***\nDESTIN_SZWDSZ05       0.0451985  0.0075732     5.968 2.40e-09 ***\nDESTIN_SZWDSZ06       0.6981330  0.0051936   134.423  &lt; 2e-16 ***\nDESTIN_SZWDSZ07      -0.0403233  0.0067749    -5.952 2.65e-09 ***\nDESTIN_SZWDSZ08       0.2850631  0.0069225    41.179  &lt; 2e-16 ***\nDESTIN_SZWDSZ09       1.3016106  0.0050365   258.433  &lt; 2e-16 ***\nDESTIN_SZYSSZ01       0.7598564  0.0044144   172.133  &lt; 2e-16 ***\nDESTIN_SZYSSZ02       0.2648061  0.0058239    45.469  &lt; 2e-16 ***\nDESTIN_SZYSSZ03      -0.0412163  0.0068337    -6.031 1.63e-09 ***\nDESTIN_SZYSSZ04      -0.0561054  0.0060829    -9.223  &lt; 2e-16 ***\nDESTIN_SZYSSZ05      -0.9970159  0.0121827   -81.839  &lt; 2e-16 ***\nDESTIN_SZYSSZ06      -1.3808376  0.0125738  -109.819  &lt; 2e-16 ***\nDESTIN_SZYSSZ07      -0.7128364  0.0165296   -43.125  &lt; 2e-16 ***\nDESTIN_SZYSSZ08       0.9409510  0.0045886   205.064  &lt; 2e-16 ***\nDESTIN_SZYSSZ09       0.3738436  0.0047971    77.930  &lt; 2e-16 ***\nlog(ORIGIN_AGE25_64)  0.1928847  0.0001667  1157.214  &lt; 2e-16 ***\nlog(dist)            -1.7828141  0.0004794 -3718.501  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 36117615  on 14273  degrees of freedom\nResidual deviance: 12319763  on 13992  degrees of freedom\nAIC: 12404881\n\nNumber of Fisher Scoring iterations: 7\n\n\nWe can examine how the constraints hold for destinations this time.\n\nCalcRSquared(decSIM$data$TRIPS, decSIM$fitted.values)\n\n[1] 0.496166"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#doubly-constrained",
    "href": "in_class_ex3/in_class_ex3.html#doubly-constrained",
    "title": "In Class Exercise 3",
    "section": "Doubly constrained",
    "text": "Doubly constrained\nIn this section, we will fit a doubly constrained SIM by using the code chunk below.\nThe general formula of Doubly Constrained Spatial Interaction Model\n\ndbcSIM &lt;- glm(formula = TRIPS ~ \n                ORIGIN_SZ + \n                DESTIN_SZ + \n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nsummary(dbcSIM)\n\n\nCall:\nglm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log(dist), family = poisson(link = \"log\"), \n    data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n                  Estimate Std. Error   z value Pr(&gt;|z|)    \n(Intercept)     21.9587595  0.0066831  3285.715  &lt; 2e-16 ***\nORIGIN_SZAMSZ02  0.4778050  0.0054127    88.275  &lt; 2e-16 ***\nORIGIN_SZAMSZ03  0.2895973  0.0055517    52.163  &lt; 2e-16 ***\nORIGIN_SZAMSZ04 -0.2628080  0.0060720   -43.282  &lt; 2e-16 ***\nORIGIN_SZAMSZ05 -0.2631404  0.0069008   -38.132  &lt; 2e-16 ***\nORIGIN_SZAMSZ06  0.1722337  0.0062028    27.767  &lt; 2e-16 ***\nORIGIN_SZAMSZ07 -0.9883200  0.0111224   -88.859  &lt; 2e-16 ***\nORIGIN_SZAMSZ08 -0.4052821  0.0104095   -38.934  &lt; 2e-16 ***\nORIGIN_SZAMSZ09  0.0356290  0.0064816     5.497 3.86e-08 ***\nORIGIN_SZAMSZ10  0.4815569  0.0055521    86.735  &lt; 2e-16 ***\nORIGIN_SZAMSZ11 -1.4440079  0.0146079   -98.851  &lt; 2e-16 ***\nORIGIN_SZAMSZ12 -1.7862677  0.0128071  -139.475  &lt; 2e-16 ***\nORIGIN_SZBDSZ01  0.8653749  0.0054381   159.132  &lt; 2e-16 ***\nORIGIN_SZBDSZ02  0.0841000  0.0062834    13.385  &lt; 2e-16 ***\nORIGIN_SZBDSZ03  0.3158343  0.0057510    54.918  &lt; 2e-16 ***\nORIGIN_SZBDSZ04  1.4556701  0.0049986   291.215  &lt; 2e-16 ***\nORIGIN_SZBDSZ05  0.6363125  0.0057193   111.257  &lt; 2e-16 ***\nORIGIN_SZBDSZ06  0.6749341  0.0058650   115.078  &lt; 2e-16 ***\nORIGIN_SZBDSZ07 -1.2176407  0.0113698  -107.095  &lt; 2e-16 ***\nORIGIN_SZBDSZ08 -0.9803580  0.0105604   -92.833  &lt; 2e-16 ***\nORIGIN_SZBKSZ01 -0.2919642  0.0080763   -36.151  &lt; 2e-16 ***\nORIGIN_SZBKSZ02  0.4609570  0.0067997    67.791  &lt; 2e-16 ***\nORIGIN_SZBKSZ03  0.6273448  0.0065989    95.068  &lt; 2e-16 ***\nORIGIN_SZBKSZ04 -0.2499063  0.0076555   -32.644  &lt; 2e-16 ***\nORIGIN_SZBKSZ05 -0.2628428  0.0078905   -33.311  &lt; 2e-16 ***\nORIGIN_SZBKSZ06 -0.2174034  0.0075134   -28.936  &lt; 2e-16 ***\nORIGIN_SZBKSZ07  0.7094093  0.0058574   121.114  &lt; 2e-16 ***\nORIGIN_SZBKSZ08 -0.1614362  0.0067626   -23.872  &lt; 2e-16 ***\nORIGIN_SZBKSZ09 -0.2739085  0.0072969   -37.537  &lt; 2e-16 ***\nORIGIN_SZBLSZ01 -2.4281074  0.0181172  -134.022  &lt; 2e-16 ***\nORIGIN_SZBLSZ02 -2.7305447  0.0219341  -124.489  &lt; 2e-16 ***\nORIGIN_SZBLSZ03 -3.3071431  0.0540398   -61.198  &lt; 2e-16 ***\nORIGIN_SZBLSZ04 -2.4550671  0.0263946   -93.014  &lt; 2e-16 ***\nORIGIN_SZBMSZ01  0.1198976  0.0065964    18.176  &lt; 2e-16 ***\nORIGIN_SZBMSZ02 -1.3908667  0.0083230  -167.112  &lt; 2e-16 ***\nORIGIN_SZBMSZ03 -0.6999122  0.0069754  -100.339  &lt; 2e-16 ***\nORIGIN_SZBMSZ04 -0.2691159  0.0066184   -40.662  &lt; 2e-16 ***\nORIGIN_SZBMSZ05 -2.6163780  0.0190989  -136.991  &lt; 2e-16 ***\nORIGIN_SZBMSZ06 -2.9729956  0.0197182  -150.774  &lt; 2e-16 ***\nORIGIN_SZBMSZ07 -0.7309916  0.0072407  -100.956  &lt; 2e-16 ***\nORIGIN_SZBMSZ08 -1.0019514  0.0073169  -136.936  &lt; 2e-16 ***\nORIGIN_SZBMSZ09 -1.3667460  0.0105325  -129.764  &lt; 2e-16 ***\nORIGIN_SZBMSZ10 -1.6907268  0.0106687  -158.476  &lt; 2e-16 ***\nORIGIN_SZBMSZ11 -1.2288802  0.0082919  -148.202  &lt; 2e-16 ***\nORIGIN_SZBMSZ12 -1.6517767  0.0115101  -143.507  &lt; 2e-16 ***\nORIGIN_SZBMSZ13 -0.7251351  0.0075289   -96.314  &lt; 2e-16 ***\nORIGIN_SZBMSZ14 -1.1534912  0.0082629  -139.599  &lt; 2e-16 ***\nORIGIN_SZBMSZ15 -0.5476774  0.0075710   -72.339  &lt; 2e-16 ***\nORIGIN_SZBMSZ16 -1.5195034  0.0111459  -136.329  &lt; 2e-16 ***\nORIGIN_SZBMSZ17 -1.6026767  0.0184419   -86.904  &lt; 2e-16 ***\nORIGIN_SZBPSZ01  0.5571291  0.0071866    77.523  &lt; 2e-16 ***\nORIGIN_SZBPSZ02  0.0523197  0.0082259     6.360 2.01e-10 ***\nORIGIN_SZBPSZ03  0.2942047  0.0080482    36.555  &lt; 2e-16 ***\nORIGIN_SZBPSZ04  0.6246296  0.0065878    94.816  &lt; 2e-16 ***\nORIGIN_SZBPSZ05  0.8663708  0.0060852   142.372  &lt; 2e-16 ***\nORIGIN_SZBPSZ06 -0.9896182  0.0109551   -90.334  &lt; 2e-16 ***\nORIGIN_SZBPSZ07 -0.5219250  0.0101830   -51.255  &lt; 2e-16 ***\nORIGIN_SZBSSZ01  0.3299588  0.0066440    49.663  &lt; 2e-16 ***\nORIGIN_SZBSSZ02  0.2851357  0.0057077    49.956  &lt; 2e-16 ***\nORIGIN_SZBSSZ03 -0.2084740  0.0063364   -32.901  &lt; 2e-16 ***\nORIGIN_SZBTSZ01  0.1425664  0.0071103    20.051  &lt; 2e-16 ***\nORIGIN_SZBTSZ02 -0.5591999  0.0093616   -59.733  &lt; 2e-16 ***\nORIGIN_SZBTSZ03 -0.3648190  0.0081677   -44.666  &lt; 2e-16 ***\nORIGIN_SZBTSZ04 -1.4555078  0.0120138  -121.152  &lt; 2e-16 ***\nORIGIN_SZBTSZ05 -0.8635510  0.0133848   -64.517  &lt; 2e-16 ***\nORIGIN_SZBTSZ06 -1.1383111  0.0106421  -106.963  &lt; 2e-16 ***\nORIGIN_SZBTSZ07 -2.3477669  0.0160858  -145.953  &lt; 2e-16 ***\nORIGIN_SZBTSZ08 -1.2918779  0.0124862  -103.464  &lt; 2e-16 ***\nORIGIN_SZCBSZ01 -3.3713588  0.0578683   -58.259  &lt; 2e-16 ***\nORIGIN_SZCCSZ01 -0.6029242  0.0153385   -39.308  &lt; 2e-16 ***\nORIGIN_SZCHSZ01 -0.7641380  0.0135100   -56.561  &lt; 2e-16 ***\nORIGIN_SZCHSZ02 -0.8400736  0.0101951   -82.400  &lt; 2e-16 ***\nORIGIN_SZCHSZ03  1.2753127  0.0072576   175.720  &lt; 2e-16 ***\nORIGIN_SZCKSZ01  0.2470943  0.0067135    36.806  &lt; 2e-16 ***\nORIGIN_SZCKSZ02  0.5793581  0.0070498    82.181  &lt; 2e-16 ***\nORIGIN_SZCKSZ03  1.0795767  0.0060642   178.025  &lt; 2e-16 ***\nORIGIN_SZCKSZ04  1.4947920  0.0063122   236.808  &lt; 2e-16 ***\nORIGIN_SZCKSZ05  0.7457580  0.0074071   100.681  &lt; 2e-16 ***\nORIGIN_SZCKSZ06  0.5760952  0.0094861    60.730  &lt; 2e-16 ***\nORIGIN_SZCLSZ01 -0.9061335  0.0098617   -91.884  &lt; 2e-16 ***\nORIGIN_SZCLSZ02 -1.7609479  0.0156124  -112.791  &lt; 2e-16 ***\nORIGIN_SZCLSZ03 -1.0081325  0.0095171  -105.929  &lt; 2e-16 ***\nORIGIN_SZCLSZ04  0.6181200  0.0057953   106.659  &lt; 2e-16 ***\nORIGIN_SZCLSZ05 -2.0462335  0.0168934  -121.127  &lt; 2e-16 ***\nORIGIN_SZCLSZ06  0.7902389  0.0055680   141.924  &lt; 2e-16 ***\nORIGIN_SZCLSZ07 -0.5472929  0.0071001   -77.082  &lt; 2e-16 ***\nORIGIN_SZCLSZ08 -0.2197650  0.0077460   -28.372  &lt; 2e-16 ***\nORIGIN_SZCLSZ09 -1.8175782  0.0195989   -92.739  &lt; 2e-16 ***\nORIGIN_SZDTSZ02 -3.7618796  0.0872098   -43.136  &lt; 2e-16 ***\nORIGIN_SZDTSZ03 -3.4514766  0.0840812   -41.049  &lt; 2e-16 ***\nORIGIN_SZDTSZ13 -3.0627578  0.0352485   -86.891  &lt; 2e-16 ***\nORIGIN_SZGLSZ01 -1.8055929  0.0111938  -161.303  &lt; 2e-16 ***\nORIGIN_SZGLSZ02 -0.1588829  0.0061413   -25.871  &lt; 2e-16 ***\nORIGIN_SZGLSZ03 -0.2508524  0.0064276   -39.027  &lt; 2e-16 ***\nORIGIN_SZGLSZ04  0.8819358  0.0051993   169.627  &lt; 2e-16 ***\nORIGIN_SZGLSZ05  0.6062778  0.0053735   112.828  &lt; 2e-16 ***\nORIGIN_SZHGSZ01  0.3841503  0.0056776    67.660  &lt; 2e-16 ***\nORIGIN_SZHGSZ02  0.3962330  0.0057579    68.815  &lt; 2e-16 ***\nORIGIN_SZHGSZ03  0.2159531  0.0061671    35.017  &lt; 2e-16 ***\nORIGIN_SZHGSZ04  0.7831941  0.0052216   149.992  &lt; 2e-16 ***\nORIGIN_SZHGSZ05  1.1741558  0.0051799   226.677  &lt; 2e-16 ***\nORIGIN_SZHGSZ06 -0.1891403  0.0065556   -28.852  &lt; 2e-16 ***\nORIGIN_SZHGSZ07  0.3105421  0.0057186    54.304  &lt; 2e-16 ***\nORIGIN_SZHGSZ08 -0.0766364  0.0063474   -12.074  &lt; 2e-16 ***\nORIGIN_SZHGSZ09 -1.2211107  0.0101434  -120.384  &lt; 2e-16 ***\nORIGIN_SZHGSZ10 -3.4844709  0.0504793   -69.028  &lt; 2e-16 ***\nORIGIN_SZJESZ01  0.4916496  0.0063444    77.493  &lt; 2e-16 ***\nORIGIN_SZJESZ02  0.1343893  0.0063762    21.077  &lt; 2e-16 ***\nORIGIN_SZJESZ03 -0.2761723  0.0068085   -40.563  &lt; 2e-16 ***\nORIGIN_SZJESZ04 -1.5932744  0.0121402  -131.240  &lt; 2e-16 ***\nORIGIN_SZJESZ05 -2.3041311  0.0160245  -143.788  &lt; 2e-16 ***\nORIGIN_SZJESZ06  0.2811076  0.0062495    44.981  &lt; 2e-16 ***\nORIGIN_SZJESZ07 -1.9413956  0.0136276  -142.461  &lt; 2e-16 ***\nORIGIN_SZJESZ08 -1.3315645  0.0143168   -93.007  &lt; 2e-16 ***\nORIGIN_SZJESZ09  0.4418314  0.0069208    63.841  &lt; 2e-16 ***\nORIGIN_SZJESZ10 -1.5551555  0.0236523   -65.751  &lt; 2e-16 ***\nORIGIN_SZJESZ11 -1.8888230  0.0224630   -84.086  &lt; 2e-16 ***\nORIGIN_SZJWSZ01  0.2564586  0.0084699    30.279  &lt; 2e-16 ***\nORIGIN_SZJWSZ02  0.6899398  0.0061751   111.729  &lt; 2e-16 ***\nORIGIN_SZJWSZ03  1.4761229  0.0057392   257.198  &lt; 2e-16 ***\nORIGIN_SZJWSZ04  0.5701272  0.0065749    86.713  &lt; 2e-16 ***\nORIGIN_SZJWSZ05 -2.1253657  0.0150769  -140.968  &lt; 2e-16 ***\nORIGIN_SZJWSZ06 -1.5307265  0.0131906  -116.047  &lt; 2e-16 ***\nORIGIN_SZJWSZ07 -2.8801618  0.0360772   -79.833  &lt; 2e-16 ***\nORIGIN_SZJWSZ08  1.4428820  0.0059638   241.938  &lt; 2e-16 ***\nORIGIN_SZJWSZ09  1.8968475  0.0055649   340.860  &lt; 2e-16 ***\nORIGIN_SZKLSZ01  0.1116580  0.0059844    18.658  &lt; 2e-16 ***\nORIGIN_SZKLSZ02 -0.9618787  0.0077344  -124.364  &lt; 2e-16 ***\nORIGIN_SZKLSZ03 -0.7070626  0.0070275  -100.613  &lt; 2e-16 ***\nORIGIN_SZKLSZ04 -2.2742765  0.0139991  -162.459  &lt; 2e-16 ***\nORIGIN_SZKLSZ05 -1.1907262  0.0123719   -96.244  &lt; 2e-16 ***\nORIGIN_SZKLSZ06 -5.9774897  0.1857994   -32.172  &lt; 2e-16 ***\nORIGIN_SZKLSZ07 -1.4258369  0.0103083  -138.320  &lt; 2e-16 ***\nORIGIN_SZKLSZ08 -1.7625888  0.0116107  -151.808  &lt; 2e-16 ***\nORIGIN_SZLKSZ01 -2.0541388  0.0448216   -45.829  &lt; 2e-16 ***\nORIGIN_SZMDSZ01 -0.8571117  0.0321054   -26.697  &lt; 2e-16 ***\nORIGIN_SZMDSZ02 -0.6034597  0.0120724   -49.987  &lt; 2e-16 ***\nORIGIN_SZMDSZ03 -2.1681163  0.0201078  -107.825  &lt; 2e-16 ***\nORIGIN_SZMPSZ01 -0.9331562  0.0096218   -96.984  &lt; 2e-16 ***\nORIGIN_SZMPSZ02 -1.0268229  0.0081379  -126.178  &lt; 2e-16 ***\nORIGIN_SZMPSZ03  0.0054001  0.0066875     0.807 0.419385    \nORIGIN_SZMUSZ02 -3.6269863  0.1105492   -32.809  &lt; 2e-16 ***\nORIGIN_SZNTSZ01 -3.0593717  0.0399843   -76.514  &lt; 2e-16 ***\nORIGIN_SZNTSZ02 -3.3331415  0.0251754  -132.397  &lt; 2e-16 ***\nORIGIN_SZNTSZ03 -0.8351522  0.0090372   -92.413  &lt; 2e-16 ***\nORIGIN_SZNTSZ05 -4.2082472  0.0583343   -72.140  &lt; 2e-16 ***\nORIGIN_SZNTSZ06 -3.8549296  0.0593793   -64.920  &lt; 2e-16 ***\nORIGIN_SZNVSZ01  0.2789069  0.0056024    49.784  &lt; 2e-16 ***\nORIGIN_SZNVSZ02 -0.6036857  0.0077126   -78.273  &lt; 2e-16 ***\nORIGIN_SZNVSZ03 -1.0072683  0.0092678  -108.685  &lt; 2e-16 ***\nORIGIN_SZNVSZ04 -0.8723996  0.0101399   -86.037  &lt; 2e-16 ***\nORIGIN_SZNVSZ05 -2.1552928  0.0183064  -117.734  &lt; 2e-16 ***\nORIGIN_SZPGSZ01  0.0520607  0.0157846     3.298 0.000973 ***\nORIGIN_SZPGSZ02 -0.3481687  0.0089328   -38.976  &lt; 2e-16 ***\nORIGIN_SZPGSZ03  0.9095292  0.0058835   154.590  &lt; 2e-16 ***\nORIGIN_SZPGSZ04  1.3653717  0.0054727   249.489  &lt; 2e-16 ***\nORIGIN_SZPGSZ05  0.3762720  0.0073841    50.957  &lt; 2e-16 ***\nORIGIN_SZPLSZ01 -0.9142754  0.0136552   -66.954  &lt; 2e-16 ***\nORIGIN_SZPLSZ02 -1.0987582  0.0175891   -62.468  &lt; 2e-16 ***\nORIGIN_SZPLSZ03 -2.3427113  0.0474176   -49.406  &lt; 2e-16 ***\nORIGIN_SZPLSZ04 -2.9140779  0.0374458   -77.821  &lt; 2e-16 ***\nORIGIN_SZPLSZ05 -2.2381965  0.0261572   -85.567  &lt; 2e-16 ***\nORIGIN_SZPNSZ01  0.9659006  0.0075177   128.484  &lt; 2e-16 ***\nORIGIN_SZPNSZ02 -0.0158348  0.0143869    -1.101 0.271053    \nORIGIN_SZPNSZ03 -2.1837321  0.0224396   -97.316  &lt; 2e-16 ***\nORIGIN_SZPNSZ04 -3.2481509  0.0370762   -87.608  &lt; 2e-16 ***\nORIGIN_SZPNSZ05 -2.0450679  0.0328165   -62.318  &lt; 2e-16 ***\nORIGIN_SZPRSZ01 -0.6701245  0.0141567   -47.336  &lt; 2e-16 ***\nORIGIN_SZPRSZ02  0.7931907  0.0058079   136.570  &lt; 2e-16 ***\nORIGIN_SZPRSZ03  0.4249094  0.0058610    72.498  &lt; 2e-16 ***\nORIGIN_SZPRSZ04 -0.8529967  0.0090997   -93.739  &lt; 2e-16 ***\nORIGIN_SZPRSZ05  0.7865479  0.0055282   142.278  &lt; 2e-16 ***\nORIGIN_SZPRSZ06 -1.3303664  0.0134512   -98.903  &lt; 2e-16 ***\nORIGIN_SZPRSZ07 -3.0458370  0.0181514  -167.802  &lt; 2e-16 ***\nORIGIN_SZPRSZ08 -0.5342399  0.0075966   -70.327  &lt; 2e-16 ***\nORIGIN_SZQTSZ01 -0.2548930  0.0086485   -29.473  &lt; 2e-16 ***\nORIGIN_SZQTSZ02 -0.8662439  0.0076549  -113.162  &lt; 2e-16 ***\nORIGIN_SZQTSZ03 -0.0890168  0.0072455   -12.286  &lt; 2e-16 ***\nORIGIN_SZQTSZ04 -1.4634370  0.0089384  -163.724  &lt; 2e-16 ***\nORIGIN_SZQTSZ05 -0.6535669  0.0077612   -84.210  &lt; 2e-16 ***\nORIGIN_SZQTSZ06 -0.8275765  0.0081835  -101.128  &lt; 2e-16 ***\nORIGIN_SZQTSZ07 -1.5369800  0.0112808  -136.248  &lt; 2e-16 ***\nORIGIN_SZQTSZ08 -0.4437979  0.0075302   -58.936  &lt; 2e-16 ***\nORIGIN_SZQTSZ09 -0.8184934  0.0083589   -97.918  &lt; 2e-16 ***\nORIGIN_SZQTSZ10 -0.6906597  0.0080980   -85.288  &lt; 2e-16 ***\nORIGIN_SZQTSZ11 -2.3251162  0.0154191  -150.795  &lt; 2e-16 ***\nORIGIN_SZQTSZ12 -3.0442790  0.0208985  -145.670  &lt; 2e-16 ***\nORIGIN_SZQTSZ13 -0.7241013  0.0093441   -77.493  &lt; 2e-16 ***\nORIGIN_SZQTSZ14 -1.8225351  0.0138207  -131.870  &lt; 2e-16 ***\nORIGIN_SZQTSZ15 -0.8720806  0.0138589   -62.926  &lt; 2e-16 ***\nORIGIN_SZRCSZ01 -1.8063415  0.0144295  -125.184  &lt; 2e-16 ***\nORIGIN_SZRCSZ06 -0.5370905  0.0101573   -52.877  &lt; 2e-16 ***\nORIGIN_SZRVSZ01 -2.7426167  0.0341386   -80.338  &lt; 2e-16 ***\nORIGIN_SZRVSZ02 -3.0827269  0.0302299  -101.976  &lt; 2e-16 ***\nORIGIN_SZRVSZ03 -2.9133853  0.0262543  -110.968  &lt; 2e-16 ***\nORIGIN_SZRVSZ04 -3.4220022  0.0582209   -58.776  &lt; 2e-16 ***\nORIGIN_SZRVSZ05 -2.6206257  0.0197470  -132.710  &lt; 2e-16 ***\nORIGIN_SZSBSZ01  0.1010337  0.0085117    11.870  &lt; 2e-16 ***\nORIGIN_SZSBSZ02 -0.8810456  0.0098244   -89.680  &lt; 2e-16 ***\nORIGIN_SZSBSZ03  0.8303668  0.0063009   131.785  &lt; 2e-16 ***\nORIGIN_SZSBSZ04  0.3489128  0.0071456    48.829  &lt; 2e-16 ***\nORIGIN_SZSBSZ05 -0.3182914  0.0085560   -37.201  &lt; 2e-16 ***\nORIGIN_SZSBSZ06 -0.9074308  0.0200035   -45.364  &lt; 2e-16 ***\nORIGIN_SZSBSZ07 -0.2217124  0.0167188   -13.261  &lt; 2e-16 ***\nORIGIN_SZSBSZ08 -1.3007367  0.0178771   -72.760  &lt; 2e-16 ***\nORIGIN_SZSBSZ09 -0.9813703  0.0107885   -90.965  &lt; 2e-16 ***\nORIGIN_SZSESZ02  1.1283424  0.0054209   208.146  &lt; 2e-16 ***\nORIGIN_SZSESZ03  1.2389996  0.0051926   238.610  &lt; 2e-16 ***\nORIGIN_SZSESZ04  0.7535119  0.0060371   124.814  &lt; 2e-16 ***\nORIGIN_SZSESZ05 -0.2347978  0.0071482   -32.847  &lt; 2e-16 ***\nORIGIN_SZSESZ06  0.9520620  0.0057572   165.368  &lt; 2e-16 ***\nORIGIN_SZSESZ07 -2.4296685  0.0231677  -104.873  &lt; 2e-16 ***\nORIGIN_SZSGSZ01 -0.6995899  0.0099969   -69.980  &lt; 2e-16 ***\nORIGIN_SZSGSZ02 -1.2602157  0.0111471  -113.053  &lt; 2e-16 ***\nORIGIN_SZSGSZ03  0.0725860  0.0061970    11.713  &lt; 2e-16 ***\nORIGIN_SZSGSZ04  0.2738315  0.0057524    47.603  &lt; 2e-16 ***\nORIGIN_SZSGSZ05 -2.0207710  0.0119838  -168.625  &lt; 2e-16 ***\nORIGIN_SZSGSZ06  0.4885608  0.0054646    89.404  &lt; 2e-16 ***\nORIGIN_SZSGSZ07 -0.8892155  0.0075074  -118.445  &lt; 2e-16 ***\nORIGIN_SZSKSZ01 -0.3682754  0.0108025   -34.092  &lt; 2e-16 ***\nORIGIN_SZSKSZ02  1.1826086  0.0071388   165.659  &lt; 2e-16 ***\nORIGIN_SZSKSZ03 -0.3230177  0.0101683   -31.767  &lt; 2e-16 ***\nORIGIN_SZSKSZ04 -1.8504236  0.0362400   -51.060  &lt; 2e-16 ***\nORIGIN_SZSKSZ05 -0.2759035  0.0185157   -14.901  &lt; 2e-16 ***\nORIGIN_SZSLSZ01 -2.2757902  0.0348766   -65.253  &lt; 2e-16 ***\nORIGIN_SZSLSZ04 -0.0899820  0.0090356    -9.959  &lt; 2e-16 ***\nORIGIN_SZSRSZ01 -2.1460151  0.0187871  -114.228  &lt; 2e-16 ***\nORIGIN_SZTHSZ01 -2.6851549  0.0571841   -46.956  &lt; 2e-16 ***\nORIGIN_SZTHSZ03 -1.0121495  0.0275551   -36.732  &lt; 2e-16 ***\nORIGIN_SZTHSZ04 -2.6129645  0.0345167   -75.701  &lt; 2e-16 ***\nORIGIN_SZTHSZ06 -1.7229100  0.0208134   -82.779  &lt; 2e-16 ***\nORIGIN_SZTMSZ01 -0.2254986  0.0070312   -32.071  &lt; 2e-16 ***\nORIGIN_SZTMSZ02  1.7271575  0.0049219   350.914  &lt; 2e-16 ***\nORIGIN_SZTMSZ03  0.9891319  0.0052266   189.250  &lt; 2e-16 ***\nORIGIN_SZTMSZ04  0.2018090  0.0062114    32.490  &lt; 2e-16 ***\nORIGIN_SZTMSZ05 -1.1882870  0.0125842   -94.427  &lt; 2e-16 ***\nORIGIN_SZTNSZ01 -1.6122620  0.0141911  -113.611  &lt; 2e-16 ***\nORIGIN_SZTNSZ02 -1.5630967  0.0112227  -139.280  &lt; 2e-16 ***\nORIGIN_SZTNSZ03 -2.0739538  0.0149298  -138.914  &lt; 2e-16 ***\nORIGIN_SZTNSZ04 -0.2816960  0.0085295   -33.026  &lt; 2e-16 ***\nORIGIN_SZTPSZ01 -0.7822239  0.0077901  -100.412  &lt; 2e-16 ***\nORIGIN_SZTPSZ02  0.5735478  0.0053042   108.131  &lt; 2e-16 ***\nORIGIN_SZTPSZ03 -0.8748650  0.0074202  -117.903  &lt; 2e-16 ***\nORIGIN_SZTPSZ04 -0.8537831  0.0069792  -122.332  &lt; 2e-16 ***\nORIGIN_SZTPSZ05 -0.5581114  0.0077012   -72.471  &lt; 2e-16 ***\nORIGIN_SZTPSZ06  0.0262001  0.0075241     3.482 0.000497 ***\nORIGIN_SZTPSZ07 -0.5969952  0.0074272   -80.380  &lt; 2e-16 ***\nORIGIN_SZTPSZ08 -1.0537959  0.0111297   -94.683  &lt; 2e-16 ***\nORIGIN_SZTPSZ09 -0.9588508  0.0081314  -117.920  &lt; 2e-16 ***\nORIGIN_SZTPSZ10 -1.1177249  0.0089403  -125.021  &lt; 2e-16 ***\nORIGIN_SZTPSZ11 -0.2799677  0.0067135   -41.702  &lt; 2e-16 ***\nORIGIN_SZTPSZ12 -0.8898871  0.0080215  -110.938  &lt; 2e-16 ***\nORIGIN_SZTSSZ01 -2.6146463  0.0521606   -50.127  &lt; 2e-16 ***\nORIGIN_SZTSSZ02  0.1682588  0.0119965    14.026  &lt; 2e-16 ***\nORIGIN_SZTSSZ03  0.2587653  0.0123809    20.900  &lt; 2e-16 ***\nORIGIN_SZTSSZ04 -0.5473825  0.0135215   -40.482  &lt; 2e-16 ***\nORIGIN_SZTSSZ05 -0.9967379  0.0206068   -48.369  &lt; 2e-16 ***\nORIGIN_SZTSSZ06  0.4933147  0.0229597    21.486  &lt; 2e-16 ***\nORIGIN_SZWCSZ01  1.2524706  0.0111133   112.700  &lt; 2e-16 ***\nORIGIN_SZWCSZ02 -2.8544820  0.0347805   -82.071  &lt; 2e-16 ***\nORIGIN_SZWCSZ03 -5.1277334  0.1475585   -34.751  &lt; 2e-16 ***\nORIGIN_SZWDSZ01  1.4725308  0.0056496   260.645  &lt; 2e-16 ***\nORIGIN_SZWDSZ02  0.1571680  0.0064909    24.214  &lt; 2e-16 ***\nORIGIN_SZWDSZ03  1.2584097  0.0061471   204.717  &lt; 2e-16 ***\nORIGIN_SZWDSZ04  0.8578765  0.0069277   123.833  &lt; 2e-16 ***\nORIGIN_SZWDSZ05  0.1702728  0.0069687    24.434  &lt; 2e-16 ***\nORIGIN_SZWDSZ06  0.1736910  0.0069507    24.989  &lt; 2e-16 ***\nORIGIN_SZWDSZ07 -1.5610176  0.0100803  -154.859  &lt; 2e-16 ***\nORIGIN_SZWDSZ08 -0.9490906  0.0102047   -93.005  &lt; 2e-16 ***\nORIGIN_SZWDSZ09  1.2107011  0.0062294   194.354  &lt; 2e-16 ***\nORIGIN_SZYSSZ01 -0.3324158  0.0074537   -44.598  &lt; 2e-16 ***\nORIGIN_SZYSSZ02  0.8177113  0.0066108   123.693  &lt; 2e-16 ***\nORIGIN_SZYSSZ03  1.6751777  0.0058470   286.503  &lt; 2e-16 ***\nORIGIN_SZYSSZ04  0.8130044  0.0059025   137.738  &lt; 2e-16 ***\nORIGIN_SZYSSZ05  0.3678420  0.0072431    50.785  &lt; 2e-16 ***\nORIGIN_SZYSSZ06 -0.6024384  0.0126722   -47.540  &lt; 2e-16 ***\nORIGIN_SZYSSZ07 -0.7631918  0.0158478   -48.157  &lt; 2e-16 ***\nORIGIN_SZYSSZ08  0.2141930  0.0076154    28.126  &lt; 2e-16 ***\nORIGIN_SZYSSZ09  1.0809368  0.0057973   186.457  &lt; 2e-16 ***\nDESTIN_SZAMSZ02  0.0761304  0.0051207    14.867  &lt; 2e-16 ***\nDESTIN_SZAMSZ03  0.0143394  0.0050755     2.825 0.004724 ** \nDESTIN_SZAMSZ04 -1.2516780  0.0074947  -167.008  &lt; 2e-16 ***\nDESTIN_SZAMSZ05 -1.2312375  0.0076598  -160.741  &lt; 2e-16 ***\nDESTIN_SZAMSZ06 -1.0333412  0.0075283  -137.261  &lt; 2e-16 ***\nDESTIN_SZAMSZ07 -1.5338249  0.0110036  -139.392  &lt; 2e-16 ***\nDESTIN_SZAMSZ08 -0.3751665  0.0075358   -49.784  &lt; 2e-16 ***\nDESTIN_SZAMSZ09 -1.1633493  0.0077556  -150.001  &lt; 2e-16 ***\nDESTIN_SZAMSZ10  0.1017717  0.0053151    19.148  &lt; 2e-16 ***\nDESTIN_SZAMSZ11 -0.8840362  0.0097007   -91.131  &lt; 2e-16 ***\nDESTIN_SZAMSZ12  0.1628123  0.0055220    29.484  &lt; 2e-16 ***\nDESTIN_SZBDSZ01  1.0040794  0.0047922   209.523  &lt; 2e-16 ***\nDESTIN_SZBDSZ02 -0.2478149  0.0063085   -39.283  &lt; 2e-16 ***\nDESTIN_SZBDSZ03  0.1016088  0.0057420    17.696  &lt; 2e-16 ***\nDESTIN_SZBDSZ04  1.1082928  0.0047747   232.116  &lt; 2e-16 ***\nDESTIN_SZBDSZ05  0.8737933  0.0050593   172.712  &lt; 2e-16 ***\nDESTIN_SZBDSZ06  0.2897032  0.0058244    49.740  &lt; 2e-16 ***\nDESTIN_SZBDSZ07 -0.9026193  0.0113656   -79.416  &lt; 2e-16 ***\nDESTIN_SZBDSZ08 -1.7063577  0.0131234  -130.024  &lt; 2e-16 ***\nDESTIN_SZBKSZ01 -1.3892839  0.0083307  -166.767  &lt; 2e-16 ***\nDESTIN_SZBKSZ02 -0.6661120  0.0073464   -90.672  &lt; 2e-16 ***\nDESTIN_SZBKSZ03 -0.9536826  0.0073196  -130.292  &lt; 2e-16 ***\nDESTIN_SZBKSZ04 -0.6655610  0.0065868  -101.044  &lt; 2e-16 ***\nDESTIN_SZBKSZ05 -0.9053119  0.0079264  -114.215  &lt; 2e-16 ***\nDESTIN_SZBKSZ06 -1.2622159  0.0075079  -168.119  &lt; 2e-16 ***\nDESTIN_SZBKSZ07 -0.0423370  0.0056686    -7.469 8.10e-14 ***\nDESTIN_SZBKSZ08 -1.3811240  0.0084985  -162.515  &lt; 2e-16 ***\nDESTIN_SZBKSZ09 -0.0797012  0.0061428   -12.975  &lt; 2e-16 ***\nDESTIN_SZBLSZ01 -0.8859670  0.0088108  -100.555  &lt; 2e-16 ***\nDESTIN_SZBLSZ02  0.1362723  0.0082167    16.585  &lt; 2e-16 ***\nDESTIN_SZBLSZ03  1.2037396  0.0093508   128.732  &lt; 2e-16 ***\nDESTIN_SZBLSZ04 -0.9316219  0.0178080   -52.315  &lt; 2e-16 ***\nDESTIN_SZBMSZ01  0.7188470  0.0061160   117.536  &lt; 2e-16 ***\nDESTIN_SZBMSZ02 -0.0597895  0.0061206    -9.769  &lt; 2e-16 ***\nDESTIN_SZBMSZ03 -0.2427075  0.0069937   -34.704  &lt; 2e-16 ***\nDESTIN_SZBMSZ04 -0.0622494  0.0065569    -9.494  &lt; 2e-16 ***\nDESTIN_SZBMSZ05 -0.2857019  0.0086450   -33.048  &lt; 2e-16 ***\nDESTIN_SZBMSZ06 -1.3486558  0.0158904   -84.872  &lt; 2e-16 ***\nDESTIN_SZBMSZ07  0.4549687  0.0058315    78.020  &lt; 2e-16 ***\nDESTIN_SZBMSZ08 -0.8730268  0.0077814  -112.195  &lt; 2e-16 ***\nDESTIN_SZBMSZ09 -2.0319890  0.0163038  -124.633  &lt; 2e-16 ***\nDESTIN_SZBMSZ10 -1.4319101  0.0102616  -139.541  &lt; 2e-16 ***\nDESTIN_SZBMSZ11 -1.2429176  0.0092250  -134.733  &lt; 2e-16 ***\nDESTIN_SZBMSZ12 -0.8526549  0.0096009   -88.810  &lt; 2e-16 ***\nDESTIN_SZBMSZ13  0.1399907  0.0066885    20.930  &lt; 2e-16 ***\nDESTIN_SZBMSZ14 -1.0103155  0.0091377  -110.566  &lt; 2e-16 ***\nDESTIN_SZBMSZ15 -0.6819769  0.0086179   -79.135  &lt; 2e-16 ***\nDESTIN_SZBMSZ16 -1.4468308  0.0134051  -107.931  &lt; 2e-16 ***\nDESTIN_SZBMSZ17 -1.5312175  0.0186843   -81.952  &lt; 2e-16 ***\nDESTIN_SZBPSZ01 -1.1726725  0.0073257  -160.077  &lt; 2e-16 ***\nDESTIN_SZBPSZ02 -2.1072012  0.0103320  -203.949  &lt; 2e-16 ***\nDESTIN_SZBPSZ03 -1.6944911  0.0098520  -171.995  &lt; 2e-16 ***\nDESTIN_SZBPSZ04 -0.7664610  0.0074458  -102.939  &lt; 2e-16 ***\nDESTIN_SZBPSZ05  0.1358370  0.0056258    24.145  &lt; 2e-16 ***\nDESTIN_SZBPSZ06 -1.2425471  0.0096942  -128.175  &lt; 2e-16 ***\nDESTIN_SZBPSZ07 -0.1666192  0.0094969   -17.545  &lt; 2e-16 ***\nDESTIN_SZBSSZ01  0.3857894  0.0057261    67.374  &lt; 2e-16 ***\nDESTIN_SZBSSZ02 -0.5293265  0.0064886   -81.578  &lt; 2e-16 ***\nDESTIN_SZBSSZ03  0.3909966  0.0048540    80.551  &lt; 2e-16 ***\nDESTIN_SZBTSZ01  0.7114965  0.0054528   130.482  &lt; 2e-16 ***\nDESTIN_SZBTSZ02 -0.0487084  0.0082474    -5.906 3.51e-09 ***\nDESTIN_SZBTSZ03  0.5539032  0.0064423    85.979  &lt; 2e-16 ***\nDESTIN_SZBTSZ04 -0.7120734  0.0128676   -55.339  &lt; 2e-16 ***\nDESTIN_SZBTSZ05  0.2176097  0.0086791    25.073  &lt; 2e-16 ***\nDESTIN_SZBTSZ06 -0.2167084  0.0084925   -25.518  &lt; 2e-16 ***\nDESTIN_SZBTSZ07 -1.4045618  0.0124363  -112.940  &lt; 2e-16 ***\nDESTIN_SZBTSZ08 -0.8213918  0.0120793   -68.000  &lt; 2e-16 ***\nDESTIN_SZCBSZ01 -5.7340877  0.3333916   -17.199  &lt; 2e-16 ***\nDESTIN_SZCCSZ01 -0.0304192  0.0095920    -3.171 0.001518 ** \nDESTIN_SZCHSZ01 -0.2598507  0.0115311   -22.535  &lt; 2e-16 ***\nDESTIN_SZCHSZ02  0.3497750  0.0068334    51.186  &lt; 2e-16 ***\nDESTIN_SZCHSZ03  2.4550172  0.0050883   482.481  &lt; 2e-16 ***\nDESTIN_SZCKSZ01 -0.4691744  0.0063130   -74.319  &lt; 2e-16 ***\nDESTIN_SZCKSZ02 -0.9557084  0.0069331  -137.847  &lt; 2e-16 ***\nDESTIN_SZCKSZ03  0.0442112  0.0057117     7.740 9.91e-15 ***\nDESTIN_SZCKSZ04 -0.8592063  0.0081238  -105.764  &lt; 2e-16 ***\nDESTIN_SZCKSZ05 -1.1745333  0.0087305  -134.532  &lt; 2e-16 ***\nDESTIN_SZCKSZ06 -0.4982877  0.0085514   -58.269  &lt; 2e-16 ***\nDESTIN_SZCLSZ01  0.2665065  0.0059712    44.632  &lt; 2e-16 ***\nDESTIN_SZCLSZ02 -1.9758876  0.0150823  -131.007  &lt; 2e-16 ***\nDESTIN_SZCLSZ03 -0.9051310  0.0091479   -98.944  &lt; 2e-16 ***\nDESTIN_SZCLSZ04 -0.0828732  0.0061559   -13.462  &lt; 2e-16 ***\nDESTIN_SZCLSZ05 -1.1414780  0.0100760  -113.287  &lt; 2e-16 ***\nDESTIN_SZCLSZ06  0.3229402  0.0056269    57.392  &lt; 2e-16 ***\nDESTIN_SZCLSZ07 -0.4833612  0.0069777   -69.272  &lt; 2e-16 ***\nDESTIN_SZCLSZ08 -0.3219670  0.0075615   -42.580  &lt; 2e-16 ***\nDESTIN_SZCLSZ09  0.0564166  0.0080703     6.991 2.74e-12 ***\nDESTIN_SZDTSZ02 -1.6384236  0.0374725   -43.723  &lt; 2e-16 ***\nDESTIN_SZDTSZ03 -0.4021571  0.0152716   -26.334  &lt; 2e-16 ***\nDESTIN_SZDTSZ13 -1.2799441  0.0177095   -72.274  &lt; 2e-16 ***\nDESTIN_SZGLSZ01 -0.0190303  0.0060665    -3.137 0.001707 ** \nDESTIN_SZGLSZ02 -0.0308469  0.0058724    -5.253 1.50e-07 ***\nDESTIN_SZGLSZ03  0.6927638  0.0048456   142.969  &lt; 2e-16 ***\nDESTIN_SZGLSZ04  0.9325848  0.0049183   189.616  &lt; 2e-16 ***\nDESTIN_SZGLSZ05  0.8480056  0.0048801   173.768  &lt; 2e-16 ***\nDESTIN_SZHGSZ01  0.0652969  0.0047795    13.662  &lt; 2e-16 ***\nDESTIN_SZHGSZ02 -0.9498251  0.0066577  -142.667  &lt; 2e-16 ***\nDESTIN_SZHGSZ03 -1.4372499  0.0076387  -188.154  &lt; 2e-16 ***\nDESTIN_SZHGSZ04 -0.5236292  0.0055353   -94.599  &lt; 2e-16 ***\nDESTIN_SZHGSZ05 -0.5420295  0.0058099   -93.295  &lt; 2e-16 ***\nDESTIN_SZHGSZ06 -0.9054730  0.0067581  -133.983  &lt; 2e-16 ***\nDESTIN_SZHGSZ07  0.0215109  0.0054019     3.982 6.83e-05 ***\nDESTIN_SZHGSZ08 -0.0490979  0.0059206    -8.293  &lt; 2e-16 ***\nDESTIN_SZHGSZ09 -0.0711560  0.0062875   -11.317  &lt; 2e-16 ***\nDESTIN_SZHGSZ10 -3.5807154  0.0290642  -123.200  &lt; 2e-16 ***\nDESTIN_SZJESZ01 -0.4023638  0.0065057   -61.848  &lt; 2e-16 ***\nDESTIN_SZJESZ02 -0.7654353  0.0067096  -114.081  &lt; 2e-16 ***\nDESTIN_SZJESZ03 -0.8778812  0.0071238  -123.232  &lt; 2e-16 ***\nDESTIN_SZJESZ04 -1.1998075  0.0088733  -135.215  &lt; 2e-16 ***\nDESTIN_SZJESZ05 -1.5623652  0.0116898  -133.652  &lt; 2e-16 ***\nDESTIN_SZJESZ06  0.2311474  0.0055595    41.577  &lt; 2e-16 ***\nDESTIN_SZJESZ07 -1.2753348  0.0094838  -134.475  &lt; 2e-16 ***\nDESTIN_SZJESZ08 -0.7654533  0.0099306   -77.081  &lt; 2e-16 ***\nDESTIN_SZJESZ09  0.1637628  0.0074164    22.081  &lt; 2e-16 ***\nDESTIN_SZJESZ10  0.7394958  0.0091249    81.041  &lt; 2e-16 ***\nDESTIN_SZJESZ11  0.5157364  0.0086546    59.591  &lt; 2e-16 ***\nDESTIN_SZJWSZ01 -1.0165204  0.0083025  -122.435  &lt; 2e-16 ***\nDESTIN_SZJWSZ02 -0.8530646  0.0067851  -125.727  &lt; 2e-16 ***\nDESTIN_SZJWSZ03  0.5176135  0.0056449    91.695  &lt; 2e-16 ***\nDESTIN_SZJWSZ04  0.3427105  0.0058499    58.584  &lt; 2e-16 ***\nDESTIN_SZJWSZ05 -1.1695940  0.0080069  -146.073  &lt; 2e-16 ***\nDESTIN_SZJWSZ06 -0.7466462  0.0070240  -106.299  &lt; 2e-16 ***\nDESTIN_SZJWSZ07 -3.0124535  0.0333481   -90.334  &lt; 2e-16 ***\nDESTIN_SZJWSZ08 -0.4253502  0.0066584   -63.881  &lt; 2e-16 ***\nDESTIN_SZJWSZ09  0.9428005  0.0053190   177.251  &lt; 2e-16 ***\nDESTIN_SZKLSZ01 -0.2965013  0.0066422   -44.639  &lt; 2e-16 ***\nDESTIN_SZKLSZ02 -0.4921137  0.0067689   -72.702  &lt; 2e-16 ***\nDESTIN_SZKLSZ03 -0.8489213  0.0078294  -108.427  &lt; 2e-16 ***\nDESTIN_SZKLSZ04 -1.2656342  0.0099918  -126.667  &lt; 2e-16 ***\nDESTIN_SZKLSZ05 -0.3570126  0.0096300   -37.073  &lt; 2e-16 ***\nDESTIN_SZKLSZ06 -2.4764906  0.0390868   -63.359  &lt; 2e-16 ***\nDESTIN_SZKLSZ07 -0.7316189  0.0080994   -90.330  &lt; 2e-16 ***\nDESTIN_SZKLSZ08 -0.1115398  0.0061168   -18.235  &lt; 2e-16 ***\nDESTIN_SZLKSZ01 -1.4940710  0.0271518   -55.027  &lt; 2e-16 ***\nDESTIN_SZMDSZ01 -1.6101440  0.0231238   -69.631  &lt; 2e-16 ***\nDESTIN_SZMDSZ02 -0.9339318  0.0126277   -73.959  &lt; 2e-16 ***\nDESTIN_SZMDSZ03 -3.4868547  0.0303657  -114.829  &lt; 2e-16 ***\nDESTIN_SZMPSZ01 -0.4518483  0.0089869   -50.279  &lt; 2e-16 ***\nDESTIN_SZMPSZ02 -0.5868264  0.0073193   -80.176  &lt; 2e-16 ***\nDESTIN_SZMPSZ03  0.4805365  0.0059041    81.391  &lt; 2e-16 ***\nDESTIN_SZMUSZ02 -1.3837581  0.0218713   -63.268  &lt; 2e-16 ***\nDESTIN_SZNTSZ01 -3.0694691  0.0533346   -57.551  &lt; 2e-16 ***\nDESTIN_SZNTSZ02 -1.4992973  0.0130358  -115.014  &lt; 2e-16 ***\nDESTIN_SZNTSZ03 -0.5221236  0.0089923   -58.064  &lt; 2e-16 ***\nDESTIN_SZNTSZ05 -1.9751162  0.0282369   -69.948  &lt; 2e-16 ***\nDESTIN_SZNTSZ06 -3.9959411  0.0511214   -78.166  &lt; 2e-16 ***\nDESTIN_SZNVSZ01 -0.1126966  0.0057077   -19.745  &lt; 2e-16 ***\nDESTIN_SZNVSZ02 -0.0259250  0.0064427    -4.024 5.72e-05 ***\nDESTIN_SZNVSZ03 -0.0123214  0.0067692    -1.820 0.068725 .  \nDESTIN_SZNVSZ04 -1.3371298  0.0130261  -102.650  &lt; 2e-16 ***\nDESTIN_SZNVSZ05 -0.9686333  0.0101539   -95.395  &lt; 2e-16 ***\nDESTIN_SZPGSZ01 -1.1798309  0.0180543   -65.349  &lt; 2e-16 ***\nDESTIN_SZPGSZ02 -1.3289737  0.0085335  -155.736  &lt; 2e-16 ***\nDESTIN_SZPGSZ03 -0.1661373  0.0055166   -30.116  &lt; 2e-16 ***\nDESTIN_SZPGSZ04 -0.3046408  0.0058469   -52.103  &lt; 2e-16 ***\nDESTIN_SZPGSZ05 -1.5412612  0.0093261  -165.264  &lt; 2e-16 ***\nDESTIN_SZPLSZ01 -0.3439667  0.0083504   -41.192  &lt; 2e-16 ***\nDESTIN_SZPLSZ02 -1.7574919  0.0154244  -113.942  &lt; 2e-16 ***\nDESTIN_SZPLSZ03 -0.3455776  0.0112089   -30.831  &lt; 2e-16 ***\nDESTIN_SZPLSZ04 -2.0749385  0.0141153  -146.999  &lt; 2e-16 ***\nDESTIN_SZPLSZ05 -0.4855216  0.0134069   -36.214  &lt; 2e-16 ***\nDESTIN_SZPNSZ01  0.0117816  0.0083558     1.410 0.158543    \nDESTIN_SZPNSZ02  0.7389858  0.0089823    82.272  &lt; 2e-16 ***\nDESTIN_SZPNSZ03 -0.4708719  0.0098588   -47.761  &lt; 2e-16 ***\nDESTIN_SZPNSZ04  1.3156771  0.0111200   118.316  &lt; 2e-16 ***\nDESTIN_SZPNSZ05  0.9881886  0.0153169    64.516  &lt; 2e-16 ***\nDESTIN_SZPRSZ01 -1.0678999  0.0098295  -108.642  &lt; 2e-16 ***\nDESTIN_SZPRSZ02  0.0650279  0.0063927    10.172  &lt; 2e-16 ***\nDESTIN_SZPRSZ03  0.6348138  0.0050147   126.592  &lt; 2e-16 ***\nDESTIN_SZPRSZ04 -0.3640286  0.0097572   -37.309  &lt; 2e-16 ***\nDESTIN_SZPRSZ05  0.0380410  0.0062577     6.079 1.21e-09 ***\nDESTIN_SZPRSZ06  0.3153712  0.0068742    45.877  &lt; 2e-16 ***\nDESTIN_SZPRSZ07 -1.6669973  0.0145573  -114.513  &lt; 2e-16 ***\nDESTIN_SZPRSZ08 -0.6170648  0.0078424   -78.683  &lt; 2e-16 ***\nDESTIN_SZQTSZ01 -0.5496582  0.0098285   -55.925  &lt; 2e-16 ***\nDESTIN_SZQTSZ02 -0.7318114  0.0086807   -84.303  &lt; 2e-16 ***\nDESTIN_SZQTSZ03 -0.5893064  0.0084789   -69.503  &lt; 2e-16 ***\nDESTIN_SZQTSZ04 -0.7103906  0.0085341   -83.242  &lt; 2e-16 ***\nDESTIN_SZQTSZ05 -0.4721472  0.0078164   -60.405  &lt; 2e-16 ***\nDESTIN_SZQTSZ06 -0.6591466  0.0080069   -82.322  &lt; 2e-16 ***\nDESTIN_SZQTSZ07 -0.9540454  0.0126807   -75.236  &lt; 2e-16 ***\nDESTIN_SZQTSZ08  0.4508867  0.0064870    69.507  &lt; 2e-16 ***\nDESTIN_SZQTSZ09 -0.4061810  0.0075485   -53.810  &lt; 2e-16 ***\nDESTIN_SZQTSZ10  0.1351889  0.0068202    19.822  &lt; 2e-16 ***\nDESTIN_SZQTSZ11  0.3181553  0.0067958    46.816  &lt; 2e-16 ***\nDESTIN_SZQTSZ12 -0.1055766  0.0095576   -11.046  &lt; 2e-16 ***\nDESTIN_SZQTSZ13  0.5199663  0.0071928    72.290  &lt; 2e-16 ***\nDESTIN_SZQTSZ14  0.6086332  0.0078537    77.496  &lt; 2e-16 ***\nDESTIN_SZQTSZ15  1.3906866  0.0092250   150.753  &lt; 2e-16 ***\nDESTIN_SZRCSZ01 -0.0862091  0.0085363   -10.099  &lt; 2e-16 ***\nDESTIN_SZRCSZ06 -1.0186282  0.0211113   -48.250  &lt; 2e-16 ***\nDESTIN_SZRVSZ01 -1.5294454  0.0179337   -85.283  &lt; 2e-16 ***\nDESTIN_SZRVSZ02 -2.3607754  0.0355628   -66.383  &lt; 2e-16 ***\nDESTIN_SZRVSZ03 -1.5266254  0.0156276   -97.688  &lt; 2e-16 ***\nDESTIN_SZRVSZ04 -1.0986565  0.0168695   -65.127  &lt; 2e-16 ***\nDESTIN_SZRVSZ05 -2.4004418  0.0320917   -74.799  &lt; 2e-16 ***\nDESTIN_SZSBSZ01 -1.4023966  0.0109496  -128.078  &lt; 2e-16 ***\nDESTIN_SZSBSZ02 -1.3899893  0.0090891  -152.929  &lt; 2e-16 ***\nDESTIN_SZSBSZ03  0.4509008  0.0059864    75.321  &lt; 2e-16 ***\nDESTIN_SZSBSZ04  0.1796309  0.0070142    25.610  &lt; 2e-16 ***\nDESTIN_SZSBSZ05 -1.3159699  0.0096485  -136.391  &lt; 2e-16 ***\nDESTIN_SZSBSZ06 -1.7705263  0.0253064   -69.964  &lt; 2e-16 ***\nDESTIN_SZSBSZ07 -0.7471529  0.0238628   -31.310  &lt; 2e-16 ***\nDESTIN_SZSBSZ08  0.7884520  0.0069638   113.221  &lt; 2e-16 ***\nDESTIN_SZSBSZ09  0.0131702  0.0066350     1.985 0.047150 *  \nDESTIN_SZSESZ02 -0.7247347  0.0060626  -119.541  &lt; 2e-16 ***\nDESTIN_SZSESZ03  0.1032728  0.0048330    21.368  &lt; 2e-16 ***\nDESTIN_SZSESZ04 -1.0992420  0.0068328  -160.878  &lt; 2e-16 ***\nDESTIN_SZSESZ05 -0.8374712  0.0058155  -144.006  &lt; 2e-16 ***\nDESTIN_SZSESZ06 -0.5531619  0.0074766   -73.985  &lt; 2e-16 ***\nDESTIN_SZSESZ07 -3.0328672  0.0246371  -123.101  &lt; 2e-16 ***\nDESTIN_SZSGSZ01 -0.1933777  0.0068235   -28.340  &lt; 2e-16 ***\nDESTIN_SZSGSZ02 -0.3000845  0.0060284   -49.779  &lt; 2e-16 ***\nDESTIN_SZSGSZ03 -0.4322879  0.0057308   -75.433  &lt; 2e-16 ***\nDESTIN_SZSGSZ04 -0.1214792  0.0056548   -21.482  &lt; 2e-16 ***\nDESTIN_SZSGSZ05 -2.0309074  0.0114993  -176.611  &lt; 2e-16 ***\nDESTIN_SZSGSZ06  0.6592095  0.0046364   142.182  &lt; 2e-16 ***\nDESTIN_SZSGSZ07 -0.4618538  0.0062027   -74.460  &lt; 2e-16 ***\nDESTIN_SZSISZ01 -0.5227257  0.0293399   -17.816  &lt; 2e-16 ***\nDESTIN_SZSKSZ01 -0.4797341  0.0091087   -52.668  &lt; 2e-16 ***\nDESTIN_SZSKSZ02  0.8477357  0.0067821   124.996  &lt; 2e-16 ***\nDESTIN_SZSKSZ03 -0.2477566  0.0074817   -33.115  &lt; 2e-16 ***\nDESTIN_SZSKSZ04 -1.3315992  0.0167055   -79.710  &lt; 2e-16 ***\nDESTIN_SZSKSZ05 -0.3519096  0.0131326   -26.797  &lt; 2e-16 ***\nDESTIN_SZSLSZ01 -0.8570431  0.0102100   -83.941  &lt; 2e-16 ***\nDESTIN_SZSLSZ04 -0.9949105  0.0088280  -112.699  &lt; 2e-16 ***\nDESTIN_SZSRSZ01 -1.0260696  0.0154393   -66.458  &lt; 2e-16 ***\nDESTIN_SZTHSZ01 -4.2040410  0.0404795  -103.856  &lt; 2e-16 ***\nDESTIN_SZTHSZ03 -2.4907000  0.0264056   -94.325  &lt; 2e-16 ***\nDESTIN_SZTHSZ04 -3.0701470  0.0244975  -125.325  &lt; 2e-16 ***\nDESTIN_SZTHSZ06 -2.5308161  0.0169699  -149.135  &lt; 2e-16 ***\nDESTIN_SZTMSZ01 -0.2354889  0.0067201   -35.042  &lt; 2e-16 ***\nDESTIN_SZTMSZ02  1.7379292  0.0044573   389.906  &lt; 2e-16 ***\nDESTIN_SZTMSZ03  0.9112458  0.0048718   187.043  &lt; 2e-16 ***\nDESTIN_SZTMSZ04  1.0731075  0.0048626   220.685  &lt; 2e-16 ***\nDESTIN_SZTMSZ05  0.6398583  0.0067321    95.046  &lt; 2e-16 ***\nDESTIN_SZTNSZ01 -0.3500456  0.0083835   -41.754  &lt; 2e-16 ***\nDESTIN_SZTNSZ02 -1.0573515  0.0112412   -94.060  &lt; 2e-16 ***\nDESTIN_SZTNSZ03 -1.4069979  0.0132733  -106.002  &lt; 2e-16 ***\nDESTIN_SZTNSZ04 -0.3616604  0.0085207   -42.445  &lt; 2e-16 ***\nDESTIN_SZTPSZ01 -0.5919243  0.0071153   -83.190  &lt; 2e-16 ***\nDESTIN_SZTPSZ02  0.7083350  0.0046540   152.198  &lt; 2e-16 ***\nDESTIN_SZTPSZ03 -0.5746433  0.0069625   -82.534  &lt; 2e-16 ***\nDESTIN_SZTPSZ04 -1.5821259  0.0084517  -187.196  &lt; 2e-16 ***\nDESTIN_SZTPSZ05 -1.1796256  0.0073039  -161.505  &lt; 2e-16 ***\nDESTIN_SZTPSZ06 -0.3968272  0.0077295   -51.339  &lt; 2e-16 ***\nDESTIN_SZTPSZ07 -2.1796617  0.0135199  -161.219  &lt; 2e-16 ***\nDESTIN_SZTPSZ08 -1.2568483  0.0107267  -117.170  &lt; 2e-16 ***\nDESTIN_SZTPSZ09 -0.2446623  0.0080840   -30.265  &lt; 2e-16 ***\nDESTIN_SZTPSZ10 -1.2542191  0.0102049  -122.904  &lt; 2e-16 ***\nDESTIN_SZTPSZ11 -0.0886883  0.0062888   -14.102  &lt; 2e-16 ***\nDESTIN_SZTPSZ12 -0.7211823  0.0075086   -96.048  &lt; 2e-16 ***\nDESTIN_SZTSSZ01 -1.6271921  0.0238498   -68.227  &lt; 2e-16 ***\nDESTIN_SZTSSZ02 -0.3340439  0.0169137   -19.750  &lt; 2e-16 ***\nDESTIN_SZTSSZ03  0.3924580  0.0111060    35.338  &lt; 2e-16 ***\nDESTIN_SZTSSZ04  0.4169932  0.0114926    36.283  &lt; 2e-16 ***\nDESTIN_SZTSSZ05  1.3206287  0.0120381   109.704  &lt; 2e-16 ***\nDESTIN_SZTSSZ06  2.4023725  0.0192840   124.579  &lt; 2e-16 ***\nDESTIN_SZWCSZ01  2.0697378  0.0061379   337.206  &lt; 2e-16 ***\nDESTIN_SZWCSZ02 -2.0934025  0.0134782  -155.318  &lt; 2e-16 ***\nDESTIN_SZWCSZ03 -3.0670149  0.0349748   -87.692  &lt; 2e-16 ***\nDESTIN_SZWDSZ01  1.0113215  0.0051461   196.522  &lt; 2e-16 ***\nDESTIN_SZWDSZ02 -1.3383793  0.0076482  -174.993  &lt; 2e-16 ***\nDESTIN_SZWDSZ03  0.3394361  0.0060396    56.202  &lt; 2e-16 ***\nDESTIN_SZWDSZ04 -0.8324928  0.0086019   -96.780  &lt; 2e-16 ***\nDESTIN_SZWDSZ05 -0.8279090  0.0083251   -99.447  &lt; 2e-16 ***\nDESTIN_SZWDSZ06 -0.2252899  0.0061074   -36.888  &lt; 2e-16 ***\nDESTIN_SZWDSZ07 -1.3638599  0.0077990  -174.877  &lt; 2e-16 ***\nDESTIN_SZWDSZ08 -0.4350176  0.0077566   -56.083  &lt; 2e-16 ***\nDESTIN_SZWDSZ09  0.5461048  0.0060745    89.901  &lt; 2e-16 ***\nDESTIN_SZYSSZ01  0.0243093  0.0053476     4.546 5.47e-06 ***\nDESTIN_SZYSSZ02 -0.3398962  0.0065947   -51.540  &lt; 2e-16 ***\nDESTIN_SZYSSZ03 -0.3694187  0.0074032   -49.900  &lt; 2e-16 ***\nDESTIN_SZYSSZ04 -0.5222848  0.0067396   -77.495  &lt; 2e-16 ***\nDESTIN_SZYSSZ05 -1.5460539  0.0124899  -123.784  &lt; 2e-16 ***\nDESTIN_SZYSSZ06 -1.5556892  0.0127640  -121.881  &lt; 2e-16 ***\nDESTIN_SZYSSZ07 -0.8673403  0.0167723   -51.713  &lt; 2e-16 ***\nDESTIN_SZYSSZ08  0.5389364  0.0052540   102.577  &lt; 2e-16 ***\nDESTIN_SZYSSZ09  0.1199483  0.0055235    21.716  &lt; 2e-16 ***\nlog(dist)       -1.8906989  0.0005319 -3554.786  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 36117615  on 14273  degrees of freedom\nResidual deviance:  8091747  on 13715  degrees of freedom\nAIC: 8177420\n\nNumber of Fisher Scoring iterations: 7\n\n\n\nCalcRSquared(dbcSIM$data$TRIPS, dbcSIM$fitted.values)\n\n[1] 0.6883675"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#model-comparison",
    "href": "in_class_ex3/in_class_ex3.html#model-comparison",
    "title": "In Class Exercise 3",
    "section": "Model comparison",
    "text": "Model comparison\nAnother useful model performance measure for continuous dependent variable is Root Mean Squared Error. In this sub-section, you will learn how to use compare_performance() of performance package\nFirst of all, let us create a list called model_list by using the code chun below.\n\nmodel_list &lt;- list(unconstrained=uncSIM,\n                   originConstrained=orcSIM,\n                   destinationConstrained=decSIM,\n                   doublyConstrained=dbcSIM)\n\nNext, we will compute the RMSE of all the models in model_list file by using the code chunk below.\n\ncompare_performance(model_list,\n                    metrics = \"RMSE\")\n\n# Comparison of Model Performance Indices\n\nName                   | Model |     RMSE\n-----------------------------------------\nunconstrained          |   glm | 2429.978\noriginConstrained      |   glm | 2057.579\ndestinationConstrained |   glm | 1891.724\ndoublyConstrained      |   glm | 1487.111"
  },
  {
    "objectID": "in_class_ex3/in_class_ex3.html#visualising-fitted",
    "href": "in_class_ex3/in_class_ex3.html#visualising-fitted",
    "title": "In Class Exercise 3",
    "section": "Visualising fitted",
    "text": "Visualising fitted\nIn this section, you will learn how to visualise the observed values and the fitted values.\nFirstly we will extract the fitted values from each model by using the code chunk below.\n\ndf &lt;- as.data.frame(uncSIM$fitted.values) %&gt;%\n  round(digits = 0)\n\nNext, we will join the values to SIM_data data frame.\n\nSIM_data &lt;- SIM_data %&gt;%   cbind(df) %&gt;%   rename(uncTRIPS = \"uncSIM$fitted.values\")\n\nRepeat the same step by for Origin Constrained SIM (i.e. orcSIM)\n\ndf &lt;- as.data.frame(orcSIM$fitted.values) %&gt;%   round(digits = 0)\n\n\nSIM_data &lt;- SIM_data %&gt;%   cbind(df) %&gt;%   rename(orcTRIPS = \"orcSIM$fitted.values\")\n\nRepeat the same step by for Destination Constrained SIM (i.e. decSIM)\n\ndf &lt;- as.data.frame(decSIM$fitted.values) %&gt;%   round(digits = 0)\n\n\nSIM_data &lt;- SIM_data %&gt;%   cbind(df) %&gt;%   rename(decTRIPS = \"decSIM$fitted.values\")\n\nRepeat the same step by for Doubly Constrained SIM (i.e. dbcSIM)\n\ndf &lt;- as.data.frame(dbcSIM$fitted.values) %&gt;%   round(digits = 0)\n\n\nSIM_data &lt;- SIM_data %&gt;%   cbind(df) %&gt;%   rename(dbcTRIPS = \"dbcSIM$fitted.values\")\n\n\nunc_p &lt;- ggplot(data = SIM_data,\n                aes(x = uncTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\norc_p &lt;- ggplot(data = SIM_data,\n                aes(x = orcTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\ndec_p &lt;- ggplot(data = SIM_data,\n                aes(x = decTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\ndbc_p &lt;- ggplot(data = SIM_data,\n                aes(x = dbcTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\nggarrange(unc_p, orc_p, dec_p, dbc_p,\n          ncol = 2,\n          nrow = 2)\n\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'"
  },
  {
    "objectID": "in_class_ex4/data/geospatial/Business.html",
    "href": "in_class_ex4/data/geospatial/Business.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "in_class_ex4/data/geospatial/MPSZ-2019.html",
    "href": "in_class_ex4/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.1.html",
    "href": "in_class_ex4/in_class_ex4.1.html",
    "title": "In-class Exercise 4: Calibrating Spatial Interaction Models with R",
    "section": "",
    "text": "This in-class exercise is a continuation of Hands-on Exercise 3, In-class Exercise 3 and In-class Exercise 4: Preparing Spatial Interaction Modelling Variables. We will continue our journey of calibrating Spatial Interaction Models by using propulsiveness and attractiveness variables prepared in earlier in-class exercise."
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.1.html#overview",
    "href": "in_class_ex4/in_class_ex4.1.html#overview",
    "title": "In-class Exercise 4: Calibrating Spatial Interaction Models with R",
    "section": "",
    "text": "This in-class exercise is a continuation of Hands-on Exercise 3, In-class Exercise 3 and In-class Exercise 4: Preparing Spatial Interaction Modelling Variables. We will continue our journey of calibrating Spatial Interaction Models by using propulsiveness and attractiveness variables prepared in earlier in-class exercise."
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.1.html#getting-started",
    "href": "in_class_ex4/in_class_ex4.1.html#getting-started",
    "title": "In-class Exercise 4: Calibrating Spatial Interaction Models with R",
    "section": "Getting Started",
    "text": "Getting Started\n\npacman::p_load(tmap, sf, performance, knitr,\n               AER, MASS, ggpubr, tidyverse,\n               epiDisplay)"
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.1.html#the-data",
    "href": "in_class_ex4/in_class_ex4.1.html#the-data",
    "title": "In-class Exercise 4: Calibrating Spatial Interaction Models with R",
    "section": "The Data",
    "text": "The Data\n\nflow_data &lt;- read_rds(\"data/rds/flow_data_tidy.rds\")\n\n\nglimpse(flow_data)\n\nRows: 14,734\nColumns: 13\n$ ORIGIN_SZ       &lt;chr&gt; \"AMSZ01\", \"AMSZ01\", \"AMSZ01\", \"AMSZ01\", \"AMSZ01\", \"AMS…\n$ DESTIN_SZ       &lt;chr&gt; \"AMSZ01\", \"AMSZ02\", \"AMSZ03\", \"AMSZ04\", \"AMSZ05\", \"AMS…\n$ MORNING_PEAK    &lt;dbl&gt; 1998, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, …\n$ dist            &lt;dbl&gt; 50.0000, 810.4491, 1360.9294, 840.4432, 1076.7916, 805…\n$ ORIGIN_AGE7_12  &lt;dbl&gt; 310, 310, 310, 310, 310, 310, 310, 310, 310, 310, 310,…\n$ ORIGIN_AGE13_24 &lt;dbl&gt; 710, 710, 710, 710, 710, 710, 710, 710, 710, 710, 710,…\n$ ORIGIN_AGE25_64 &lt;dbl&gt; 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, …\n$ DESTIN_AGE7_12  &lt;dbl&gt; 310.00, 1140.00, 1010.00, 980.00, 810.00, 1050.00, 420…\n$ DESTIN_AGE13_24 &lt;dbl&gt; 710.00, 2770.00, 2650.00, 2000.00, 1920.00, 2390.00, 1…\n$ DESTIN_AGE25_64 &lt;dbl&gt; 2780.00, 15700.00, 14240.00, 11320.00, 9650.00, 12460.…\n$ SCHOOL_COUNT    &lt;dbl&gt; 0.99, 2.00, 2.00, 1.00, 3.00, 2.00, 0.99, 0.99, 3.00, …\n$ RETAIL_COUNT    &lt;dbl&gt; 1.00, 0.99, 6.00, 0.99, 0.99, 0.99, 1.00, 117.00, 0.99…\n$ geometry        &lt;LINESTRING [m]&gt; LINESTRING (29501.77 39419...., LINESTRING …\n\n\n\nkable(head(flow_data[, 1:5], n = 5))\n\n\n\n\n\n\n\n\n\n\n\n\nORIGIN_SZ\nDESTIN_SZ\nMORNING_PEAK\ndist\nORIGIN_AGE7_12\ngeometry\n\n\n\n\nAMSZ01\nAMSZ01\n1998\n50.0000\n310\nLINESTRING (29501.77 39419….\n\n\nAMSZ01\nAMSZ02\n8289\n810.4491\n310\nLINESTRING (29501.77 39419….\n\n\nAMSZ01\nAMSZ03\n8971\n1360.9294\n310\nLINESTRING (29501.77 39419….\n\n\nAMSZ01\nAMSZ04\n2252\n840.4432\n310\nLINESTRING (29501.77 39419….\n\n\nAMSZ01\nAMSZ05\n6136\n1076.7916\n310\nLINESTRING (29501.77 39419….\n\n\n\n\n\n\nPreparing inter-zonal flow data\n\nflow_data$FlowNoIntra &lt;- ifelse(\n  flow_data$ORIGIN_SZ == flow_data$DESTIN_SZ,\n  0, flow_data$MORNING_PEAK)\nflow_data$offset &lt;- ifelse(\n  flow_data$ORIGIN_SZ == flow_data$DESTIN_SZ,\n  0.000001, 1)\n\n\ninter_zonal_flow &lt;- flow_data %&gt;%\n  filter(FlowNoIntra &gt; 0)"
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.1.html#calibrating-spatial-interaction-models",
    "href": "in_class_ex4/in_class_ex4.1.html#calibrating-spatial-interaction-models",
    "title": "In-class Exercise 4: Calibrating Spatial Interaction Models with R",
    "section": "Calibrating Spatial Interaction Models",
    "text": "Calibrating Spatial Interaction Models\n\nOrigin- (Production-) constrained Model\n\norcSIM_Poisson &lt;- glm(formula = MORNING_PEAK ~ \n                ORIGIN_SZ +\n                log(SCHOOL_COUNT) +\n                log(dist) - 1,\n              family = poisson(link = \"log\"),\n              data = inter_zonal_flow,\n              na.action = na.exclude)\nsummary(orcSIM_Poisson)\n\n\nCall:\nglm(formula = MORNING_PEAK ~ ORIGIN_SZ + log(SCHOOL_COUNT) + \n    log(dist) - 1, family = poisson(link = \"log\"), data = inter_zonal_flow, \n    na.action = na.exclude)\n\nCoefficients:\n                    Estimate Std. Error  z value Pr(&gt;|z|)    \nORIGIN_SZAMSZ01   19.8348561  0.0047238  4198.89   &lt;2e-16 ***\nORIGIN_SZAMSZ02   20.5944893  0.0042428  4854.01   &lt;2e-16 ***\nORIGIN_SZAMSZ03   20.2196800  0.0045182  4475.14   &lt;2e-16 ***\nORIGIN_SZAMSZ04   19.7601499  0.0049621  3982.22   &lt;2e-16 ***\nORIGIN_SZAMSZ05   19.6201706  0.0056125  3495.81   &lt;2e-16 ***\nORIGIN_SZAMSZ06   19.9227734  0.0048571  4101.75   &lt;2e-16 ***\nORIGIN_SZAMSZ07   18.6888684  0.0096199  1942.72   &lt;2e-16 ***\nORIGIN_SZAMSZ08   19.1748771  0.0090571  2117.11   &lt;2e-16 ***\nORIGIN_SZAMSZ09   20.0034895  0.0052661  3798.53   &lt;2e-16 ***\nORIGIN_SZAMSZ10   20.2709047  0.0045301  4474.74   &lt;2e-16 ***\nORIGIN_SZAMSZ11   18.4507374  0.0129172  1428.39   &lt;2e-16 ***\nORIGIN_SZAMSZ12   18.3551601  0.0109577  1675.10   &lt;2e-16 ***\nORIGIN_SZBDSZ01   21.1681145  0.0043259  4893.40   &lt;2e-16 ***\nORIGIN_SZBDSZ02   20.6704634  0.0050452  4097.04   &lt;2e-16 ***\nORIGIN_SZBDSZ03   20.9386261  0.0045286  4623.64   &lt;2e-16 ***\nORIGIN_SZBDSZ04   21.7923608  0.0038648  5638.66   &lt;2e-16 ***\nORIGIN_SZBDSZ05   20.8655426  0.0045860  4549.88   &lt;2e-16 ***\nORIGIN_SZBDSZ06   21.0481502  0.0046044  4571.31   &lt;2e-16 ***\nORIGIN_SZBDSZ07   19.1946161  0.0097935  1959.93   &lt;2e-16 ***\nORIGIN_SZBDSZ08   19.2698235  0.0091091  2115.44   &lt;2e-16 ***\nORIGIN_SZBKSZ01   19.4843657  0.0064508  3020.45   &lt;2e-16 ***\nORIGIN_SZBKSZ02   20.1201070  0.0049850  4036.12   &lt;2e-16 ***\nORIGIN_SZBKSZ03   20.3562182  0.0047005  4330.62   &lt;2e-16 ***\nORIGIN_SZBKSZ04   19.5528328  0.0059397  3291.90   &lt;2e-16 ***\nORIGIN_SZBKSZ05   19.6019882  0.0063059  3108.51   &lt;2e-16 ***\nORIGIN_SZBKSZ06   19.6583036  0.0056117  3503.10   &lt;2e-16 ***\nORIGIN_SZBKSZ07   20.4422246  0.0041776  4893.29   &lt;2e-16 ***\nORIGIN_SZBKSZ08   19.8790301  0.0050429  3941.96   &lt;2e-16 ***\nORIGIN_SZBKSZ09   19.8092400  0.0055440  3573.10   &lt;2e-16 ***\nORIGIN_SZBLSZ01   18.1240710  0.0149002  1216.36   &lt;2e-16 ***\nORIGIN_SZBLSZ02   17.8130174  0.0192358   926.03   &lt;2e-16 ***\nORIGIN_SZBLSZ03   16.9580022  0.0462658   366.53   &lt;2e-16 ***\nORIGIN_SZBLSZ04   18.2702931  0.0233271   783.22   &lt;2e-16 ***\nORIGIN_SZBMSZ01   20.0444122  0.0052589  3811.51   &lt;2e-16 ***\nORIGIN_SZBMSZ02   18.6031531  0.0066413  2801.14   &lt;2e-16 ***\nORIGIN_SZBMSZ03   19.3188719  0.0054609  3537.65   &lt;2e-16 ***\nORIGIN_SZBMSZ04   19.4012617  0.0049051  3955.35   &lt;2e-16 ***\nORIGIN_SZBMSZ05   16.8827045  0.0168726  1000.60   &lt;2e-16 ***\nORIGIN_SZBMSZ06   16.9290380  0.0181768   931.35   &lt;2e-16 ***\nORIGIN_SZBMSZ07   19.2421046  0.0056052  3432.92   &lt;2e-16 ***\nORIGIN_SZBMSZ08   19.1050263  0.0055689  3430.64   &lt;2e-16 ***\nORIGIN_SZBMSZ09   18.6535335  0.0086043  2167.93   &lt;2e-16 ***\nORIGIN_SZBMSZ10   18.2887211  0.0089018  2054.51   &lt;2e-16 ***\nORIGIN_SZBMSZ11   18.8239689  0.0063079  2984.18   &lt;2e-16 ***\nORIGIN_SZBMSZ12   18.7093457  0.0092939  2013.08   &lt;2e-16 ***\nORIGIN_SZBMSZ13   19.6160534  0.0057392  3417.89   &lt;2e-16 ***\nORIGIN_SZBMSZ14   19.0511599  0.0063250  3012.02   &lt;2e-16 ***\nORIGIN_SZBMSZ15   19.3676364  0.0057888  3345.71   &lt;2e-16 ***\nORIGIN_SZBMSZ16   18.3856824  0.0092466  1988.37   &lt;2e-16 ***\nORIGIN_SZBMSZ17   18.3262978  0.0157593  1162.89   &lt;2e-16 ***\nORIGIN_SZBPSZ01   20.0309398  0.0053382  3752.36   &lt;2e-16 ***\nORIGIN_SZBPSZ02   19.6217238  0.0061249  3203.59   &lt;2e-16 ***\nORIGIN_SZBPSZ03   19.6911256  0.0059596  3304.09   &lt;2e-16 ***\nORIGIN_SZBPSZ04   20.3371244  0.0048003  4236.66   &lt;2e-16 ***\nORIGIN_SZBPSZ05   20.4232382  0.0043323  4714.13   &lt;2e-16 ***\nORIGIN_SZBPSZ06   18.7700645  0.0093449  2008.59   &lt;2e-16 ***\nORIGIN_SZBPSZ07   19.4084279  0.0087828  2209.83   &lt;2e-16 ***\nORIGIN_SZBSSZ01   19.9759546  0.0056370  3543.69   &lt;2e-16 ***\nORIGIN_SZBSSZ02   20.2471427  0.0046900  4317.07   &lt;2e-16 ***\nORIGIN_SZBSSZ03   19.6096716  0.0052563  3730.70   &lt;2e-16 ***\nORIGIN_SZBTSZ01   20.0154768  0.0058416  3426.40   &lt;2e-16 ***\nORIGIN_SZBTSZ02   19.3076644  0.0081266  2375.85   &lt;2e-16 ***\nORIGIN_SZBTSZ03   19.5224950  0.0068713  2841.16   &lt;2e-16 ***\nORIGIN_SZBTSZ04   18.6537299  0.0103752  1797.91   &lt;2e-16 ***\nORIGIN_SZBTSZ05   18.7920411  0.0120478  1559.79   &lt;2e-16 ***\nORIGIN_SZBTSZ06   18.6408221  0.0094384  1974.99   &lt;2e-16 ***\nORIGIN_SZBTSZ07   17.5616925  0.0141445  1241.60   &lt;2e-16 ***\nORIGIN_SZBTSZ08   18.6836943  0.0109486  1706.48   &lt;2e-16 ***\nORIGIN_SZCBSZ01   18.4777047  0.0548304   337.00   &lt;2e-16 ***\nORIGIN_SZCCSZ01   18.9366613  0.0139342  1359.01   &lt;2e-16 ***\nORIGIN_SZCHSZ01   19.7097762  0.0120926  1629.91   &lt;2e-16 ***\nORIGIN_SZCHSZ02   19.3473689  0.0081367  2377.78   &lt;2e-16 ***\nORIGIN_SZCHSZ03   21.3174526  0.0063367  3364.10   &lt;2e-16 ***\nORIGIN_SZCKSZ01   19.9914781  0.0048935  4085.28   &lt;2e-16 ***\nORIGIN_SZCKSZ02   20.4024397  0.0049909  4087.90   &lt;2e-16 ***\nORIGIN_SZCKSZ03   20.6227932  0.0041757  4938.78   &lt;2e-16 ***\nORIGIN_SZCKSZ04   21.2394341  0.0042067  5048.92   &lt;2e-16 ***\nORIGIN_SZCKSZ05   20.8119715  0.0049187  4231.21   &lt;2e-16 ***\nORIGIN_SZCKSZ06   20.1723727  0.0071706  2813.19   &lt;2e-16 ***\nORIGIN_SZCLSZ01   19.3418875  0.0076590  2525.39   &lt;2e-16 ***\nORIGIN_SZCLSZ02   18.5210857  0.0135452  1367.35   &lt;2e-16 ***\nORIGIN_SZCLSZ03   19.0639140  0.0080131  2379.08   &lt;2e-16 ***\nORIGIN_SZCLSZ04   20.7015199  0.0041966  4932.94   &lt;2e-16 ***\nORIGIN_SZCLSZ05   18.2512094  0.0146697  1244.14   &lt;2e-16 ***\nORIGIN_SZCLSZ06   20.8049642  0.0039225  5304.03   &lt;2e-16 ***\nORIGIN_SZCLSZ07   19.6317502  0.0053880  3643.64   &lt;2e-16 ***\nORIGIN_SZCLSZ08   20.0819877  0.0056661  3544.24   &lt;2e-16 ***\nORIGIN_SZCLSZ09   18.5580583  0.0165316  1122.58   &lt;2e-16 ***\nORIGIN_SZDTSZ02   15.9547091  0.0833971   191.31   &lt;2e-16 ***\nORIGIN_SZDTSZ03   16.1809403  0.0737950   219.27   &lt;2e-16 ***\nORIGIN_SZDTSZ13   16.8934424  0.0312424   540.72   &lt;2e-16 ***\nORIGIN_SZGLSZ01   18.3305602  0.0095978  1909.87   &lt;2e-16 ***\nORIGIN_SZGLSZ02   20.1130799  0.0049125  4094.29   &lt;2e-16 ***\nORIGIN_SZGLSZ03   20.0087850  0.0053081  3769.50   &lt;2e-16 ***\nORIGIN_SZGLSZ04   20.8659429  0.0041095  5077.50   &lt;2e-16 ***\nORIGIN_SZGLSZ05   20.7695912  0.0043005  4829.55   &lt;2e-16 ***\nORIGIN_SZHGSZ01   20.0700050  0.0044558  4504.20   &lt;2e-16 ***\nORIGIN_SZHGSZ02   20.2162306  0.0044078  4586.45   &lt;2e-16 ***\nORIGIN_SZHGSZ03   20.0730779  0.0048691  4122.52   &lt;2e-16 ***\nORIGIN_SZHGSZ04   20.7463916  0.0039970  5190.44   &lt;2e-16 ***\nORIGIN_SZHGSZ05   21.0085543  0.0039787  5280.22   &lt;2e-16 ***\nORIGIN_SZHGSZ06   19.7596631  0.0054033  3656.96   &lt;2e-16 ***\nORIGIN_SZHGSZ07   20.3039840  0.0045933  4420.33   &lt;2e-16 ***\nORIGIN_SZHGSZ08   20.0466913  0.0052359  3828.66   &lt;2e-16 ***\nORIGIN_SZHGSZ09   18.2904463  0.0068796  2658.66   &lt;2e-16 ***\nORIGIN_SZHGSZ10   16.9273379  0.0421016   402.06   &lt;2e-16 ***\nORIGIN_SZJESZ01   20.2105223  0.0046345  4360.89   &lt;2e-16 ***\nORIGIN_SZJESZ02   20.0553136  0.0046250  4336.27   &lt;2e-16 ***\nORIGIN_SZJESZ03   19.9283521  0.0049663  4012.72   &lt;2e-16 ***\nORIGIN_SZJESZ04   18.5272373  0.0099131  1868.96   &lt;2e-16 ***\nORIGIN_SZJESZ05   17.8163098  0.0138768  1283.89   &lt;2e-16 ***\nORIGIN_SZJESZ06   20.0519054  0.0044827  4473.13   &lt;2e-16 ***\nORIGIN_SZJESZ07   18.1592588  0.0117147  1550.12   &lt;2e-16 ***\nORIGIN_SZJESZ08   19.0127760  0.0116351  1634.09   &lt;2e-16 ***\nORIGIN_SZJESZ09   20.6474613  0.0048360  4269.56   &lt;2e-16 ***\nORIGIN_SZJESZ10   18.7316276  0.0191218   979.60   &lt;2e-16 ***\nORIGIN_SZJESZ11   18.4713145  0.0197052   937.38   &lt;2e-16 ***\nORIGIN_SZJWSZ01   20.4455197  0.0062844  3253.40   &lt;2e-16 ***\nORIGIN_SZJWSZ02   20.8736301  0.0042105  4957.46   &lt;2e-16 ***\nORIGIN_SZJWSZ03   21.2446711  0.0039394  5392.87   &lt;2e-16 ***\nORIGIN_SZJWSZ04   20.5320433  0.0046167  4447.29   &lt;2e-16 ***\nORIGIN_SZJWSZ05   18.1978617  0.0128796  1412.92   &lt;2e-16 ***\nORIGIN_SZJWSZ06   18.8656784  0.0107494  1755.05   &lt;2e-16 ***\nORIGIN_SZJWSZ07   17.6298655  0.0277165   636.08   &lt;2e-16 ***\nORIGIN_SZJWSZ08   21.8938104  0.0037081  5904.30   &lt;2e-16 ***\nORIGIN_SZJWSZ09   21.6870952  0.0035930  6035.95   &lt;2e-16 ***\nORIGIN_SZKLSZ01   20.1320553  0.0047771  4214.27   &lt;2e-16 ***\nORIGIN_SZKLSZ02   19.2343254  0.0062284  3088.16   &lt;2e-16 ***\nORIGIN_SZKLSZ03   19.4537766  0.0057108  3406.52   &lt;2e-16 ***\nORIGIN_SZKLSZ04   17.7998675  0.0119771  1486.16   &lt;2e-16 ***\nORIGIN_SZKLSZ05   18.7901113  0.0107510  1747.75   &lt;2e-16 ***\nORIGIN_SZKLSZ06   14.0574604  0.1857156    75.69   &lt;2e-16 ***\nORIGIN_SZKLSZ07   18.7444042  0.0084840  2209.39   &lt;2e-16 ***\nORIGIN_SZKLSZ08   18.1689046  0.0101435  1791.19   &lt;2e-16 ***\nORIGIN_SZLKSZ01   18.1057097  0.0397078   455.97   &lt;2e-16 ***\nORIGIN_SZMDSZ01   18.6897699  0.0285411   654.84   &lt;2e-16 ***\nORIGIN_SZMDSZ02   19.2168566  0.0102648  1872.12   &lt;2e-16 ***\nORIGIN_SZMDSZ03   17.8088649  0.0169590  1050.11   &lt;2e-16 ***\nORIGIN_SZMPSZ01   19.2289393  0.0083870  2292.72   &lt;2e-16 ***\nORIGIN_SZMPSZ02   19.4637541  0.0068241  2852.21   &lt;2e-16 ***\nORIGIN_SZMPSZ03   20.1158402  0.0054351  3701.07   &lt;2e-16 ***\nORIGIN_SZMUSZ02   16.0345681  0.1037455   154.56   &lt;2e-16 ***\nORIGIN_SZNTSZ01   16.9917526  0.0352472   482.07   &lt;2e-16 ***\nORIGIN_SZNTSZ02   16.5919379  0.0233165   711.60   &lt;2e-16 ***\nORIGIN_SZNTSZ03   18.8932132  0.0075744  2494.34   &lt;2e-16 ***\nORIGIN_SZNTSZ05   15.8704767  0.0495822   320.08   &lt;2e-16 ***\nORIGIN_SZNTSZ06   15.3135326  0.0557027   274.92   &lt;2e-16 ***\nORIGIN_SZNVSZ01   20.2546190  0.0043237  4684.53   &lt;2e-16 ***\nORIGIN_SZNVSZ02   19.2392181  0.0065216  2950.10   &lt;2e-16 ***\nORIGIN_SZNVSZ03   18.8978476  0.0080305  2353.26   &lt;2e-16 ***\nORIGIN_SZNVSZ04   18.8916836  0.0090864  2079.11   &lt;2e-16 ***\nORIGIN_SZNVSZ05   17.6223579  0.0168013  1048.87   &lt;2e-16 ***\nORIGIN_SZPGSZ01   19.3354858  0.0122868  1573.67   &lt;2e-16 ***\nORIGIN_SZPGSZ02   19.4076441  0.0072856  2663.82   &lt;2e-16 ***\nORIGIN_SZPGSZ03   20.4934774  0.0045228  4531.10   &lt;2e-16 ***\nORIGIN_SZPGSZ04   20.9829809  0.0041075  5108.40   &lt;2e-16 ***\nORIGIN_SZPGSZ05   20.1767537  0.0057227  3525.73   &lt;2e-16 ***\nORIGIN_SZPLSZ01   19.1757857  0.0119920  1599.05   &lt;2e-16 ***\nORIGIN_SZPLSZ02   18.8191619  0.0149646  1257.58   &lt;2e-16 ***\nORIGIN_SZPLSZ03   18.3098090  0.0371707   492.59   &lt;2e-16 ***\nORIGIN_SZPLSZ04   17.4543587  0.0370232   471.44   &lt;2e-16 ***\nORIGIN_SZPLSZ05   18.1978293  0.0225001   808.79   &lt;2e-16 ***\nORIGIN_SZPNSZ01   21.3553624  0.0044609  4787.18   &lt;2e-16 ***\nORIGIN_SZPNSZ02   20.5701589  0.0111236  1849.23   &lt;2e-16 ***\nORIGIN_SZPNSZ03   18.4160952  0.0193487   951.80   &lt;2e-16 ***\nORIGIN_SZPNSZ04   17.7262285  0.0334873   529.34   &lt;2e-16 ***\nORIGIN_SZPNSZ05   18.9611837  0.0275439   688.40   &lt;2e-16 ***\nORIGIN_SZPRSZ01   19.8725779  0.0117373  1693.11   &lt;2e-16 ***\nORIGIN_SZPRSZ02   21.1465884  0.0044476  4754.59   &lt;2e-16 ***\nORIGIN_SZPRSZ03   20.7704400  0.0045188  4596.45   &lt;2e-16 ***\nORIGIN_SZPRSZ04   19.7406719  0.0074642  2644.70   &lt;2e-16 ***\nORIGIN_SZPRSZ05   21.5038805  0.0041851  5138.16   &lt;2e-16 ***\nORIGIN_SZPRSZ06   19.0191179  0.0117177  1623.11   &lt;2e-16 ***\nORIGIN_SZPRSZ07   17.6397067  0.0162460  1085.79   &lt;2e-16 ***\nORIGIN_SZPRSZ08   20.1557286  0.0062065  3247.54   &lt;2e-16 ***\nORIGIN_SZQTSZ01   19.7019752  0.0066192  2976.48   &lt;2e-16 ***\nORIGIN_SZQTSZ02   19.1166393  0.0061097  3128.89   &lt;2e-16 ***\nORIGIN_SZQTSZ03   19.6783696  0.0055828  3524.84   &lt;2e-16 ***\nORIGIN_SZQTSZ04   18.7213291  0.0072751  2573.33   &lt;2e-16 ***\nORIGIN_SZQTSZ05   19.2498822  0.0062176  3096.03   &lt;2e-16 ***\nORIGIN_SZQTSZ06   19.2514764  0.0065477  2940.17   &lt;2e-16 ***\nORIGIN_SZQTSZ07   18.5197136  0.0095257  1944.18   &lt;2e-16 ***\nORIGIN_SZQTSZ08   19.5698752  0.0061139  3200.89   &lt;2e-16 ***\nORIGIN_SZQTSZ09   19.1865091  0.0069697  2752.84   &lt;2e-16 ***\nORIGIN_SZQTSZ10   19.5636024  0.0064318  3041.72   &lt;2e-16 ***\nORIGIN_SZQTSZ11   17.7046879  0.0143580  1233.09   &lt;2e-16 ***\nORIGIN_SZQTSZ12   17.2545632  0.0186718   924.10   &lt;2e-16 ***\nORIGIN_SZQTSZ13   19.4520621  0.0078806  2468.34   &lt;2e-16 ***\nORIGIN_SZQTSZ14   18.1538401  0.0122079  1487.06   &lt;2e-16 ***\nORIGIN_SZQTSZ15   19.4820765  0.0120857  1612.00   &lt;2e-16 ***\nORIGIN_SZRCSZ01   18.2441435  0.0125024  1459.25   &lt;2e-16 ***\nORIGIN_SZRCSZ06   18.7940051  0.0081961  2293.04   &lt;2e-16 ***\nORIGIN_SZRVSZ01   16.7427655  0.0323719   517.20   &lt;2e-16 ***\nORIGIN_SZRVSZ02   16.3244999  0.0276769   589.82   &lt;2e-16 ***\nORIGIN_SZRVSZ03   16.6612734  0.0244941   680.22   &lt;2e-16 ***\nORIGIN_SZRVSZ04   16.0867448  0.0556316   289.17   &lt;2e-16 ***\nORIGIN_SZRVSZ05   17.0243564  0.0164105  1037.41   &lt;2e-16 ***\nORIGIN_SZSBSZ01   20.0776122  0.0062300  3222.74   &lt;2e-16 ***\nORIGIN_SZSBSZ02   19.2287441  0.0080821  2379.18   &lt;2e-16 ***\nORIGIN_SZSBSZ03   20.7067645  0.0044850  4616.86   &lt;2e-16 ***\nORIGIN_SZSBSZ04   20.7250948  0.0050470  4106.38   &lt;2e-16 ***\nORIGIN_SZSBSZ05   19.7278256  0.0065344  3019.09   &lt;2e-16 ***\nORIGIN_SZSBSZ06   18.8470088  0.0171009  1102.10   &lt;2e-16 ***\nORIGIN_SZSBSZ07   19.3662073  0.0124339  1557.53   &lt;2e-16 ***\nORIGIN_SZSBSZ08   18.9319472  0.0140580  1346.70   &lt;2e-16 ***\nORIGIN_SZSBSZ09   19.1007690  0.0088532  2157.51   &lt;2e-16 ***\nORIGIN_SZSESZ02   20.8772730  0.0041353  5048.56   &lt;2e-16 ***\nORIGIN_SZSESZ03   20.9055777  0.0039251  5326.18   &lt;2e-16 ***\nORIGIN_SZSESZ04   20.5620327  0.0046027  4467.36   &lt;2e-16 ***\nORIGIN_SZSESZ05   19.4726179  0.0058631  3321.20   &lt;2e-16 ***\nORIGIN_SZSESZ06   20.7293565  0.0045388  4567.19   &lt;2e-16 ***\nORIGIN_SZSESZ07   17.6384101  0.0195694   901.33   &lt;2e-16 ***\nORIGIN_SZSGSZ01   19.0908922  0.0085636  2229.30   &lt;2e-16 ***\nORIGIN_SZSGSZ02   18.6118265  0.0101921  1826.10   &lt;2e-16 ***\nORIGIN_SZSGSZ03   20.0122412  0.0050226  3984.45   &lt;2e-16 ***\nORIGIN_SZSGSZ04   20.2430693  0.0046957  4311.02   &lt;2e-16 ***\nORIGIN_SZSGSZ05   18.0306887  0.0107603  1675.67   &lt;2e-16 ***\nORIGIN_SZSGSZ06   20.2968098  0.0044259  4585.94   &lt;2e-16 ***\nORIGIN_SZSGSZ07   19.1175890  0.0062761  3046.11   &lt;2e-16 ***\nORIGIN_SZSKSZ01   20.1055198  0.0085135  2361.62   &lt;2e-16 ***\nORIGIN_SZSKSZ02   21.0090654  0.0055299  3799.19   &lt;2e-16 ***\nORIGIN_SZSKSZ03   19.5974539  0.0080345  2439.18   &lt;2e-16 ***\nORIGIN_SZSKSZ04   18.2951351  0.0275744   663.48   &lt;2e-16 ***\nORIGIN_SZSKSZ05   19.4180023  0.0155539  1248.43   &lt;2e-16 ***\nORIGIN_SZSLSZ01   17.0425036  0.0329343   517.47   &lt;2e-16 ***\nORIGIN_SZSLSZ04   19.5216773  0.0076566  2549.64   &lt;2e-16 ***\nORIGIN_SZSRSZ01   16.9882761  0.0162024  1048.50   &lt;2e-16 ***\nORIGIN_SZTHSZ01   17.8848178  0.0488525   366.10   &lt;2e-16 ***\nORIGIN_SZTHSZ03   18.3280287  0.0223520   819.97   &lt;2e-16 ***\nORIGIN_SZTHSZ04   17.2887838  0.0286183   604.12   &lt;2e-16 ***\nORIGIN_SZTHSZ06   17.7137131  0.0183217   966.82   &lt;2e-16 ***\nORIGIN_SZTMSZ01   20.4891959  0.0056272  3641.09   &lt;2e-16 ***\nORIGIN_SZTMSZ02   22.1443734  0.0037176  5956.62   &lt;2e-16 ***\nORIGIN_SZTMSZ03   21.4784634  0.0040345  5323.72   &lt;2e-16 ***\nORIGIN_SZTMSZ04   20.8862351  0.0049749  4198.36   &lt;2e-16 ***\nORIGIN_SZTMSZ05   19.5080323  0.0112766  1729.95   &lt;2e-16 ***\nORIGIN_SZTNSZ01   17.8426257  0.0128114  1392.71   &lt;2e-16 ***\nORIGIN_SZTNSZ02   17.9839752  0.0098214  1831.10   &lt;2e-16 ***\nORIGIN_SZTNSZ03   17.6609617  0.0134588  1312.22   &lt;2e-16 ***\nORIGIN_SZTNSZ04   19.3461963  0.0073514  2631.63   &lt;2e-16 ***\nORIGIN_SZTPSZ01   19.1667325  0.0065559  2923.58   &lt;2e-16 ***\nORIGIN_SZTPSZ02   20.3243731  0.0041187  4934.65   &lt;2e-16 ***\nORIGIN_SZTPSZ03   19.2048306  0.0059339  3236.45   &lt;2e-16 ***\nORIGIN_SZTPSZ04   19.2413896  0.0054565  3526.34   &lt;2e-16 ***\nORIGIN_SZTPSZ05   19.4295659  0.0058440  3324.68   &lt;2e-16 ***\nORIGIN_SZTPSZ06   19.7101444  0.0054775  3598.37   &lt;2e-16 ***\nORIGIN_SZTPSZ07   19.5596100  0.0060214  3248.36   &lt;2e-16 ***\nORIGIN_SZTPSZ08   18.7979693  0.0095641  1965.47   &lt;2e-16 ***\nORIGIN_SZTPSZ09   19.1027148  0.0066795  2859.90   &lt;2e-16 ***\nORIGIN_SZTPSZ10   18.9714615  0.0075921  2498.83   &lt;2e-16 ***\nORIGIN_SZTPSZ11   19.8630857  0.0053908  3684.61   &lt;2e-16 ***\nORIGIN_SZTPSZ12   19.2775614  0.0065625  2937.55   &lt;2e-16 ***\nORIGIN_SZTSSZ01   17.9597288  0.0478912   375.01   &lt;2e-16 ***\nORIGIN_SZTSSZ02   20.9546971  0.0081666  2565.89   &lt;2e-16 ***\nORIGIN_SZTSSZ03   20.4055112  0.0084443  2416.47   &lt;2e-16 ***\nORIGIN_SZTSSZ04   20.7483687  0.0088682  2339.63   &lt;2e-16 ***\nORIGIN_SZTSSZ05   19.9628531  0.0151293  1319.48   &lt;2e-16 ***\nORIGIN_SZTSSZ06   21.5811362  0.0178108  1211.69   &lt;2e-16 ***\nORIGIN_SZWCSZ01   20.7108540  0.0086335  2398.89   &lt;2e-16 ***\nORIGIN_SZWCSZ02   17.6397892  0.0328833   536.44   &lt;2e-16 ***\nORIGIN_SZWCSZ03   14.8390913  0.1240692   119.60   &lt;2e-16 ***\nORIGIN_SZWDSZ01   21.2240606  0.0037448  5667.58   &lt;2e-16 ***\nORIGIN_SZWDSZ02   20.7729893  0.0044409  4677.64   &lt;2e-16 ***\nORIGIN_SZWDSZ03   21.3964805  0.0041502  5155.51   &lt;2e-16 ***\nORIGIN_SZWDSZ04   21.1536722  0.0048407  4369.96   &lt;2e-16 ***\nORIGIN_SZWDSZ05   20.4690390  0.0051670  3961.47   &lt;2e-16 ***\nORIGIN_SZWDSZ06   20.6745506  0.0049056  4214.51   &lt;2e-16 ***\nORIGIN_SZWDSZ07   19.1813218  0.0082633  2321.27   &lt;2e-16 ***\nORIGIN_SZWDSZ08   19.2929231  0.0080603  2393.57   &lt;2e-16 ***\nORIGIN_SZWDSZ09   21.3866290  0.0039905  5359.38   &lt;2e-16 ***\nORIGIN_SZYSSZ01   19.5852726  0.0057381  3413.21   &lt;2e-16 ***\nORIGIN_SZYSSZ02   20.7543673  0.0047970  4326.50   &lt;2e-16 ***\nORIGIN_SZYSSZ03   21.7355719  0.0039706  5474.07   &lt;2e-16 ***\nORIGIN_SZYSSZ04   20.9419376  0.0043328  4833.39   &lt;2e-16 ***\nORIGIN_SZYSSZ05   20.1714855  0.0058245  3463.24   &lt;2e-16 ***\nORIGIN_SZYSSZ06   19.2486053  0.0116698  1649.44   &lt;2e-16 ***\nORIGIN_SZYSSZ07   18.7339402  0.0141499  1323.97   &lt;2e-16 ***\nORIGIN_SZYSSZ08   19.9390490  0.0060983  3269.63   &lt;2e-16 ***\nORIGIN_SZYSSZ09   20.9908642  0.0039987  5249.38   &lt;2e-16 ***\nlog(SCHOOL_COUNT)  0.3672258  0.0004589   800.19   &lt;2e-16 ***\nlog(dist)         -1.6558900  0.0004019 -4120.59   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 189463537  on 14471  degrees of freedom\nResidual deviance:  16430417  on 14190  degrees of freedom\nAIC: 16520118\n\nNumber of Fisher Scoring iterations: 6\n\n\n\n\n\n\n\n\nNote\n\n\n\nUse file from elearn, there is no BUSINESS_COUNT. I have separated ex4 and ex4.1 for learning purpose\n\n\n\n\nGoodness of fit\n\nCalcRSquared &lt;- function(observed, estimated){\n  r &lt;- cor(observed, estimated)\n  R2 &lt;- r^2\n  R2\n}\n\n\nCalcRSquared(orcSIM_Poisson$data$MORNING_PEAK, orcSIM_Poisson$fitted.values)\n\n[1] 0.423468\n\n\n\n\nDoubly constrained model\n\ndbcSIM_Poisson &lt;- glm(formula = MORNING_PEAK ~ \n                ORIGIN_SZ + \n                DESTIN_SZ +\n                log(dist),\n              family = poisson(link = \"log\"),\n              data = inter_zonal_flow,\n              na.action = na.exclude)\nsummary(dbcSIM_Poisson)\n\n\nCall:\nglm(formula = MORNING_PEAK ~ ORIGIN_SZ + DESTIN_SZ + log(dist), \n    family = poisson(link = \"log\"), data = inter_zonal_flow, \n    na.action = na.exclude)\n\nCoefficients:\n                  Estimate Std. Error   z value Pr(&gt;|z|)    \n(Intercept)     21.8312374  0.0059160  3690.190  &lt; 2e-16 ***\nORIGIN_SZAMSZ02  0.5263502  0.0048031   109.585  &lt; 2e-16 ***\nORIGIN_SZAMSZ03  0.3139982  0.0049254    63.751  &lt; 2e-16 ***\nORIGIN_SZAMSZ04 -0.2146257  0.0053639   -40.013  &lt; 2e-16 ***\nORIGIN_SZAMSZ05 -0.1890446  0.0060386   -31.306  &lt; 2e-16 ***\nORIGIN_SZAMSZ06  0.1539201  0.0054401    28.294  &lt; 2e-16 ***\nORIGIN_SZAMSZ07 -0.9826565  0.0098676   -99.584  &lt; 2e-16 ***\nORIGIN_SZAMSZ08 -0.4488417  0.0093070   -48.226  &lt; 2e-16 ***\nORIGIN_SZAMSZ09  0.0713474  0.0057402    12.429  &lt; 2e-16 ***\nORIGIN_SZAMSZ10  0.4313742  0.0050370    85.641  &lt; 2e-16 ***\nORIGIN_SZAMSZ11 -1.4712226  0.0131178  -112.154  &lt; 2e-16 ***\nORIGIN_SZAMSZ12 -1.7250733  0.0111603  -154.573  &lt; 2e-16 ***\nORIGIN_SZBDSZ01  0.8810576  0.0048168   182.914  &lt; 2e-16 ***\nORIGIN_SZBDSZ02  0.1100240  0.0055529    19.814  &lt; 2e-16 ***\nORIGIN_SZBDSZ03  0.3606166  0.0050672    71.167  &lt; 2e-16 ***\nORIGIN_SZBDSZ04  1.4624347  0.0044212   330.781  &lt; 2e-16 ***\nORIGIN_SZBDSZ05  0.6207557  0.0050843   122.092  &lt; 2e-16 ***\nORIGIN_SZBDSZ06  0.6712973  0.0051953   129.214  &lt; 2e-16 ***\nORIGIN_SZBDSZ07 -1.2338669  0.0100775  -122.437  &lt; 2e-16 ***\nORIGIN_SZBDSZ08 -1.0444562  0.0094555  -110.460  &lt; 2e-16 ***\nORIGIN_SZBKSZ01 -0.2838426  0.0071354   -39.780  &lt; 2e-16 ***\nORIGIN_SZBKSZ02  0.5550522  0.0059014    94.054  &lt; 2e-16 ***\nORIGIN_SZBKSZ03  0.7396640  0.0056796   130.231  &lt; 2e-16 ***\nORIGIN_SZBKSZ04 -0.2242451  0.0067482   -33.230  &lt; 2e-16 ***\nORIGIN_SZBKSZ05 -0.2371614  0.0069386   -34.180  &lt; 2e-16 ***\nORIGIN_SZBKSZ06 -0.1413812  0.0065035   -21.739  &lt; 2e-16 ***\nORIGIN_SZBKSZ07  0.7089989  0.0051843   136.758  &lt; 2e-16 ***\nORIGIN_SZBKSZ08 -0.0907065  0.0059157   -15.333  &lt; 2e-16 ***\nORIGIN_SZBKSZ09 -0.1775146  0.0063302   -28.042  &lt; 2e-16 ***\nORIGIN_SZBLSZ01 -2.3684539  0.0154280  -153.516  &lt; 2e-16 ***\nORIGIN_SZBLSZ02 -2.8078475  0.0197839  -141.926  &lt; 2e-16 ***\nORIGIN_SZBLSZ03 -3.3122763  0.0466091   -71.065  &lt; 2e-16 ***\nORIGIN_SZBLSZ04 -2.6770542  0.0241793  -110.717  &lt; 2e-16 ***\nORIGIN_SZBMSZ01  0.0618035  0.0059400    10.405  &lt; 2e-16 ***\nORIGIN_SZBMSZ02 -1.3535767  0.0073741  -183.557  &lt; 2e-16 ***\nORIGIN_SZBMSZ03 -0.7569095  0.0063187  -119.790  &lt; 2e-16 ***\nORIGIN_SZBMSZ04 -0.2949304  0.0059603   -49.483  &lt; 2e-16 ***\nORIGIN_SZBMSZ05 -2.6131992  0.0172376  -151.599  &lt; 2e-16 ***\nORIGIN_SZBMSZ06 -3.0315024  0.0185502  -163.422  &lt; 2e-16 ***\nORIGIN_SZBMSZ07 -0.6962524  0.0064068  -108.674  &lt; 2e-16 ***\nORIGIN_SZBMSZ08 -0.9310730  0.0064541  -144.261  &lt; 2e-16 ***\nORIGIN_SZBMSZ09 -1.2911253  0.0092047  -140.268  &lt; 2e-16 ***\nORIGIN_SZBMSZ10 -1.6687004  0.0095708  -174.353  &lt; 2e-16 ***\nORIGIN_SZBMSZ11 -1.1152794  0.0072027  -154.841  &lt; 2e-16 ***\nORIGIN_SZBMSZ12 -1.5323954  0.0099932  -153.344  &lt; 2e-16 ***\nORIGIN_SZBMSZ13 -0.6267376  0.0065863   -95.158  &lt; 2e-16 ***\nORIGIN_SZBMSZ14 -1.0475467  0.0072472  -144.544  &lt; 2e-16 ***\nORIGIN_SZBMSZ15 -0.5049444  0.0067390   -74.929  &lt; 2e-16 ***\nORIGIN_SZBMSZ16 -1.5282897  0.0099545  -153.527  &lt; 2e-16 ***\nORIGIN_SZBMSZ17 -1.5722349  0.0161533   -97.332  &lt; 2e-16 ***\nORIGIN_SZBPSZ01  0.5814175  0.0062904    92.429  &lt; 2e-16 ***\nORIGIN_SZBPSZ02  0.0875442  0.0072190    12.127  &lt; 2e-16 ***\nORIGIN_SZBPSZ03  0.3358227  0.0070460    47.662  &lt; 2e-16 ***\nORIGIN_SZBPSZ04  0.6507586  0.0057726   112.733  &lt; 2e-16 ***\nORIGIN_SZBPSZ05  0.9502124  0.0052971   179.384  &lt; 2e-16 ***\nORIGIN_SZBPSZ06 -1.0480314  0.0098191  -106.734  &lt; 2e-16 ***\nORIGIN_SZBPSZ07 -0.5467931  0.0091676   -59.644  &lt; 2e-16 ***\nORIGIN_SZBSSZ01  0.2998334  0.0059193    50.654  &lt; 2e-16 ***\nORIGIN_SZBSSZ02  0.2841036  0.0050863    55.856  &lt; 2e-16 ***\nORIGIN_SZBSSZ03 -0.2331505  0.0056565   -41.218  &lt; 2e-16 ***\nORIGIN_SZBTSZ01  0.0987284  0.0063715    15.495  &lt; 2e-16 ***\nORIGIN_SZBTSZ02 -0.6261229  0.0084604   -74.006  &lt; 2e-16 ***\nORIGIN_SZBTSZ03 -0.4326963  0.0073452   -58.909  &lt; 2e-16 ***\nORIGIN_SZBTSZ04 -1.4998668  0.0110013  -136.336  &lt; 2e-16 ***\nORIGIN_SZBTSZ05 -0.9564768  0.0122202   -78.270  &lt; 2e-16 ***\nORIGIN_SZBTSZ06 -1.2853131  0.0099328  -129.401  &lt; 2e-16 ***\nORIGIN_SZBTSZ07 -2.3870991  0.0144589  -165.096  &lt; 2e-16 ***\nORIGIN_SZBTSZ08 -1.3715855  0.0113825  -120.499  &lt; 2e-16 ***\nORIGIN_SZCBSZ01 -3.5940232  0.0548979   -65.467  &lt; 2e-16 ***\nORIGIN_SZCCSZ01 -0.7008220  0.0140373   -49.926  &lt; 2e-16 ***\nORIGIN_SZCHSZ01 -0.9109524  0.0122869   -74.140  &lt; 2e-16 ***\nORIGIN_SZCHSZ02 -0.8566547  0.0088749   -96.526  &lt; 2e-16 ***\nORIGIN_SZCHSZ03  1.1153731  0.0066136   168.650  &lt; 2e-16 ***\nORIGIN_SZCKSZ01  0.3001815  0.0058548    51.271  &lt; 2e-16 ***\nORIGIN_SZCKSZ02  0.7185711  0.0060595   118.585  &lt; 2e-16 ***\nORIGIN_SZCKSZ03  1.1389824  0.0053179   214.178  &lt; 2e-16 ***\nORIGIN_SZCKSZ04  1.6281772  0.0054761   297.324  &lt; 2e-16 ***\nORIGIN_SZCKSZ05  0.8338470  0.0064178   129.927  &lt; 2e-16 ***\nORIGIN_SZCKSZ06  0.6528993  0.0082375    79.259  &lt; 2e-16 ***\nORIGIN_SZCLSZ01 -0.7174758  0.0082123   -87.366  &lt; 2e-16 ***\nORIGIN_SZCLSZ02 -1.7513100  0.0139062  -125.938  &lt; 2e-16 ***\nORIGIN_SZCLSZ03 -1.0362873  0.0085485  -121.224  &lt; 2e-16 ***\nORIGIN_SZCLSZ04  0.6160017  0.0051276   120.136  &lt; 2e-16 ***\nORIGIN_SZCLSZ05 -2.1005122  0.0150228  -139.821  &lt; 2e-16 ***\nORIGIN_SZCLSZ06  0.7252108  0.0049447   146.665  &lt; 2e-16 ***\nORIGIN_SZCLSZ07 -0.5343482  0.0062500   -85.496  &lt; 2e-16 ***\nORIGIN_SZCLSZ08 -0.2153408  0.0067571   -31.869  &lt; 2e-16 ***\nORIGIN_SZCLSZ09 -1.8019961  0.0169078  -106.578  &lt; 2e-16 ***\nORIGIN_SZDTSZ02 -3.9057711  0.0834668   -46.794  &lt; 2e-16 ***\nORIGIN_SZDTSZ03 -3.4152419  0.0738650   -46.236  &lt; 2e-16 ***\nORIGIN_SZDTSZ13 -3.0183438  0.0315257   -95.742  &lt; 2e-16 ***\nORIGIN_SZGLSZ01 -1.7812384  0.0099367  -179.258  &lt; 2e-16 ***\nORIGIN_SZGLSZ02 -0.1074991  0.0054325   -19.788  &lt; 2e-16 ***\nORIGIN_SZGLSZ03 -0.2461106  0.0057176   -43.045  &lt; 2e-16 ***\nORIGIN_SZGLSZ04  0.8657186  0.0046413   186.524  &lt; 2e-16 ***\nORIGIN_SZGLSZ05  0.5871393  0.0047939   122.477  &lt; 2e-16 ***\nORIGIN_SZHGSZ01  0.3543819  0.0050461    70.229  &lt; 2e-16 ***\nORIGIN_SZHGSZ02  0.4218178  0.0050820    83.003  &lt; 2e-16 ***\nORIGIN_SZHGSZ03  0.2411309  0.0054241    44.456  &lt; 2e-16 ***\nORIGIN_SZHGSZ04  0.8180622  0.0046153   177.252  &lt; 2e-16 ***\nORIGIN_SZHGSZ05  1.2173687  0.0045655   266.647  &lt; 2e-16 ***\nORIGIN_SZHGSZ06 -0.1826300  0.0058214   -31.372  &lt; 2e-16 ***\nORIGIN_SZHGSZ07  0.3172839  0.0050733    62.540  &lt; 2e-16 ***\nORIGIN_SZHGSZ08 -0.1151369  0.0057067   -20.176  &lt; 2e-16 ***\nORIGIN_SZHGSZ09 -1.2873441  0.0091690  -140.401  &lt; 2e-16 ***\nORIGIN_SZHGSZ10 -3.3783178  0.0424682   -79.549  &lt; 2e-16 ***\nORIGIN_SZJESZ01  0.4859234  0.0055927    86.885  &lt; 2e-16 ***\nORIGIN_SZJESZ02  0.1766088  0.0055800    31.650  &lt; 2e-16 ***\nORIGIN_SZJESZ03 -0.2177441  0.0059535   -36.574  &lt; 2e-16 ***\nORIGIN_SZJESZ04 -1.5532182  0.0104526  -148.597  &lt; 2e-16 ***\nORIGIN_SZJESZ05 -2.3332926  0.0142701  -163.509  &lt; 2e-16 ***\nORIGIN_SZJESZ06  0.3007382  0.0055019    54.661  &lt; 2e-16 ***\nORIGIN_SZJESZ07 -1.9687994  0.0121092  -162.587  &lt; 2e-16 ***\nORIGIN_SZJESZ08 -1.3032070  0.0122024  -106.800  &lt; 2e-16 ***\nORIGIN_SZJESZ09  0.5762635  0.0058766    98.061  &lt; 2e-16 ***\nORIGIN_SZJESZ10 -1.4423113  0.0194773   -74.051  &lt; 2e-16 ***\nORIGIN_SZJESZ11 -1.9720897  0.0200811   -98.206  &lt; 2e-16 ***\nORIGIN_SZJWSZ01  0.3808627  0.0071357    53.374  &lt; 2e-16 ***\nORIGIN_SZJWSZ02  0.7963999  0.0053150   149.840  &lt; 2e-16 ***\nORIGIN_SZJWSZ03  1.5429636  0.0049961   308.834  &lt; 2e-16 ***\nORIGIN_SZJWSZ04  0.6410760  0.0056711   113.042  &lt; 2e-16 ***\nORIGIN_SZJWSZ05 -2.1571049  0.0133584  -161.479  &lt; 2e-16 ***\nORIGIN_SZJWSZ06 -1.5174532  0.0113384  -133.833  &lt; 2e-16 ***\nORIGIN_SZJWSZ07 -2.7089963  0.0280439   -96.598  &lt; 2e-16 ***\nORIGIN_SZJWSZ08  1.5343415  0.0051711   296.713  &lt; 2e-16 ***\nORIGIN_SZJWSZ09  1.8837410  0.0048845   385.656  &lt; 2e-16 ***\nORIGIN_SZKLSZ01  0.1081286  0.0053307    20.284  &lt; 2e-16 ***\nORIGIN_SZKLSZ02 -0.8844695  0.0067728  -130.591  &lt; 2e-16 ***\nORIGIN_SZKLSZ03 -0.6872640  0.0062857  -109.337  &lt; 2e-16 ***\nORIGIN_SZKLSZ04 -2.2090319  0.0122440  -180.418  &lt; 2e-16 ***\nORIGIN_SZKLSZ05 -1.1728726  0.0110765  -105.888  &lt; 2e-16 ***\nORIGIN_SZKLSZ06 -6.1162315  0.1857789   -32.922  &lt; 2e-16 ***\nORIGIN_SZKLSZ07 -1.4082749  0.0092299  -152.578  &lt; 2e-16 ***\nORIGIN_SZKLSZ08 -1.7781551  0.0104682  -169.862  &lt; 2e-16 ***\nORIGIN_SZLKSZ01 -2.0531568  0.0398803   -51.483  &lt; 2e-16 ***\nORIGIN_SZMDSZ01 -0.8825639  0.0287621   -30.685  &lt; 2e-16 ***\nORIGIN_SZMDSZ02 -0.6219993  0.0107388   -57.921  &lt; 2e-16 ***\nORIGIN_SZMDSZ03 -2.0840156  0.0173117  -120.382  &lt; 2e-16 ***\nORIGIN_SZMPSZ01 -0.9659093  0.0086972  -111.060  &lt; 2e-16 ***\nORIGIN_SZMPSZ02 -1.0411153  0.0073403  -141.836  &lt; 2e-16 ***\nORIGIN_SZMPSZ03  0.0001659  0.0059401     0.028 0.977719    \nORIGIN_SZMUSZ02 -3.7599031  0.1037937   -36.225  &lt; 2e-16 ***\nORIGIN_SZNTSZ01 -3.0388366  0.0355325   -85.523  &lt; 2e-16 ***\nORIGIN_SZNTSZ02 -3.4230640  0.0235902  -145.106  &lt; 2e-16 ***\nORIGIN_SZNTSZ03 -0.9094796  0.0082551  -110.172  &lt; 2e-16 ***\nORIGIN_SZNTSZ05 -4.0861681  0.0499630   -81.784  &lt; 2e-16 ***\nORIGIN_SZNTSZ06 -3.9497128  0.0565388   -69.858  &lt; 2e-16 ***\nORIGIN_SZNVSZ01  0.3235636  0.0049439    65.447  &lt; 2e-16 ***\nORIGIN_SZNVSZ02 -0.6946748  0.0070536   -98.485  &lt; 2e-16 ***\nORIGIN_SZNVSZ03 -1.0540196  0.0083781  -125.806  &lt; 2e-16 ***\nORIGIN_SZNVSZ04 -0.9897977  0.0093463  -105.903  &lt; 2e-16 ***\nORIGIN_SZNVSZ05 -2.2578432  0.0169180  -133.458  &lt; 2e-16 ***\nORIGIN_SZPGSZ01  0.2399827  0.0130436    18.398  &lt; 2e-16 ***\nORIGIN_SZPGSZ02 -0.3352342  0.0078451   -42.732  &lt; 2e-16 ***\nORIGIN_SZPGSZ03  0.9515148  0.0051376   185.207  &lt; 2e-16 ***\nORIGIN_SZPGSZ04  1.3998952  0.0047991   291.697  &lt; 2e-16 ***\nORIGIN_SZPGSZ05  0.4451629  0.0063423    70.189  &lt; 2e-16 ***\nORIGIN_SZPLSZ01 -0.9705918  0.0122781   -79.050  &lt; 2e-16 ***\nORIGIN_SZPLSZ02 -1.0670151  0.0153358   -69.577  &lt; 2e-16 ***\nORIGIN_SZPLSZ03 -2.1229124  0.0373527   -56.834  &lt; 2e-16 ***\nORIGIN_SZPLSZ04 -3.0911932  0.0371296   -83.254  &lt; 2e-16 ***\nORIGIN_SZPLSZ05 -2.1705708  0.0226085   -96.007  &lt; 2e-16 ***\nORIGIN_SZPNSZ01  0.9052637  0.0065952   137.262  &lt; 2e-16 ***\nORIGIN_SZPNSZ02 -0.1720425  0.0125658   -13.691  &lt; 2e-16 ***\nORIGIN_SZPNSZ03 -2.3973459  0.0201408  -119.029  &lt; 2e-16 ***\nORIGIN_SZPNSZ04 -3.4483689  0.0343741  -100.319  &lt; 2e-16 ***\nORIGIN_SZPNSZ05 -2.0588530  0.0282328   -72.924  &lt; 2e-16 ***\nORIGIN_SZPRSZ01 -0.6399015  0.0120470   -53.117  &lt; 2e-16 ***\nORIGIN_SZPRSZ02  0.8122270  0.0050886   159.617  &lt; 2e-16 ***\nORIGIN_SZPRSZ03  0.3990960  0.0051810    77.031  &lt; 2e-16 ***\nORIGIN_SZPRSZ04 -0.8485348  0.0079236  -107.089  &lt; 2e-16 ***\nORIGIN_SZPRSZ05  0.8008791  0.0048532   165.021  &lt; 2e-16 ***\nORIGIN_SZPRSZ06 -1.4498806  0.0121422  -119.408  &lt; 2e-16 ***\nORIGIN_SZPRSZ07 -3.2025045  0.0167118  -191.631  &lt; 2e-16 ***\nORIGIN_SZPRSZ08 -0.5862269  0.0067255   -87.165  &lt; 2e-16 ***\nORIGIN_SZQTSZ01 -0.1859270  0.0075531   -24.616  &lt; 2e-16 ***\nORIGIN_SZQTSZ02 -0.8715122  0.0068124  -127.929  &lt; 2e-16 ***\nORIGIN_SZQTSZ03 -0.1259816  0.0064796   -19.443  &lt; 2e-16 ***\nORIGIN_SZQTSZ04 -1.4620032  0.0079848  -183.098  &lt; 2e-16 ***\nORIGIN_SZQTSZ05 -0.6675643  0.0069616   -95.892  &lt; 2e-16 ***\nORIGIN_SZQTSZ06 -0.8190026  0.0072713  -112.634  &lt; 2e-16 ***\nORIGIN_SZQTSZ07 -1.5189403  0.0099864  -152.101  &lt; 2e-16 ***\nORIGIN_SZQTSZ08 -0.4976238  0.0067874   -73.316  &lt; 2e-16 ***\nORIGIN_SZQTSZ09 -0.9006162  0.0075978  -118.536  &lt; 2e-16 ***\nORIGIN_SZQTSZ10 -0.6690184  0.0071574   -93.473  &lt; 2e-16 ***\nORIGIN_SZQTSZ11 -2.5203437  0.0147000  -171.452  &lt; 2e-16 ***\nORIGIN_SZQTSZ12 -3.0461675  0.0190193  -160.162  &lt; 2e-16 ***\nORIGIN_SZQTSZ13 -0.7501068  0.0084481   -88.791  &lt; 2e-16 ***\nORIGIN_SZQTSZ14 -1.9321849  0.0126114  -153.209  &lt; 2e-16 ***\nORIGIN_SZQTSZ15 -0.9576828  0.0127157   -75.315  &lt; 2e-16 ***\nORIGIN_SZRCSZ01 -1.8167951  0.0129234  -140.582  &lt; 2e-16 ***\nORIGIN_SZRCSZ06 -0.5560563  0.0090507   -61.438  &lt; 2e-16 ***\nORIGIN_SZRVSZ01 -2.8862570  0.0325532   -88.663  &lt; 2e-16 ***\nORIGIN_SZRVSZ02 -3.1555662  0.0281279  -112.186  &lt; 2e-16 ***\nORIGIN_SZRVSZ03 -2.9836089  0.0248449  -120.089  &lt; 2e-16 ***\nORIGIN_SZRVSZ04 -3.5520422  0.0561371   -63.274  &lt; 2e-16 ***\nORIGIN_SZRVSZ05 -2.5866584  0.0180382  -143.399  &lt; 2e-16 ***\nORIGIN_SZSBSZ01  0.2867444  0.0071098    40.331  &lt; 2e-16 ***\nORIGIN_SZSBSZ02 -0.9012334  0.0087262  -103.278  &lt; 2e-16 ***\nORIGIN_SZSBSZ03  0.8311038  0.0055422   149.958  &lt; 2e-16 ***\nORIGIN_SZSBSZ04  0.4044170  0.0062047    65.179  &lt; 2e-16 ***\nORIGIN_SZSBSZ05 -0.2661845  0.0074162   -35.892  &lt; 2e-16 ***\nORIGIN_SZSBSZ06 -0.9023075  0.0175046   -51.547  &lt; 2e-16 ***\nORIGIN_SZSBSZ07  0.0505870  0.0131317     3.852 0.000117 ***\nORIGIN_SZSBSZ08 -1.1158011  0.0145416   -76.732  &lt; 2e-16 ***\nORIGIN_SZSBSZ09 -0.9682835  0.0095396  -101.501  &lt; 2e-16 ***\nORIGIN_SZSESZ02  1.1452735  0.0047810   239.548  &lt; 2e-16 ***\nORIGIN_SZSESZ03  1.2815277  0.0045677   280.564  &lt; 2e-16 ***\nORIGIN_SZSESZ04  0.8085857  0.0052756   153.269  &lt; 2e-16 ***\nORIGIN_SZSESZ05 -0.2329413  0.0063113   -36.909  &lt; 2e-16 ***\nORIGIN_SZSESZ06  1.0576879  0.0049909   211.925  &lt; 2e-16 ***\nORIGIN_SZSESZ07 -2.3165908  0.0196831  -117.695  &lt; 2e-16 ***\nORIGIN_SZSGSZ01 -0.6606350  0.0088079   -75.005  &lt; 2e-16 ***\nORIGIN_SZSGSZ02 -1.3638984  0.0104040  -131.094  &lt; 2e-16 ***\nORIGIN_SZSGSZ03  0.1152591  0.0054649    21.091  &lt; 2e-16 ***\nORIGIN_SZSGSZ04  0.2954067  0.0050865    58.077  &lt; 2e-16 ***\nORIGIN_SZSGSZ05 -2.0792678  0.0109882  -189.227  &lt; 2e-16 ***\nORIGIN_SZSGSZ06  0.4563227  0.0048880    93.356  &lt; 2e-16 ***\nORIGIN_SZSGSZ07 -0.8955254  0.0067100  -133.461  &lt; 2e-16 ***\nORIGIN_SZSKSZ01 -0.3184402  0.0093032   -34.229  &lt; 2e-16 ***\nORIGIN_SZSKSZ02  1.1160484  0.0063851   174.790  &lt; 2e-16 ***\nORIGIN_SZSKSZ03 -0.2566692  0.0086021   -29.838  &lt; 2e-16 ***\nORIGIN_SZSKSZ04 -1.5781827  0.0279394   -56.486  &lt; 2e-16 ***\nORIGIN_SZSKSZ05 -0.2724361  0.0163597   -16.653  &lt; 2e-16 ***\nORIGIN_SZSLSZ01 -2.4458625  0.0330301   -74.050  &lt; 2e-16 ***\nORIGIN_SZSLSZ04 -0.0987076  0.0079626   -12.396  &lt; 2e-16 ***\nORIGIN_SZSRSZ01 -2.2584977  0.0176647  -127.854  &lt; 2e-16 ***\nORIGIN_SZTHSZ01 -2.5878524  0.0489998   -52.814  &lt; 2e-16 ***\nORIGIN_SZTHSZ03 -0.8101746  0.0226814   -35.720  &lt; 2e-16 ***\nORIGIN_SZTHSZ04 -2.4186655  0.0288663   -83.789  &lt; 2e-16 ***\nORIGIN_SZTHSZ06 -1.7080541  0.0186353   -91.657  &lt; 2e-16 ***\nORIGIN_SZTMSZ01 -0.2193476  0.0061823   -35.480  &lt; 2e-16 ***\nORIGIN_SZTMSZ02  1.7772464  0.0043394   409.558  &lt; 2e-16 ***\nORIGIN_SZTMSZ03  1.0051343  0.0046055   218.249  &lt; 2e-16 ***\nORIGIN_SZTMSZ04  0.1642370  0.0055078    29.819  &lt; 2e-16 ***\nORIGIN_SZTMSZ05 -1.2878706  0.0114828  -112.157  &lt; 2e-16 ***\nORIGIN_SZTNSZ01 -1.7163504  0.0131268  -130.751  &lt; 2e-16 ***\nORIGIN_SZTNSZ02 -1.6508988  0.0103851  -158.968  &lt; 2e-16 ***\nORIGIN_SZTNSZ03 -2.1545577  0.0137947  -156.187  &lt; 2e-16 ***\nORIGIN_SZTNSZ04 -0.3949120  0.0078496   -50.310  &lt; 2e-16 ***\nORIGIN_SZTPSZ01 -0.8058100  0.0069916  -115.253  &lt; 2e-16 ***\nORIGIN_SZTPSZ02  0.5369060  0.0047272   113.577  &lt; 2e-16 ***\nORIGIN_SZTPSZ03 -0.7779333  0.0064278  -121.027  &lt; 2e-16 ***\nORIGIN_SZTPSZ04 -0.8153581  0.0061387  -132.823  &lt; 2e-16 ***\nORIGIN_SZTPSZ05 -0.5073676  0.0067771   -74.865  &lt; 2e-16 ***\nORIGIN_SZTPSZ06  0.0847301  0.0065717    12.893  &lt; 2e-16 ***\nORIGIN_SZTPSZ07 -0.5839519  0.0066148   -88.280  &lt; 2e-16 ***\nORIGIN_SZTPSZ08 -1.0577941  0.0098480  -107.412  &lt; 2e-16 ***\nORIGIN_SZTPSZ09 -0.9067707  0.0071367  -127.057  &lt; 2e-16 ***\nORIGIN_SZTPSZ10 -1.1362091  0.0080905  -140.438  &lt; 2e-16 ***\nORIGIN_SZTPSZ11 -0.2374621  0.0059472   -39.928  &lt; 2e-16 ***\nORIGIN_SZTPSZ12 -0.8028874  0.0069663  -115.253  &lt; 2e-16 ***\nORIGIN_SZTSSZ01 -2.7809271  0.0482843   -57.595  &lt; 2e-16 ***\nORIGIN_SZTSSZ02  0.0425804  0.0105088     4.052 5.08e-05 ***\nORIGIN_SZTSSZ03  0.1142369  0.0109412    10.441  &lt; 2e-16 ***\nORIGIN_SZTSSZ04 -0.6186261  0.0116324   -53.181  &lt; 2e-16 ***\nORIGIN_SZTSSZ05 -1.0846732  0.0173555   -62.497  &lt; 2e-16 ***\nORIGIN_SZTSSZ06  0.3980173  0.0198100    20.092  &lt; 2e-16 ***\nORIGIN_SZWCSZ01  1.3545143  0.0092002   147.227  &lt; 2e-16 ***\nORIGIN_SZWCSZ02 -2.9863278  0.0330906   -90.247  &lt; 2e-16 ***\nORIGIN_SZWCSZ03 -5.0504916  0.1241385   -40.684  &lt; 2e-16 ***\nORIGIN_SZWDSZ01  1.5238429  0.0049404   308.448  &lt; 2e-16 ***\nORIGIN_SZWDSZ02  0.2832576  0.0056218    50.386  &lt; 2e-16 ***\nORIGIN_SZWDSZ03  1.3702524  0.0053266   257.245  &lt; 2e-16 ***\nORIGIN_SZWDSZ04  1.0248225  0.0059272   172.903  &lt; 2e-16 ***\nORIGIN_SZWDSZ05  0.2356778  0.0060587    38.899  &lt; 2e-16 ***\nORIGIN_SZWDSZ06  0.3146925  0.0059919    52.520  &lt; 2e-16 ***\nORIGIN_SZWDSZ07 -1.4971897  0.0091243  -164.088  &lt; 2e-16 ***\nORIGIN_SZWDSZ08 -0.8894079  0.0087414  -101.747  &lt; 2e-16 ***\nORIGIN_SZWDSZ09  1.4437633  0.0053160   271.590  &lt; 2e-16 ***\nORIGIN_SZYSSZ01 -0.2519398  0.0064443   -39.095  &lt; 2e-16 ***\nORIGIN_SZYSSZ02  0.8726785  0.0057658   151.354  &lt; 2e-16 ***\nORIGIN_SZYSSZ03  1.7868139  0.0050674   352.611  &lt; 2e-16 ***\nORIGIN_SZYSSZ04  0.8418040  0.0051738   162.704  &lt; 2e-16 ***\nORIGIN_SZYSSZ05  0.4292096  0.0062520    68.652  &lt; 2e-16 ***\nORIGIN_SZYSSZ06 -0.7459961  0.0119123   -62.624  &lt; 2e-16 ***\nORIGIN_SZYSSZ07 -0.8422281  0.0144559   -58.262  &lt; 2e-16 ***\nORIGIN_SZYSSZ08  0.1829428  0.0067885    26.949  &lt; 2e-16 ***\nORIGIN_SZYSSZ09  1.1159712  0.0050760   219.853  &lt; 2e-16 ***\nDESTIN_SZAMSZ02  0.0694567  0.0045966    15.111  &lt; 2e-16 ***\nDESTIN_SZAMSZ03  0.0760100  0.0044639    17.028  &lt; 2e-16 ***\nDESTIN_SZAMSZ04 -1.1306391  0.0064373  -175.639  &lt; 2e-16 ***\nDESTIN_SZAMSZ05 -1.0751133  0.0065164  -164.985  &lt; 2e-16 ***\nDESTIN_SZAMSZ06 -0.9624298  0.0065937  -145.962  &lt; 2e-16 ***\nDESTIN_SZAMSZ07 -1.5060319  0.0097616  -154.281  &lt; 2e-16 ***\nDESTIN_SZAMSZ08 -0.4813202  0.0069794   -68.963  &lt; 2e-16 ***\nDESTIN_SZAMSZ09 -1.0220675  0.0066313  -154.129  &lt; 2e-16 ***\nDESTIN_SZAMSZ10  0.1235142  0.0047044    26.255  &lt; 2e-16 ***\nDESTIN_SZAMSZ11 -0.8917993  0.0088519  -100.746  &lt; 2e-16 ***\nDESTIN_SZAMSZ12  0.0195208  0.0051704     3.775 0.000160 ***\nDESTIN_SZBDSZ01  0.9736349  0.0042757   227.713  &lt; 2e-16 ***\nDESTIN_SZBDSZ02 -0.1969470  0.0055284   -35.625  &lt; 2e-16 ***\nDESTIN_SZBDSZ03  0.1266471  0.0050786    24.938  &lt; 2e-16 ***\nDESTIN_SZBDSZ04  1.1608485  0.0041956   276.684  &lt; 2e-16 ***\nDESTIN_SZBDSZ05  0.9293840  0.0044412   209.265  &lt; 2e-16 ***\nDESTIN_SZBDSZ06  0.4090567  0.0050300    81.323  &lt; 2e-16 ***\nDESTIN_SZBDSZ07 -0.8171478  0.0098945   -82.586  &lt; 2e-16 ***\nDESTIN_SZBDSZ08 -1.5895287  0.0111632  -142.391  &lt; 2e-16 ***\nDESTIN_SZBKSZ01 -1.3793311  0.0072145  -191.189  &lt; 2e-16 ***\nDESTIN_SZBKSZ02 -0.5253670  0.0061879   -84.903  &lt; 2e-16 ***\nDESTIN_SZBKSZ03 -1.0095362  0.0065426  -154.301  &lt; 2e-16 ***\nDESTIN_SZBKSZ04 -0.5662858  0.0056453  -100.311  &lt; 2e-16 ***\nDESTIN_SZBKSZ05 -0.9406607  0.0070597  -133.244  &lt; 2e-16 ***\nDESTIN_SZBKSZ06 -1.3129276  0.0067414  -194.755  &lt; 2e-16 ***\nDESTIN_SZBKSZ07  0.0120605  0.0049284     2.447 0.014400 *  \nDESTIN_SZBKSZ08 -1.3658471  0.0075109  -181.849  &lt; 2e-16 ***\nDESTIN_SZBKSZ09 -0.1771310  0.0055645   -31.832  &lt; 2e-16 ***\nDESTIN_SZBLSZ01 -0.8175223  0.0075645  -108.074  &lt; 2e-16 ***\nDESTIN_SZBLSZ02  0.1631280  0.0071753    22.735  &lt; 2e-16 ***\nDESTIN_SZBLSZ03  1.2598494  0.0081706   154.194  &lt; 2e-16 ***\nDESTIN_SZBLSZ04 -0.5642975  0.0137827   -40.943  &lt; 2e-16 ***\nDESTIN_SZBMSZ01  0.6921844  0.0054211   127.684  &lt; 2e-16 ***\nDESTIN_SZBMSZ02 -0.1209392  0.0055362   -21.845  &lt; 2e-16 ***\nDESTIN_SZBMSZ03 -0.2373881  0.0062427   -38.027  &lt; 2e-16 ***\nDESTIN_SZBMSZ04 -0.0407117  0.0058001    -7.019 2.23e-12 ***\nDESTIN_SZBMSZ05 -0.2363309  0.0075967   -31.110  &lt; 2e-16 ***\nDESTIN_SZBMSZ06 -1.1930710  0.0134761   -88.532  &lt; 2e-16 ***\nDESTIN_SZBMSZ07  0.4625103  0.0051864    89.178  &lt; 2e-16 ***\nDESTIN_SZBMSZ08 -0.8604731  0.0069899  -123.102  &lt; 2e-16 ***\nDESTIN_SZBMSZ09 -2.1290239  0.0154841  -137.498  &lt; 2e-16 ***\nDESTIN_SZBMSZ10 -1.4617153  0.0094014  -155.478  &lt; 2e-16 ***\nDESTIN_SZBMSZ11 -1.3234050  0.0085506  -154.773  &lt; 2e-16 ***\nDESTIN_SZBMSZ12 -0.8399230  0.0085361   -98.397  &lt; 2e-16 ***\nDESTIN_SZBMSZ13  0.1366529  0.0059697    22.891  &lt; 2e-16 ***\nDESTIN_SZBMSZ14 -1.0491968  0.0083021  -126.378  &lt; 2e-16 ***\nDESTIN_SZBMSZ15 -0.6726684  0.0076276   -88.189  &lt; 2e-16 ***\nDESTIN_SZBMSZ16 -1.4011734  0.0116569  -120.201  &lt; 2e-16 ***\nDESTIN_SZBMSZ17 -1.5682752  0.0167333   -93.722  &lt; 2e-16 ***\nDESTIN_SZBPSZ01 -1.1120017  0.0063197  -175.959  &lt; 2e-16 ***\nDESTIN_SZBPSZ02 -2.0833466  0.0091139  -228.590  &lt; 2e-16 ***\nDESTIN_SZBPSZ03 -1.6937265  0.0087437  -193.709  &lt; 2e-16 ***\nDESTIN_SZBPSZ04 -0.7964999  0.0066129  -120.447  &lt; 2e-16 ***\nDESTIN_SZBPSZ05  0.2109118  0.0048815    43.206  &lt; 2e-16 ***\nDESTIN_SZBPSZ06 -1.1808365  0.0083657  -141.152  &lt; 2e-16 ***\nDESTIN_SZBPSZ07 -0.2077428  0.0084543   -24.572  &lt; 2e-16 ***\nDESTIN_SZBSSZ01  0.3164175  0.0050682    62.431  &lt; 2e-16 ***\nDESTIN_SZBSSZ02 -0.4852688  0.0057001   -85.134  &lt; 2e-16 ***\nDESTIN_SZBSSZ03  0.4130432  0.0043061    95.921  &lt; 2e-16 ***\nDESTIN_SZBTSZ01  0.6215095  0.0048914   127.061  &lt; 2e-16 ***\nDESTIN_SZBTSZ02 -0.0145076  0.0071799    -2.021 0.043324 *  \nDESTIN_SZBTSZ03  0.4919981  0.0058498    84.105  &lt; 2e-16 ***\nDESTIN_SZBTSZ04 -0.6957555  0.0114078   -60.989  &lt; 2e-16 ***\nDESTIN_SZBTSZ05  0.3329814  0.0073568    45.262  &lt; 2e-16 ***\nDESTIN_SZBTSZ06 -0.1333295  0.0073965   -18.026  &lt; 2e-16 ***\nDESTIN_SZBTSZ07 -1.4449581  0.0113186  -127.663  &lt; 2e-16 ***\nDESTIN_SZBTSZ08 -0.7079056  0.0103797   -68.201  &lt; 2e-16 ***\nDESTIN_SZCBSZ01 -5.7344725  0.3162767   -18.131  &lt; 2e-16 ***\nDESTIN_SZCCSZ01 -0.0009541  0.0083381    -0.114 0.908900    \nDESTIN_SZCHSZ01 -0.2083016  0.0099054   -21.029  &lt; 2e-16 ***\nDESTIN_SZCHSZ02  0.5369606  0.0057531    93.334  &lt; 2e-16 ***\nDESTIN_SZCHSZ03  2.5530638  0.0043945   580.971  &lt; 2e-16 ***\nDESTIN_SZCKSZ01 -0.5725975  0.0056507  -101.333  &lt; 2e-16 ***\nDESTIN_SZCKSZ02 -1.1181852  0.0063287  -176.685  &lt; 2e-16 ***\nDESTIN_SZCKSZ03  0.1156680  0.0049440    23.396  &lt; 2e-16 ***\nDESTIN_SZCKSZ04 -0.8647725  0.0071003  -121.794  &lt; 2e-16 ***\nDESTIN_SZCKSZ05 -1.1641791  0.0076248  -152.684  &lt; 2e-16 ***\nDESTIN_SZCKSZ06 -0.4397612  0.0073040   -60.208  &lt; 2e-16 ***\nDESTIN_SZCLSZ01  0.1930552  0.0053752    35.916  &lt; 2e-16 ***\nDESTIN_SZCLSZ02 -2.0436501  0.0136039  -150.225  &lt; 2e-16 ***\nDESTIN_SZCLSZ03 -0.9338571  0.0082908  -112.638  &lt; 2e-16 ***\nDESTIN_SZCLSZ04  0.0532041  0.0053276     9.987  &lt; 2e-16 ***\nDESTIN_SZCLSZ05 -1.0782781  0.0088184  -122.276  &lt; 2e-16 ***\nDESTIN_SZCLSZ06  0.4068171  0.0049068    82.910  &lt; 2e-16 ***\nDESTIN_SZCLSZ07 -0.3579507  0.0060289   -59.373  &lt; 2e-16 ***\nDESTIN_SZCLSZ08 -0.2487993  0.0066588   -37.364  &lt; 2e-16 ***\nDESTIN_SZCLSZ09  0.1611080  0.0071178    22.635  &lt; 2e-16 ***\nDESTIN_SZDTSZ02 -1.7308348  0.0349466   -49.528  &lt; 2e-16 ***\nDESTIN_SZDTSZ03 -0.5994253  0.0146230   -40.992  &lt; 2e-16 ***\nDESTIN_SZDTSZ13 -1.3685031  0.0162803   -84.059  &lt; 2e-16 ***\nDESTIN_SZGLSZ01 -0.0910001  0.0055275   -16.463  &lt; 2e-16 ***\nDESTIN_SZGLSZ02 -0.0692224  0.0052840   -13.100  &lt; 2e-16 ***\nDESTIN_SZGLSZ03  0.6493421  0.0043446   149.459  &lt; 2e-16 ***\nDESTIN_SZGLSZ04  0.9327947  0.0043674   213.583  &lt; 2e-16 ***\nDESTIN_SZGLSZ05  0.8161728  0.0043625   187.087  &lt; 2e-16 ***\nDESTIN_SZHGSZ01  0.0658625  0.0042516    15.491  &lt; 2e-16 ***\nDESTIN_SZHGSZ02 -0.8134329  0.0056721  -143.409  &lt; 2e-16 ***\nDESTIN_SZHGSZ03 -1.3546132  0.0066257  -204.448  &lt; 2e-16 ***\nDESTIN_SZHGSZ04 -0.4500588  0.0048448   -92.895  &lt; 2e-16 ***\nDESTIN_SZHGSZ05 -0.5026431  0.0050996   -98.566  &lt; 2e-16 ***\nDESTIN_SZHGSZ06 -0.8673686  0.0059530  -145.704  &lt; 2e-16 ***\nDESTIN_SZHGSZ07  0.0560490  0.0047702    11.750  &lt; 2e-16 ***\nDESTIN_SZHGSZ08 -0.0443189  0.0052599    -8.426  &lt; 2e-16 ***\nDESTIN_SZHGSZ09 -0.0126355  0.0054966    -2.299 0.021518 *  \nDESTIN_SZHGSZ10 -3.5821793  0.0263281  -136.059  &lt; 2e-16 ***\nDESTIN_SZJESZ01 -0.3704281  0.0056684   -65.350  &lt; 2e-16 ***\nDESTIN_SZJESZ02 -0.7369159  0.0058686  -125.570  &lt; 2e-16 ***\nDESTIN_SZJESZ03 -0.8985484  0.0063627  -141.222  &lt; 2e-16 ***\nDESTIN_SZJESZ04 -1.0511995  0.0073996  -142.061  &lt; 2e-16 ***\nDESTIN_SZJESZ05 -1.5324974  0.0102612  -149.349  &lt; 2e-16 ***\nDESTIN_SZJESZ06  0.3105267  0.0048241    64.370  &lt; 2e-16 ***\nDESTIN_SZJESZ07 -1.3234483  0.0085497  -154.795  &lt; 2e-16 ***\nDESTIN_SZJESZ08 -0.6559742  0.0083174   -78.867  &lt; 2e-16 ***\nDESTIN_SZJESZ09  0.2663752  0.0063370    42.035  &lt; 2e-16 ***\nDESTIN_SZJESZ10  0.8529026  0.0076067   112.126  &lt; 2e-16 ***\nDESTIN_SZJESZ11  0.5559641  0.0074629    74.497  &lt; 2e-16 ***\nDESTIN_SZJWSZ01 -0.9790971  0.0071830  -136.308  &lt; 2e-16 ***\nDESTIN_SZJWSZ02 -0.8746590  0.0060179  -145.342  &lt; 2e-16 ***\nDESTIN_SZJWSZ03  0.5689062  0.0049105   115.855  &lt; 2e-16 ***\nDESTIN_SZJWSZ04  0.4520963  0.0050302    89.876  &lt; 2e-16 ***\nDESTIN_SZJWSZ05 -1.0249671  0.0067371  -152.137  &lt; 2e-16 ***\nDESTIN_SZJWSZ06 -0.7451483  0.0062189  -119.819  &lt; 2e-16 ***\nDESTIN_SZJWSZ07 -2.8453099  0.0287335   -99.024  &lt; 2e-16 ***\nDESTIN_SZJWSZ08 -0.3372309  0.0058003   -58.141  &lt; 2e-16 ***\nDESTIN_SZJWSZ09  1.0505330  0.0045908   228.832  &lt; 2e-16 ***\nDESTIN_SZKLSZ01 -0.2334836  0.0057970   -40.277  &lt; 2e-16 ***\nDESTIN_SZKLSZ02 -0.5416148  0.0061432   -88.164  &lt; 2e-16 ***\nDESTIN_SZKLSZ03 -0.8026495  0.0068745  -116.757  &lt; 2e-16 ***\nDESTIN_SZKLSZ04 -1.2918594  0.0090197  -143.227  &lt; 2e-16 ***\nDESTIN_SZKLSZ05 -0.4069101  0.0087812   -46.339  &lt; 2e-16 ***\nDESTIN_SZKLSZ06 -2.5333101  0.0363215   -69.747  &lt; 2e-16 ***\nDESTIN_SZKLSZ07 -0.6623343  0.0070761   -93.601  &lt; 2e-16 ***\nDESTIN_SZKLSZ08 -0.1408205  0.0054965   -25.620  &lt; 2e-16 ***\nDESTIN_SZLKSZ01 -1.2639235  0.0208254   -60.691  &lt; 2e-16 ***\nDESTIN_SZMDSZ01 -1.5655800  0.0202787   -77.203  &lt; 2e-16 ***\nDESTIN_SZMDSZ02 -0.9767682  0.0114687   -85.168  &lt; 2e-16 ***\nDESTIN_SZMDSZ03 -3.3328109  0.0254294  -131.061  &lt; 2e-16 ***\nDESTIN_SZMPSZ01 -0.4552859  0.0080666   -56.441  &lt; 2e-16 ***\nDESTIN_SZMPSZ02 -0.5386560  0.0064620   -83.358  &lt; 2e-16 ***\nDESTIN_SZMPSZ03  0.4952000  0.0052295    94.694  &lt; 2e-16 ***\nDESTIN_SZMUSZ02 -1.4434175  0.0202509   -71.277  &lt; 2e-16 ***\nDESTIN_SZNTSZ01 -2.9194067  0.0449654   -64.926  &lt; 2e-16 ***\nDESTIN_SZNTSZ02 -1.3780179  0.0112867  -122.092  &lt; 2e-16 ***\nDESTIN_SZNTSZ03 -0.5044699  0.0080449   -62.707  &lt; 2e-16 ***\nDESTIN_SZNTSZ05 -2.0017134  0.0258750   -77.361  &lt; 2e-16 ***\nDESTIN_SZNTSZ06 -3.8120537  0.0434271   -87.781  &lt; 2e-16 ***\nDESTIN_SZNVSZ01 -0.1071506  0.0051026   -20.999  &lt; 2e-16 ***\nDESTIN_SZNVSZ02 -0.0274710  0.0057611    -4.768 1.86e-06 ***\nDESTIN_SZNVSZ03  0.1076352  0.0057909    18.587  &lt; 2e-16 ***\nDESTIN_SZNVSZ04 -1.2087250  0.0110438  -109.448  &lt; 2e-16 ***\nDESTIN_SZNVSZ05 -1.0058290  0.0092167  -109.131  &lt; 2e-16 ***\nDESTIN_SZPGSZ01 -1.2029931  0.0163170   -73.726  &lt; 2e-16 ***\nDESTIN_SZPGSZ02 -1.2878671  0.0074139  -173.709  &lt; 2e-16 ***\nDESTIN_SZPGSZ03 -0.1520894  0.0048629   -31.275  &lt; 2e-16 ***\nDESTIN_SZPGSZ04 -0.1985959  0.0050374   -39.424  &lt; 2e-16 ***\nDESTIN_SZPGSZ05 -1.5290983  0.0082617  -185.083  &lt; 2e-16 ***\nDESTIN_SZPLSZ01 -0.3567934  0.0074298   -48.022  &lt; 2e-16 ***\nDESTIN_SZPLSZ02 -1.7114351  0.0134462  -127.280  &lt; 2e-16 ***\nDESTIN_SZPLSZ03 -0.3241427  0.0098895   -32.776  &lt; 2e-16 ***\nDESTIN_SZPLSZ04 -1.7117196  0.0119003  -143.838  &lt; 2e-16 ***\nDESTIN_SZPLSZ05 -0.5086379  0.0120051   -42.368  &lt; 2e-16 ***\nDESTIN_SZPNSZ01  0.2026781  0.0068977    29.383  &lt; 2e-16 ***\nDESTIN_SZPNSZ02  0.8313754  0.0078544   105.848  &lt; 2e-16 ***\nDESTIN_SZPNSZ03 -0.4041254  0.0086586   -46.673  &lt; 2e-16 ***\nDESTIN_SZPNSZ04  1.5814539  0.0093641   168.885  &lt; 2e-16 ***\nDESTIN_SZPNSZ05  1.1823430  0.0129843    91.059  &lt; 2e-16 ***\nDESTIN_SZPRSZ01 -1.1057553  0.0088197  -125.374  &lt; 2e-16 ***\nDESTIN_SZPRSZ02  0.0895099  0.0056308    15.897  &lt; 2e-16 ***\nDESTIN_SZPRSZ03  0.6921925  0.0043977   157.397  &lt; 2e-16 ***\nDESTIN_SZPRSZ04 -0.2848336  0.0084725   -33.619  &lt; 2e-16 ***\nDESTIN_SZPRSZ05  0.1744480  0.0053553    32.575  &lt; 2e-16 ***\nDESTIN_SZPRSZ06  0.4279206  0.0058735    72.856  &lt; 2e-16 ***\nDESTIN_SZPRSZ07 -1.5123108  0.0124303  -121.664  &lt; 2e-16 ***\nDESTIN_SZPRSZ08 -0.5650226  0.0068530   -82.449  &lt; 2e-16 ***\nDESTIN_SZQTSZ01 -0.5952360  0.0090505   -65.769  &lt; 2e-16 ***\nDESTIN_SZQTSZ02 -0.7728170  0.0078910   -97.937  &lt; 2e-16 ***\nDESTIN_SZQTSZ03 -0.5066812  0.0073996   -68.474  &lt; 2e-16 ***\nDESTIN_SZQTSZ04 -0.6398414  0.0075411   -84.847  &lt; 2e-16 ***\nDESTIN_SZQTSZ05 -0.4354527  0.0069345   -62.795  &lt; 2e-16 ***\nDESTIN_SZQTSZ06 -0.6597391  0.0071919   -91.733  &lt; 2e-16 ***\nDESTIN_SZQTSZ07 -0.9392696  0.0112518   -83.477  &lt; 2e-16 ***\nDESTIN_SZQTSZ08  0.4617774  0.0057011    80.998  &lt; 2e-16 ***\nDESTIN_SZQTSZ09 -0.3174497  0.0065890   -48.178  &lt; 2e-16 ***\nDESTIN_SZQTSZ10  0.1993449  0.0059923    33.267  &lt; 2e-16 ***\nDESTIN_SZQTSZ11  0.2551535  0.0061885    41.230  &lt; 2e-16 ***\nDESTIN_SZQTSZ12 -0.1662603  0.0086701   -19.176  &lt; 2e-16 ***\nDESTIN_SZQTSZ13  0.5500978  0.0063091    87.192  &lt; 2e-16 ***\nDESTIN_SZQTSZ14  0.5364435  0.0070157    76.463  &lt; 2e-16 ***\nDESTIN_SZQTSZ15  1.3611043  0.0081643   166.715  &lt; 2e-16 ***\nDESTIN_SZRCSZ01 -0.1034049  0.0076769   -13.470  &lt; 2e-16 ***\nDESTIN_SZRCSZ06 -1.0633902  0.0189846   -56.013  &lt; 2e-16 ***\nDESTIN_SZRVSZ01 -1.5486221  0.0165272   -93.701  &lt; 2e-16 ***\nDESTIN_SZRVSZ02 -2.4092611  0.0326906   -73.699  &lt; 2e-16 ***\nDESTIN_SZRVSZ03 -1.5172079  0.0139258  -108.950  &lt; 2e-16 ***\nDESTIN_SZRVSZ04 -1.1663615  0.0157430   -74.088  &lt; 2e-16 ***\nDESTIN_SZRVSZ05 -2.2404292  0.0281339   -79.634  &lt; 2e-16 ***\nDESTIN_SZSBSZ01 -1.3783780  0.0096022  -143.549  &lt; 2e-16 ***\nDESTIN_SZSBSZ02 -1.4445213  0.0081630  -176.959  &lt; 2e-16 ***\nDESTIN_SZSBSZ03  0.5149906  0.0051663    99.683  &lt; 2e-16 ***\nDESTIN_SZSBSZ04  0.2389086  0.0060765    39.317  &lt; 2e-16 ***\nDESTIN_SZSBSZ05 -1.2737442  0.0082818  -153.801  &lt; 2e-16 ***\nDESTIN_SZSBSZ06 -1.8683520  0.0227277   -82.206  &lt; 2e-16 ***\nDESTIN_SZSBSZ07 -0.5993154  0.0184895   -32.414  &lt; 2e-16 ***\nDESTIN_SZSBSZ08  0.8156302  0.0059840   136.302  &lt; 2e-16 ***\nDESTIN_SZSBSZ09  0.0900611  0.0057054    15.785  &lt; 2e-16 ***\nDESTIN_SZSESZ02 -0.6397704  0.0052491  -121.882  &lt; 2e-16 ***\nDESTIN_SZSESZ03  0.1714103  0.0042357    40.468  &lt; 2e-16 ***\nDESTIN_SZSESZ04 -1.0596175  0.0059865  -177.002  &lt; 2e-16 ***\nDESTIN_SZSESZ05 -0.8071891  0.0051229  -157.566  &lt; 2e-16 ***\nDESTIN_SZSESZ06 -0.5580934  0.0066216   -84.284  &lt; 2e-16 ***\nDESTIN_SZSESZ07 -3.1448863  0.0227788  -138.062  &lt; 2e-16 ***\nDESTIN_SZSGSZ01 -0.1795225  0.0060127   -29.857  &lt; 2e-16 ***\nDESTIN_SZSGSZ02 -0.2986570  0.0053561   -55.760  &lt; 2e-16 ***\nDESTIN_SZSGSZ03 -0.4074671  0.0050609   -80.513  &lt; 2e-16 ***\nDESTIN_SZSGSZ04 -0.1505164  0.0050931   -29.553  &lt; 2e-16 ***\nDESTIN_SZSGSZ05 -1.9908372  0.0101448  -196.242  &lt; 2e-16 ***\nDESTIN_SZSGSZ06  0.6715268  0.0041161   163.148  &lt; 2e-16 ***\nDESTIN_SZSGSZ07 -0.4494757  0.0055319   -81.252  &lt; 2e-16 ***\nDESTIN_SZSISZ01 -0.5517983  0.0261860   -21.072  &lt; 2e-16 ***\nDESTIN_SZSKSZ01 -0.4749154  0.0079257   -59.921  &lt; 2e-16 ***\nDESTIN_SZSKSZ02  0.9400302  0.0057218   164.290  &lt; 2e-16 ***\nDESTIN_SZSKSZ03 -0.2800377  0.0066081   -42.378  &lt; 2e-16 ***\nDESTIN_SZSKSZ04 -1.2570212  0.0145351   -86.482  &lt; 2e-16 ***\nDESTIN_SZSKSZ05 -0.2600474  0.0112800   -23.054  &lt; 2e-16 ***\nDESTIN_SZSLSZ01 -0.7775604  0.0085818   -90.606  &lt; 2e-16 ***\nDESTIN_SZSLSZ04 -0.8586515  0.0073142  -117.396  &lt; 2e-16 ***\nDESTIN_SZSRSZ01 -1.1370887  0.0142148   -79.993  &lt; 2e-16 ***\nDESTIN_SZTHSZ01 -4.3259988  0.0368554  -117.378  &lt; 2e-16 ***\nDESTIN_SZTHSZ03 -2.6632914  0.0252720  -105.385  &lt; 2e-16 ***\nDESTIN_SZTHSZ04 -3.1000906  0.0216372  -143.276  &lt; 2e-16 ***\nDESTIN_SZTHSZ06 -2.5952642  0.0156340  -166.001  &lt; 2e-16 ***\nDESTIN_SZTMSZ01 -0.2092828  0.0059257   -35.318  &lt; 2e-16 ***\nDESTIN_SZTMSZ02  1.8238139  0.0039155   465.798  &lt; 2e-16 ***\nDESTIN_SZTMSZ03  0.8518259  0.0043636   195.210  &lt; 2e-16 ***\nDESTIN_SZTMSZ04  1.0222812  0.0043466   235.191  &lt; 2e-16 ***\nDESTIN_SZTMSZ05  0.6323777  0.0060058   105.294  &lt; 2e-16 ***\nDESTIN_SZTNSZ01 -0.3336078  0.0074388   -44.847  &lt; 2e-16 ***\nDESTIN_SZTNSZ02 -1.0820469  0.0101689  -106.408  &lt; 2e-16 ***\nDESTIN_SZTNSZ03 -1.4186505  0.0119906  -118.313  &lt; 2e-16 ***\nDESTIN_SZTNSZ04 -0.3058199  0.0074743   -40.916  &lt; 2e-16 ***\nDESTIN_SZTPSZ01 -0.4872299  0.0061571   -79.133  &lt; 2e-16 ***\nDESTIN_SZTPSZ02  0.7158441  0.0041312   173.278  &lt; 2e-16 ***\nDESTIN_SZTPSZ03 -0.4314229  0.0059917   -72.004  &lt; 2e-16 ***\nDESTIN_SZTPSZ04 -1.5898245  0.0076083  -208.959  &lt; 2e-16 ***\nDESTIN_SZTPSZ05 -1.0445550  0.0062363  -167.497  &lt; 2e-16 ***\nDESTIN_SZTPSZ06 -0.4319582  0.0070100   -61.621  &lt; 2e-16 ***\nDESTIN_SZTPSZ07 -2.1602303  0.0120352  -179.493  &lt; 2e-16 ***\nDESTIN_SZTPSZ08 -1.1920493  0.0093083  -128.063  &lt; 2e-16 ***\nDESTIN_SZTPSZ09 -0.2022481  0.0071137   -28.431  &lt; 2e-16 ***\nDESTIN_SZTPSZ10 -1.2464793  0.0090124  -138.308  &lt; 2e-16 ***\nDESTIN_SZTPSZ11 -0.0808445  0.0056019   -14.432  &lt; 2e-16 ***\nDESTIN_SZTPSZ12 -0.6784376  0.0066340  -102.267  &lt; 2e-16 ***\nDESTIN_SZTSSZ01 -1.5845062  0.0222086   -71.346  &lt; 2e-16 ***\nDESTIN_SZTSSZ02 -0.1886010  0.0146338   -12.888  &lt; 2e-16 ***\nDESTIN_SZTSSZ03  0.6525526  0.0092450    70.585  &lt; 2e-16 ***\nDESTIN_SZTSSZ04  0.5285464  0.0100182    52.759  &lt; 2e-16 ***\nDESTIN_SZTSSZ05  1.4670106  0.0104357   140.577  &lt; 2e-16 ***\nDESTIN_SZTSSZ06  2.5043588  0.0167444   149.564  &lt; 2e-16 ***\nDESTIN_SZWCSZ01  1.9787931  0.0054306   364.375  &lt; 2e-16 ***\nDESTIN_SZWCSZ02 -2.2593108  0.0127916  -176.624  &lt; 2e-16 ***\nDESTIN_SZWCSZ03 -3.1897655  0.0326927   -97.568  &lt; 2e-16 ***\nDESTIN_SZWDSZ01  1.0476108  0.0044629   234.738  &lt; 2e-16 ***\nDESTIN_SZWDSZ02 -1.3176990  0.0065894  -199.973  &lt; 2e-16 ***\nDESTIN_SZWDSZ03  0.3432057  0.0052496    65.377  &lt; 2e-16 ***\nDESTIN_SZWDSZ04 -0.7895927  0.0073392  -107.586  &lt; 2e-16 ***\nDESTIN_SZWDSZ05 -0.8751665  0.0072946  -119.975  &lt; 2e-16 ***\nDESTIN_SZWDSZ06 -0.2106221  0.0053027   -39.720  &lt; 2e-16 ***\nDESTIN_SZWDSZ07 -1.6050834  0.0071754  -223.692  &lt; 2e-16 ***\nDESTIN_SZWDSZ08 -0.5124717  0.0069223   -74.032  &lt; 2e-16 ***\nDESTIN_SZWDSZ09  0.3813542  0.0054697    69.721  &lt; 2e-16 ***\nDESTIN_SZYSSZ01  0.0853753  0.0046572    18.332  &lt; 2e-16 ***\nDESTIN_SZYSSZ02 -0.3227172  0.0057351   -56.271  &lt; 2e-16 ***\nDESTIN_SZYSSZ03 -0.4151283  0.0066299   -62.615  &lt; 2e-16 ***\nDESTIN_SZYSSZ04 -0.4637327  0.0058206   -79.671  &lt; 2e-16 ***\nDESTIN_SZYSSZ05 -1.5888242  0.0111001  -143.136  &lt; 2e-16 ***\nDESTIN_SZYSSZ06 -1.4606209  0.0107759  -135.545  &lt; 2e-16 ***\nDESTIN_SZYSSZ07 -0.7839065  0.0144357   -54.304  &lt; 2e-16 ***\nDESTIN_SZYSSZ08  0.6265412  0.0045504   137.691  &lt; 2e-16 ***\nDESTIN_SZYSSZ09  0.1520067  0.0048092    31.607  &lt; 2e-16 ***\nlog(dist)       -1.8468315  0.0004608 -4008.033  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 47094011  on 14470  degrees of freedom\nResidual deviance: 10420261  on 13912  degrees of freedom\nAIC: 10510518\n\nNumber of Fisher Scoring iterations: 7\n\n\n\nCalcRSquared(dbcSIM_Poisson$data$MORNING_PEAK,\n             dbcSIM_Poisson$fitted.values)\n\n[1] 0.7001882"
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.1.html#model-comparison",
    "href": "in_class_ex4/in_class_ex4.1.html#model-comparison",
    "title": "In-class Exercise 4: Calibrating Spatial Interaction Models with R",
    "section": "Model comparison",
    "text": "Model comparison\n\nStatistical measures\n\nmodel_list &lt;- list(\n  Origin_Constrained = orcSIM_Poisson,\n  Doubly_Constrained = dbcSIM_Poisson)\n\n\ncompare_performance(model_list,\n                    metrics = \"RMSE\")\n\n# Comparison of Model Performance Indices\n\nName               | Model |     RMSE\n-------------------------------------\nOrigin_Constrained |   glm | 2642.615\nDoubly_Constrained |   glm | 1906.694\n\n\n\n\nVisualising fitted values\n\ndf &lt;- as.data.frame(orcSIM_Poisson$fitted.values) %&gt;%\n  round(digits = 0)\n\n\ninter_zonal_flow &lt;- inter_zonal_flow %&gt;%\n  cbind(df) %&gt;%\n  rename(orcTRIPS = \"orcSIM_Poisson.fitted.values\")\n\n\ndf &lt;- as.data.frame(dbcSIM_Poisson$fitted.values) %&gt;%\n  round(digits = 0)\n\n\ninter_zonal_flow &lt;- inter_zonal_flow %&gt;%\n  cbind(df) %&gt;%\n  rename(dbcTRIPS = \"dbcSIM_Poisson.fitted.values\")\n\n\norc_p &lt;- ggplot(data = inter_zonal_flow,\n                aes(x = orcTRIPS,\n                    y = MORNING_PEAK)) +\n  geom_point() +\n  geom_smooth(method = lm) +\n  coord_cartesian(xlim=c(0,150000),\n                  ylim=c(0,150000))\n\ndbc_p &lt;- ggplot(data = inter_zonal_flow,\n                aes(x = dbcTRIPS,\n                    y = MORNING_PEAK)) +\n  geom_point() +\n  geom_smooth(method = lm) +\n  coord_cartesian(xlim=c(0,150000),\n                  ylim=c(0,150000))\n\n\nggarrange(orc_p, dbc_p,\n          ncol = 2,\n          nrow = 1)\n\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'"
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.html",
    "href": "in_class_ex4/in_class_ex4.html",
    "title": "In-class Exercise 4: Geospatial Data Science With R- Preparing Spatial Interaction Modelling Variables",
    "section": "",
    "text": "pacman:: p_load(tidyverse, sf, httr, tmap)"
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.html#downloading-general-information-of-schools-data-from-data.gov.sg",
    "href": "in_class_ex4/in_class_ex4.html#downloading-general-information-of-schools-data-from-data.gov.sg",
    "title": "In-class Exercise 4: Geospatial Data Science With R- Preparing Spatial Interaction Modelling Variables",
    "section": "Downloading General information of schools data from data.gov.sg",
    "text": "Downloading General information of schools data from data.gov.sg\nTo get started, you are required to download General information of schools data set of School Directory and Information from data.gov.sg."
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.html#geocoding-using-sla-api",
    "href": "in_class_ex4/in_class_ex4.html#geocoding-using-sla-api",
    "title": "In-class Exercise 4: Geospatial Data Science With R- Preparing Spatial Interaction Modelling Variables",
    "section": "Geocoding using SLA API",
    "text": "Geocoding using SLA API\n\nurl&lt;-\"https://www.onemap.gov.sg/api/common/elastic/search\"\n\ncsv&lt;-read_csv(\"data/aspatial/Generalinformationofschools.csv\")\n\nRows: 346 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (31): school_name, url_address, address, postal_code, telephone_no, tele...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\npostcodes&lt;-csv$`postal_code`\n\nfound&lt;-data.frame()\nnot_found&lt;-data.frame()\n\nfor(postcode in postcodes){\n  query&lt;-list('searchVal'=postcode,'returnGeom'='Y','getAddrDetails'='Y','pageNum'='1')\n  res&lt;- GET(url,query=query)\n  \n  if((content(res)$found)!=0){\n    found&lt;-rbind(found,data.frame(content(res))[4:13])\n  } else{\n    not_found = data.frame(postcode)\n  }\n}\n\nNext, the code chunk below will be used to combine both found and not_found data.frames into a single tibble data.frame called merged. At the same time, we will write merged and not_found tibble data.frames into two separate csv files called schools and not_found respectively.\n\nmerged = merge(csv, found, by.x = 'postal_code', by.y = 'results.POSTAL', all = TRUE)\nwrite.csv(merged, file = \"data/aspatial/schools.csv\")\nwrite.csv(not_found, file = \"data/aspatial/not_found.csv\")\n\n\n\n\n\n\n\nNote\n\n\n\nUpdate for ZhengHua Sec - results.LATITUDE and results.LONGITUDE fields of the ungeocoded record in schoolss.csv manually. (link)"
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.html#tidying-schools-data.frame",
    "href": "in_class_ex4/in_class_ex4.html#tidying-schools-data.frame",
    "title": "In-class Exercise 4: Geospatial Data Science With R- Preparing Spatial Interaction Modelling Variables",
    "section": "Tidying schools data.frame",
    "text": "Tidying schools data.frame\n\nschools &lt;- read_csv(\"data/aspatial/schools1.csv\") %&gt;%\n  rename(latitude = \"results.LATITUDE\",\n         longitude = \"results.LONGITUDE\")%&gt;%\n  select(postal_code, school_name, latitude, longitude)\n\nNew names:\nRows: 350 Columns: 41\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(35): school_name, url_address, address, telephone_no, telephone_no_2, f... dbl\n(6): ...1, postal_code, results.X, results.Y, results.LATITUDE, results...\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -&gt; `...1`"
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.html#converting-an-aspatial-data-into-sf-tibble-data.frame",
    "href": "in_class_ex4/in_class_ex4.html#converting-an-aspatial-data-into-sf-tibble-data.frame",
    "title": "In-class Exercise 4: Geospatial Data Science With R- Preparing Spatial Interaction Modelling Variables",
    "section": "Converting an aspatial data into sf tibble data.frame",
    "text": "Converting an aspatial data into sf tibble data.frame\n\nschools_sf &lt;- st_as_sf(schools, \n                       coords = c(\"longitude\", \"latitude\"),\n                       crs=4326) %&gt;%\n  st_transform(crs = 3414)"
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.html#plotting-a-point-simple-feature-layer",
    "href": "in_class_ex4/in_class_ex4.html#plotting-a-point-simple-feature-layer",
    "title": "In-class Exercise 4: Geospatial Data Science With R- Preparing Spatial Interaction Modelling Variables",
    "section": "Plotting a point simple feature layer",
    "text": "Plotting a point simple feature layer\n\nmpsz &lt;- st_read(dsn = \"data/geospatial/\",\n                layer = \"MPSZ-2019\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `MPSZ-2019' from data source \n  `C:\\czx0727\\ISSS624_\\in_class_ex4\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\n\ntmap_options(check.and.fix = TRUE)\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(schools_sf) +\n  tm_dots()\n\nWarning: The shape mpsz is invalid. See sf::st_is_valid"
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.html#performing-point-in-polygon-count-process",
    "href": "in_class_ex4/in_class_ex4.html#performing-point-in-polygon-count-process",
    "title": "In-class Exercise 4: Geospatial Data Science With R- Preparing Spatial Interaction Modelling Variables",
    "section": "Performing point-in-polygon count process",
    "text": "Performing point-in-polygon count process\n\nmpsz$`SCHOOL_COUNT`&lt;- lengths(\n  st_intersects(\n    mpsz, schools_sf))\n\n\nsummary(mpsz$SCHOOL_COUNT)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   0.000   1.051   2.000  12.000 \n\n\n\n\n\n\n\n\nNote\n\n\n\nThe summary statistics above reveals that there are excessive 0 values in SCHOOL_COUNT field. If log() is going to use to transform this field, additional step is required to ensure that all 0 will be replaced with a value between 0 and 1 but not 0 neither 1."
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.html#data-integration-and-final-touch-up",
    "href": "in_class_ex4/in_class_ex4.html#data-integration-and-final-touch-up",
    "title": "In-class Exercise 4: Geospatial Data Science With R- Preparing Spatial Interaction Modelling Variables",
    "section": "Data Integration and Final Touch-up",
    "text": "Data Integration and Final Touch-up\n\nbusiness_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Business\")\n\nReading layer `Business' from data source \n  `C:\\czx0727\\ISSS624_\\in_class_ex4\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 6550 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3669.148 ymin: 25408.41 xmax: 47034.83 ymax: 50148.54\nProjected CRS: SVY21 / Singapore TM\n\n\n\ntmap_options(check.and.fix = TRUE)\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(business_sf) +\n  tm_dots()\n\nWarning: The shape mpsz is invalid. See sf::st_is_valid\n\n\n\n\n\n\nmpsz$`BUSINESS_COUNT`&lt;- lengths(\n  st_intersects(\n    mpsz, business_sf))\n\n\nsummary(mpsz$BUSINESS_COUNT)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    0.00    2.00   19.73   13.00  307.00 \n\n\n\nflow_data &lt;- read_rds(\"data/rds/flow_data_tidy.rds\")\nflow_data\n\nSimple feature collection with 14734 features and 12 fields\nGeometry type: LINESTRING\nDimension:     XY\nBounding box:  xmin: 5105.594 ymin: 25813.33 xmax: 49483.22 ymax: 49552.79\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n   ORIGIN_SZ DESTIN_SZ MORNING_PEAK      dist ORIGIN_AGE7_12 ORIGIN_AGE13_24\n1     AMSZ01    AMSZ01         1998   50.0000            310             710\n2     AMSZ01    AMSZ02         8289  810.4491            310             710\n3     AMSZ01    AMSZ03         8971 1360.9294            310             710\n4     AMSZ01    AMSZ04         2252  840.4432            310             710\n5     AMSZ01    AMSZ05         6136 1076.7916            310             710\n6     AMSZ01    AMSZ06         2148  805.2979            310             710\n7     AMSZ01    AMSZ07         1620 1798.7526            310             710\n8     AMSZ01    AMSZ08         1925 2576.0199            310             710\n9     AMSZ01    AMSZ09         1773 1204.2846            310             710\n10    AMSZ01    AMSZ10           63 1417.8035            310             710\n   ORIGIN_AGE25_64 DESTIN_AGE7_12 DESTIN_AGE13_24 DESTIN_AGE25_64 SCHOOL_COUNT\n1             2780         310.00          710.00         2780.00         0.99\n2             2780        1140.00         2770.00        15700.00         2.00\n3             2780        1010.00         2650.00        14240.00         2.00\n4             2780         980.00         2000.00        11320.00         1.00\n5             2780         810.00         1920.00         9650.00         3.00\n6             2780        1050.00         2390.00        12460.00         2.00\n7             2780         420.00         1120.00         3620.00         0.99\n8             2780         390.00         1150.00         4350.00         0.99\n9             2780        1190.00         3260.00        13350.00         3.00\n10            2780           0.99            0.99            0.99         1.00\n   RETAIL_COUNT                       geometry\n1          1.00 LINESTRING (29501.77 39419....\n2          0.99 LINESTRING (29501.77 39419....\n3          6.00 LINESTRING (29501.77 39419....\n4          0.99 LINESTRING (29501.77 39419....\n5          0.99 LINESTRING (29501.77 39419....\n6          0.99 LINESTRING (29501.77 39419....\n7          1.00 LINESTRING (29501.77 39419....\n8        117.00 LINESTRING (29501.77 39419....\n9          0.99 LINESTRING (29501.77 39419....\n10        20.00 LINESTRING (29501.77 39419....\n\n\n\nmpsz_tidy &lt;- mpsz %&gt;%\n  st_drop_geometry() %&gt;%\n  select(SUBZONE_C, SCHOOL_COUNT, BUSINESS_COUNT)\n\n\nflow_data &lt;- flow_data %&gt;%\n  left_join(mpsz_tidy,\n            by = c(\"DESTIN_SZ\" = \"SUBZONE_C\")) %&gt;%\n  rename(TRIPS = MORNING_PEAK,\n         DIST = dist)"
  },
  {
    "objectID": "in_class_ex4/in_class_ex4.html#checking-for-variables-with-zero-values",
    "href": "in_class_ex4/in_class_ex4.html#checking-for-variables-with-zero-values",
    "title": "In-class Exercise 4: Geospatial Data Science With R- Preparing Spatial Interaction Modelling Variables",
    "section": "Checking for variables with zero values",
    "text": "Checking for variables with zero values\n\nsummary(flow_data)\n\n  ORIGIN_SZ          DESTIN_SZ             TRIPS             DIST      \n Length:14734       Length:14734       Min.   :     1   Min.   :   50  \n Class :character   Class :character   1st Qu.:    14   1st Qu.: 3346  \n Mode  :character   Mode  :character   Median :    76   Median : 6067  \n                                       Mean   :  1021   Mean   : 6880  \n                                       3rd Qu.:   426   3rd Qu.: 9729  \n                                       Max.   :232187   Max.   :26136  \n ORIGIN_AGE7_12    ORIGIN_AGE13_24    ORIGIN_AGE25_64    DESTIN_AGE7_12   \n Min.   :   0.99   Min.   :    0.99   Min.   :    0.99   Min.   :   0.99  \n 1st Qu.: 240.00   1st Qu.:  440.00   1st Qu.: 2200.00   1st Qu.: 240.00  \n Median : 700.00   Median : 1350.00   Median : 6810.00   Median : 720.00  \n Mean   :1031.86   Mean   : 2268.84   Mean   :10487.62   Mean   :1033.40  \n 3rd Qu.:1480.00   3rd Qu.: 3260.00   3rd Qu.:15770.00   3rd Qu.:1500.00  \n Max.   :6340.00   Max.   :16380.00   Max.   :74610.00   Max.   :6340.00  \n DESTIN_AGE13_24    DESTIN_AGE25_64    SCHOOL_COUNT.x    RETAIL_COUNT   \n Min.   :    0.99   Min.   :    0.99   Min.   : 0.990   Min.   :  0.99  \n 1st Qu.:  460.00   1st Qu.: 2200.00   1st Qu.: 0.990   1st Qu.:  0.99  \n Median : 1420.00   Median : 7030.00   Median : 1.000   Median :  3.00  \n Mean   : 2290.35   Mean   :10574.46   Mean   : 1.987   Mean   : 16.47  \n 3rd Qu.: 3260.00   3rd Qu.:15830.00   3rd Qu.: 2.000   3rd Qu.: 12.00  \n Max.   :16380.00   Max.   :74610.00   Max.   :12.000   Max.   :307.00  \n SCHOOL_COUNT.y  BUSINESS_COUNT            geometry    \n Min.   : 0.00   Min.   :  0.00   LINESTRING   :14734  \n 1st Qu.: 0.00   1st Qu.:  0.00   epsg:3414    :    0  \n Median : 1.00   Median :  3.00   +proj=tmer...:    0  \n Mean   : 1.58   Mean   : 16.17                        \n 3rd Qu.: 2.00   3rd Qu.: 12.00                        \n Max.   :12.00   Max.   :307.00                        \n\n\nThe print report above reveals that variables ORIGIN_AGE7_12, ORIGIN_AGE13_24, ORIGIN_AGE25_64, DESTIN_AGE7_12, DESTIN_AGE13_24, DESTIN_AGE25_64 consist of 0 values.\nIn view of this, code chunk below will be used to replace zero values to 0.99.\n\nflow_data$SCHOOL_COUNT.y &lt;- ifelse(\n  flow_data$SCHOOL_COUNT.y == 0,\n  0.99, flow_data$SCHOOL_COUNT.y)\nflow_data$BUSINESS_COUNT &lt;- ifelse(\n  flow_data$BUSINESS_COUNT == 0,\n  0.99, flow_data$BUSINESS_COUNT)\n\n\nsummary(flow_data)\n\n  ORIGIN_SZ          DESTIN_SZ             TRIPS             DIST      \n Length:14734       Length:14734       Min.   :     1   Min.   :   50  \n Class :character   Class :character   1st Qu.:    14   1st Qu.: 3346  \n Mode  :character   Mode  :character   Median :    76   Median : 6067  \n                                       Mean   :  1021   Mean   : 6880  \n                                       3rd Qu.:   426   3rd Qu.: 9729  \n                                       Max.   :232187   Max.   :26136  \n ORIGIN_AGE7_12    ORIGIN_AGE13_24    ORIGIN_AGE25_64    DESTIN_AGE7_12   \n Min.   :   0.99   Min.   :    0.99   Min.   :    0.99   Min.   :   0.99  \n 1st Qu.: 240.00   1st Qu.:  440.00   1st Qu.: 2200.00   1st Qu.: 240.00  \n Median : 700.00   Median : 1350.00   Median : 6810.00   Median : 720.00  \n Mean   :1031.86   Mean   : 2268.84   Mean   :10487.62   Mean   :1033.40  \n 3rd Qu.:1480.00   3rd Qu.: 3260.00   3rd Qu.:15770.00   3rd Qu.:1500.00  \n Max.   :6340.00   Max.   :16380.00   Max.   :74610.00   Max.   :6340.00  \n DESTIN_AGE13_24    DESTIN_AGE25_64    SCHOOL_COUNT.x    RETAIL_COUNT   \n Min.   :    0.99   Min.   :    0.99   Min.   : 0.990   Min.   :  0.99  \n 1st Qu.:  460.00   1st Qu.: 2200.00   1st Qu.: 0.990   1st Qu.:  0.99  \n Median : 1420.00   Median : 7030.00   Median : 1.000   Median :  3.00  \n Mean   : 2290.35   Mean   :10574.46   Mean   : 1.987   Mean   : 16.47  \n 3rd Qu.: 3260.00   3rd Qu.:15830.00   3rd Qu.: 2.000   3rd Qu.: 12.00  \n Max.   :16380.00   Max.   :74610.00   Max.   :12.000   Max.   :307.00  \n SCHOOL_COUNT.y   BUSINESS_COUNT            geometry    \n Min.   : 0.990   Min.   :  0.99   LINESTRING   :14734  \n 1st Qu.: 0.990   1st Qu.:  0.99   epsg:3414    :    0  \n Median : 1.000   Median :  3.00   +proj=tmer...:    0  \n Mean   : 1.984   Mean   : 16.47                        \n 3rd Qu.: 2.000   3rd Qu.: 12.00                        \n Max.   :12.000   Max.   :307.00"
  },
  {
    "objectID": "in_class_ex5/data/geospatial/Business.html",
    "href": "in_class_ex5/data/geospatial/Business.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "in_class_ex5/data/geospatial/entertn.html",
    "href": "in_class_ex5/data/geospatial/entertn.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "in_class_ex5/data/geospatial/F&B.html",
    "href": "in_class_ex5/data/geospatial/F&B.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "in_class_ex5/data/geospatial/FinServ.html",
    "href": "in_class_ex5/data/geospatial/FinServ.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "in_class_ex5/data/geospatial/Liesure&Recreation.html",
    "href": "in_class_ex5/data/geospatial/Liesure&Recreation.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "in_class_ex5/data/geospatial/MPSZ-2019.html",
    "href": "in_class_ex5/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "in_class_ex5/data/geospatial/Retails.html",
    "href": "in_class_ex5/data/geospatial/Retails.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "in_class_ex5/in_class_ex5.html",
    "href": "in_class_ex5/in_class_ex5.html",
    "title": "In-class Exercise 5: Spatial Econometrics Interaction Modelling",
    "section": "",
    "text": "devtools::install_github(\"LukeCe/spflow\")\n\nSkipping install of 'spflow' from a github remote, the SHA1 (df913677) has not changed since last install.\n  Use `force = TRUE` to force installation\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe development version (0.1.0.9010) of spflow will be used instead of the released version (0.1.0). From github: https://cran.r-project.org/web/packages/spflow/index.html\n\n\n\npacman::p_load(tmap, sf, spdep, sp, knitr,\n               tidyverse, spflow, reshape2, Matrix)\n\n\n\n\nPlease refer to the in depth of in class exercise 5 here.\nThree spflow objects are required, they are:\n\nspflow_network-class, an S4 class that contains all information on a spatial network which is composed by a set of nodes that are linked by some neighborhood relation.\nspflow_network_pair-class, an S4 class which holds information on origin-destination (OD) pairs. Each OD pair is composed of two nodes, each belonging to one network. All origin nodes must belong to the same origin network should be contained in one spflow_network-class, and likewise for the destinations.\nspflow_network_multi-class, an S4 class that gathers information on multiple objects of types spflow_network-class and spflow_network_pair-class. Its purpose is to ensure that the identification between the nodes that serve as origins or destinations, and the OD-pairs is consistent (similar to relational data bases).\n\n\nmpsz_nb &lt;- read_rds(\"data/rds/mpsz_nb.rds\")\nmpsz_flow &lt;- read_rds(\"data/rds/mpsz_flow.rds\")\nmpsz_var &lt;- read_rds(\"data/rds/mpsz_var.rds\")\n\n\n\n\nmpsz_net &lt;- spflow_network(\n  id_net = \"sg\",\n  node_neighborhood = nb2mat(mpsz_nb$by_contiguity),\n  node_data = mpsz_var,\n  node_key_column = \"SZ_CODE\")\n\nmpsz_net\n\nSpatial network nodes with id: sg\n--------------------------------------------------\nNumber of nodes: 313\nAverage number of links per node: 6.077\nDensity of the neighborhood matrix: 1.94% (non-zero connections)\n\nData on nodes:\n                SZ_NAME SZ_CODE BUSSTOP_COUNT AGE7_12 AGE13_24 AGE25_64\n1      INSTITUTION HILL  RVSZ05             2     330      360     2260\n2        ROBERTSON QUAY  SRSZ01            10     320      350     2200\n3          FORT CANNING  MUSZ02             6       0       10       30\n4      MARINA EAST (MP)  MPSZ05             2       0        0        0\n5               SENTOSA  SISZ01             1     200      260     1440\n6        CITY TERMINALS  BMSZ17            10       0        0        0\n---                 ---     ---           ---     ---      ---      ---\n308            NEE SOON  YSSZ07            12      90      140      590\n309       UPPER THOMSON  BSSZ01            47    1590     3660    15980\n310          SHANGRI-LA  AMSZ05            12     810     1920     9650\n311          TOWNSVILLE  AMSZ04             9     980     2000    11320\n312           MARYMOUNT  BSSZ02            25    1610     4060    16860\n313 TUAS VIEW EXTENSION  TSSZ06            11       0        0        0\n    SCHOOL_COUNT BUSINESS_COUNT RETAILS_COUNT FINSERV_COUNT ENTERTN_COUNT\n1              1              6            26             3             0\n2              0              4           207            18             6\n3              0              7            17             0             3\n4              0              0             0             0             0\n5              0              1            84            29             2\n6              0             11            14             4             0\n---          ---            ---           ---           ---           ---\n308            0              0             7             0             0\n309            3             21           305            30             0\n310            3              0            53             9             0\n311            1              0            83            11             0\n312            3             19           135             8             0\n313            0             53             3             1             0\n    FB_COUNT LR_COUNT COORD_X COORD_Y\n1          4        3  103.84    1.29\n2         38       11  103.84    1.29\n3          4        7  103.85    1.29\n4          0        0  103.88    1.29\n5         38       20  103.83    1.25\n6         15        0  103.85    1.26\n---      ---      ---     ---     ---\n308        0        0  103.81     1.4\n309        5       11  103.83    1.36\n310        0        0  103.84    1.37\n311        1        1  103.85    1.36\n312        3       11  103.84    1.35\n313        0        0  103.61    1.26\n\n\n\n\n\n\nmpsz_net_pairs &lt;- spflow_network_pair(\n  id_orig_net = \"sg\",\n  id_dest_net = \"sg\",\n  pair_data = mpsz_flow,\n  orig_key_column = \"ORIGIN_SZ\",\n  dest_key_column = \"DESTIN_SZ\")\n\nmpsz_net_pairs\n\nSpatial network pair with id: sg_sg\n--------------------------------------------------\nOrigin network id: sg (with 313 nodes)\nDestination network id: sg (with 313 nodes)\nNumber of pairs: 97969\nCompleteness of pairs: 100.00% (97969/97969)\n\nData on node-pairs:\n      DESTIN_SZ ORIGIN_SZ DISTANCE TRIPS\n1        RVSZ05    RVSZ05        0    67\n314      SRSZ01    RVSZ05   305.74   251\n627      MUSZ02    RVSZ05   951.83     0\n940      MPSZ05    RVSZ05  5254.07     0\n1253     SISZ01    RVSZ05     4975     0\n1566     BMSZ17    RVSZ05  3176.16     0\n---         ---       ---      ---   ---\n96404    YSSZ07    TSSZ06 26972.97     0\n96717    BSSZ01    TSSZ06 25582.48     0\n97030    AMSZ05    TSSZ06 26714.79     0\n97343    AMSZ04    TSSZ06 27572.74     0\n97656    BSSZ02    TSSZ06  26681.7     0\n97969    TSSZ06    TSSZ06        0   270\n\n\n\n\n\n\nmpsz_multi_net &lt;- spflow_network_multi(mpsz_net, mpsz_net_pairs)\n\nmpsz_multi_net\n\nCollection of spatial network nodes and pairs\n--------------------------------------------------\nContains 1 spatial network nodes  \n    With id :  sg\nContains 1 spatial network pairs  \n    With id :  sg_sg\n\nAvailability of origin-destination pair information:\n\n ID_ORIG_NET ID_DEST_NET ID_NET_PAIR COMPLETENESS     C_PAIRS  C_ORIG  C_DEST\n          sg          sg       sg_sg      100.00% 97969/97969 313/313 313/313\n\n\n\n\n\n\n\ncor_formula &lt;- log(1+ TRIPS) ~\n  BUSSTOP_COUNT +\n  AGE7_12 +\n  AGE13_24 +\n  AGE25_64 +\n  SCHOOL_COUNT +\n  BUSINESS_COUNT +\n  RETAILS_COUNT +\n  FINSERV_COUNT +\n  P_(log(DISTANCE + 1))\n\n\ncor_mat &lt;- pair_cor(\n  mpsz_multi_net,\n  spflow_formula = cor_formula,\n  add_lags_x = FALSE\n)\n\ncolnames(cor_mat) &lt;- paste0(\n  substr(\n    colnames(cor_mat),1,3),\"...\")\n\ncor_image(cor_mat)\n\n\n\n\n\n\n\nThe three different estimators currently supported by spflow are:\n\nMaximum Likelihood Estimation (MLE) which is the default estimation procedure. The matrix form estimation in the framework of this model was first developed by LeSage and Pace (2008) and then improved by Dargel (2021) . Spatial two-stage least squares (S2SLS)\nSpatial Two-stage Least Squares (S2SLS) estimator is an adaptation of the one proposed by Kelejian and Prucha (1998), to the case of origin-destination flows, with up to three neighborhood matrices Dargel (2021). A similar estimation is done by Tamesue and Tsutsumi (2016). The user can activate the S2SLS estimation via the estimation_control argument using the input spflow_control(estimation_method = \"s2sls\").\nBayesian Markov Chain Monte Carlo (MCMC) estimator is based on the ideas of LeSage and Pace (2009) and incorporates the improvements proposed in Dargel (2021) . The estimation is based on a tuned Metropolis-Hastings sampler for the auto-regressive parameters, and for the remaining parameters it uses Gibbs sampling. The routine uses 5500 iterations of the sampling procedure and considers the first 2500 as burn-in period. The user can activate the S2SLS estimation via the estimation_control argument using the input spflow_control(estimation_method = \"mcmc\").\n\n\n\n\nbase_model &lt;- spflow(\n  spflow_formula = log(1 + TRIPS) ~\n  O_(BUSSTOP_COUNT + AGE25_64) +\n  D_(SCHOOL_COUNT +\n  BUSINESS_COUNT +\n  RETAILS_COUNT +\n  FINSERV_COUNT) +\n  P_(log(DISTANCE + 1)),\n  spflow_networks = mpsz_multi_net)\n     \n     \n     \nbase_model\n\n--------------------------------------------------\nSpatial interaction model estimated by: MLE  \nSpatial correlation structure: SDM (model_9)\nDependent variable: log(1 + TRIPS)\n\n--------------------------------------------------\nCoefficients:\n                          est     sd   t.stat  p.val\nrho_d                   0.680  0.004  192.553  0.000\nrho_o                   0.678  0.004  187.732  0.000\nrho_w                  -0.396  0.006  -65.590  0.000\n(Intercept)             0.410  0.065    6.266  0.000\n(Intra)                 1.313  0.081   16.263  0.000\nD_SCHOOL_COUNT          0.017  0.002    7.885  0.000\nD_SCHOOL_COUNT.lag1     0.002  0.004    0.551  0.582\nD_BUSINESS_COUNT        0.000  0.000    3.015  0.003\nD_BUSINESS_COUNT.lag1   0.000  0.000   -0.249  0.804\nD_RETAILS_COUNT         0.000  0.000   -0.306  0.759\nD_RETAILS_COUNT.lag1    0.000  0.000    0.152  0.880\nD_FINSERV_COUNT         0.002  0.000    6.787  0.000\nD_FINSERV_COUNT.lag1   -0.002  0.001   -3.767  0.000\nO_BUSSTOP_COUNT         0.002  0.000    6.806  0.000\nO_BUSSTOP_COUNT.lag1   -0.001  0.000   -2.364  0.018\nO_AGE25_64              0.000  0.000    7.336  0.000\nO_AGE25_64.lag1         0.000  0.000   -2.797  0.005\nP_log(DISTANCE + 1)    -0.050  0.007   -6.793  0.000\n\n--------------------------------------------------\nR2_corr: 0.6942942  \nObservations: 97969  \nModel coherence: Validated\n\n\n\n\n\n\n\n\nNote\n\n\n\nunderstand the main variable and the lags\n\n\n\n\n\n\nold_par &lt;- par(nfrow = c(1,3),\n               nar = c(2,2,2,2))\n\nWarning in par(nfrow = c(1, 3), nar = c(2, 2, 2, 2)): \"nfrow\" is not a\ngraphical parameter\n\n\nWarning in par(nfrow = c(1, 3), nar = c(2, 2, 2, 2)): \"nar\" is not a graphical\nparameter\n\nspflow_moran_plots(base_model)\n\n\n\n\n\n\n\n\n\n\n\npar(old_par)\n\nWarning in par(old_par): \"nfrow\" is not a graphical parameter\n\n\nWarning in par(old_par): \"nar\" is not a graphical parameter\n\ncorr_residual &lt;- pair_cor(base_model)\ncolnames(corr_residual) &lt;- substr(colnames(corr_residual),1,3)\n\ncor_image(corr_residual)\n\n\n\n\n\n\n\n\nspflow_formula &lt;- log(1 + TRIPS) ~\n  O_(BUSSTOP_COUNT + AGE25_64) +\n  D_(SCHOOL_COUNT +\n  BUSINESS_COUNT +\n  RETAILS_COUNT +\n  FINSERV_COUNT) +\n  P_(log(DISTANCE + 1))\n  \nmodel_control &lt;- spflow_control(\n  estimation_method = \"mle\",\n  model = \"model_8\"\n)\n\nmle_model8 &lt;- spflow(\n  spflow_formula,\n  spflow_networks = mpsz_multi_net,\n  estimation_control = model_control)\n\nmle_model8\n\n--------------------------------------------------\nSpatial interaction model estimated by: MLE  \nSpatial correlation structure: SDM (model_8)\nDependent variable: log(1 + TRIPS)\n\n--------------------------------------------------\nCoefficients:\n                          est     sd    t.stat  p.val\nrho_d                   0.689  0.003   196.832  0.000\nrho_o                   0.687  0.004   192.214  0.000\nrho_w                  -0.473  0.003  -142.469  0.000\n(Intercept)             1.086  0.049    22.275  0.000\n(Intra)                 0.840  0.075    11.255  0.000\nD_SCHOOL_COUNT          0.019  0.002     8.896  0.000\nD_SCHOOL_COUNT.lag1     0.019  0.004     5.130  0.000\nD_BUSINESS_COUNT        0.000  0.000     3.328  0.001\nD_BUSINESS_COUNT.lag1   0.000  0.000     1.664  0.096\nD_RETAILS_COUNT         0.000  0.000    -0.414  0.679\nD_RETAILS_COUNT.lag1    0.000  0.000    -0.171  0.864\nD_FINSERV_COUNT         0.002  0.000     6.150  0.000\nD_FINSERV_COUNT.lag1   -0.003  0.001    -4.601  0.000\nO_BUSSTOP_COUNT         0.003  0.000     7.676  0.000\nO_BUSSTOP_COUNT.lag1    0.000  0.000     0.552  0.581\nO_AGE25_64              0.000  0.000     6.870  0.000\nO_AGE25_64.lag1         0.000  0.000    -0.462  0.644\nP_log(DISTANCE + 1)    -0.125  0.005   -22.865  0.000\n\n--------------------------------------------------\nR2_corr: 0.6965974  \nObservations: 97969  \nModel coherence: Validated\n\n\n\nold_par &lt;- par(mfrow = c(1, 3), \n               mar = c(2,2,2,2))\nspflow_moran_plots(mle_model8)"
  },
  {
    "objectID": "in_class_ex5/in_class_ex5.html#getting-started",
    "href": "in_class_ex5/in_class_ex5.html#getting-started",
    "title": "In-class Exercise 5: Spatial Econometrics Interaction Modelling",
    "section": "",
    "text": "devtools::install_github(\"LukeCe/spflow\")\n\nSkipping install of 'spflow' from a github remote, the SHA1 (df913677) has not changed since last install.\n  Use `force = TRUE` to force installation\n\n\n\n\n\n\n\n\nNote\n\n\n\nThe development version (0.1.0.9010) of spflow will be used instead of the released version (0.1.0). From github: https://cran.r-project.org/web/packages/spflow/index.html\n\n\n\npacman::p_load(tmap, sf, spdep, sp, knitr,\n               tidyverse, spflow, reshape2, Matrix)"
  },
  {
    "objectID": "in_class_ex5/in_class_ex5.html#preparing-spflow-objects",
    "href": "in_class_ex5/in_class_ex5.html#preparing-spflow-objects",
    "title": "In-class Exercise 5: Spatial Econometrics Interaction Modelling",
    "section": "",
    "text": "Please refer to the in depth of in class exercise 5 here.\nThree spflow objects are required, they are:\n\nspflow_network-class, an S4 class that contains all information on a spatial network which is composed by a set of nodes that are linked by some neighborhood relation.\nspflow_network_pair-class, an S4 class which holds information on origin-destination (OD) pairs. Each OD pair is composed of two nodes, each belonging to one network. All origin nodes must belong to the same origin network should be contained in one spflow_network-class, and likewise for the destinations.\nspflow_network_multi-class, an S4 class that gathers information on multiple objects of types spflow_network-class and spflow_network_pair-class. Its purpose is to ensure that the identification between the nodes that serve as origins or destinations, and the OD-pairs is consistent (similar to relational data bases).\n\n\nmpsz_nb &lt;- read_rds(\"data/rds/mpsz_nb.rds\")\nmpsz_flow &lt;- read_rds(\"data/rds/mpsz_flow.rds\")\nmpsz_var &lt;- read_rds(\"data/rds/mpsz_var.rds\")\n\n\n\n\nmpsz_net &lt;- spflow_network(\n  id_net = \"sg\",\n  node_neighborhood = nb2mat(mpsz_nb$by_contiguity),\n  node_data = mpsz_var,\n  node_key_column = \"SZ_CODE\")\n\nmpsz_net\n\nSpatial network nodes with id: sg\n--------------------------------------------------\nNumber of nodes: 313\nAverage number of links per node: 6.077\nDensity of the neighborhood matrix: 1.94% (non-zero connections)\n\nData on nodes:\n                SZ_NAME SZ_CODE BUSSTOP_COUNT AGE7_12 AGE13_24 AGE25_64\n1      INSTITUTION HILL  RVSZ05             2     330      360     2260\n2        ROBERTSON QUAY  SRSZ01            10     320      350     2200\n3          FORT CANNING  MUSZ02             6       0       10       30\n4      MARINA EAST (MP)  MPSZ05             2       0        0        0\n5               SENTOSA  SISZ01             1     200      260     1440\n6        CITY TERMINALS  BMSZ17            10       0        0        0\n---                 ---     ---           ---     ---      ---      ---\n308            NEE SOON  YSSZ07            12      90      140      590\n309       UPPER THOMSON  BSSZ01            47    1590     3660    15980\n310          SHANGRI-LA  AMSZ05            12     810     1920     9650\n311          TOWNSVILLE  AMSZ04             9     980     2000    11320\n312           MARYMOUNT  BSSZ02            25    1610     4060    16860\n313 TUAS VIEW EXTENSION  TSSZ06            11       0        0        0\n    SCHOOL_COUNT BUSINESS_COUNT RETAILS_COUNT FINSERV_COUNT ENTERTN_COUNT\n1              1              6            26             3             0\n2              0              4           207            18             6\n3              0              7            17             0             3\n4              0              0             0             0             0\n5              0              1            84            29             2\n6              0             11            14             4             0\n---          ---            ---           ---           ---           ---\n308            0              0             7             0             0\n309            3             21           305            30             0\n310            3              0            53             9             0\n311            1              0            83            11             0\n312            3             19           135             8             0\n313            0             53             3             1             0\n    FB_COUNT LR_COUNT COORD_X COORD_Y\n1          4        3  103.84    1.29\n2         38       11  103.84    1.29\n3          4        7  103.85    1.29\n4          0        0  103.88    1.29\n5         38       20  103.83    1.25\n6         15        0  103.85    1.26\n---      ---      ---     ---     ---\n308        0        0  103.81     1.4\n309        5       11  103.83    1.36\n310        0        0  103.84    1.37\n311        1        1  103.85    1.36\n312        3       11  103.84    1.35\n313        0        0  103.61    1.26\n\n\n\n\n\n\nmpsz_net_pairs &lt;- spflow_network_pair(\n  id_orig_net = \"sg\",\n  id_dest_net = \"sg\",\n  pair_data = mpsz_flow,\n  orig_key_column = \"ORIGIN_SZ\",\n  dest_key_column = \"DESTIN_SZ\")\n\nmpsz_net_pairs\n\nSpatial network pair with id: sg_sg\n--------------------------------------------------\nOrigin network id: sg (with 313 nodes)\nDestination network id: sg (with 313 nodes)\nNumber of pairs: 97969\nCompleteness of pairs: 100.00% (97969/97969)\n\nData on node-pairs:\n      DESTIN_SZ ORIGIN_SZ DISTANCE TRIPS\n1        RVSZ05    RVSZ05        0    67\n314      SRSZ01    RVSZ05   305.74   251\n627      MUSZ02    RVSZ05   951.83     0\n940      MPSZ05    RVSZ05  5254.07     0\n1253     SISZ01    RVSZ05     4975     0\n1566     BMSZ17    RVSZ05  3176.16     0\n---         ---       ---      ---   ---\n96404    YSSZ07    TSSZ06 26972.97     0\n96717    BSSZ01    TSSZ06 25582.48     0\n97030    AMSZ05    TSSZ06 26714.79     0\n97343    AMSZ04    TSSZ06 27572.74     0\n97656    BSSZ02    TSSZ06  26681.7     0\n97969    TSSZ06    TSSZ06        0   270\n\n\n\n\n\n\nmpsz_multi_net &lt;- spflow_network_multi(mpsz_net, mpsz_net_pairs)\n\nmpsz_multi_net\n\nCollection of spatial network nodes and pairs\n--------------------------------------------------\nContains 1 spatial network nodes  \n    With id :  sg\nContains 1 spatial network pairs  \n    With id :  sg_sg\n\nAvailability of origin-destination pair information:\n\n ID_ORIG_NET ID_DEST_NET ID_NET_PAIR COMPLETENESS     C_PAIRS  C_ORIG  C_DEST\n          sg          sg       sg_sg      100.00% 97969/97969 313/313 313/313"
  },
  {
    "objectID": "in_class_ex5/in_class_ex5.html#correlation-analysis",
    "href": "in_class_ex5/in_class_ex5.html#correlation-analysis",
    "title": "In-class Exercise 5: Spatial Econometrics Interaction Modelling",
    "section": "",
    "text": "cor_formula &lt;- log(1+ TRIPS) ~\n  BUSSTOP_COUNT +\n  AGE7_12 +\n  AGE13_24 +\n  AGE25_64 +\n  SCHOOL_COUNT +\n  BUSINESS_COUNT +\n  RETAILS_COUNT +\n  FINSERV_COUNT +\n  P_(log(DISTANCE + 1))\n\n\ncor_mat &lt;- pair_cor(\n  mpsz_multi_net,\n  spflow_formula = cor_formula,\n  add_lags_x = FALSE\n)\n\ncolnames(cor_mat) &lt;- paste0(\n  substr(\n    colnames(cor_mat),1,3),\"...\")\n\ncor_image(cor_mat)"
  },
  {
    "objectID": "in_class_ex5/in_class_ex5.html#model-calibration",
    "href": "in_class_ex5/in_class_ex5.html#model-calibration",
    "title": "In-class Exercise 5: Spatial Econometrics Interaction Modelling",
    "section": "",
    "text": "The three different estimators currently supported by spflow are:\n\nMaximum Likelihood Estimation (MLE) which is the default estimation procedure. The matrix form estimation in the framework of this model was first developed by LeSage and Pace (2008) and then improved by Dargel (2021) . Spatial two-stage least squares (S2SLS)\nSpatial Two-stage Least Squares (S2SLS) estimator is an adaptation of the one proposed by Kelejian and Prucha (1998), to the case of origin-destination flows, with up to three neighborhood matrices Dargel (2021). A similar estimation is done by Tamesue and Tsutsumi (2016). The user can activate the S2SLS estimation via the estimation_control argument using the input spflow_control(estimation_method = \"s2sls\").\nBayesian Markov Chain Monte Carlo (MCMC) estimator is based on the ideas of LeSage and Pace (2009) and incorporates the improvements proposed in Dargel (2021) . The estimation is based on a tuned Metropolis-Hastings sampler for the auto-regressive parameters, and for the remaining parameters it uses Gibbs sampling. The routine uses 5500 iterations of the sampling procedure and considers the first 2500 as burn-in period. The user can activate the S2SLS estimation via the estimation_control argument using the input spflow_control(estimation_method = \"mcmc\").\n\n\n\n\nbase_model &lt;- spflow(\n  spflow_formula = log(1 + TRIPS) ~\n  O_(BUSSTOP_COUNT + AGE25_64) +\n  D_(SCHOOL_COUNT +\n  BUSINESS_COUNT +\n  RETAILS_COUNT +\n  FINSERV_COUNT) +\n  P_(log(DISTANCE + 1)),\n  spflow_networks = mpsz_multi_net)\n     \n     \n     \nbase_model\n\n--------------------------------------------------\nSpatial interaction model estimated by: MLE  \nSpatial correlation structure: SDM (model_9)\nDependent variable: log(1 + TRIPS)\n\n--------------------------------------------------\nCoefficients:\n                          est     sd   t.stat  p.val\nrho_d                   0.680  0.004  192.553  0.000\nrho_o                   0.678  0.004  187.732  0.000\nrho_w                  -0.396  0.006  -65.590  0.000\n(Intercept)             0.410  0.065    6.266  0.000\n(Intra)                 1.313  0.081   16.263  0.000\nD_SCHOOL_COUNT          0.017  0.002    7.885  0.000\nD_SCHOOL_COUNT.lag1     0.002  0.004    0.551  0.582\nD_BUSINESS_COUNT        0.000  0.000    3.015  0.003\nD_BUSINESS_COUNT.lag1   0.000  0.000   -0.249  0.804\nD_RETAILS_COUNT         0.000  0.000   -0.306  0.759\nD_RETAILS_COUNT.lag1    0.000  0.000    0.152  0.880\nD_FINSERV_COUNT         0.002  0.000    6.787  0.000\nD_FINSERV_COUNT.lag1   -0.002  0.001   -3.767  0.000\nO_BUSSTOP_COUNT         0.002  0.000    6.806  0.000\nO_BUSSTOP_COUNT.lag1   -0.001  0.000   -2.364  0.018\nO_AGE25_64              0.000  0.000    7.336  0.000\nO_AGE25_64.lag1         0.000  0.000   -2.797  0.005\nP_log(DISTANCE + 1)    -0.050  0.007   -6.793  0.000\n\n--------------------------------------------------\nR2_corr: 0.6942942  \nObservations: 97969  \nModel coherence: Validated\n\n\n\n\n\n\n\n\nNote\n\n\n\nunderstand the main variable and the lags\n\n\n\n\n\n\nold_par &lt;- par(nfrow = c(1,3),\n               nar = c(2,2,2,2))\n\nWarning in par(nfrow = c(1, 3), nar = c(2, 2, 2, 2)): \"nfrow\" is not a\ngraphical parameter\n\n\nWarning in par(nfrow = c(1, 3), nar = c(2, 2, 2, 2)): \"nar\" is not a graphical\nparameter\n\nspflow_moran_plots(base_model)\n\n\n\n\n\n\n\n\n\n\n\npar(old_par)\n\nWarning in par(old_par): \"nfrow\" is not a graphical parameter\n\n\nWarning in par(old_par): \"nar\" is not a graphical parameter\n\ncorr_residual &lt;- pair_cor(base_model)\ncolnames(corr_residual) &lt;- substr(colnames(corr_residual),1,3)\n\ncor_image(corr_residual)\n\n\n\n\n\n\n\n\nspflow_formula &lt;- log(1 + TRIPS) ~\n  O_(BUSSTOP_COUNT + AGE25_64) +\n  D_(SCHOOL_COUNT +\n  BUSINESS_COUNT +\n  RETAILS_COUNT +\n  FINSERV_COUNT) +\n  P_(log(DISTANCE + 1))\n  \nmodel_control &lt;- spflow_control(\n  estimation_method = \"mle\",\n  model = \"model_8\"\n)\n\nmle_model8 &lt;- spflow(\n  spflow_formula,\n  spflow_networks = mpsz_multi_net,\n  estimation_control = model_control)\n\nmle_model8\n\n--------------------------------------------------\nSpatial interaction model estimated by: MLE  \nSpatial correlation structure: SDM (model_8)\nDependent variable: log(1 + TRIPS)\n\n--------------------------------------------------\nCoefficients:\n                          est     sd    t.stat  p.val\nrho_d                   0.689  0.003   196.832  0.000\nrho_o                   0.687  0.004   192.214  0.000\nrho_w                  -0.473  0.003  -142.469  0.000\n(Intercept)             1.086  0.049    22.275  0.000\n(Intra)                 0.840  0.075    11.255  0.000\nD_SCHOOL_COUNT          0.019  0.002     8.896  0.000\nD_SCHOOL_COUNT.lag1     0.019  0.004     5.130  0.000\nD_BUSINESS_COUNT        0.000  0.000     3.328  0.001\nD_BUSINESS_COUNT.lag1   0.000  0.000     1.664  0.096\nD_RETAILS_COUNT         0.000  0.000    -0.414  0.679\nD_RETAILS_COUNT.lag1    0.000  0.000    -0.171  0.864\nD_FINSERV_COUNT         0.002  0.000     6.150  0.000\nD_FINSERV_COUNT.lag1   -0.003  0.001    -4.601  0.000\nO_BUSSTOP_COUNT         0.003  0.000     7.676  0.000\nO_BUSSTOP_COUNT.lag1    0.000  0.000     0.552  0.581\nO_AGE25_64              0.000  0.000     6.870  0.000\nO_AGE25_64.lag1         0.000  0.000    -0.462  0.644\nP_log(DISTANCE + 1)    -0.125  0.005   -22.865  0.000\n\n--------------------------------------------------\nR2_corr: 0.6965974  \nObservations: 97969  \nModel coherence: Validated\n\n\n\nold_par &lt;- par(mfrow = c(1, 3), \n               mar = c(2,2,2,2))\nspflow_moran_plots(mle_model8)"
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html",
    "href": "take_home_ex1/take_home_ex1.html",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "",
    "text": "Transportation is a pivotal aspect of daily life for Singaporean residents. In 2022, an average of around 3.4 million passengers utilized public buses each day in Singapore, marking a steady rebound from the significant decline during the COVID-19 pandemic1. Noteworthy advancements have been made in the enhancement of bus stops and interchanges, exemplified by projects like the Jurong Town Bus Interchange in November 20232. Additionally, there have been alterations in bus services, including the cancellation of service 167, reflecting ongoing developments in Singapore’s transportation infrastructure 3."
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#objectives",
    "href": "take_home_ex1/take_home_ex1.html#objectives",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "2.1 Objectives",
    "text": "2.1 Objectives\nExploratory Spatial Data Analysis (ESDA) hold tremendous potential to address complex problems facing society, such as transportation issue and development. In this study, I will demonstrate how to apply geospatial visualisation and appropriate Local Indicators of Spatial Association (LISA) to undercover the spatial and spatio-temporal mobility patterns of public bus passengers in Singapore. I will also propose some recommendations in this study."
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#the-study-area",
    "href": "take_home_ex1/take_home_ex1.html#the-study-area",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "2.2 The Study Area",
    "text": "2.2 The Study Area\nThe focus of this study would in Singapore, mainly the public bus passengers in Singapore"
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#setting-the-analytical-tools",
    "href": "take_home_ex1/take_home_ex1.html#setting-the-analytical-tools",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "2.3 Setting the Analytical Tools",
    "text": "2.3 Setting the Analytical Tools\nThe code chunk below installs and loads tmap, sf, tidyverse, knitr, sfdep and plotly\n\npacman::p_load(tmap, sf, tidyverse, knitr, sfdep, plotly)"
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#data",
    "href": "take_home_ex1/take_home_ex1.html#data",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "3.1 Data",
    "text": "3.1 Data\n\n3.1.1 Aspatial data\nPassenger Volume by Origin Destination Bus Stops will be downloaded from LTA DataMall. Aug 2023 dataset is dowloaded. This study will use only Aug 2023 data.\nBelow are the detailed steps to obtain the dataset:\n\nGo to LTA DataMall -&gt; Head to Dynamic Datasets -&gt; Request for API Access\n\n\n\nYou will receive an email with subject head ” LTA DataMall | Registration Confirmation”. Please take note of the API Account Key\n\n\n\nThe link here explains how to make it API calls. It would be advisable to download Postman. In Postman:\na. Enter the URL: “http://datamall2.mytransport.sg/ltaodataservice/PV/ODBus?”\n\nEnter your AccountKey under “Headers”. Add the date in “Params”\n\n\n\n\nClick on the Send button. Download the CSV files\n\n\n\n\n\n3.1.2 Geospatial data\nTwo geospatial data will be used in this study, they are:\n\nBus Stop Location from LTA DataMall. It provides information about all the bus stops currently being serviced by buses, including the bus stop code (identifier) and location coordinates. This is downloaded from LTA DataMall -&gt; Static Datasets -&gt; Under Search Bar type: “Bus Stop” -&gt; Download the SHP file\n\n\n\nhexagon, a hexagon layer of 250m (this distance is the perpendicular distance between the centre of the hexagon and its edges.). Guidance on how it is created is located here.\n\n\n\n\n\n\n\nNote\n\n\n\nThe steps to create the hexagon layer in this study is located in Section 4.2 Hexagon."
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#importing-the-data-into-r-environment",
    "href": "take_home_ex1/take_home_ex1.html#importing-the-data-into-r-environment",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "3.2 Importing the data into R Environment",
    "text": "3.2 Importing the data into R Environment\n\n3.2.1 Importing Aspatial data into R\nFirstly, we will import the Passenger Volume by Origin Destination Bus Stops data set downloaded from LTA DataMall by using read_csv() of readr package.\n\nodbus &lt;- read_csv(\"data/aspatial/origin_destination_bus_202308.csv\")\n\nRows: 5709512 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): YEAR_MONTH, DAY_TYPE, PT_TYPE, ORIGIN_PT_CODE, DESTINATION_PT_CODE\ndbl (2): TIME_PER_HOUR, TOTAL_TRIPS\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nA quick check of odbus tibble data frame shows that the values in OROGIN_PT_CODE and DESTINATON_PT_CODE are in numeric data type.\n\nglimpse(odbus)\n\nRows: 5,709,512\nColumns: 7\n$ YEAR_MONTH          &lt;chr&gt; \"2023-08\", \"2023-08\", \"2023-08\", \"2023-08\", \"2023-…\n$ DAY_TYPE            &lt;chr&gt; \"WEEKDAY\", \"WEEKENDS/HOLIDAY\", \"WEEKENDS/HOLIDAY\",…\n$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 17, 7, 17, 14, 10, 10,…\n$ PT_TYPE             &lt;chr&gt; \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"…\n$ ORIGIN_PT_CODE      &lt;chr&gt; \"04168\", \"04168\", \"80119\", \"80119\", \"44069\", \"4406…\n$ DESTINATION_PT_CODE &lt;chr&gt; \"10051\", \"10051\", \"90079\", \"90079\", \"17229\", \"1722…\n$ TOTAL_TRIPS         &lt;dbl&gt; 7, 2, 3, 10, 5, 4, 3, 22, 3, 3, 7, 1, 3, 1, 3, 1, …\n\n\n\nodbus$ORIGIN_PT_CODE &lt;- as.factor(odbus$ORIGIN_PT_CODE)\nodbus$DESTINATION_PT_CODE &lt;- as.factor(odbus$DESTINATION_PT_CODE) \n\nNow, ORIGIN_PT_CODE and DESTINATON_PT_CODE are in factor data type now.\n\nglimpse(odbus)\n\nRows: 5,709,512\nColumns: 7\n$ YEAR_MONTH          &lt;chr&gt; \"2023-08\", \"2023-08\", \"2023-08\", \"2023-08\", \"2023-…\n$ DAY_TYPE            &lt;chr&gt; \"WEEKDAY\", \"WEEKENDS/HOLIDAY\", \"WEEKENDS/HOLIDAY\",…\n$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 17, 7, 17, 14, 10, 10,…\n$ PT_TYPE             &lt;chr&gt; \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"…\n$ ORIGIN_PT_CODE      &lt;fct&gt; 04168, 04168, 80119, 80119, 44069, 44069, 20281, 2…\n$ DESTINATION_PT_CODE &lt;fct&gt; 10051, 10051, 90079, 90079, 17229, 17229, 20141, 2…\n$ TOTAL_TRIPS         &lt;dbl&gt; 7, 2, 3, 10, 5, 4, 3, 22, 3, 3, 7, 1, 3, 1, 3, 1, …\n\n\n\n\n3.2.2 Extracting the study data\nData will extracted basing on the following timing:\n\n\n3.2.2.1 For Weekday morning peak (6 to 9)\n\norigin6_9 &lt;- odbus %&gt;%\n  filter(DAY_TYPE == \"WEEKDAY\") %&gt;%\n  filter(TIME_PER_HOUR &gt;= 6 &\n           TIME_PER_HOUR &lt;= 9) %&gt;%\n  group_by(ORIGIN_PT_CODE) %&gt;%\n  summarise(TRIPS = sum(TOTAL_TRIPS))\n\n\nkable(head(origin6_9))\n\n\n\n\nORIGIN_PT_CODE\nTRIPS\n\n\n\n\n01012\n1973\n\n\n01013\n952\n\n\n01019\n1789\n\n\n01029\n2561\n\n\n01039\n2938\n\n\n01059\n1651\n\n\n\n\n\nOutput is saved in rds format for future used.\n\nwrite_rds(origin6_9, \"data/rds/origin6_9.rds\")\n\nThe code chunk below will be used to import the save origin6_9.rds into R environment.\n\norigin6_9 &lt;- read_rds(\"data/rds/origin6_9.rds\")\n\n\n\n3.2.2.2 For Weekday afternoon peak (17 to 20)\n\norigin17_20 &lt;- odbus %&gt;%\n  filter(DAY_TYPE == \"WEEKDAY\") %&gt;%\n  filter(TIME_PER_HOUR &gt;= 17 &\n           TIME_PER_HOUR &lt;= 20) %&gt;%\n  group_by(ORIGIN_PT_CODE) %&gt;%\n  summarise(TRIPS = sum(TOTAL_TRIPS))\n\n\nkable(head(origin17_20))\n\n\n\n\nORIGIN_PT_CODE\nTRIPS\n\n\n\n\n01012\n8448\n\n\n01013\n7328\n\n\n01019\n3608\n\n\n01029\n9317\n\n\n01039\n12937\n\n\n01059\n2133\n\n\n\n\n\n\nwrite_rds(origin17_20, \"data/rds/origin17_20.rds\")\n\n\norigin17_20 &lt;- read_rds(\"data/rds/origin17_20.rds\")\n\n\n\n3.2.2.3 For Weekend/holiday morning peak (11 to 14)\n\norigin11_14 &lt;- odbus %&gt;%\n  filter(DAY_TYPE == \"WEEKENDS/HOLIDAY\") %&gt;%\n  filter(TIME_PER_HOUR &gt;= 11 &\n           TIME_PER_HOUR &lt;= 14) %&gt;%\n  group_by(ORIGIN_PT_CODE) %&gt;%\n  summarise(TRIPS = sum(TOTAL_TRIPS))\n\n\nkable(head(origin11_14))\n\n\n\n\nORIGIN_PT_CODE\nTRIPS\n\n\n\n\n01012\n2273\n\n\n01013\n1697\n\n\n01019\n1511\n\n\n01029\n3272\n\n\n01039\n5424\n\n\n01059\n1062\n\n\n\n\n\n\nwrite_rds(origin11_14, \"data/rds/origin11_14.rds\")\n\n\norigin11_14 &lt;- read_rds(\"data/rds/origin11_14.rds\")\n\n\n\n3.2.2.4 For Weekend/holiday evening peak (16 to 19)\n\norigin16_19 &lt;- odbus %&gt;%\n  filter(DAY_TYPE == \"WEEKENDS/HOLIDAY\") %&gt;%\n  filter(TIME_PER_HOUR &gt;= 16 &\n           TIME_PER_HOUR &lt;= 19) %&gt;%\n  group_by(ORIGIN_PT_CODE) %&gt;%\n  summarise(TRIPS = sum(TOTAL_TRIPS))\n\n\nkable(head(origin16_19))\n\n\n\n\nORIGIN_PT_CODE\nTRIPS\n\n\n\n\n01012\n3208\n\n\n01013\n2796\n\n\n01019\n1623\n\n\n01029\n4244\n\n\n01039\n7403\n\n\n01059\n1190\n\n\n\n\n\n\nwrite_rds(origin16_19, \"data/rds/origin16_19.rds\")\n\n\norigin16_19 &lt;- read_rds(\"data/rds/origin16_19.rds\")\n\n\n\n\n3.2.3 Importing Geospatial data into R\n\n3.2.3.1 BusStop\nIn this section, I will import one shapefile into RStudio, it is:\n\nBusStop: This data provides the location of bus stop as at last quarter of 2023.\n\n\nbusstop &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"BusStop\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `BusStop' from data source \n  `C:\\czx0727\\ISSS624_\\take_home_ex1\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 5161 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82\nProjected CRS: SVY21\n\n\nThe structure of busstop sf tibble data frame should look as below.\n\nglimpse(busstop)\n\nRows: 5,161\nColumns: 4\n$ BUS_STOP_N &lt;chr&gt; \"22069\", \"32071\", \"44331\", \"96081\", \"11561\", \"66191\", \"2338…\n$ BUS_ROOF_N &lt;chr&gt; \"B06\", \"B23\", \"B01\", \"B05\", \"B05\", \"B03\", \"B02A\", \"B02\", \"B…\n$ LOC_DESC   &lt;chr&gt; \"OPP CEVA LOGISTICS\", \"AFT TRACK 13\", \"BLK 239\", \"GRACE IND…\n$ geometry   &lt;POINT [m]&gt; POINT (13576.31 32883.65), POINT (13228.59 44206.38),…"
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#combining-busstop-and-origin6_9",
    "href": "take_home_ex1/take_home_ex1.html#combining-busstop-and-origin6_9",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "4.1 Combining busstop and origin6_9",
    "text": "4.1 Combining busstop and origin6_9\nbusstop and origin6_9 dataset are combined by left join with the unique identifer: “ORIGIN_PT_CODE” in origin6_9 and “BUS_STOP_N” in busstop\n\norigintrip_SZ &lt;- left_join(origin6_9, \n                           busstop,\n                           by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\"))\n\nNext, I will make the combine dataset a shape file\n\ntest_points_1 = origintrip_SZ %&gt;%\n  st_as_sf(crs = 3414)\n\nhead(test_points_1)\n\nSimple feature collection with 6 features and 4 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 30140.8 ymin: 31007.64 xmax: 30570.37 ymax: 31494.55\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 6 × 5\n  ORIGIN_PT_CODE TRIPS BUS_ROOF_N LOC_DESC                       geometry\n  &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;      &lt;chr&gt;                       &lt;POINT [m]&gt;\n1 01012           1973 B03        HOTEL GRAND PACIFIC  (30140.8 31031.95)\n2 01013            952 B05        ST JOSEPH'S CH      (30218.75 31126.49)\n3 01019           1789 B04        BRAS BASAH CPLX     (30187.77 31034.55)\n4 01029           2561 B07        OPP NATL LIB        (30345.83 31007.64)\n5 01039           2938 B09        BUGIS CUBE          (30471.08 31175.63)\n6 01059           1651 B08        BUGIS STN EXIT A    (30570.37 31494.55)"
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#hexagon",
    "href": "take_home_ex1/take_home_ex1.html#hexagon",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "4.2 Hexagon",
    "text": "4.2 Hexagon\nFrom the link located here, a Hexagon grid (honeycomb) is created with the from test_points_1 above:\n\n# cell size of layer of 250m\narea_honeycomb_grid = st_make_grid(test_points_1, c(500, 500), what = \"polygons\", square = FALSE, crs = 3414)\n\n# To sf and add grid ID\nhoneycomb_grid_sf = st_sf(area_honeycomb_grid)\n\nSave the shape file to aspatial folder\n\nst_write(honeycomb_grid_sf, \"data/aspatial/hexagon.shp\",append=TRUE)\n\nUpdating layer `hexagon' to data source `data/aspatial/hexagon.shp' using driver `ESRI Shapefile'\nUpdating existing layer hexagon\nWriting 5580 features with 0 fields and geometry type Polygon."
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#import-back-hexagon-shape-file-and-combine-with-busstop-and-weekday-morning-peak-6am-to-9am",
    "href": "take_home_ex1/take_home_ex1.html#import-back-hexagon-shape-file-and-combine-with-busstop-and-weekday-morning-peak-6am-to-9am",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "4.3 Import back Hexagon Shape File and combine with busstop and Weekday morning peak (6am to 9am)",
    "text": "4.3 Import back Hexagon Shape File and combine with busstop and Weekday morning peak (6am to 9am)\nThe file is saved and imported back:\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"hexagon\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `hexagon' from data source \n  `C:\\czx0727\\ISSS624_\\take_home_ex1\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 22134 features and 1 field\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 3720.122 ymin: 26337.76 xmax: 48470.12 ymax: 53256.72\nProjected CRS: SVY21 / Singapore TM\n\n\n\nglimpse(mpsz)\n\nRows: 22,134\nColumns: 2\n$ FID      &lt;dbl&gt; 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,…\n$ geometry &lt;POLYGON [m]&gt; POLYGON ((3845.122 26554.27..., POLYGON ((3845.122 26…\n\n\n\nbusstop_mpsz &lt;- st_intersection(busstop, mpsz) %&gt;%\n   st_drop_geometry()\n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\n\nBefore moving to the next step, I save the output into rds format.\n\nwrite_rds(busstop_mpsz, \"data/rds/busstop_mpsz.rds\")  \n\nNext, I append the hexagon from busstop_mpsz data frame onto origin6_9 data frame.\n\norigin_SZ &lt;- left_join(origin6_9 , busstop_mpsz,\n            by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\"))\n\nBefore continue, the code chunk below shows how it is done to check for duplicating records.\n\nduplicate &lt;- origin_SZ %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\nThe code chunk below will be used to retain the unique records.\n\norigin_SZ &lt;- unique(origin_SZ)\n\nUpdated records with no duplicate is compbined with mpsz\n\nmpsz_origtrip &lt;- inner_join(mpsz, \n                           origin_SZ,\n                           by = c(\"FID\" = \"FID\"))"
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#weekday-morning-peak---6am-to-9am",
    "href": "take_home_ex1/take_home_ex1.html#weekday-morning-peak---6am-to-9am",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "5.1 Weekday morning peak - 6am to 9am",
    "text": "5.1 Weekday morning peak - 6am to 9am\nA choropleth map is plotted showing the distribution of passenger trips:\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz_origtrip)+\n  tm_fill(\"TRIPS\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Passenger trips\") +\n  tm_layout(main.title = \"Passenger trips generated by origin at the hexagon level (Weekday morning peak - 6am to 9am)\",\n            main.title.position = \"center\",\n            main.title.size = 0.8,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2) +\n  tm_credits(\"Source: Passenger trips data from LTA\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\nThe Choropleth Visualization above indicates a generally high number of passengers, largely attributed to students commuting to school and individuals traveling to work. However, some areas stand out as anomalies, displaying notably high passenger numbers despite surrounding areas experiencing lower passenger traffic. Notably, from the western perspective, Tuas Cres Station Exit A (23,219 passengers) and Joo Koon Station Exit A and Exit B (34,764 passengers) exhibit significant passenger trips. Moving towards the north, Woodlands Checkpoint (105,938 passengers) and Johor Bahru Checkpoint (97,009 passengers) also demonstrate elevated passenger activity. There are also a few estate areas with high passenger activity in a cluster with low passenger activity: Blk 421C (9,406 passengers), After Springleaf road (12,951 passengers).\nDescriptive Statistics is shown below:\n\nsummary(mpsz_origtrip$TRIPS)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      1     471    2204    5266    6314  365871 \n\n\nHistogram plot is shown below. As expected, it is a right skewed histogram:\n\nggplot(data=mpsz_origtrip, \n       aes(x= (TRIPS)))+\n  geom_histogram(bins=100, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  labs(title = \"How are passenger trips distributed in Singapore?\",\n      x = \"Passenger Trips\",\n      y = \"Frequency\")"
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#weekday-afternoon-peak---5pm-to-8pm",
    "href": "take_home_ex1/take_home_ex1.html#weekday-afternoon-peak---5pm-to-8pm",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "5.2 Weekday afternoon peak - 5pm to 8pm",
    "text": "5.2 Weekday afternoon peak - 5pm to 8pm\nAppend the hexagon from busstop_mpsz data frame onto origin17_20 data frame. The steps will be the same as above from Section [5.1 Weekday morning peak - 6am to 9am]\n\norigin_SZ2 &lt;- left_join(origin17_20 , busstop_mpsz,\n            by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\"))\n\n\nduplicate &lt;- origin_SZ2 %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\n\norigin_SZ2 &lt;- unique(origin_SZ2)\n\n\nmpsz_origtrip1 &lt;- inner_join(mpsz, \n                           origin_SZ2,\n                           by = c(\"FID\" = \"FID\"))\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz_origtrip1)+\n  tm_fill(\"TRIPS\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Passenger trips\") +\n  tm_layout(main.title = \"Passenger trips generated by origin at the hexagon level (Weekday afternoon peak - 5pm to 8pm)\",\n            main.title.position = \"center\",\n            main.title.size = 0.8,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2) +\n  tm_credits(\"Source: Passenger trips data from LTA\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\n\nThe Choropleth Visualization depicts heightened passenger volumes, notably concentrated around central zones like Orchard and Somerset stations, as well as the west-central area encompassing the Queenstown region. This surge in numbers may be attributed to post-work commuters frequenting eateries and entertainment hubs within the central precinct.\nNotably, Joo Koon station (6,100 passengers) exhibits a substantial influx of passengers, potentially stemming from the conclusion of work hours and the discharge of full-time national servicemen. This trend is similarly observed in stations proximate to Gedong Camp (3,276 passengers). Furthermore, heightened passenger activity is evident at Woodlands Checkpoint, Johor Bahru Checkpoint, and the Senoko region.\nDescriptive Statistics is shown below:\n\nsummary(mpsz_origtrip1$TRIPS)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      1     722    2058    5068    4771  536630 \n\n\nHistogram plot is shown below. As expected, it is a right skewed histogram:\n\nggplot(data=mpsz_origtrip1, \n       aes(x= (TRIPS)))+\n  geom_histogram(bins=100, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  labs(title = \"How are passenger trips distributed in Singapore?\",\n      x = \"Passenger Trips\",\n      y = \"Frequency\")"
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#weekendholiday-morning-peak---11am-to-2pm",
    "href": "take_home_ex1/take_home_ex1.html#weekendholiday-morning-peak---11am-to-2pm",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "5.3 Weekend/holiday morning peak - 11am to 2pm",
    "text": "5.3 Weekend/holiday morning peak - 11am to 2pm\nAppend the hexagon from busstop_mpsz data frame onto origin11_14 data frame. The steps will be the same as above.\n\norigin_SZ3 &lt;- left_join(origin11_14 , busstop_mpsz,\n            by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\"))\n\n\nduplicate &lt;- origin_SZ3 %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\n\norigin_SZ3 &lt;- unique(origin_SZ3)\n\n\nmpsz_origtrip3 &lt;- inner_join(mpsz, \n                           origin_SZ3,\n                           by = c(\"FID\" = \"FID\"))\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz_origtrip3)+\n  tm_fill(\"TRIPS\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Passenger trips\") +\n  tm_layout(main.title = \"Passenger trips generated by origin at the hexagon level (Weekend/holiday morning peak - 11am to 2pm)\",\n            main.title.position = \"center\",\n            main.title.size = 0.8,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2) +\n  tm_credits(\"Source: Hexagon level\\n and Passenger trips data from LTA\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\nThe Choropleth Visualization shows a decrease in passenger volumes in comparison to the two preceding plots (lesser number of dark hexagons). Likewise, there is a notable concentration of high activity around central zones such as Orchard and Somerset stations. This increase in numbers might be linked to families gathering for brunch or lunch.\nIt’s worth mentioning that Joo Koon station experiences lower passenger volumes on weekends (871 passengers), as fewer individuals are commuting to work in the Tuas area.\nWoodlands and Johor Bahru checkpoints alos exhibits high passengers volumes (43,602 passengers).\nDescriptive Statistics is shown below:\n\nsummary(mpsz_origtrip3$TRIPS)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      1     186     672    1534    1696  102210 \n\n\nHistogram plot is shown below. As expected, it is a right skewed histogram:\n\nggplot(data=mpsz_origtrip3, \n       aes(x= (TRIPS)))+\n  geom_histogram(bins=100, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  labs(title = \"How are passenger trips distributed in Singapore?\",\n      x = \"Passenger Trips\",\n      y = \"Frequency\")"
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#weekendholiday-evening-peak---4pm-to-7pm",
    "href": "take_home_ex1/take_home_ex1.html#weekendholiday-evening-peak---4pm-to-7pm",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "5.4 Weekend/holiday evening peak - 4pm to 7pm",
    "text": "5.4 Weekend/holiday evening peak - 4pm to 7pm\nAppend the hexagon from busstop_mpsz data frame onto origin16_20 data frame. The steps will be the same as above.\n\norigin_SZ4 &lt;- left_join(origin16_19, busstop_mpsz,\n            by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\"))\n\n\nduplicate &lt;- origin_SZ4 %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\n\norigin_SZ4 &lt;- unique(origin_SZ4)\n\n\nmpsz_origtrip4 &lt;- inner_join(mpsz, \n                           origin_SZ4,\n                           by = c(\"FID\" = \"FID\"))\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz_origtrip4)+\n  tm_fill(\"TRIPS\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Passenger trips\") +\n  tm_layout(main.title = \"Passenger trips generated by origin at the hexagon level (Weekend/holiday evening peak - 4pm to 7pm)\",\n            main.title.position = \"center\",\n            main.title.size = 0.8,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2) +\n  tm_credits(\"Source: Hexagon level\\n and Passenger trips data from LTA\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\nThe Choropleth Visualization seems to be similar to the previous plot for Weekend/holiday morning peak - 11am to 2pm. Likewise, there is a notable concentration of high activity around central zones such as Orchard and Somerset stations. This increase in numbers might be linked to families gathering for dinner.\nIt’s worth mentioning that Joo Koon station experiences lower passenger volumes on weekends (2083 passengers), as fewer individuals are commuting to work in the Tuas area.\nWoodlands and Johor Bahru checkpoint still exhibits high passenger volumes (60,597 passengers).\nDescriptive Statistics is shown below:\n\nsummary(mpsz_origtrip4$TRIPS)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n      1     203     631    1534    1480  143443 \n\n\nHistogram plot is shown below. As expected, it is a right skewed histogram:\n\nggplot(data=mpsz_origtrip4, \n       aes(x= (TRIPS)))+\n  geom_histogram(bins=100, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  labs(title = \"How are passenger trips distributed in Singapore?\",\n      x = \"Passenger Trips\",\n      y = \"Frequency\")"
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#comparing-all-peak-hour-period",
    "href": "take_home_ex1/take_home_ex1.html#comparing-all-peak-hour-period",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "5.5 Comparing all peak hour period",
    "text": "5.5 Comparing all peak hour period\nFrom all the Choropleth Visualization above, a few notable observations:\n\nWoodlands Checkpoint and Johor Bahru Checkpoint consistently exhibit high passenger volumes. This might be attributed to daily commuting between Malaysia and Singapore for work. On weekends, there could be Singaporeans traveling to Malaysia for shopping and leisure activities.\nOrchard and Somerset stations consistently record high passenger volumes, except during the weekday morning peak hours (6 am to 9 am). This high passenger volumes might be due to individuals traveling to central locations for their meals. In addition, as it is the central business distinct area, most companies will be in central area. This explains the influx of passenger volumes in these areas4."
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#weekday-morning-peak---6am-to-9am-1",
    "href": "take_home_ex1/take_home_ex1.html#weekday-morning-peak---6am-to-9am-1",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "6.1 Weekday morning peak - 6am to 9am",
    "text": "6.1 Weekday morning peak - 6am to 9am\n\n6.1.1 Deriving contiguity weights: Queen’s method\nIn the code chunk below, queen method is used to derive the contiguity weights.\n\nwm_q &lt;- mpsz_origtrip%&gt;%\n  mutate(nb = st_contiguity(geometry),\n         wt = st_weights(nb,\n                         style = \"W\",\n                         allow_zero = TRUE),\n         .before =1) \n\n\n\n\n\n\n\nNote\n\n\n\nFor st_weights():\n\nallow_zero: It is set to “TRUE”, and assigns zero as lagged value to zone without neighbors. The reason is that there is hexagon layer with no neighour (example: Johor Bahru Station)\nstyle: Default \"W\" for row standardized weights.\n\n\n\n\nwm_q\n\nSimple feature collection with 4980 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 3720.122 ymin: 26337.76 xmax: 48345.12 ymax: 53040.21\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n         nb                              wt FID ORIGIN_PT_CODE TRIPS BUS_ROOF_N\n1         2                               1   3          25059    62        UNK\n2         1                               1 127          25059    62        UNK\n3         5                               1 315          25751    50       B02D\n4         0                            NULL 320          26379    44        NIL\n5         3                               1 439          25761   155        B03\n6      8, 9                        0.5, 0.5 443          26389   308        NIL\n7         0                            NULL 445          26369    73        NIL\n8  6, 9, 14 0.3333333, 0.3333333, 0.3333333 504          25711   123       B02C\n9  6, 8, 14 0.3333333, 0.3333333, 0.3333333 504          25719   893       B01C\n10        0                            NULL 508          26299    82        B13\n              LOC_DESC                       geometry\n1    AFT TUAS STH BLVD POLYGON ((3845.122 27853.31...\n2    AFT TUAS STH BLVD POLYGON ((4095.122 27853.31...\n3  BEF TUAS STH AVE 14 POLYGON ((4470.122 28502.83...\n4             YONG NAM POLYGON ((4470.122 30667.89...\n5       OPP REC S'PORE POLYGON ((4720.122 28502.83...\n6   BEF TUAS STH AVE 5 POLYGON ((4720.122 30234.88...\n7         SEE HUP SENG POLYGON ((4720.122 31100.9,...\n8        OPP THE INDEX POLYGON ((4845.122 30018.37...\n9            THE INDEX POLYGON ((4845.122 30018.37...\n10  BEF TUAS STH AVE 6 POLYGON ((4845.122 31750.42...\n\n\n\n\n6.1.2 Computing local Moran’s I\nI will compute Local Moran’s I of TRIPS at hexagon level by using local_moran() of sfdep package.\n\nlisa &lt;- wm_q %&gt;% \n  mutate(local_moran = local_moran(\n    TRIPS, nb, wt, nsim = 99,zero.policy= TRUE, na.action = na.exclude),\n         .before = 1) %&gt;%\n  unnest(local_moran)\n\n\n\n\n\n\n\nNote\n\n\n\nReference from link:\n\nzero.policy is set to TRUE as it will assign zero to the lagged value of zones without neighbours\nna.action is set to na.exclude - In these cases the weights list will be subsetted to remove NAs in the data. In addition, it will be necessary to set zero.policy to TRUE because this subsetting may create no-neighbour observations (as per above)\n\n\n\n\nlisa\n\nSimple feature collection with 4980 features and 19 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 3720.122 ymin: 26337.76 xmax: 48345.12 ymax: 53040.21\nProjected CRS: SVY21 / Singapore TM\n# A tibble: 4,980 × 20\n      ii       eii  var_ii   z_ii   p_ii p_ii_sim p_folded_sim skewness kurtosis\n   &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;        &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;\n 1 0.205  0.0388    0.0476  0.762  0.446     0.2          0.1     -2.11     5.19\n 2 0.205  0.0270    0.0568  0.747  0.455     0.22         0.11    -2.42     6.92\n 3 0.202 -0.0714    0.404   0.430  0.667     0.28         0.14    -5.41    34.3 \n 4 0     NA        NA      NA     NA        NA           NA       NA       NA   \n 5 0.202  0.0266    0.0888  0.588  0.556     0.26         0.13    -2.92     9.54\n 6 0.179 -0.0737    0.515   0.352  0.725     0.3          0.15    -8.73    80.1 \n 7 0     NA        NA      NA     NA        NA           NA       NA       NA   \n 8 0.187 -0.00999   0.0534  0.854  0.393     0.14         0.07    -3.68    18.7 \n 9 0.168 -0.000440  0.0341  0.911  0.362     0.04         0.02    -3.58    20.0 \n10 0     NA        NA      NA     NA        NA           NA       NA       NA   \n# ℹ 4,970 more rows\n# ℹ 11 more variables: mean &lt;fct&gt;, median &lt;fct&gt;, pysal &lt;fct&gt;, nb &lt;nb&gt;,\n#   wt &lt;list&gt;, FID &lt;dbl&gt;, ORIGIN_PT_CODE &lt;chr&gt;, TRIPS &lt;dbl&gt;, BUS_ROOF_N &lt;chr&gt;,\n#   LOC_DESC &lt;chr&gt;, geometry &lt;POLYGON [m]&gt;\n\n\n\n\n6.1.3 Visualising local Moran’s I\nIn this code chunk below, tmap functions are used prepare a choropleth map by using value in the ii field.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_fill(\"ii\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n  tm_layout(main.title = \"local Moran's I of TRIPS\",\n            main.title.size = 0.8)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\nFrom the plot above, majority of the hexagon layers seem to have values of local Moran’s I of -10 to 10. With an exception of one point of value 40 to 50.\n\n\n6.1.4 Visualising p-value of local Moran’s I\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_fill(\"p_ii_sim\",\n          breaks = c(0, 0.001, 0.01, 0.05, 1),\n              labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) + \n  tm_borders(alpha = 0.5) +\n   tm_layout(main.title = \"p-value of local Moran's I\",\n            main.title.size = 0.8)\n\n\n\n\nMajority of the hexagon layers are not significant. However, there are a few layers of p value that are significant. It is notable in the west region of Singapore.\n\n\n6.1.5 Visualising local Moran’s I and p-value\nBoth maps next to each other as shown below.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nmap1 &lt;- tm_shape(lisa) +\n  tm_fill(\"ii\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n  tm_layout(main.title = \"local Moran's I of TRIPS\",\n            main.title.size = 0.8)\n\nmap2 &lt;- tm_shape(lisa) +\n  tm_fill(\"p_ii_sim\",\n          breaks = c(0, 0.001, 0.01, 0.05, 1),\n              labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) + \n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-value of local Moran's I\",\n            main.title.size = 0.8)\n\ntmap_arrange(map1, map2, ncol = 2)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n6.1.6 Visualising LISA map\n\nlisa_sig &lt;- lisa  %&gt;%\n  filter(p_ii_sim &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(lisa_sig) +\n  tm_fill(\"mean\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\n\n\n\nThe map above indicates that most low-low occurrences are seen around Tuas and near Gedong Camp. This aligns with expectations due to the presence of various industrial zones in Tuas, and fewer visits to army camps, showcasing contrasting values in close proximity.\nFurthermore, high-high instances are noticed in specific sections of Woodlands and the Dover area.\nNo instances of low-high or high-low are observed in the data."
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#weekday-afternoon-peak---5pm-to-8pm-1",
    "href": "take_home_ex1/take_home_ex1.html#weekday-afternoon-peak---5pm-to-8pm-1",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "6.2 Weekday afternoon peak - 5pm to 8pm",
    "text": "6.2 Weekday afternoon peak - 5pm to 8pm\n\n6.2.1 Deriving contiguity weights: Queen’s method\nIn the code chunk below, queen method is used to derive the contiguity weights.\n\nwm_q2 &lt;- mpsz_origtrip1%&gt;%\n  mutate(nb = st_contiguity(geometry),\n         wt = st_weights(nb,\n                         style = \"W\",\n                         allow_zero = TRUE),\n         .before =1) \n\n\nwm_q2\n\nSimple feature collection with 4996 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 3720.122 ymin: 26337.76 xmax: 48345.12 ymax: 53040.21\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n         nb                              wt FID ORIGIN_PT_CODE TRIPS BUS_ROOF_N\n1         2                               1   3          25059   417        UNK\n2         1                               1 127          25059   417        UNK\n3         5                               1 315          25751   110       B02D\n4         0                            NULL 320          26379   249        NIL\n5         3                               1 439          25761  1810        B03\n6      8, 9                        0.5, 0.5 443          26389   276        NIL\n7         0                            NULL 445          26369   220        NIL\n8  6, 9, 14 0.3333333, 0.3333333, 0.3333333 504          25711   196       B02C\n9  6, 8, 14 0.3333333, 0.3333333, 0.3333333 504          25719  2709       B01C\n10        0                            NULL 508          26299   325        B13\n              LOC_DESC                       geometry\n1    AFT TUAS STH BLVD POLYGON ((3845.122 27853.31...\n2    AFT TUAS STH BLVD POLYGON ((4095.122 27853.31...\n3  BEF TUAS STH AVE 14 POLYGON ((4470.122 28502.83...\n4             YONG NAM POLYGON ((4470.122 30667.89...\n5       OPP REC S'PORE POLYGON ((4720.122 28502.83...\n6   BEF TUAS STH AVE 5 POLYGON ((4720.122 30234.88...\n7         SEE HUP SENG POLYGON ((4720.122 31100.9,...\n8        OPP THE INDEX POLYGON ((4845.122 30018.37...\n9            THE INDEX POLYGON ((4845.122 30018.37...\n10  BEF TUAS STH AVE 6 POLYGON ((4845.122 31750.42...\n\n\n\n\n6.2.2 Computing local Moran’s I\nI will compute Local Moran’s I of TRIPS at hexagon level by using local_moran() of sfdep package.\n\nlisa2 &lt;- wm_q2 %&gt;% \n  mutate(local_moran = local_moran(\n    TRIPS, nb, wt, nsim = 99,zero.policy= TRUE, na.action = na.exclude),\n         .before = 1) %&gt;%\n  unnest(local_moran)\n\n\n\n6.2.3 Visualising local Moran’s I\nIn this code chunk below, tmap functions are used prepare a choropleth map by using value in the ii field.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa2) +\n  tm_fill(\"ii\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n  tm_layout(main.title = \"local Moran's I of TRIPS\",\n            main.title.size = 0.8)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\nFrom the plot above, majority of the hexagon layers seem to have values of local Moran’s I of -10 to 10. With an exception of one point of value 40 to 50.\n\n\n6.2.4 Visualising p-value of local Moran’s I\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa2) +\n  tm_fill(\"p_ii_sim\",\n          breaks = c(0, 0.001, 0.01, 0.05, 1),\n              labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) + \n  tm_borders(alpha = 0.5) +\n   tm_layout(main.title = \"p-value of local Moran's I\",\n            main.title.size = 0.8)\n\n\n\n\nMajority of the hexagon layers are not significant. However, there are a few layers of p value that are significant, notable in the Tuas and Gedong camp region.\n\n\n6.2.5 Visualising local Moran’s I and p-value\nBoth maps next to each other as shown below.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\nmap1 &lt;- tm_shape(lisa2) +\n  tm_fill(\"ii\") + \n  tm_borders(alpha = 0.5) +\n  tm_view(set.zoom.limits = c(6,8)) +\n  tm_layout(main.title = \"local Moran's I of TRIPS\",\n            main.title.size = 0.8)\n\nmap2 &lt;- tm_shape(lisa2) +\n  tm_fill(\"p_ii_sim\",\n          breaks = c(0, 0.001, 0.01, 0.05, 1),\n              labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) + \n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"p-value of local Moran's I\",\n            main.title.size = 0.8)\n\ntmap_arrange(map1, map2, ncol = 2)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n6.2.6 Visualising LISA map\n\nlisa_sig2 &lt;- lisa2  %&gt;%\n  filter(p_ii_sim &lt; 0.05)\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(lisa) +\n  tm_polygons() +\n  tm_borders(alpha = 0.5) +\ntm_shape(lisa_sig) +\n  tm_fill(\"mean\") + \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\n\n\n\nFrom the plot above, low-low are observed in areas such as Tuas, near Gedong Camp. However, in this plot, areas in Queenstown area also consists of low-low.\nIn addition, high-high are observed in areas such as Woodlands.\nSimilarly, there are no high-low and low-high values."
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#weekendholiday-morning-peak---11am-to-2pm-1",
    "href": "take_home_ex1/take_home_ex1.html#weekendholiday-morning-peak---11am-to-2pm-1",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "6.3 Weekend/holiday morning peak - 11am to 2pm",
    "text": "6.3 Weekend/holiday morning peak - 11am to 2pm\n\n6.3.1 Deriving contiguity weights: Queen’s method\nIn the code chunk below, queen method is used to derive the contiguity weights.\n\nwm_q3 &lt;- mpsz_origtrip3%&gt;%   \n  mutate(nb = st_contiguity(geometry),          \n         wt = st_weights(nb,                          \n                         style = \"W\",                          \n                         allow_zero = TRUE),          \n         .before =1) \n\n\nwm_q3\n\nSimple feature collection with 4971 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 3720.122 ymin: 26337.76 xmax: 48345.12 ymax: 53040.21\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n         nb                              wt FID ORIGIN_PT_CODE TRIPS BUS_ROOF_N\n1         2                               1   3          25059     5        UNK\n2         1                               1 127          25059     5        UNK\n3         5                               1 315          25751    24       B02D\n4         0                            NULL 320          26379    27        NIL\n5         3                               1 439          25761   148        B03\n6      8, 9                        0.5, 0.5 443          26389   106        NIL\n7         0                            NULL 445          26369    75        NIL\n8  6, 9, 14 0.3333333, 0.3333333, 0.3333333 504          25711    39       B02C\n9  6, 8, 14 0.3333333, 0.3333333, 0.3333333 504          25719   406       B01C\n10        0                            NULL 508          26299    43        B13\n              LOC_DESC                       geometry\n1    AFT TUAS STH BLVD POLYGON ((3845.122 27853.31...\n2    AFT TUAS STH BLVD POLYGON ((4095.122 27853.31...\n3  BEF TUAS STH AVE 14 POLYGON ((4470.122 28502.83...\n4             YONG NAM POLYGON ((4470.122 30667.89...\n5       OPP REC S'PORE POLYGON ((4720.122 28502.83...\n6   BEF TUAS STH AVE 5 POLYGON ((4720.122 30234.88...\n7         SEE HUP SENG POLYGON ((4720.122 31100.9,...\n8        OPP THE INDEX POLYGON ((4845.122 30018.37...\n9            THE INDEX POLYGON ((4845.122 30018.37...\n10  BEF TUAS STH AVE 6 POLYGON ((4845.122 31750.42...\n\n\n\n\n6.3.2 Computing local Moran’s I\nI will compute Local Moran’s I of TRIPS at hexagon level by using local_moran() of sfdep package.\n\nlisa3 &lt;- wm_q3 %&gt;%    \n  mutate(local_moran = local_moran(     \n    TRIPS, nb, wt, nsim = 99,\n    zero.policy= TRUE, na.action = na.exclude),          .before = 1) %&gt;%   \n  unnest(local_moran)\n\n\n\n6.3.3 Visualising local Moran’s I\nIn this code chunk below, tmap functions are used prepare a choropleth map by using value in the ii field.\n\ntmap_mode(\"plot\") \n\ntmap mode set to plotting\n\ntm_shape(lisa3) +   \n  tm_fill(\"ii\") +    \n  tm_borders(alpha = 0.5) +  \n  tm_view(set.zoom.limits = c(6,8)) +   \n  tm_layout(main.title = \"local Moran's I of TRIPS\",            \n            main.title.size = 0.8)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\nFrom the plot above, majority of the hexagon layers seem to have values of local Moran’s I of -10 to 10. With an exception of one point of value 40 to 50.\n\n\n6.3.4 Visualising p-value of local Moran’s I\n\ntmap_mode(\"plot\") \n\ntmap mode set to plotting\n\ntm_shape(lisa3) +   \n  tm_fill(\"p_ii_sim\",          \n          breaks = c(0, 0.001, 0.01, 0.05, 1),               \n          labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) +    \n  tm_borders(alpha = 0.5) +    \n  tm_layout(main.title = \"p-value of local Moran's I\",            \n            main.title.size = 0.8)\n\n\n\n\nMajority of the hexagon layers are not significant. However, there are a few layers of p value that are significant.\n\n\n6.3.5 Visualising local Moran’s I and p-value\nBoth maps next to each other as shown below.\n\ntmap_mode(\"plot\") \n\ntmap mode set to plotting\n\nmap1 &lt;- tm_shape(lisa3) +   \n  tm_fill(\"ii\") +    \n  tm_borders(alpha = 0.5) +   \n  tm_view(set.zoom.limits = c(6,8)) +   \n  tm_layout(main.title = \"local Moran's I of TRIPS\",             \n            main.title.size = 0.8)  \nmap2 &lt;- tm_shape(lisa3) +   \n  tm_fill(\"p_ii_sim\",           \n          breaks = c(0, 0.001, 0.01, 0.05, 1),               \n          labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) +    \n  tm_borders(alpha = 0.5) +   \n  tm_layout(main.title = \"p-value of local Moran's I\",             \n            main.title.size = 0.8)  \ntmap_arrange(map1, map2, ncol = 2)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n6.3.6 Visualising LISA map\n\nlisa_sig3 &lt;- lisa3  %&gt;%   \n  filter(p_ii_sim &lt; 0.05) \ntmap_mode(\"plot\") \n\ntmap mode set to plotting\n\ntm_shape(lisa) +   \n  tm_polygons() +   \n  tm_borders(alpha = 0.5) + \n  tm_shape(lisa_sig) +   \n  tm_fill(\"mean\") +    \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\n\n\n\nFrom the plot above, low-low are observed in areas such as Tuas, near Gedong Camp, and even Queenstown area. In addition, high-high are observed in areas such Commonwealth.\nSimilarly, there are no high-low and low-high."
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#weekendholiday-evening-peak---4pm-to-7pm-1",
    "href": "take_home_ex1/take_home_ex1.html#weekendholiday-evening-peak---4pm-to-7pm-1",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "6.4 Weekend/holiday evening peak - 4pm to 7pm",
    "text": "6.4 Weekend/holiday evening peak - 4pm to 7pm\n\n6.4.1 Deriving contiguity weights: Queen’s method\nIn the code chunk below, queen method is used to derive the contiguity weights.\n\nwm_q4 &lt;- mpsz_origtrip4%&gt;%      \n  mutate(nb = st_contiguity(geometry),                    \n         wt = st_weights(nb,                                              \n                         style = \"W\",                                                    allow_zero = TRUE),                    \n         .before =1) \n\n\nwm_q4\n\nSimple feature collection with 4951 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 3720.122 ymin: 26337.76 xmax: 48345.12 ymax: 53040.21\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n         nb                              wt FID ORIGIN_PT_CODE TRIPS BUS_ROOF_N\n1         2                               1   3          25059    65        UNK\n2         1                               1 127          25059    65        UNK\n3         5                               1 315          25751    26       B02D\n4         0                            NULL 320          26379    54        NIL\n5         3                               1 439          25761   303        B03\n6      8, 9                        0.5, 0.5 443          26389    90        NIL\n7         0                            NULL 445          26369    35        NIL\n8  6, 9, 14 0.3333333, 0.3333333, 0.3333333 504          25711   141       B02C\n9  6, 8, 14 0.3333333, 0.3333333, 0.3333333 504          25719   547       B01C\n10        0                            NULL 508          26299    49        B13\n              LOC_DESC                       geometry\n1    AFT TUAS STH BLVD POLYGON ((3845.122 27853.31...\n2    AFT TUAS STH BLVD POLYGON ((4095.122 27853.31...\n3  BEF TUAS STH AVE 14 POLYGON ((4470.122 28502.83...\n4             YONG NAM POLYGON ((4470.122 30667.89...\n5       OPP REC S'PORE POLYGON ((4720.122 28502.83...\n6   BEF TUAS STH AVE 5 POLYGON ((4720.122 30234.88...\n7         SEE HUP SENG POLYGON ((4720.122 31100.9,...\n8        OPP THE INDEX POLYGON ((4845.122 30018.37...\n9            THE INDEX POLYGON ((4845.122 30018.37...\n10  BEF TUAS STH AVE 6 POLYGON ((4845.122 31750.42...\n\n\n\n\n6.4.2 Computing local Moran’s I\nI will compute Local Moran’s I of TRIPS at hexagon level by using local_moran() of sfdep package.\n\nlisa4 &lt;- wm_q4 %&gt;%       \n  mutate(local_moran = local_moran(          \n    TRIPS, nb, wt, nsim = 99,zero.policy= TRUE, na.action = na.exclude),          .before = 1) %&gt;%   unnest(local_moran)\n\n\n\n6.4.3 Visualising local Moran’s I\nIn this code chunk below, tmap functions are used prepare a choropleth map by using value in the ii field.\n\ntmap_mode(\"plot\")  \n\ntmap mode set to plotting\n\ntm_shape(lisa4) +      \n  tm_fill(\"ii\") +       \n  tm_borders(alpha = 0.5) +     \n  tm_view(set.zoom.limits = c(6,8)) +      \n  tm_layout(main.title = \"local Moran's I of TRIPS\",                         main.title.size = 0.8)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\nFrom the plot above, majority of the hexagon layers seem to have values of local Moran’s I of -10 to 10. With an exception of two points of value 40 to 50.\n\n\n6.4.4 Visualising p-value of local Moran’s I\n\ntmap_mode(\"plot\")  \n\ntmap mode set to plotting\n\ntm_shape(lisa4) +      \n  tm_fill(\"p_ii_sim\",                     \n          breaks = c(0, 0.001, 0.01, 0.05, 1),                          \n          labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) +       \n  tm_borders(alpha = 0.5) +       \n  tm_layout(main.title = \"p-value of local Moran's I\",                         main.title.size = 0.8)\n\n\n\n\nMajority of the hexagon layers are not significant. However, there are a few layers of p value that are significant, again in Tuas and near Gedong camp region.\n\n\n6.4.5 Visualising local Moran’s I and p-value\nBoth maps next to each other as shown below.\n\ntmap_mode(\"plot\")  \n\ntmap mode set to plotting\n\nmap1 &lt;- tm_shape(lisa4) +      \n  tm_fill(\"ii\") +       \n  tm_borders(alpha = 0.5) +      \n  tm_view(set.zoom.limits = c(6,8)) +      \n  tm_layout(main.title = \"local Moran's I of TRIPS\",                          main.title.size = 0.8)   \n\nmap2 &lt;- tm_shape(lisa4) +      \n  tm_fill(\"p_ii_sim\",                      \n          breaks = c(0, 0.001, 0.01, 0.05, 1),                          \n          labels = c(\"0.001\", \"0.01\", \"0.05\", \"Not sig\")) +       \n  tm_borders(alpha = 0.5) +      \n  tm_layout(main.title = \"p-value of local Moran's I\",                          main.title.size = 0.8)   \n\ntmap_arrange(map1, map2, ncol = 2)\n\nVariable(s) \"ii\" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.\n\n\n\n\n\n\n\n6.4.6 Visualising LISA map\n\nlisa_sig4 &lt;- lisa4  %&gt;%      \n  filter(p_ii_sim &lt; 0.05)  \ntmap_mode(\"plot\")  \n\ntmap mode set to plotting\n\ntm_shape(lisa) +      \n  tm_polygons() +      \n  tm_borders(alpha = 0.5) +    \n  tm_shape(lisa_sig) +      \n  tm_fill(\"mean\") +       \n  tm_borders(alpha = 0.4)\n\nWarning: One tm layer group has duplicated layer types, which are omitted. To\ndraw multiple layers of the same type, use multiple layer groups (i.e. specify\ntm_shape prior to each of them).\n\n\n\n\n\nFrom the plot above, low-low are observed in areas such as Tuas, areas near Gedong Camp, and Queenstown area. In addition, high-high are observed in areas such Commonwealth."
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#comparing-all-peak-hour-period-1",
    "href": "take_home_ex1/take_home_ex1.html#comparing-all-peak-hour-period-1",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "6.5 Comparing all peak hour period",
    "text": "6.5 Comparing all peak hour period\nAcross all the LISA maps, a notable prevalence of low-low instances is evident in Tuas and neighboring regions close to Gedong Camp. This can be possible explained by the concentration of industrial zones in Tuas and fewer visits to nearby region near army camp reinforces the proximity of contrasting values.\nFurthermore, the occurrence of high-high instances lacks consistency across all the LISA maps, showcasing variations from Woodlands to Commonwealth areas.\nThe amalgamation of information from both the LISA maps and geospatial visualization highlights Tuas, Woodlands, and areas near Gedong Camp as significant points of interest in Singapore’s bus transportation development."
  },
  {
    "objectID": "take_home_ex1/take_home_ex1.html#footnotes",
    "href": "take_home_ex1/take_home_ex1.html#footnotes",
    "title": "Take-home Exercise 1: Geospatial Analytics for Public Good",
    "section": "Footnotes",
    "text": "Footnotes\n\n\nhttps://www.statista.com/statistics/1006198/singapore-daily-public-bus-ridership/#:~:text=Daily%20ridership%20of%20public%20buses%20Singapore%202015%2D2022&text=In%202022%2C%20an%20average%20of,COVID%2D19%20and%20its%20measures.↩︎\nhttps://theindependent.sg/lta-jurong-town-hall-bus-interchange-opens-in-november-2023/↩︎\nhttps://www.channelnewsasia.com/singapore/bus-service-167-ridership-falls-lta-commuters-unhappy-3928596↩︎\nhttps://www.corporateservicessingapore.com/7-popular-business-locations-singapore/↩︎\nhttps://www.asiaone.com/singapore/waited-bus-1-hour-commuters-stuck-woodlands-tuas-checkpoints-polling-day-september-school-holidays↩︎\nhttps://mothership.sg/2023/06/jams-sg-jb-causeway-vesak-day/↩︎"
  },
  {
    "objectID": "take_home_ex2/data/geospatial/Business.html",
    "href": "take_home_ex2/data/geospatial/Business.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "take_home_ex2/data/geospatial/entertn.html",
    "href": "take_home_ex2/data/geospatial/entertn.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "take_home_ex2/data/geospatial/F&B.html",
    "href": "take_home_ex2/data/geospatial/F&B.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "take_home_ex2/data/geospatial/FinServ.html",
    "href": "take_home_ex2/data/geospatial/FinServ.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "take_home_ex2/data/geospatial/Liesure&Recreation.html",
    "href": "take_home_ex2/data/geospatial/Liesure&Recreation.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "take_home_ex2/data/geospatial/MPSZ-2019.html",
    "href": "take_home_ex2/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "take_home_ex2/data/geospatial/Retails.html",
    "href": "take_home_ex2/data/geospatial/Retails.html",
    "title": "ISSS624 Geospatial Analytics Application",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html",
    "href": "take_home_ex2/take_home_ex2.html",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "",
    "text": "In this study, I will continue my geospatial analytics learning journey to demonstrate the potential value of geospatial data science and analysis (GDSA) to integrate publicly available data from multiple sources for building a spatial interaction models to determine factors affecting urban mobility patterns of public bus transit. This study will tap on more data such as HDB, School Directory and Information, Train Station Exit Layer, Financial Service, Business data."
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#setting-the-analytical-tools",
    "href": "take_home_ex2/take_home_ex2.html#setting-the-analytical-tools",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "2.1 Setting the Analytical Tools",
    "text": "2.1 Setting the Analytical Tools\nThe code chunk below installs and loads the various packages.\nFor the purpose of this study, 11 r packages will be used. They are:\n\ntmap for plotting cartographicquality thematic maps.\nsf for importing, integrating, processing and transforming geospatial data.\nDT for working with HTTP organised by HTTP verbs.\nstplanr for transport planning and analysis\nsp for spatial data\nperformance for computing model comparison matrices such as rmse.\nreshape2 for melt function\nhttr for working with HTTP\nggpubr for creating publication quality statistical graphics.\ntidyverse for importing, integrating, wrangling and visualising data.\ncorrplot for correlation matrix\n\n\npacman::p_load(tmap, sf, DT, stplanr, sp,\n               performance,reshape2,httr,\n               ggpubr, tidyverse, corrplot)\n\n\n\n\n\n\n\nNote\n\n\n\nFrom link, past experience shows that computing distance matrix by using sf function took relatively longer time that sp method especially the data set is large. In view of this, sp method is used in the code chunks below."
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#data",
    "href": "take_home_ex2/take_home_ex2.html#data",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "3.1 Data",
    "text": "3.1 Data\n\n3.1.1 Importing the OD data\nFirstly, I will import the Passenger Volume by Origin Destination Bus Stops data set downloaded from LTA DataMall by using read_csv() of readr package. Oct 2023 data will be used. Detailed explanation of how the dataset is obtained is in Take Home Exercise 1.\n\nodbus &lt;- read_csv(\"data/aspatial/origin_destination_bus_202310.csv\")\n\nRows: 5694297 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (5): YEAR_MONTH, DAY_TYPE, PT_TYPE, ORIGIN_PT_CODE, DESTINATION_PT_CODE\ndbl (2): TIME_PER_HOUR, TOTAL_TRIPS\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nI will display the odbus tibble data table by using the code chunk below.\n\nglimpse(odbus)\n\nRows: 5,694,297\nColumns: 7\n$ YEAR_MONTH          &lt;chr&gt; \"2023-10\", \"2023-10\", \"2023-10\", \"2023-10\", \"2023-…\n$ DAY_TYPE            &lt;chr&gt; \"WEEKENDS/HOLIDAY\", \"WEEKDAY\", \"WEEKENDS/HOLIDAY\",…\n$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 7, 14, 14, 10, 20, 20,…\n$ PT_TYPE             &lt;chr&gt; \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"…\n$ ORIGIN_PT_CODE      &lt;chr&gt; \"04168\", \"04168\", \"80119\", \"80119\", \"44069\", \"2028…\n$ DESTINATION_PT_CODE &lt;chr&gt; \"10051\", \"10051\", \"90079\", \"90079\", \"17229\", \"2014…\n$ TOTAL_TRIPS         &lt;dbl&gt; 3, 5, 3, 5, 4, 1, 24, 2, 1, 7, 3, 2, 5, 1, 1, 1, 1…\n\n\nA quick check of odbus tibble data frame shows that the values in ORIGIN_PT_CODE and DESTINATON_PT_CODE are in numeric data type. Hence, the code chunk below is used to convert these data values into character data type.\n\nodbus$ORIGIN_PT_CODE &lt;- as.factor(odbus$ORIGIN_PT_CODE)\nodbus$DESTINATION_PT_CODE &lt;- as.factor(odbus$DESTINATION_PT_CODE) \n\nFor this study, I will extract commuting flows on weekday and between 6 and 9 o’clock. This will mainly be people going to school or work.\n\nodbus6_9 &lt;- odbus %&gt;%\n  filter(DAY_TYPE == \"WEEKDAY\") %&gt;%\n  filter(TIME_PER_HOUR &gt;= 6 &\n           TIME_PER_HOUR &lt;= 9) %&gt;%\n  group_by(ORIGIN_PT_CODE,\n           DESTINATION_PT_CODE) %&gt;%\n  summarise(TRIPS = sum(TOTAL_TRIPS))\n\n`summarise()` has grouped output by 'ORIGIN_PT_CODE'. You can override using\nthe `.groups` argument.\n\n\nI will save the output in rds format for future used.\n\nwrite_rds(odbus6_9, \"data/rds/odbus6_9.rds\")\n\nThe code chunk below will be used to import the save odbus6_9.rds into R environment.\n\nodbus6_9 &lt;- read_rds(\"data/rds/odbus6_9.rds\")\n\n\n\n3.1.2 Importing Geospatial data into R\nFor the purpose of this exercise, three geospatial data will be used first. They are:\n\nBusStop: This data provides the location of bus stop as at last quarter of 2023.\nMPSZ-2019: This data provides the sub-zone boundary of URA Master Plan 2019.\nHexagon: analytical hexagon data of 375m (this distance is the perpendicular distance between the centre of the hexagon and its edges) to represent the traffic analysis zone (TAZ).\n\nFirst 2 data sets are in ESRI shapefile format. Last file will be derived from R in the later section 4.2 Creating Hexagon layer.\n\nbusstop &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"BusStop\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `BusStop' from data source \n  `C:\\czx0727\\ISSS624_\\take_home_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 5161 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82\nProjected CRS: SVY21\n\n\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"MPSZ-2019\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `MPSZ-2019' from data source \n  `C:\\czx0727\\ISSS624_\\take_home_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\n\nmpsz\n\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N\n1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION\n2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION\n3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION\n4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION\n5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION\n6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION\n7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION\n8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION\n9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION\n10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION\n   REGION_C                       geometry\n1        CR MULTIPOLYGON (((33222.98 29...\n2        CR MULTIPOLYGON (((28481.45 30...\n3        CR MULTIPOLYGON (((28087.34 30...\n4        WR MULTIPOLYGON (((14557.7 304...\n5        CR MULTIPOLYGON (((29542.53 31...\n6        CR MULTIPOLYGON (((35279.55 30...\n7        WR MULTIPOLYGON (((15772.59 21...\n8        WR MULTIPOLYGON (((19843.41 21...\n9        CR MULTIPOLYGON (((30870.53 22...\n10       CR MULTIPOLYGON (((26879.04 26...\n\n\n\nmpsz &lt;- write_rds(mpsz, \"data/rds/mpsz.rds\")"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#combining-busstop-and-mpsz",
    "href": "take_home_ex2/take_home_ex2.html#combining-busstop-and-mpsz",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "4.1 Combining Busstop and mpsz",
    "text": "4.1 Combining Busstop and mpsz\nCode chunk below populates the planning subzone code (i.e. SUBZONE_C) of mpsz sf data frame into busstop sf data frame.\n\nbusstop_mpsz &lt;- st_intersection(busstop, mpsz) %&gt;%\n  select(BUS_STOP_N, SUBZONE_C) \n\nWarning: attribute variables are assumed to be spatially constant throughout\nall geometries\n\n\n\nwrite_rds(busstop_mpsz, \"data/rds/busstop_mpsz.rds\")"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#creating-hexagon-layer",
    "href": "take_home_ex2/take_home_ex2.html#creating-hexagon-layer",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "4.2 Creating Hexagon layer",
    "text": "4.2 Creating Hexagon layer\nNow, I am going to create a hexagon layer from the guidance of this link:\n\n# cell size of layer of 250m\narea_honeycomb_grid = st_make_grid(busstop_mpsz, c(750, 750), what = \"polygons\", square = FALSE, crs = 3414)\n\n# To sf and add grid ID\nhoneycomb_grid_sf = st_sf(area_honeycomb_grid)\n\n\nst_write(honeycomb_grid_sf, \"data/geospatial/hexagon.shp\",append=TRUE)\n\nUpdating layer `hexagon' to data source `data/geospatial/hexagon.shp' using driver `ESRI Shapefile'\nUpdating existing layer hexagon\nWriting 2299 features with 0 fields and geometry type Polygon.\n\n\n\nhexagon &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"hexagon\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `hexagon' from data source \n  `C:\\czx0727\\ISSS624_\\take_home_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 72872 features and 1 field\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 3220.122 ymin: 26049.09 xmax: 48970.12 ymax: 50947.32\nProjected CRS: SVY21 / Singapore TM"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#combine-hexagon-and-busstop_mpsz",
    "href": "take_home_ex2/take_home_ex2.html#combine-hexagon-and-busstop_mpsz",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "4.3 Combine Hexagon and Busstop_Mpsz",
    "text": "4.3 Combine Hexagon and Busstop_Mpsz\nNext, we are going to combine the datset busstop_mpsz and hexagon. This will give me the hexagon layer together with Busstop_mpsz.\n\nod_data &lt;- st_join(busstop_mpsz , hexagon,\n            by = c(\"geometry\" = \"geometry\"))"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#combine-hexagon-and-busstop",
    "href": "take_home_ex2/take_home_ex2.html#combine-hexagon-and-busstop",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "4.4 Combine Hexagon and Busstop",
    "text": "4.4 Combine Hexagon and Busstop\nI will combine the Hexagon and busstop. This will sieve out areas with bus stops in hexagon format.\n\nhexagon_busstop &lt;- st_join(hexagon, busstop, by = c(\"FID\" = \"FID\"))\n\n\nhexagon_busstop &lt;- hexagon_busstop %&gt;%\n  drop_na() %&gt;%\n  group_by(FID)\n\n\nwrite_rds(hexagon_busstop, \"data/rds/hexagon_busstop.rds\")"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#combine-odbus6_9-with-od_data",
    "href": "take_home_ex2/take_home_ex2.html#combine-odbus6_9-with-od_data",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "4.5 Combine odbus6_9 with od_data",
    "text": "4.5 Combine odbus6_9 with od_data\nI will combine the Hexagon and Busstop_Mpsz with the odbus6_9 data to give me od_data1 for the unique identifier which is the origin:\n\nod_data_1 &lt;- left_join(odbus6_9 , od_data,\n            by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\")) %&gt;%\n  rename(ORIGIN_BS = ORIGIN_PT_CODE,\n         ORIGIN_SZ = SUBZONE_C,\n         DESTIN_BS = DESTINATION_PT_CODE)\n\nWarning in left_join(odbus6_9, od_data, by = c(ORIGIN_PT_CODE = \"BUS_STOP_N\")): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 1 of `x` matches multiple rows in `y`.\nℹ Row 19489 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\nBefore continue, it is a good practice for us to check for duplicating records.\n\nduplicate &lt;- od_data_1 %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\nIf duplicated records are found, the code chunk below will be used to retain the unique records.\n\nod_data_1 &lt;- unique(od_data_1)\n\nIt will be a good practice to confirm if the duplicating records issue has been addressed fully.\nNext, we will update od_data data frame with Combine Hexagon and Busstop_Mpsz with destination:\n\nod_data_2 &lt;- left_join(od_data_1 , od_data,\n            by = c(\"DESTIN_BS\" = \"BUS_STOP_N\")) \n\nWarning in left_join(od_data_1, od_data, by = c(DESTIN_BS = \"BUS_STOP_N\")): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 1 of `x` matches multiple rows in `y`.\nℹ Row 19460 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\nBefore continue, it is a good practice for us to check for duplicating records once again.\n\nduplicate &lt;- od_data_2 %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\nIf duplicated records are found, the code chunk below will be used to retain the unique records.\n\nod_data_2 &lt;- unique(od_data_2)\n\n\nod_data_2 &lt;- od_data_2 %&gt;%\n  drop_na() %&gt;%\n  group_by(FID.x, FID.y) %&gt;%\n  summarise(MORNING_PEAK = sum(TRIPS))\n\n`summarise()` has grouped output by 'FID.x'. You can override using the\n`.groups` argument.\n\n\nIt is time to save the output into an rds file format.\n\nwrite_rds(od_data_2, \"data/rds/od_data_2.rds\")\n\n\nod_data_2 &lt;- read_rds(\"data/rds/od_data_2.rds\")"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#removing-intra-zonal-flows",
    "href": "take_home_ex2/take_home_ex2.html#removing-intra-zonal-flows",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "5.1 Removing intra-zonal flows",
    "text": "5.1 Removing intra-zonal flows\nI will not plot the intra-zonal flows. The code chunk below will be used to remove intra-zonal flows at the hexagon level. O-D matrix is as shown:\n\nod_data_3 &lt;- od_data_2[od_data_2$FID.x!=od_data_2$FID.y,]\n\n\nhead(od_data_3)\n\n# A tibble: 6 × 3\n# Groups:   FID.x [1]\n  FID.x FID.y MORNING_PEAK\n  &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;\n1     1    89            1\n2     1   110            1\n3     1   152            4\n4     1   179           93\n5     1   200            3\n6     1   202            1"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#creating-desire-lines",
    "href": "take_home_ex2/take_home_ex2.html#creating-desire-lines",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "5.2 Creating desire lines",
    "text": "5.2 Creating desire lines\nIn this code chunk below, od2line() of stplanr package is used to create the desire lines at the hexagon layer.\n\nflowLine &lt;- od2line(flow = od_data_3, \n                    zones = hexagon,\n                    zone_code = \"FID\")\n\nCreating centroids representing desire line start and end points."
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#visualising-the-desire-lines",
    "href": "take_home_ex2/take_home_ex2.html#visualising-the-desire-lines",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "5.3 Visualising the desire lines",
    "text": "5.3 Visualising the desire lines\nTo visualise the resulting desire lines, the code chunk below is used.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntmap_options(check.and.fix = TRUE)\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(hexagon_busstop) +\n  tm_polygons() +\nflowLine %&gt;%  \ntm_shape() +\n  tm_lines(lwd = \"MORNING_PEAK\",\n           style = \"quantile\",\n           scale = c(0.1, 1, 3, 5, 7, 10),\n           n = 6,\n           alpha = 0.3)\n\nWarning: The shape mpsz is invalid. See sf::st_is_valid\n\n\nWarning in g$scale * (x/maxW): longer object length is not a multiple of\nshorter object length"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#morning-peak-greater-than-or-equal-to-5000",
    "href": "take_home_ex2/take_home_ex2.html#morning-peak-greater-than-or-equal-to-5000",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "5.4 Morning Peak (Greater than or equal to 5000)",
    "text": "5.4 Morning Peak (Greater than or equal to 5000)\nWhen the flow data are very messy and highly skewed like the one shown above, it is wiser to focus on selected flows, for example flow greater than or equal to 5000 as shown below.\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(hexagon_busstop) +\n  tm_polygons() +\nflowLine %&gt;%  \n  filter(MORNING_PEAK &gt;= 5000) %&gt;%\ntm_shape() +\n  tm_lines(lwd = \"MORNING_PEAK\",\n           style = \"quantile\",\n           scale = c(0.1, 1, 3, 5, 7, 10),\n           n = 6,\n           alpha = 0.3)\n\nWarning: The shape mpsz is invalid. See sf::st_is_valid\n\n\nWarning in g$scale * (x/maxW): longer object length is not a multiple of\nshorter object length\n\n\n\n\n\nFor passengers volume greater or equal to 5000, we can observe from the map above that there are passenger flow between Woodlands and areas such as Tuas, Jurong, Woodlands and Tampines areas. There are also small pockets of areas in the central of Singapore.\nThe flow is most noticeable between Woodlands and Tampines."
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#morning-peak-greater-than-or-equal-to-10000",
    "href": "take_home_ex2/take_home_ex2.html#morning-peak-greater-than-or-equal-to-10000",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "5.5 Morning Peak (Greater than or equal to 10000)",
    "text": "5.5 Morning Peak (Greater than or equal to 10000)\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(hexagon_busstop) +\n  tm_polygons() +\nflowLine %&gt;%  \n  filter(MORNING_PEAK &gt;= 10000) %&gt;%\ntm_shape() +\n  tm_lines(lwd = \"MORNING_PEAK\",\n           style = \"quantile\",\n           scale = c(0.1, 1, 3, 5, 7, 10),\n           n = 6,\n           alpha = 0.3)\n\nWarning: The shape mpsz is invalid. See sf::st_is_valid\n\n\nWarning in g$scale * (x/maxW): longer object length is not a multiple of\nshorter object length\n\n\n\n\n\nFor passenger volumes greater than 10,000, we observe in areas between Woodlands and Tuas, and also Woodlands and Tampines."
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#morning-peak-greater-than-or-equal-to-50000",
    "href": "take_home_ex2/take_home_ex2.html#morning-peak-greater-than-or-equal-to-50000",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "5.6 Morning Peak (Greater than or equal to 50000)",
    "text": "5.6 Morning Peak (Greater than or equal to 50000)\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(hexagon_busstop) +\n  tm_polygons() +\nflowLine %&gt;%  \n  filter(MORNING_PEAK &gt;= 50000) %&gt;%\ntm_shape() +\n  tm_lines(lwd = \"MORNING_PEAK\",\n           style = \"quantile\",\n           scale = c(0.1, 1, 3, 5, 7, 10),\n           n = 6,\n           alpha = 0.3)\n\nWarning: The shape mpsz is invalid. See sf::st_is_valid\n\n\nWarning in g$scale * (w_legend/maxW): longer object length is not a multiple of\nshorter object length\n\n\nWarning in g$scale * (x/maxW): longer object length is not a multiple of\nshorter object length\n\n\n\n\n\nFor passengers volume equal or greater than 50,000, it is concentrated in Woodlands region."
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#geospatial",
    "href": "take_home_ex2/take_home_ex2.html#geospatial",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "6.1 Geospatial",
    "text": "6.1 Geospatial\nFor geospatial, I will be using the following:\n\nBusiness: This dataset is used to illustrated people commuting to work\n\n\n\n\n\n\nNote\n\n\n\nData is prepared by Prof Kam - ISSS624\n\n\n\n\nbusiness &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"Business\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `Business' from data source \n  `C:\\czx0727\\ISSS624_\\take_home_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 6550 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3669.148 ymin: 25408.41 xmax: 47034.83 ymax: 50148.54\nProjected CRS: SVY21 / Singapore TM\n\n\n\nhexagon_busstop$`BUSINESS_COUNT`&lt;- lengths(\n  st_intersects(\n    hexagon_busstop, business))\n\n\nsummary(hexagon_busstop$BUSINESS_COUNT)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   0.000   5.696   5.000 117.000 \n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(hexagon_busstop) +\n  tm_polygons() +\ntm_shape(business) +\n  tm_dots() \n\nWarning: The shape mpsz is invalid. See sf::st_is_valid\n\n\n\n\n\n\nFinServ: This dataset is used to illustrate people working in the financial services sector\n\n\n\n\n\n\n\nNote\n\n\n\nData is prepared by Prof Kam - ISSS624\n\n\n\nfinserv &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"FinServ\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `FinServ' from data source \n  `C:\\czx0727\\ISSS624_\\take_home_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 3320 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 4881.527 ymin: 25171.88 xmax: 46526.16 ymax: 49338.02\nProjected CRS: SVY21 / Singapore TM\n\n\n\nhexagon_busstop$`FINANCE_COUNT`&lt;- lengths(\n  st_intersects(\n    hexagon_busstop, finserv))\n\n\nsummary(hexagon_busstop$FINANCE_COUNT)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   1.000   4.286   5.000  91.000 \n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(hexagon_busstop) +\n  tm_polygons() +\ntm_shape(finserv) +\n  tm_dots() \n\nWarning: The shape mpsz is invalid. See sf::st_is_valid\n\n\n\n\n\n\nTrain Station Exit Layer: This dataset is used to indicate if there is any potential transition from train station to busstop. Steps to obtain the data is shown below:\n\nIn datamall -&gt; Go to static datasets -&gt; under search bar type “Train Station Exit Point” -&gt; download shp file\n\n\ntrain &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"Train_Station_Exit_Layer\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `Train_Station_Exit_Layer' from data source \n  `C:\\czx0727\\ISSS624_\\take_home_ex2\\data\\geospatial' using driver `ESRI Shapefile'\nSimple feature collection with 565 features and 2 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6134.086 ymin: 27499.7 xmax: 45356.36 ymax: 47865.92\nProjected CRS: SVY21\n\n\n\nhexagon_busstop$`TRAIN_COUNT`&lt;- lengths(\n  st_intersects(\n    hexagon_busstop, train))\n\n\nsummary(hexagon_busstop$TRAIN_COUNT)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   0.000   0.749   1.000  11.000 \n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(hexagon_busstop) +\n  tm_polygons() +\ntm_shape(train) +\n  tm_dots() \n\nWarning: The shape mpsz is invalid. See sf::st_is_valid\n\n\n\n\n\n\nRapid Transit System Station. This is for the location of MRT. Steps to obtain the data is shown below:\n\nIn datamall -&gt; Go to static datasets -&gt; under search bar type “Train Station” -&gt; download shp file\n\n\nmrt &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"RapidTransitSystemStation\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `RapidTransitSystemStation' from data source \n  `C:\\czx0727\\ISSS624_\\take_home_ex2\\data\\geospatial' using driver `ESRI Shapefile'\n\n\nWarning in CPL_read_ogr(dsn, layer, query, as.character(options), quiet, : GDAL\nMessage 1: Non closed ring detected. To avoid accepting it, set the\nOGR_GEOMETRY_ACCEPT_UNCLOSED_RING configuration option to NO\n\n\nSimple feature collection with 220 features and 4 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 6068.209 ymin: 27478.44 xmax: 45377.5 ymax: 47913.58\nProjected CRS: SVY21\n\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntmap_options(check.and.fix = TRUE)\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(hexagon_busstop) +\n  tm_polygons() +\ntm_shape(train) +\n  tm_dots() \n\nWarning: The shape mpsz is invalid. See sf::st_is_valid\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\ntmap_options(check.and.fix = TRUE) is used as Non closed ring is detected in this dataset\n\n\n\n\n\n\n\n\nImportant\n\n\n\nDue to issue with the shape file, Rapid Transit System Station will not be used in Spatial Interaction Models"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#aspatial",
    "href": "take_home_ex2/take_home_ex2.html#aspatial",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "6.2 Aspatial",
    "text": "6.2 Aspatial\nFor aspatial, I will be using the following:\n\nHDB: This dataset is used to understand the location of HBD in the hexagon layer\n\n\n\n\n\n\n\nNote\n\n\n\nData is prepared by Prof Kam - ISSS624\n\n\n\ndata &lt;- read.csv(\"data/aspatial/hdb.csv\")\n\n\ncoordinates &lt;- data[, c(\"lng\", \"lat\")]  \nspatial_points &lt;- SpatialPointsDataFrame(coordinates, data)\n\nConvert to CRS3414:\n\n# Create a SpatialPoints object\ncoordinates &lt;- data[, c(\"lng\", \"lat\")]\nspatial_points &lt;- SpatialPoints(coords = coordinates)\n\n# Define the current CRS (WGS84 - EPSG:4326)\nproj4string(spatial_points) &lt;- CRS(\"+proj=longlat +datum=WGS84\")\n\n# Convert SpatialPoints to an sf object\nsf_points &lt;- st_as_sf(spatial_points)\n\n# Define EPSG:3414 CRS\nepsg_3414_crs &lt;- st_crs(3414)\n\n# Transform the sf object to EPSG:3414\nsf_points_3414 &lt;- st_transform(sf_points, crs = epsg_3414_crs)\n\n# Convert back to SpatialPoints\nspatial_points_3414 &lt;- as(sf_points_3414, \"Spatial\")\n\n\ntmap_mode(\"plot\")\n\ntmap mode set to plotting\n\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(hexagon_busstop) +\n  tm_polygons() +\ntm_shape(spatial_points_3414) +\n  tm_dots()\n\nWarning: The shape mpsz is invalid. See sf::st_is_valid\n\n\n\n\n\n\nsf_spatial_points_3414 &lt;- st_as_sf(spatial_points_3414)\n\nintersections &lt;- st_intersects(hexagon_busstop, sf_spatial_points_3414)\n\nhexagon_busstop$HDB_COUNT &lt;- lengths(intersections)\n\n\nsummary(hexagon_busstop$HDB_COUNT)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n   0.00    0.00    8.00   17.66   32.00   74.00 \n\n\n\nSchool Directory and Information - Dataset is taken from Data@Gov. This information is useful as the morning period will consist of students going to school\n\na. Steps in Data@Gov: Type in “School Directory and Information” in search bar\n\nb. SLA API -&gt; To note on API document -&gt; Search\n\nConcepts learned from In-Class Ex 4 will be used to extract the data from SLA API\n\nurl&lt;-\"https://www.onemap.gov.sg/api/common/elastic/search\"\n\ncsv&lt;-read_csv(\"data/aspatial/Generalinformationofschools.csv\")\n\nRows: 346 Columns: 31\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (31): school_name, url_address, address, postal_code, telephone_no, tele...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\npostcodes&lt;-csv$`postal_code`\n\nfound&lt;-data.frame()\nnot_found&lt;-data.frame()\n\nfor(postcode in postcodes){\n  query&lt;-list('searchVal'=postcode,'returnGeom'='Y','getAddrDetails'='Y','pageNum'='1')\n  res&lt;- GET(url,query=query)\n  \n  if((content(res)$found)!=0){\n    found&lt;-rbind(found,data.frame(content(res))[4:13])\n  } else{\n    not_found = data.frame(postcode)\n  }\n}\n\nNext, the code chunk below will be used to combine both found and not_found data.frames into a single tibble data.frame called merged. At the same time, I will write merged and not_found tibble data.frames into two separate csv files called schools and not_found respectively.\n\nmerged = merge(csv, found, by.x = 'postal_code', by.y = 'results.POSTAL', all = TRUE)\nwrite.csv(merged, file = \"data/aspatial/schools.csv\")\nwrite.csv(not_found, file = \"data/aspatial/not_found.csv\")\n\nI will manually clean up for ZhengHua Secondary School for the coordinates (link). File is saved as schools1.csv\nNext, I will import schools1.csv into R environment and at the same time tidying the data by selecting only the necessary fields as well as rename some fields.\n\nschools &lt;- read_csv(\"data/aspatial/schools1.csv\") %&gt;%\n  rename(latitude = \"results.LATITUDE\",\n         longitude = \"results.LONGITUDE\")%&gt;%\n  select(postal_code, school_name, latitude, longitude)\n\nNew names:\nRows: 350 Columns: 41\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(35): school_name, url_address, address, telephone_no, telephone_no_2, f... dbl\n(6): ...1, postal_code, results.X, results.Y, results.LATITUDE, results...\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -&gt; `...1`\n\n\nI convert schools1 tibble data.frame data into a simple feature tibble data.frame called schools_sf by using values in latitude and longitude fields.\n\nschools_sf &lt;- st_as_sf(schools, \n                       coords = c(\"longitude\", \"latitude\"),\n                       crs=4326) %&gt;%\n  st_transform(crs = 3414)\n\nPlot is shown below:\n\ntmap_options(check.and.fix = TRUE)\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(hexagon_busstop) +\n  tm_polygons() +\ntm_shape(schools_sf) +\n  tm_dots()\n\nWarning: The shape mpsz is invalid. See sf::st_is_valid\n\n\n\n\n\nI will count count the number of schools located inside the hexagon layer.\n\nhexagon_busstop$`SCHOOL_COUNT`&lt;- lengths(\n  st_intersects(\n    hexagon_busstop, schools_sf))\n\nI will examine the summary statistics of the derived variable.\n\nsummary(hexagon_busstop$`SCHOOL_COUNT`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.0000  0.0000  0.0000  0.4354  1.0000  5.0000 \n\n\n\n\n\n\n\n\nImportant\n\n\n\nThe summary statistics above reveals that there are excessive 0 values in SCHOOL_COUNT field. If log() is going to use to transform this field, additional step is required to ensure that all 0 will be replaced with a value between 0 and 1 but not 0 neither 1. This is the same for other data.\n\n\n\nUniversity location - As the school data covers only the primary, secondary schools and Junior Colleges, I have manually created the file university.csv by finding the name, postal, latitude and longitude of the 6 autonomous universities in Singapore.\n\n\n\n\n\n\n\nNote\n\n\n\nData is specially prepared by Zhixuan for this take home exercise\n\n\nI will import university.csv into R environment\n\nuniversity &lt;- read_csv(\"data/aspatial/university.csv\") %&gt;%\n  rename(latitude = \"results.LATITUDE\",\n         longitude = \"results.LONGITUDE\")\n\nRows: 6 Columns: 4\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): University, postal_code\ndbl (2): results.LATITUDE, results.LONGITUDE\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nI convert schools1 tibble data.frame data into a simple feature tibble data.frame called schools_sf by using values in latitude and longitude fields.\n\nuniversity_sf &lt;- st_as_sf(university, \n                       coords = c(\"longitude\", \"latitude\"),\n                       crs=4326) %&gt;%\n  st_transform(crs = 3414)\n\nPlot is shown below:\n\ntmap_options(check.and.fix = TRUE)\ntm_shape(mpsz) +\n  tm_polygons() +\ntm_shape(hexagon_busstop) +\n  tm_polygons() +\ntm_shape(university_sf) +\n  tm_dots()\n\nWarning: The shape mpsz is invalid. See sf::st_is_valid\n\n\n\n\n\nI will count count the number of universities located inside the hexagon layer.\n\nhexagon_busstop$`UNIVERSITY_COUNT`&lt;- lengths(\n  st_intersects(\n    hexagon_busstop, university_sf))\n\nI will examine the summary statistics of the derived variable.\n\nsummary(hexagon_busstop$`UNIVERSITY_COUNT`)\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n0.000000 0.000000 0.000000 0.006211 0.000000 1.000000 \n\n\nThe data will be joined with od_data:\n\nhexagon_busstop_tidy &lt;- hexagon_busstop %&gt;%\n  st_drop_geometry() %&gt;%\n  select(FID, SCHOOL_COUNT, BUSINESS_COUNT, FINANCE_COUNT,TRAIN_COUNT,HDB_COUNT,UNIVERSITY_COUNT )\n\n\nflow_data &lt;- od_data_2 %&gt;%\n  left_join(hexagon_busstop_tidy,\n            by = c(\"FID.y\" = \"FID\"))\n\nWarning in left_join(., hexagon_busstop_tidy, by = c(FID.y = \"FID\")): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 1 of `x` matches multiple rows in `y`.\nℹ Row 9 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\n\n\n\n\n\n\n\nNote\n\n\n\nFID.y is the destination. It is unique join field between od_data_2 and hexagon_busstop_tidy. In this study, I am interested in the destination of the travelling trip.\n\n\n\nsummary(flow_data)\n\n     FID.x          FID.y       MORNING_PEAK      SCHOOL_COUNT   \n Min.   :   1   Min.   :   1   Min.   :    1.0   Min.   :0.0000  \n 1st Qu.:1338   1st Qu.:1337   1st Qu.:    7.0   1st Qu.:0.0000  \n Median :1709   Median :1723   Median :   34.0   Median :0.0000  \n Mean   :1689   Mean   :1682   Mean   :  343.3   Mean   :0.4483  \n 3rd Qu.:2049   3rd Qu.:2033   3rd Qu.:  160.0   3rd Qu.:1.0000  \n Max.   :2951   Max.   :2951   Max.   :74894.0   Max.   :5.0000  \n                                                 NA's   :144     \n BUSINESS_COUNT   FINANCE_COUNT     TRAIN_COUNT       HDB_COUNT    \n Min.   :  0.00   Min.   : 0.000   Min.   : 0.000   Min.   : 0.00  \n 1st Qu.:  0.00   1st Qu.: 1.000   1st Qu.: 0.000   1st Qu.: 0.00  \n Median :  1.00   Median : 4.000   Median : 0.000   Median :13.00  \n Mean   :  5.84   Mean   : 8.147   Mean   : 1.356   Mean   :19.04  \n 3rd Qu.:  5.00   3rd Qu.: 9.000   3rd Qu.: 2.000   3rd Qu.:33.00  \n Max.   :117.00   Max.   :91.000   Max.   :11.000   Max.   :74.00  \n NA's   :144      NA's   :144      NA's   :144      NA's   :144    \n UNIVERSITY_COUNT \n Min.   :0.00000  \n 1st Qu.:0.00000  \n Median :0.00000  \n Mean   :0.01249  \n 3rd Qu.:0.00000  \n Max.   :1.00000  \n NA's   :144      \n\n\nThe code chunk below will be used to replace zero values to 0.99 for the propulsive and attractiveness variables.\n\nflow_data$SCHOOL_COUNT &lt;- ifelse(\n  flow_data$SCHOOL_COUNT == 0,\n  0.99, flow_data$SCHOOL_COUNT)\nflow_data$BUSINESS_COUNT &lt;- ifelse(\n  flow_data$BUSINESS_COUNT == 0,\n  0.99, flow_data$BUSINESS_COUNT)\nflow_data$FINANCE_COUNT &lt;- ifelse(\n  flow_data$FINANCE_COUNT == 0,\n  0.99, flow_data$FINANCE_COUNT)\nflow_data$TRAIN_COUNT &lt;- ifelse(\n  flow_data$TRAIN_COUNT == 0,\n  0.99, flow_data$TRAIN_COUNT)\nflow_data$HDB_COUNT &lt;- ifelse(\n  flow_data$HDB_COUNT == 0,\n  0.99, flow_data$HDB_COUNT)\nflow_data$UNIVERSITY_COUNT&lt;- ifelse(\n  flow_data$UNIVERSITY_COUNT == 0,\n  0.99, flow_data$UNIVERSITY_COUNT)\n\n\nsummary(flow_data)\n\n     FID.x          FID.y       MORNING_PEAK      SCHOOL_COUNT  \n Min.   :   1   Min.   :   1   Min.   :    1.0   Min.   :0.990  \n 1st Qu.:1338   1st Qu.:1337   1st Qu.:    7.0   1st Qu.:0.990  \n Median :1709   Median :1723   Median :   34.0   Median :0.990  \n Mean   :1689   Mean   :1682   Mean   :  343.3   Mean   :1.119  \n 3rd Qu.:2049   3rd Qu.:2033   3rd Qu.:  160.0   3rd Qu.:1.000  \n Max.   :2951   Max.   :2951   Max.   :74894.0   Max.   :5.000  \n                                                 NA's   :144    \n BUSINESS_COUNT    FINANCE_COUNT     TRAIN_COUNT       HDB_COUNT    \n Min.   :  0.990   Min.   : 0.990   Min.   : 0.990   Min.   : 0.99  \n 1st Qu.:  0.990   1st Qu.: 1.000   1st Qu.: 0.990   1st Qu.: 0.99  \n Median :  1.000   Median : 4.000   Median : 0.990   Median :13.00  \n Mean   :  6.293   Mean   : 8.375   Mean   : 1.951   Mean   :19.33  \n 3rd Qu.:  5.000   3rd Qu.: 9.000   3rd Qu.: 2.000   3rd Qu.:33.00  \n Max.   :117.000   Max.   :91.000   Max.   :11.000   Max.   :74.00  \n NA's   :144       NA's   :144      NA's   :144      NA's   :144    \n UNIVERSITY_COUNT\n Min.   :0.9900  \n 1st Qu.:0.9900  \n Median :0.9900  \n Mean   :0.9901  \n 3rd Qu.:0.9900  \n Max.   :1.0000  \n NA's   :144     \n\n\nNext I will remove duplicate record:\n\nduplicate &lt;- flow_data %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\n\nflow_data &lt;- unique(flow_data)\n\n\nsummary(flow_data)\n\n     FID.x          FID.y       MORNING_PEAK      SCHOOL_COUNT  \n Min.   :   1   Min.   :   1   Min.   :    1.0   Min.   :0.990  \n 1st Qu.:1313   1st Qu.:1318   1st Qu.:    6.0   1st Qu.:0.990  \n Median :1702   Median :1700   Median :   31.0   Median :0.990  \n Mean   :1674   Mean   :1669   Mean   :  300.4   Mean   :1.098  \n 3rd Qu.:2032   3rd Qu.:2026   3rd Qu.:  143.0   3rd Qu.:1.000  \n Max.   :2951   Max.   :2951   Max.   :74894.0   Max.   :5.000  \n                                                 NA's   :144    \n BUSINESS_COUNT    FINANCE_COUNT     TRAIN_COUNT       HDB_COUNT    \n Min.   :  0.990   Min.   : 0.990   Min.   : 0.990   Min.   : 0.99  \n 1st Qu.:  0.990   1st Qu.: 0.990   1st Qu.: 0.990   1st Qu.: 0.99  \n Median :  1.000   Median : 2.000   Median : 0.990   Median : 6.00  \n Mean   :  5.881   Mean   : 7.324   Mean   : 1.773   Mean   :15.52  \n 3rd Qu.:  5.000   3rd Qu.: 7.000   3rd Qu.: 2.000   3rd Qu.:27.00  \n Max.   :117.000   Max.   :91.000   Max.   :11.000   Max.   :74.00  \n NA's   :144       NA's   :144      NA's   :144      NA's   :144    \n UNIVERSITY_COUNT\n Min.   :0.9900  \n 1st Qu.:0.9900  \n Median :0.9900  \n Mean   :0.9901  \n 3rd Qu.:0.9900  \n Max.   :1.0000  \n NA's   :144     \n\n\nI will save flow_data sf tibble data.frame into an rds file and call the file flow_data_tidy.\n\nwrite_rds(flow_data,\n          \"data/rds/flow_data_tidy.rds\")\n\nThe explanatory variables to be used in the Spatial Interaction Modelling will be :\n\nBusiness\nFinance Service\nTrain Station Exit Layer\nHDB\nSchool Directory and information\nUniversity"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#converting-from-sf-data.table-to-spatialpolygonsdataframe",
    "href": "take_home_ex2/take_home_ex2.html#converting-from-sf-data.table-to-spatialpolygonsdataframe",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "7.1 Converting from sf data.table to SpatialPolygonsDataFrame",
    "text": "7.1 Converting from sf data.table to SpatialPolygonsDataFrame\nFirst as.Spatial() will be used to convert hexagon_busstop from sf tibble data frame to SpatialPolygonsDataFrame of sp object as shown in the code chunk below\n\nhexagon_busstop_sp &lt;- as(hexagon_busstop, \"Spatial\")\nhexagon_busstop_sp\n\nclass       : SpatialPolygonsDataFrame \nfeatures    : 5152 \nextent      : 3320.122, 48495.12, 26106.82, 50499.87  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 10\nnames       :  FID, BUS_STOP_N, BUS_ROOF_N,       LOC_DESC, BUSINESS_COUNT, FINANCE_COUNT, TRAIN_COUNT, HDB_COUNT, SCHOOL_COUNT, UNIVERSITY_COUNT \nmin values  :    1,      01012,        B01,  18 WOODSVILLE,              0,             0,           0,         0,            0,                0 \nmax values  : 2951,      99189,        UNK, ZUELLIG PHARMA,            117,            91,          11,        74,            5,                1"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#computing-the-distance-matrix",
    "href": "take_home_ex2/take_home_ex2.html#computing-the-distance-matrix",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "7.2 Computing the distance matrix",
    "text": "7.2 Computing the distance matrix\nNext, spDists() of sp package will be used to compute the Euclidean distance between the centroids of the hexagon layer.\n\ndist &lt;- spDists(hexagon_busstop_sp, \n                longlat = FALSE)\nhead(dist, n=c(10, 10))\n\n          [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]\n [1,]    0.000  650.000 2343.608 1125.833 1125.833 2978.674 4059.249 1719.738\n [2,]  650.000    0.000 2251.666  650.000  650.000 2833.284 3953.796 1300.000\n [3,] 2343.608 2251.666    0.000 1719.738 1719.738  650.000 1719.738 1300.000\n [4,] 1125.833  650.000 1719.738    0.000    0.000 2251.666 3377.499  650.000\n [5,] 1125.833  650.000 1719.738    0.000    0.000 2251.666 3377.499  650.000\n [6,] 2978.674 2833.284  650.000 2251.666 2251.666    0.000 1125.833 1719.738\n [7,] 4059.249 3953.796 1719.738 3377.499 3377.499 1125.833    0.000 2833.284\n [8,] 1719.738 1300.000 1300.000  650.000  650.000 1719.738 2833.284    0.000\n [9,] 2600.000 2343.608  650.000 1719.738 1719.738  650.000 1719.738 1125.833\n[10,] 2600.000 2343.608  650.000 1719.738 1719.738  650.000 1719.738 1125.833\n          [,9]    [,10]\n [1,] 2600.000 2600.000\n [2,] 2343.608 2343.608\n [3,]  650.000  650.000\n [4,] 1719.738 1719.738\n [5,] 1719.738 1719.738\n [6,]  650.000  650.000\n [7,] 1719.738 1719.738\n [8,] 1125.833 1125.833\n [9,]    0.000    0.000\n[10,]    0.000    0.000\n\n\nNext, I will rename column and rows based on FID\n\nsz_names &lt;- hexagon_busstop$FID\n\n\ncolnames(dist) &lt;- paste0(sz_names)\nrownames(dist) &lt;- paste0(sz_names)\n\nNext, I will pivot the distance matrix into a long table by using the row and column subzone codes as show in the code chunk below.\n\ndistPair &lt;- melt(dist) %&gt;%\n  rename(dist = value)\nhead(distPair, 10)\n\n   Var1 Var2     dist\n1     1    1    0.000\n2    44    1  650.000\n3    46    1 2343.608\n4    66    1 1125.833\n5    66    1 1125.833\n6    68    1 2978.674\n7    69    1 4059.249\n8    88    1 1719.738\n9    89    1 2600.000\n10   89    1 2600.000\n\n\nTo update the intra-zonal distances, I will select and find out the minimum value of the distance by using summary().\n\ndistPair %&gt;%\n  filter(dist &gt; 0) %&gt;%\n  summary()\n\n      Var1           Var2           dist      \n Min.   :   1   Min.   :   1   Min.   :  650  \n 1st Qu.:1086   1st Qu.:1086   1st Qu.: 7881  \n Median :1618   Median :1618   Median :12654  \n Mean   :1547   Mean   :1547   Mean   :13322  \n 3rd Qu.:2030   3rd Qu.:2030   3rd Qu.:17884  \n Max.   :2951   Max.   :2951   Max.   :44982  \n\n\nNext, a constant distance value of 300m is added into intra-zones distance.\n\ndistPair$dist &lt;- ifelse(distPair$dist == 0,\n                        300, distPair$dist)\n\n\n\n\n\n\n\nNote\n\n\n\n300m is used as half of the minimum distance of 650m is around 300m\n\n\nThe code chunk below will be used to check the result data.frame.\n\ndistPair %&gt;%\n  summary()\n\n      Var1           Var2           dist      \n Min.   :   1   Min.   :   1   Min.   :  300  \n 1st Qu.:1087   1st Qu.:1087   1st Qu.: 7881  \n Median :1618   Median :1618   Median :12654  \n Mean   :1547   Mean   :1547   Mean   :13305  \n 3rd Qu.:2030   3rd Qu.:2030   3rd Qu.:17884  \n Max.   :2951   Max.   :2951   Max.   :44982  \n\n\nThe code chunk below is used to rename the origin and destination fields.\n\ndistPair &lt;- distPair %&gt;%\n  rename(orig = Var1,\n         dest = Var2)\n\nLastly, the code chunk below is used to save the dataframe for future use.\n\nwrite_rds(distPair, \"data/rds/distPair.rds\")"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#preparing-flow-data",
    "href": "take_home_ex2/take_home_ex2.html#preparing-flow-data",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "8.1 Preparing Flow Data",
    "text": "8.1 Preparing Flow Data\n\nhead(flow_data, 10)\n\n# A tibble: 10 × 9\n# Groups:   FID.x [2]\n   FID.x FID.y MORNING_PEAK SCHOOL_COUNT BUSINESS_COUNT FINANCE_COUNT\n   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;\n 1     1    89            1         0.99          50             1   \n 2     1   110            1         0.99           4             0.99\n 3     1   152            4         0.99           9             0.99\n 4     1   179           93         0.99          36             0.99\n 5     1   200            3         0.99          28             0.99\n 6     1   202            1         0.99           0.99          0.99\n 7    44    89            1         0.99          50             1   \n 8    44   110            1         0.99           4             0.99\n 9    44   152            4         0.99           9             0.99\n10    44   179           93         0.99          36             0.99\n# ℹ 3 more variables: TRAIN_COUNT &lt;dbl&gt;, HDB_COUNT &lt;dbl&gt;,\n#   UNIVERSITY_COUNT &lt;dbl&gt;\n\n\n\n8.1.1 Separating intra-flow from passenger volume df\nCode chunk below is used to add three new fields in flow_data dataframe.\n\nflow_data$FlowNoIntra &lt;- ifelse(\n  flow_data$FID.x == flow_data$FID.y, \n  0, flow_data$MORNING_PEAK)\nflow_data$offset &lt;- ifelse(\n  flow_data$FID.x == flow_data$FID.y, \n  0.000001, 1)\n\n\n\n8.1.2 Combining flow data with distance value\n\nflow_data$FID.x &lt;- as.factor(flow_data$FID.x)\nflow_data$FID.y &lt;- as.factor(flow_data$FID.y)\n\nNow, left_join() of dplyr will be used to flow_data dataframe and distPair dataframe. The output is called flow_data1.\n\nflow_data$FID.x &lt;- as.integer(as.character(flow_data$FID.x))\nflow_data$FID.y &lt;- as.integer(as.character(flow_data$FID.y))\n\n\nflow_data1 &lt;- flow_data %&gt;%\n  left_join (distPair,\n             by = c(\"FID.x\" = \"orig\",\n                    \"FID.y\" = \"dest\"))\n\nI will remove duplicate\n\nduplicate &lt;- flow_data1 %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\n\nflow_data1 &lt;- unique(flow_data1)\n\nI will called the output data file SIM_data. I will save the file to rds data file format.\n\nwrite_rds(flow_data1, \"data/rds/SIM_data.rds\")"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#calibrating-spatial-interaction-models",
    "href": "take_home_ex2/take_home_ex2.html#calibrating-spatial-interaction-models",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "8.2 Calibrating Spatial Interaction Models",
    "text": "8.2 Calibrating Spatial Interaction Models\n\n8.2.1 Importing the modelling data\nI import back SIM_data\n\nSIM_data &lt;- read_rds(\"data/rds/SIM_data.rds\")\n\n\n\n8.2.2 Visualising the dependent variable\nI will do a visualisation to understand why poisson regression will be used:\n\nggplot(data = SIM_data,\n       aes(x = MORNING_PEAK)) +\n  geom_histogram()\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\nNotice that the distribution is highly skewed and not resemble bell shape or normal distribution.\nNext, let us visualise the relation between the dependent variable and one of the key independent variable in Spatial Interaction Model, namely distance.\n\nggplot(data = SIM_data,\n       aes(x = dist,\n           y = MORNING_PEAK)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\nWarning: Removed 251 rows containing non-finite values (`stat_smooth()`).\n\n\nWarning: Removed 251 rows containing missing values (`geom_point()`).\n\n\n\n\n\nThe relationship hardly resemble linear relationship.\nI will further plot the scatter plot by using the log transformed version of both variables, I can see that their relationship is more resemble linear relationship.\n\nggplot(data = SIM_data,\n       aes(x = log(dist),\n           y = log(MORNING_PEAK))) +\n  geom_point() +\n  geom_smooth(method = lm)\n\n`geom_smooth()` using formula = 'y ~ x'\n\n\nWarning: Removed 251 rows containing non-finite values (`stat_smooth()`).\n\n\nWarning: Removed 251 rows containing missing values (`geom_point()`).\n\n\n\n\n\n\n\n8.2.3 Checking for variables with zero values\nSince Poisson Regression is based of log and log 0 is undefined, it is important to ensure that no 0 values in the explanatory variables.\nIn the code chunk below, summary() of Base R is used to compute the summary statistics of all variables in SIM_data data frame.\n\nsummary(SIM_data)\n\n     FID.x          FID.y       MORNING_PEAK      SCHOOL_COUNT  \n Min.   :   1   Min.   :   1   Min.   :    1.0   Min.   :0.990  \n 1st Qu.:1313   1st Qu.:1318   1st Qu.:    6.0   1st Qu.:0.990  \n Median :1702   Median :1700   Median :   31.0   Median :0.990  \n Mean   :1674   Mean   :1669   Mean   :  300.4   Mean   :1.098  \n 3rd Qu.:2032   3rd Qu.:2026   3rd Qu.:  143.0   3rd Qu.:1.000  \n Max.   :2951   Max.   :2951   Max.   :74894.0   Max.   :5.000  \n                                                 NA's   :144    \n BUSINESS_COUNT    FINANCE_COUNT     TRAIN_COUNT       HDB_COUNT    \n Min.   :  0.990   Min.   : 0.990   Min.   : 0.990   Min.   : 0.99  \n 1st Qu.:  0.990   1st Qu.: 0.990   1st Qu.: 0.990   1st Qu.: 0.99  \n Median :  1.000   Median : 2.000   Median : 0.990   Median : 6.00  \n Mean   :  5.881   Mean   : 7.324   Mean   : 1.773   Mean   :15.52  \n 3rd Qu.:  5.000   3rd Qu.: 7.000   3rd Qu.: 2.000   3rd Qu.:27.00  \n Max.   :117.000   Max.   :91.000   Max.   :11.000   Max.   :74.00  \n NA's   :144       NA's   :144      NA's   :144      NA's   :144    \n UNIVERSITY_COUNT  FlowNoIntra          offset              dist      \n Min.   :0.9900   Min.   :    0.0   Min.   :0.000001   Min.   :  300  \n 1st Qu.:0.9900   1st Qu.:    6.0   1st Qu.:1.000000   1st Qu.: 2833  \n Median :0.9900   Median :   30.0   Median :1.000000   Median : 5159  \n Mean   :0.9901   Mean   :  292.6   Mean   :0.991650   Mean   : 6019  \n 3rd Qu.:0.9900   3rd Qu.:  139.0   3rd Qu.:1.000000   3rd Qu.: 8500  \n Max.   :1.0000   Max.   :74894.0   Max.   :1.000000   Max.   :25082  \n NA's   :144                                           NA's   :251    \n\n\nSince we have replaced the zero values. No further action is required.\nNow, I will change FID.x and FID.y to character. Both must be in categorical data type to do poisson regression:\n\nSIM_data$FID.x &lt;- as.character(SIM_data$FID.x)\nSIM_data$FID.y &lt;- as.character(SIM_data$FID.y)\n\nInter-zonal flow will be selected from flow_data and save into a new output data.frame called inter_zonal_flow by using the code chunk below.\n\ninter_zonal_flow &lt;- SIM_data %&gt;%\n  filter(FlowNoIntra &gt; 0)\n\n\nsummary(inter_zonal_flow)\n\n    FID.x              FID.y            MORNING_PEAK      SCHOOL_COUNT  \n Length:83965       Length:83965       Min.   :    1.0   Min.   :0.990  \n Class :character   Class :character   1st Qu.:    6.0   1st Qu.:0.990  \n Mode  :character   Mode  :character   Median :   31.0   Median :0.990  \n                                       Mean   :  295.1   Mean   :1.098  \n                                       3rd Qu.:  140.0   3rd Qu.:1.000  \n                                       Max.   :74894.0   Max.   :5.000  \n                                                         NA's   :144    \n BUSINESS_COUNT    FINANCE_COUNT     TRAIN_COUNT       HDB_COUNT    \n Min.   :  0.990   Min.   : 0.990   Min.   : 0.990   Min.   : 0.99  \n 1st Qu.:  0.990   1st Qu.: 0.990   1st Qu.: 0.990   1st Qu.: 0.99  \n Median :  1.000   Median : 2.000   Median : 0.990   Median : 6.00  \n Mean   :  5.875   Mean   : 7.347   Mean   : 1.776   Mean   :15.51  \n 3rd Qu.:  5.000   3rd Qu.: 7.000   3rd Qu.: 2.000   3rd Qu.:27.00  \n Max.   :117.000   Max.   :91.000   Max.   :11.000   Max.   :74.00  \n NA's   :144       NA's   :144      NA's   :144      NA's   :144    \n UNIVERSITY_COUNT  FlowNoIntra          offset       dist      \n Min.   :0.9900   Min.   :    1.0   Min.   :1   Min.   :  650  \n 1st Qu.:0.9900   1st Qu.:    6.0   1st Qu.:1   1st Qu.: 2833  \n Median :0.9900   Median :   31.0   Median :1   Median : 5159  \n Mean   :0.9901   Mean   :  295.1   Mean   :1   Mean   : 6068  \n 3rd Qu.:0.9900   3rd Qu.:  140.0   3rd Qu.:1   3rd Qu.: 8500  \n Max.   :1.0000   Max.   :74894.0   Max.   :1   Max.   :25082  \n NA's   :144                                    NA's   :251    \n\n\nRemove NA:\n\ninter_zonal_flow &lt;- na.omit(inter_zonal_flow)\n\n\nsummary(inter_zonal_flow)\n\n    FID.x              FID.y            MORNING_PEAK      SCHOOL_COUNT  \n Length:83714       Length:83714       Min.   :    1.0   Min.   :0.990  \n Class :character   Class :character   1st Qu.:    6.0   1st Qu.:0.990  \n Mode  :character   Mode  :character   Median :   31.0   Median :0.990  \n                                       Mean   :  295.5   Mean   :1.098  \n                                       3rd Qu.:  141.0   3rd Qu.:1.000  \n                                       Max.   :74894.0   Max.   :5.000  \n BUSINESS_COUNT    FINANCE_COUNT     TRAIN_COUNT       HDB_COUNT    \n Min.   :  0.990   Min.   : 0.990   Min.   : 0.990   Min.   : 0.99  \n 1st Qu.:  0.990   1st Qu.: 0.990   1st Qu.: 0.990   1st Qu.: 0.99  \n Median :  1.000   Median : 2.000   Median : 0.990   Median : 6.00  \n Mean   :  5.873   Mean   : 7.344   Mean   : 1.775   Mean   :15.51  \n 3rd Qu.:  5.000   3rd Qu.: 7.000   3rd Qu.: 2.000   3rd Qu.:27.00  \n Max.   :117.000   Max.   :91.000   Max.   :11.000   Max.   :74.00  \n UNIVERSITY_COUNT  FlowNoIntra          offset       dist      \n Min.   :0.9900   Min.   :    1.0   Min.   :1   Min.   :  650  \n 1st Qu.:0.9900   1st Qu.:    6.0   1st Qu.:1   1st Qu.: 2833  \n Median :0.9900   Median :   31.0   Median :1   Median : 5159  \n Mean   :0.9901   Mean   :  295.5   Mean   :1   Mean   : 6068  \n 3rd Qu.:0.9900   3rd Qu.:  141.0   3rd Qu.:1   3rd Qu.: 8500  \n Max.   :1.0000   Max.   :74894.0   Max.   :1   Max.   :25082  \n\n\n\n\n8.2.3 Correlation Analysis\nBefore I proceed to do SIM, I will determine if there are any correlations between the variables.\nI will first ensure all columns are numeric:\n\ninter_zonal_flow$SCHOOL_COUNT&lt;- as.numeric(inter_zonal_flow$SCHOOL_COUNT)\n\ninter_zonal_flow$BUSINESS_COUNT&lt;- as.numeric(inter_zonal_flow$BUSINESS_COUNT)\n\ninter_zonal_flow$HDB_COUNT&lt;- as.numeric(inter_zonal_flow$HDB_COUNT)\n\ninter_zonal_flow$TRAIN_COUNT&lt;- as.numeric(inter_zonal_flow$TRAIN_COUNT)\n\ninter_zonal_flow$FINANCE_COUNT&lt;- as.numeric(inter_zonal_flow$FINANCE_COUNT)\n\ninter_zonal_flow$UNIVERSITY_COUNT&lt;- as.numeric(inter_zonal_flow$UNIVERSITY_COUNT)\n\ninter_zonal_flow$MORNING_PEAK&lt;- as.numeric(inter_zonal_flow$MORNING_PEAK)\n\n\nvars.cor = cor(inter_zonal_flow[,3:9])\ncorrplot.mixed(vars.cor,\n         lower = \"ellipse\", \n               upper = \"number\",\n               tl.pos = \"lt\",\n               diag = \"l\",\n               tl.col = \"black\")\n\n\n\n\nFINANCE_COUNT and TRAIN_COUNT seems to be correlated (R = 0.64), I will remove FINANCE_COUNT in the final analysis."
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#unconstrained-spatial-interaction-model",
    "href": "take_home_ex2/take_home_ex2.html#unconstrained-spatial-interaction-model",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "8.3 Unconstrained Spatial Interaction Model",
    "text": "8.3 Unconstrained Spatial Interaction Model\nThe code chunk used to calibrate to model is shown below:\n\nuncSIM &lt;- glm(formula = MORNING_PEAK ~ \n                  log(SCHOOL_COUNT)+\n                  log(BUSINESS_COUNT)+\n                  log(HDB_COUNT)+\n                  log(TRAIN_COUNT)+\n                  log(UNIVERSITY_COUNT)+\n                  log(dist),\n              family = poisson(link = \"log\"),\n              data = inter_zonal_flow,\n              na.action = na.exclude)\nuncSIM\n\n\nCall:  glm(formula = MORNING_PEAK ~ log(SCHOOL_COUNT) + log(BUSINESS_COUNT) + \n    log(HDB_COUNT) + log(TRAIN_COUNT) + log(UNIVERSITY_COUNT) + \n    log(dist), family = poisson(link = \"log\"), data = inter_zonal_flow, \n    na.action = na.exclude)\n\nCoefficients:\n          (Intercept)      log(SCHOOL_COUNT)    log(BUSINESS_COUNT)  \n             15.65483                0.14519                0.01229  \n       log(HDB_COUNT)       log(TRAIN_COUNT)  log(UNIVERSITY_COUNT)  \n              0.14748                0.67031                5.69327  \n            log(dist)  \n             -1.31839  \n\nDegrees of Freedom: 83713 Total (i.e. Null);  83707 Residual\nNull Deviance:      99390000 \nResidual Deviance: 61920000     AIC: 62360000\n\n\n\nCalcRSquared &lt;- function(observed, estimated){\n  r &lt;- cor(observed, estimated)\n  R2 &lt;- r^2\n  R2\n}\n\n\n8.3.1 Goodness of fit\n\nCalcRSquared(uncSIM$data$MORNING_PEAK, uncSIM$fitted.values)\n\n[1] 0.1406999"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#origin-production-constrained-sim",
    "href": "take_home_ex2/take_home_ex2.html#origin-production-constrained-sim",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "8.4 Origin (Production) constrained SIM",
    "text": "8.4 Origin (Production) constrained SIM\nThe code chunk used to calibrate to model is shown below. FID.x is the origin:\n\norcSIM &lt;- glm(formula = MORNING_PEAK ~ \n                  FID.x +\n                  log(SCHOOL_COUNT)+\n                  log(BUSINESS_COUNT)+\n                  log(HDB_COUNT)+\n                  log(TRAIN_COUNT)+\n                  log(UNIVERSITY_COUNT)+\n                  log(dist) - 1,\n              family = poisson(link = \"log\"),\n              data = inter_zonal_flow,\n              na.action = na.exclude)\nsummary(orcSIM)\n\n\nCall:\nglm(formula = MORNING_PEAK ~ FID.x + log(SCHOOL_COUNT) + log(BUSINESS_COUNT) + \n    log(HDB_COUNT) + log(TRAIN_COUNT) + log(UNIVERSITY_COUNT) + \n    log(dist) - 1, family = poisson(link = \"log\"), data = inter_zonal_flow, \n    na.action = na.exclude)\n\nCoefficients:\n                        Estimate Std. Error   z value Pr(&gt;|z|)    \nFID.x1                13.9898150  0.0985764   141.919   &lt;2e-16 ***\nFID.x1000             16.1400287  0.0066001  2445.440   &lt;2e-16 ***\nFID.x1001             16.7351006  0.0051355  3258.687   &lt;2e-16 ***\nFID.x1002             16.7886048  0.0060556  2772.429   &lt;2e-16 ***\nFID.x1003             18.1174859  0.0046711  3878.646   &lt;2e-16 ***\nFID.x1005             13.6247719  0.0378686   359.791   &lt;2e-16 ***\nFID.x1006             14.3647157  0.0263934   544.254   &lt;2e-16 ***\nFID.x1014             13.1463910  0.0661416   198.761   &lt;2e-16 ***\nFID.x1015             10.9699313  0.2085329    52.605   &lt;2e-16 ***\nFID.x1016             15.3483956  0.0118783  1292.140   &lt;2e-16 ***\nFID.x1017             14.5580621  0.0185602   784.368   &lt;2e-16 ***\nFID.x1018             17.0864967  0.0066758  2559.458   &lt;2e-16 ***\nFID.x1019             17.3128570  0.0040002  4328.018   &lt;2e-16 ***\nFID.x1020             17.0130253  0.0062564  2719.319   &lt;2e-16 ***\nFID.x1021             16.1002082  0.0074026  2174.939   &lt;2e-16 ***\nFID.x1022             16.0980587  0.0071624  2247.568   &lt;2e-16 ***\nFID.x1023             13.4016427  0.0423884   316.163   &lt;2e-16 ***\nFID.x1024             16.3974161  0.0067103  2443.621   &lt;2e-16 ***\nFID.x1025             12.7406200  0.0720337   176.870   &lt;2e-16 ***\nFID.x1026             14.1642510  0.0277843   509.794   &lt;2e-16 ***\nFID.x1036             13.1788363  0.0522020   252.458   &lt;2e-16 ***\nFID.x1037             14.6358858  0.0162773   899.161   &lt;2e-16 ***\nFID.x1038             16.4017379  0.0071550  2292.342   &lt;2e-16 ***\nFID.x1039             12.9193092  0.0651512   198.297   &lt;2e-16 ***\nFID.x1040             16.3528433  0.0072512  2255.201   &lt;2e-16 ***\nFID.x1041             16.5719184  0.0058727  2821.865   &lt;2e-16 ***\nFID.x1043             14.5017308  0.0152457   951.203   &lt;2e-16 ***\nFID.x1044             16.5136628  0.0074114  2228.144   &lt;2e-16 ***\nFID.x1045             15.4640360  0.0093352  1656.524   &lt;2e-16 ***\nFID.x1046             14.7697983  0.0159365   926.790   &lt;2e-16 ***\nFID.x1047             14.3646770  0.0215015   668.077   &lt;2e-16 ***\nFID.x1048             11.8819820  0.0894839   132.783   &lt;2e-16 ***\nFID.x1049             14.7698856  0.0219977   671.428   &lt;2e-16 ***\nFID.x1058             15.8371147  0.0138930  1139.938   &lt;2e-16 ***\nFID.x1059             15.5487746  0.0100885  1541.233   &lt;2e-16 ***\nFID.x1060             14.3300829  0.0169112   847.372   &lt;2e-16 ***\nFID.x1061             15.4316017  0.0102343  1507.837   &lt;2e-16 ***\nFID.x1062             17.0600370  0.0044726  3814.386   &lt;2e-16 ***\nFID.x1065             16.5912864  0.0049435  3356.189   &lt;2e-16 ***\nFID.x1066             16.4364191  0.0057877  2839.866   &lt;2e-16 ***\nFID.x1067             14.5214893  0.0196278   739.842   &lt;2e-16 ***\nFID.x1068             16.3559595  0.0075094  2178.076   &lt;2e-16 ***\nFID.x1069             12.9808406  0.1026368   126.474   &lt;2e-16 ***\nFID.x1070             12.1287477  0.0741742   163.517   &lt;2e-16 ***\nFID.x1079             15.5337952  0.0130000  1194.905   &lt;2e-16 ***\nFID.x1080             16.5183791  0.0057727  2861.469   &lt;2e-16 ***\nFID.x1081             16.5799559  0.0059126  2804.182   &lt;2e-16 ***\nFID.x1082             14.5351303  0.0163892   886.871   &lt;2e-16 ***\nFID.x1083             16.6466652  0.0060374  2757.272   &lt;2e-16 ***\nFID.x1084             16.1780171  0.0068663  2356.139   &lt;2e-16 ***\nFID.x1086             14.5941277  0.0139229  1048.207   &lt;2e-16 ***\nFID.x1087             16.4723726  0.0055267  2980.521   &lt;2e-16 ***\nFID.x1090             13.3147149  0.0544590   244.490   &lt;2e-16 ***\nFID.x1091             17.8401806  0.0042792  4169.089   &lt;2e-16 ***\nFID.x1092             16.5808728  0.0094181  1760.533   &lt;2e-16 ***\nFID.x110              13.4848155  0.0811591   166.153   &lt;2e-16 ***\nFID.x1100             15.4539493  0.0134536  1148.686   &lt;2e-16 ***\nFID.x1101             17.1631737  0.0046495  3691.439   &lt;2e-16 ***\nFID.x1102             18.0933484  0.0033616  5382.368   &lt;2e-16 ***\nFID.x1103             14.9430350  0.0208921   715.249   &lt;2e-16 ***\nFID.x1104             14.2778973  0.0196555   726.406   &lt;2e-16 ***\nFID.x1105             14.8759260  0.0122303  1216.318   &lt;2e-16 ***\nFID.x1106             16.7525458  0.0057800  2898.377   &lt;2e-16 ***\nFID.x1107             14.9445054  0.0117864  1267.941   &lt;2e-16 ***\nFID.x1108             17.4933813  0.0038556  4537.097   &lt;2e-16 ***\nFID.x1109             15.8909009  0.0096761  1642.285   &lt;2e-16 ***\nFID.x111              15.1727093  0.0185262   818.987   &lt;2e-16 ***\nFID.x1111             13.2856867  0.0563200   235.897   &lt;2e-16 ***\nFID.x1113             12.3481923  0.0833779   148.099   &lt;2e-16 ***\nFID.x1114             12.9468331  0.0604729   214.093   &lt;2e-16 ***\nFID.x112              11.5554992  0.1690538    68.354   &lt;2e-16 ***\nFID.x1121             15.4100208  0.0103894  1483.245   &lt;2e-16 ***\nFID.x1122             15.6125696  0.0105340  1482.109   &lt;2e-16 ***\nFID.x1123             16.6967351  0.0046048  3625.938   &lt;2e-16 ***\nFID.x1124             16.9748952  0.0066713  2544.464   &lt;2e-16 ***\nFID.x1126             14.6463696  0.0182869   800.923   &lt;2e-16 ***\nFID.x1128             16.0746913  0.0069570  2310.580   &lt;2e-16 ***\nFID.x1129             14.4460394  0.0181459   796.103   &lt;2e-16 ***\nFID.x113              16.1501718  0.0126816  1273.512   &lt;2e-16 ***\nFID.x1130             16.5485076  0.0056005  2954.831   &lt;2e-16 ***\nFID.x1133             13.7758534  0.2672766    51.542   &lt;2e-16 ***\nFID.x1136              8.7733620  1.0000040     8.773   &lt;2e-16 ***\nFID.x114              12.3728689  0.0642104   192.693   &lt;2e-16 ***\nFID.x1143             15.4679811  0.0089098  1736.056   &lt;2e-16 ***\nFID.x1144             16.3061782  0.0064893  2512.791   &lt;2e-16 ***\nFID.x1145             16.2172932  0.0064063  2531.466   &lt;2e-16 ***\nFID.x1147             15.2772863  0.0124167  1230.380   &lt;2e-16 ***\nFID.x1148             15.4923626  0.0086361  1793.902   &lt;2e-16 ***\nFID.x1149             15.6622653  0.0086089  1819.314   &lt;2e-16 ***\nFID.x1151             17.3512761  0.0041417  4189.459   &lt;2e-16 ***\nFID.x1152             17.6854046  0.0049486  3573.788   &lt;2e-16 ***\nFID.x1154             12.8062889  0.0857935   149.269   &lt;2e-16 ***\nFID.x1156             13.7890684  0.0298254   462.327   &lt;2e-16 ***\nFID.x1157             14.7925528  0.0143631  1029.898   &lt;2e-16 ***\nFID.x1158             18.9120554  0.0041951  4508.155   &lt;2e-16 ***\nFID.x1164             15.1929254  0.0111883  1357.926   &lt;2e-16 ***\nFID.x1165             14.6686971  0.0159964   917.002   &lt;2e-16 ***\nFID.x1166             16.7857911  0.0048175  3484.360   &lt;2e-16 ***\nFID.x1167             15.9486751  0.0070658  2257.168   &lt;2e-16 ***\nFID.x1169             16.2811593  0.0060655  2684.216   &lt;2e-16 ***\nFID.x1170             14.5273536  0.0157835   920.413   &lt;2e-16 ***\nFID.x1171             14.2422717  0.0293721   484.891   &lt;2e-16 ***\nFID.x1172             16.2136477  0.0077462  2093.108   &lt;2e-16 ***\nFID.x1173             16.8949523  0.0063448  2662.794   &lt;2e-16 ***\nFID.x1178             17.2081801  0.0047988  3585.941   &lt;2e-16 ***\nFID.x1179             18.1959330  0.0037446  4859.197   &lt;2e-16 ***\nFID.x1186             13.9732502  0.0318370   438.900   &lt;2e-16 ***\nFID.x1187             14.4502961  0.0193511   746.744   &lt;2e-16 ***\nFID.x1188             15.5416585  0.0111055  1399.451   &lt;2e-16 ***\nFID.x1189             14.7385088  0.0135112  1090.840   &lt;2e-16 ***\nFID.x1190             16.2664642  0.0059360  2740.285   &lt;2e-16 ***\nFID.x1191             14.9044952  0.0130502  1142.087   &lt;2e-16 ***\nFID.x1193             16.2053627  0.0098830  1639.720   &lt;2e-16 ***\nFID.x1194             17.4200160  0.0046391  3755.080   &lt;2e-16 ***\nFID.x1197             14.6482815  0.0246062   595.308   &lt;2e-16 ***\nFID.x1199             16.4849524  0.0078290  2105.621   &lt;2e-16 ***\nFID.x1200             16.9162008  0.0052963  3193.945   &lt;2e-16 ***\nFID.x1207             15.1321296  0.0112419  1346.045   &lt;2e-16 ***\nFID.x1208             14.0029515  0.0282744   495.253   &lt;2e-16 ***\nFID.x1209             16.4621548  0.0063094  2609.139   &lt;2e-16 ***\nFID.x1210             15.3987213  0.0097000  1587.502   &lt;2e-16 ***\nFID.x1211             14.4686242  0.0158964   910.180   &lt;2e-16 ***\nFID.x1212             15.9617276  0.0069167  2307.697   &lt;2e-16 ***\nFID.x1221             16.7277359  0.0054713  3057.339   &lt;2e-16 ***\nFID.x1222             17.0035107  0.0057114  2977.125   &lt;2e-16 ***\nFID.x1228             15.0206344  0.0115900  1295.995   &lt;2e-16 ***\nFID.x1229             13.0572720  0.0631638   206.721   &lt;2e-16 ***\nFID.x1230             15.8284675  0.0082923  1908.804   &lt;2e-16 ***\nFID.x1231             15.1658265  0.0144112  1052.366   &lt;2e-16 ***\nFID.x1233             16.5687266  0.0052962  3128.403   &lt;2e-16 ***\nFID.x1240             14.5983166  0.0247311   590.283   &lt;2e-16 ***\nFID.x1242             16.0755060  0.0091456  1757.723   &lt;2e-16 ***\nFID.x1243             16.9452305  0.0054175  3127.888   &lt;2e-16 ***\nFID.x1244             13.1605259  0.0453059   290.481   &lt;2e-16 ***\nFID.x1249             16.6451774  0.0057473  2896.179   &lt;2e-16 ***\nFID.x1250             15.9889723  0.0088489  1806.894   &lt;2e-16 ***\nFID.x1251             16.0463226  0.0079827  2010.139   &lt;2e-16 ***\nFID.x1252             12.7012546  0.0435242   291.820   &lt;2e-16 ***\nFID.x1253             14.5396054  0.0194802   746.380   &lt;2e-16 ***\nFID.x1262             12.1297563  0.1231235    98.517   &lt;2e-16 ***\nFID.x1264             15.9985533  0.0071236  2245.839   &lt;2e-16 ***\nFID.x1265             14.4061013  0.0233938   615.809   &lt;2e-16 ***\nFID.x1270             14.5110135  0.0181073   801.392   &lt;2e-16 ***\nFID.x1271             11.6917376  0.1020969   114.516   &lt;2e-16 ***\nFID.x1272             15.7186798  0.0074531  2109.017   &lt;2e-16 ***\nFID.x1273             16.6483352  0.0053062  3137.527   &lt;2e-16 ***\nFID.x1274             14.3982538  0.0145132   992.082   &lt;2e-16 ***\nFID.x1276             15.6594419  0.0083440  1876.734   &lt;2e-16 ***\nFID.x1285             16.1302808  0.0079365  2032.421   &lt;2e-16 ***\nFID.x1286             18.3403175  0.0033463  5480.719   &lt;2e-16 ***\nFID.x1287             17.9173861  0.0051935  3449.988   &lt;2e-16 ***\nFID.x1292             15.5593587  0.0165369   940.889   &lt;2e-16 ***\nFID.x1293             14.0036355  0.0197878   707.690   &lt;2e-16 ***\nFID.x1294             14.4351542  0.0156271   923.726   &lt;2e-16 ***\nFID.x1295             16.6713233  0.0054563  3055.429   &lt;2e-16 ***\nFID.x1296             14.2783513  0.0189337   754.122   &lt;2e-16 ***\nFID.x1297             14.9592270  0.0111735  1338.818   &lt;2e-16 ***\nFID.x1304             13.6322026  0.0612652   222.511   &lt;2e-16 ***\nFID.x1305             12.5017662  0.0917125   136.315   &lt;2e-16 ***\nFID.x1307             16.8868000  0.0052715  3203.390   &lt;2e-16 ***\nFID.x1308             16.3194969  0.0075483  2162.013   &lt;2e-16 ***\nFID.x1309             16.8538589  0.0074303  2268.268   &lt;2e-16 ***\nFID.x1313             15.8256000  0.0086483  1829.907   &lt;2e-16 ***\nFID.x1314             14.1718637  0.0291822   485.634   &lt;2e-16 ***\nFID.x1315             13.2182828  0.0426872   309.655   &lt;2e-16 ***\nFID.x1316             16.9223070  0.0041852  4043.391   &lt;2e-16 ***\nFID.x1317             13.6050050  0.0283683   479.585   &lt;2e-16 ***\nFID.x1318             14.8657555  0.0137705  1079.535   &lt;2e-16 ***\nFID.x132              13.2469107  0.0870832   152.118   &lt;2e-16 ***\nFID.x1328             16.5484288  0.0076963  2150.192   &lt;2e-16 ***\nFID.x1329             17.0496355  0.0046142  3695.037   &lt;2e-16 ***\nFID.x133              13.4381391  0.0558835   240.467   &lt;2e-16 ***\nFID.x1330             16.1959424  0.0085641  1891.141   &lt;2e-16 ***\nFID.x1336             13.1396295  0.0602567   218.061   &lt;2e-16 ***\nFID.x1337             15.6725408  0.0081958  1912.265   &lt;2e-16 ***\nFID.x1338             15.5565322  0.0077045  2019.150   &lt;2e-16 ***\nFID.x134              15.6359453  0.0244680   639.036   &lt;2e-16 ***\nFID.x1340             16.0692865  0.0066188  2427.824   &lt;2e-16 ***\nFID.x1348             13.8018274  0.0516515   267.211   &lt;2e-16 ***\nFID.x135              11.8017805  0.1162800   101.495   &lt;2e-16 ***\nFID.x1350             16.9894069  0.0050104  3390.843   &lt;2e-16 ***\nFID.x1351             17.4575109  0.0044982  3881.002   &lt;2e-16 ***\nFID.x1352             15.5304890  0.0146625  1059.196   &lt;2e-16 ***\nFID.x1356             14.4641273  0.0153527   942.123   &lt;2e-16 ***\nFID.x1358             14.1859727  0.0136802  1036.975   &lt;2e-16 ***\nFID.x1359             16.3757740  0.0100934  1622.419   &lt;2e-16 ***\nFID.x136              13.0304838  0.0471690   276.251   &lt;2e-16 ***\nFID.x1371             17.1492425  0.0058819  2915.578   &lt;2e-16 ***\nFID.x1372             17.6937884  0.0041355  4278.543   &lt;2e-16 ***\nFID.x1373             16.8409965  0.0058820  2863.156   &lt;2e-16 ***\nFID.x1374             10.9555868  0.3535635    30.986   &lt;2e-16 ***\nFID.x1377             13.9417113  0.0207780   670.986   &lt;2e-16 ***\nFID.x1378             15.0681156  0.0096442  1562.407   &lt;2e-16 ***\nFID.x1379             16.0272274  0.0059688  2685.154   &lt;2e-16 ***\nFID.x1380             16.5712331  0.0046431  3569.028   &lt;2e-16 ***\nFID.x1381             14.6819980  0.0126392  1161.621   &lt;2e-16 ***\nFID.x1383             14.2067016  0.0221351   641.817   &lt;2e-16 ***\nFID.x1391             14.8171895  0.0567800   260.958   &lt;2e-16 ***\nFID.x1393             16.9511085  0.0055304  3065.098   &lt;2e-16 ***\nFID.x1394             16.8503157  0.0053134  3171.312   &lt;2e-16 ***\nFID.x1395             14.6956104  0.0175585   836.950   &lt;2e-16 ***\nFID.x1396             12.9758188  0.0735702   176.373   &lt;2e-16 ***\nFID.x1399             15.4156357  0.0083017  1856.935   &lt;2e-16 ***\nFID.x1400             15.9558457  0.0058898  2709.074   &lt;2e-16 ***\nFID.x1401             16.4433846  0.0053718  3061.030   &lt;2e-16 ***\nFID.x1402             15.3356255  0.0087152  1759.645   &lt;2e-16 ***\nFID.x1403             15.3258508  0.0088088  1739.844   &lt;2e-16 ***\nFID.x1404             14.7186699  0.0128215  1147.969   &lt;2e-16 ***\nFID.x1413             13.0052889  0.0905780   143.581   &lt;2e-16 ***\nFID.x1415             16.6521678  0.0062360  2670.330   &lt;2e-16 ***\nFID.x1416             16.9643400  0.0059322  2859.694   &lt;2e-16 ***\nFID.x1417             15.6710531  0.0113916  1375.672   &lt;2e-16 ***\nFID.x1418              9.8077413  0.4472220    21.930   &lt;2e-16 ***\nFID.x1420             15.9651109  0.0067751  2356.444   &lt;2e-16 ***\nFID.x1421             15.7906467  0.0082933  1904.029   &lt;2e-16 ***\nFID.x1422             15.0194937  0.0093391  1608.236   &lt;2e-16 ***\nFID.x1424             14.9170490  0.0104571  1426.501   &lt;2e-16 ***\nFID.x1433             11.1523376  0.2294319    48.608   &lt;2e-16 ***\nFID.x1434             13.0778043  0.0687380   190.256   &lt;2e-16 ***\nFID.x1437             17.1581942  0.0049891  3439.110   &lt;2e-16 ***\nFID.x1438             14.0991387  0.0397241   354.926   &lt;2e-16 ***\nFID.x1439             14.8648520  0.0166744   891.479   &lt;2e-16 ***\nFID.x1442             16.5324649  0.0068291  2420.897   &lt;2e-16 ***\nFID.x1443             16.2187485  0.0059549  2723.603   &lt;2e-16 ***\nFID.x1444             15.8155548  0.0099948  1582.375   &lt;2e-16 ***\nFID.x1445             13.4293318  0.0244084   550.193   &lt;2e-16 ***\nFID.x1446             15.7309615  0.0073129  2151.119   &lt;2e-16 ***\nFID.x1447             16.0555643  0.0065477  2452.098   &lt;2e-16 ***\nFID.x1459             14.7154864  0.0144013  1021.820   &lt;2e-16 ***\nFID.x1460             14.8570163  0.0197385   752.691   &lt;2e-16 ***\nFID.x1463             16.4635967  0.0053074  3102.006   &lt;2e-16 ***\nFID.x1464             15.0075024  0.0097843  1533.837   &lt;2e-16 ***\nFID.x1465             16.1359942  0.0056568  2852.488   &lt;2e-16 ***\nFID.x1468             15.4524883  0.0082609  1870.560   &lt;2e-16 ***\nFID.x1469             13.8131645  0.0422063   327.277   &lt;2e-16 ***\nFID.x1476             13.6883862  0.0468542   292.148   &lt;2e-16 ***\nFID.x1480             16.2115594  0.0082649  1961.483   &lt;2e-16 ***\nFID.x1481             17.1211846  0.0055532  3083.098   &lt;2e-16 ***\nFID.x1482             15.2142306  0.0124364  1223.362   &lt;2e-16 ***\nFID.x1484             14.9668075  0.0103438  1446.941   &lt;2e-16 ***\nFID.x1485             15.6486390  0.0074328  2105.353   &lt;2e-16 ***\nFID.x1486             15.3404900  0.0080355  1909.100   &lt;2e-16 ***\nFID.x1487             14.5139984  0.0147497   984.019   &lt;2e-16 ***\nFID.x1488             12.8009937  0.0342539   373.709   &lt;2e-16 ***\nFID.x1490             14.6145322  0.0154314   947.063   &lt;2e-16 ***\nFID.x1497             16.9422445  0.0063281  2677.301   &lt;2e-16 ***\nFID.x1501             14.0561516  0.0312296   450.091   &lt;2e-16 ***\nFID.x1502             16.8130161  0.0050165  3351.566   &lt;2e-16 ***\nFID.x1503             13.4156050  0.0380873   352.233   &lt;2e-16 ***\nFID.x1506             14.6483560  0.0239983   610.391   &lt;2e-16 ***\nFID.x1507             16.2046451  0.0050989  3178.059   &lt;2e-16 ***\nFID.x1508             16.8561359  0.0043637  3862.849   &lt;2e-16 ***\nFID.x1509             14.6055391  0.0174235   838.268   &lt;2e-16 ***\nFID.x1511             14.6958280  0.0131853  1114.564   &lt;2e-16 ***\nFID.x1512             11.8704018  0.1507810    78.726   &lt;2e-16 ***\nFID.x1518             11.5368913  0.1155019    99.885   &lt;2e-16 ***\nFID.x1519             15.1507326  0.0130472  1161.225   &lt;2e-16 ***\nFID.x152              16.3579328  0.0153938  1062.632   &lt;2e-16 ***\nFID.x1523             16.5422466  0.0069545  2378.654   &lt;2e-16 ***\nFID.x1524             16.9897748  0.0052313  3247.690   &lt;2e-16 ***\nFID.x1525             14.6988064  0.0182071   807.311   &lt;2e-16 ***\nFID.x1527             16.8883826  0.0046835  3605.954   &lt;2e-16 ***\nFID.x1528             16.5858312  0.0049528  3348.771   &lt;2e-16 ***\nFID.x1529             16.1220365  0.0055017  2930.349   &lt;2e-16 ***\nFID.x153              13.5206140  0.0752205   179.746   &lt;2e-16 ***\nFID.x1531             15.1792219  0.0086828  1748.191   &lt;2e-16 ***\nFID.x1534             13.3195564  0.0451759   294.838   &lt;2e-16 ***\nFID.x1539             11.0879169  0.1857157    59.704   &lt;2e-16 ***\nFID.x154              12.7765006  0.0638169   200.206   &lt;2e-16 ***\nFID.x1541             14.4482156  0.0206857   698.464   &lt;2e-16 ***\nFID.x1542             12.0451107  0.0814279   147.924   &lt;2e-16 ***\nFID.x1545             17.3288905  0.0043231  4008.473   &lt;2e-16 ***\nFID.x1546             16.0019932  0.0091065  1757.197   &lt;2e-16 ***\nFID.x1549             16.2202196  0.0060259  2691.730   &lt;2e-16 ***\nFID.x155              14.4037102  0.0474361   303.644   &lt;2e-16 ***\nFID.x1550             16.6841499  0.0043585  3827.918   &lt;2e-16 ***\nFID.x1551             15.8192599  0.0058714  2694.284   &lt;2e-16 ***\nFID.x1552             14.4461072  0.0162090   891.241   &lt;2e-16 ***\nFID.x1553             14.9480378  0.0228396   654.480   &lt;2e-16 ***\nFID.x1554             16.2876924  0.0054697  2977.827   &lt;2e-16 ***\nFID.x1556             11.9176353  0.1010541   117.933   &lt;2e-16 ***\nFID.x156              13.7619422  0.0400305   343.787   &lt;2e-16 ***\nFID.x1560             14.9408946  0.0164210   909.863   &lt;2e-16 ***\nFID.x1562             14.7311545  0.0188199   782.743   &lt;2e-16 ***\nFID.x1563             13.4130800  0.0331983   404.029   &lt;2e-16 ***\nFID.x1564             15.2754459  0.0114139  1338.314   &lt;2e-16 ***\nFID.x1565             16.3077005  0.0067658  2410.331   &lt;2e-16 ***\nFID.x1566             15.9488007  0.0085402  1867.494   &lt;2e-16 ***\nFID.x1567             15.6801061  0.0140717  1114.304   &lt;2e-16 ***\nFID.x157              10.8980315  0.1525229    71.452   &lt;2e-16 ***\nFID.x1570             13.6743715  0.0195993   697.698   &lt;2e-16 ***\nFID.x1571             15.9153320  0.0063742  2496.855   &lt;2e-16 ***\nFID.x1572             16.7953333  0.0043178  3889.826   &lt;2e-16 ***\nFID.x1573             14.9784263  0.0079636  1880.861   &lt;2e-16 ***\nFID.x1574             15.1336915  0.0084946  1781.568   &lt;2e-16 ***\nFID.x1575             15.1677972  0.0107153  1415.527   &lt;2e-16 ***\nFID.x1576             12.5556701  0.0564114   222.573   &lt;2e-16 ***\nFID.x1579             15.6980261  0.0081182  1933.692   &lt;2e-16 ***\nFID.x158              13.3713077  0.0325954   410.220   &lt;2e-16 ***\nFID.x1580             14.6325629  0.0145586  1005.080   &lt;2e-16 ***\nFID.x1581             15.2773100  0.0102851  1485.387   &lt;2e-16 ***\nFID.x1583             12.1225350  0.1072500   113.031   &lt;2e-16 ***\nFID.x1584             12.7005659  0.0487651   260.444   &lt;2e-16 ***\nFID.x1586             17.0661280  0.0046600  3662.268   &lt;2e-16 ***\nFID.x1587             15.3783237  0.0102842  1495.331   &lt;2e-16 ***\nFID.x1588             16.3667032  0.0065417  2501.891   &lt;2e-16 ***\nFID.x1589             13.4403451  0.0451239   297.854   &lt;2e-16 ***\nFID.x159              14.4148456  0.0386428   373.028   &lt;2e-16 ***\nFID.x1592             11.4606803  0.0880905   130.101   &lt;2e-16 ***\nFID.x1593             15.5757719  0.0070902  2196.807   &lt;2e-16 ***\nFID.x1594             15.3264607  0.0068801  2227.642   &lt;2e-16 ***\nFID.x1595             15.6366122  0.0061700  2534.284   &lt;2e-16 ***\nFID.x1596             14.3749858  0.0154103   932.819   &lt;2e-16 ***\nFID.x1597             13.4053981  0.0354185   378.486   &lt;2e-16 ***\nFID.x1599             12.0834382  0.0791071   152.748   &lt;2e-16 ***\nFID.x1600             15.0880974  0.0156556   963.752   &lt;2e-16 ***\nFID.x1601             15.1180150  0.0100290  1507.430   &lt;2e-16 ***\nFID.x1602             14.9698329  0.0107811  1388.531   &lt;2e-16 ***\nFID.x1606             15.5001810  0.0092330  1678.778   &lt;2e-16 ***\nFID.x1607             16.3728709  0.0063164  2592.129   &lt;2e-16 ***\nFID.x1608             16.8542296  0.0067859  2483.727   &lt;2e-16 ***\nFID.x1609             16.5906586  0.0069217  2396.893   &lt;2e-16 ***\nFID.x1610             15.4700835  0.0113772  1359.742   &lt;2e-16 ***\nFID.x1614             15.8398951  0.0057955  2733.159   &lt;2e-16 ***\nFID.x1615             15.4665308  0.0063303  2443.249   &lt;2e-16 ***\nFID.x1616             15.1938417  0.0076815  1977.979   &lt;2e-16 ***\nFID.x1617             15.4291579  0.0063321  2436.643   &lt;2e-16 ***\nFID.x1618             15.3783421  0.0096379  1595.604   &lt;2e-16 ***\nFID.x1619             14.6224483  0.0131518  1111.822   &lt;2e-16 ***\nFID.x1620             13.5861092  0.0568722   238.888   &lt;2e-16 ***\nFID.x1622             15.0292923  0.0138036  1088.794   &lt;2e-16 ***\nFID.x1623             15.0654238  0.0103248  1459.150   &lt;2e-16 ***\nFID.x1624             15.6664104  0.0077219  2028.836   &lt;2e-16 ***\nFID.x1625             14.8794054  0.0216470   687.364   &lt;2e-16 ***\nFID.x1627             13.4920163  0.0500185   269.740   &lt;2e-16 ***\nFID.x1628             17.6384749  0.0038959  4527.432   &lt;2e-16 ***\nFID.x1629             17.2878010  0.0043342  3988.707   &lt;2e-16 ***\nFID.x1630             16.5541726  0.0056109  2950.339   &lt;2e-16 ***\nFID.x1631             17.2869623  0.0056114  3080.704   &lt;2e-16 ***\nFID.x1632             14.3915847  0.0411923   349.376   &lt;2e-16 ***\nFID.x1635             12.5987198  0.0322636   390.493   &lt;2e-16 ***\nFID.x1637             14.3490143  0.0107297  1337.323   &lt;2e-16 ***\nFID.x1638             14.8232926  0.0078137  1897.091   &lt;2e-16 ***\nFID.x1639             16.0572121  0.0059705  2689.434   &lt;2e-16 ***\nFID.x1641             13.4433104  0.0202837   662.763   &lt;2e-16 ***\nFID.x1642             15.4660984  0.0072126  2144.314   &lt;2e-16 ***\nFID.x1643             15.7297670  0.0070300  2237.505   &lt;2e-16 ***\nFID.x1644             14.7227769  0.0144103  1021.687   &lt;2e-16 ***\nFID.x1645             16.7101092  0.0057611  2900.495   &lt;2e-16 ***\nFID.x1646             15.5706447  0.0085879  1813.092   &lt;2e-16 ***\nFID.x1647             15.0845823  0.0138760  1087.101   &lt;2e-16 ***\nFID.x1649             15.3343306  0.0119850  1279.459   &lt;2e-16 ***\nFID.x1650             16.4950458  0.0051032  3232.278   &lt;2e-16 ***\nFID.x1651             16.8952737  0.0049055  3444.146   &lt;2e-16 ***\nFID.x1652             16.0650413  0.0099369  1616.709   &lt;2e-16 ***\nFID.x1653             13.5785501  0.0574198   236.479   &lt;2e-16 ***\nFID.x1654             14.7179206  0.0422763   348.136   &lt;2e-16 ***\nFID.x1657             15.3441201  0.0066091  2321.651   &lt;2e-16 ***\nFID.x1658             14.4276720  0.0126099  1144.153   &lt;2e-16 ***\nFID.x1659             14.4520853  0.0108152  1336.274   &lt;2e-16 ***\nFID.x1661             15.4765568  0.0074134  2087.644   &lt;2e-16 ***\nFID.x1662             14.9434942  0.0087127  1715.130   &lt;2e-16 ***\nFID.x1663             14.7185947  0.0108872  1351.916   &lt;2e-16 ***\nFID.x1664             15.3909318  0.0075045  2050.899   &lt;2e-16 ***\nFID.x1665             15.5856410  0.0083986  1855.739   &lt;2e-16 ***\nFID.x1666             16.0426447  0.0060680  2643.810   &lt;2e-16 ***\nFID.x1667             16.6752623  0.0050569  3297.498   &lt;2e-16 ***\nFID.x1668             15.4307162  0.0094257  1637.081   &lt;2e-16 ***\nFID.x1671             17.0694024  0.0051914  3288.004   &lt;2e-16 ***\nFID.x1672             16.2536414  0.0067460  2409.370   &lt;2e-16 ***\nFID.x1673             16.7902531  0.0073825  2274.317   &lt;2e-16 ***\nFID.x1675             16.6751523  0.0173613   960.479   &lt;2e-16 ***\nFID.x1678             14.6060400  0.0107496  1358.747   &lt;2e-16 ***\nFID.x1679             15.7640355  0.0053698  2935.661   &lt;2e-16 ***\nFID.x1680             14.5830070  0.0085056  1714.515   &lt;2e-16 ***\nFID.x1681             14.2852601  0.0099101  1441.479   &lt;2e-16 ***\nFID.x1682             14.6370933  0.0136598  1071.547   &lt;2e-16 ***\nFID.x1683             16.1191292  0.0055625  2897.810   &lt;2e-16 ***\nFID.x1684             16.1275020  0.0054771  2944.559   &lt;2e-16 ***\nFID.x1685             13.8465238  0.0168069   823.859   &lt;2e-16 ***\nFID.x1686             14.5321400  0.0143725  1011.106   &lt;2e-16 ***\nFID.x1687             15.5768678  0.0069068  2255.279   &lt;2e-16 ***\nFID.x1688             16.2582926  0.0074056  2195.415   &lt;2e-16 ***\nFID.x1689             15.9004367  0.0068605  2317.666   &lt;2e-16 ***\nFID.x1692             15.7080159  0.0110062  1427.192   &lt;2e-16 ***\nFID.x1693             16.8341362  0.0054955  3063.280   &lt;2e-16 ***\nFID.x1694             17.9058568  0.0041593  4305.035   &lt;2e-16 ***\nFID.x1700             14.8670939  0.0077930  1907.738   &lt;2e-16 ***\nFID.x1701             15.2561944  0.0061114  2496.335   &lt;2e-16 ***\nFID.x1702             15.7696097  0.0048912  3224.046   &lt;2e-16 ***\nFID.x1703             14.0104408  0.0371956   376.669   &lt;2e-16 ***\nFID.x1704             14.9630376  0.0087645  1707.235   &lt;2e-16 ***\nFID.x1705             16.1509964  0.0053928  2994.902   &lt;2e-16 ***\nFID.x1706             16.5143967  0.0057450  2874.586   &lt;2e-16 ***\nFID.x1707             14.1635272  0.0138894  1019.735   &lt;2e-16 ***\nFID.x1708             17.0548702  0.0044092  3868.046   &lt;2e-16 ***\nFID.x1709             16.9197369  0.0041058  4120.916   &lt;2e-16 ***\nFID.x1710             17.3164317  0.0038988  4441.473   &lt;2e-16 ***\nFID.x1711             13.8041188  0.0202727   680.921   &lt;2e-16 ***\nFID.x1714             17.8144380  0.0042569  4184.817   &lt;2e-16 ***\nFID.x1715             17.6462028  0.0048562  3633.777   &lt;2e-16 ***\nFID.x1721             11.4065564  0.0556259   205.058   &lt;2e-16 ***\nFID.x1722             14.1039663  0.0106255  1327.369   &lt;2e-16 ***\nFID.x1723             14.5243625  0.0082945  1751.087   &lt;2e-16 ***\nFID.x1724             14.6506050  0.0133332  1098.806   &lt;2e-16 ***\nFID.x1725             14.6061396  0.0102271  1428.185   &lt;2e-16 ***\nFID.x1726             14.8166315  0.0235473   629.228   &lt;2e-16 ***\nFID.x1727             17.1957204  0.0037450  4591.648   &lt;2e-16 ***\nFID.x1728             16.0837872  0.0062810  2560.709   &lt;2e-16 ***\nFID.x1729             16.6745432  0.0045173  3691.233   &lt;2e-16 ***\nFID.x1730             15.9593305  0.0072468  2202.265   &lt;2e-16 ***\nFID.x1731             16.6960999  0.0044099  3786.065   &lt;2e-16 ***\nFID.x1732             13.2349588  0.0295804   447.424   &lt;2e-16 ***\nFID.x1733             14.8954360  0.0145866  1021.175   &lt;2e-16 ***\nFID.x1736             17.2823441  0.0049913  3462.479   &lt;2e-16 ***\nFID.x1737             16.5043394  0.0099062  1666.067   &lt;2e-16 ***\nFID.x174              14.4679849  0.0640862   225.758   &lt;2e-16 ***\nFID.x1743             14.7801543  0.0140129  1054.750   &lt;2e-16 ***\nFID.x1744             13.6890024  0.0123673  1106.874   &lt;2e-16 ***\nFID.x1745             14.8821144  0.0069191  2150.862   &lt;2e-16 ***\nFID.x1746             16.1410924  0.0047561  3393.761   &lt;2e-16 ***\nFID.x1747             15.5309130  0.0072168  2152.047   &lt;2e-16 ***\nFID.x1748             16.0565452  0.0061009  2631.834   &lt;2e-16 ***\nFID.x1749             16.3299780  0.0051221  3188.140   &lt;2e-16 ***\nFID.x175              12.9166627  0.0839650   153.834   &lt;2e-16 ***\nFID.x1750             15.5063462  0.0072509  2138.528   &lt;2e-16 ***\nFID.x1751             15.2011986  0.0089496  1698.528   &lt;2e-16 ***\nFID.x1752             17.2314048  0.0040074  4299.887   &lt;2e-16 ***\nFID.x1753             15.9707193  0.0074245  2151.090   &lt;2e-16 ***\nFID.x1757             16.0332740  0.0135743  1181.149   &lt;2e-16 ***\nFID.x1758             17.6227025  0.0055048  3201.358   &lt;2e-16 ***\nFID.x1765             14.4489489  0.0118214  1222.271   &lt;2e-16 ***\nFID.x1766             15.0140129  0.0067233  2233.122   &lt;2e-16 ***\nFID.x1767             15.6685939  0.0050891  3078.828   &lt;2e-16 ***\nFID.x1768             16.7023235  0.0056627  2949.544   &lt;2e-16 ***\nFID.x1769             16.7128453  0.0046405  3601.487   &lt;2e-16 ***\nFID.x177              12.1935113  0.1857166    65.657   &lt;2e-16 ***\nFID.x1770             16.7326080  0.0047245  3541.686   &lt;2e-16 ***\nFID.x1771             16.7031935  0.0043888  3805.863   &lt;2e-16 ***\nFID.x1772             15.3806020  0.0093254  1649.316   &lt;2e-16 ***\nFID.x1773             16.9021388  0.0044080  3834.410   &lt;2e-16 ***\nFID.x1774             16.6010509  0.0050166  3309.196   &lt;2e-16 ***\nFID.x1776             15.7915733  0.0096388  1638.337   &lt;2e-16 ***\nFID.x1779             15.5604807  0.0110426  1409.138   &lt;2e-16 ***\nFID.x178              13.5573974  0.0519203   261.120   &lt;2e-16 ***\nFID.x1786             10.9966169  0.0902091   121.901   &lt;2e-16 ***\nFID.x1788             14.3241417  0.0093421  1533.289   &lt;2e-16 ***\nFID.x1789             14.8896611  0.0082535  1804.052   &lt;2e-16 ***\nFID.x179              14.7277511  0.0190463   773.259   &lt;2e-16 ***\nFID.x1790             15.2775439  0.0080472  1898.486   &lt;2e-16 ***\nFID.x1791             16.7075518  0.0046666  3580.276   &lt;2e-16 ***\nFID.x1792             17.4057900  0.0047549  3660.578   &lt;2e-16 ***\nFID.x1793             16.4794639  0.0068636  2400.986   &lt;2e-16 ***\nFID.x1794             15.0633797  0.0094716  1590.367   &lt;2e-16 ***\nFID.x1795             17.1382334  0.0041932  4087.192   &lt;2e-16 ***\nFID.x1796             15.8360064  0.0090111  1757.381   &lt;2e-16 ***\nFID.x180              16.8112146  0.0063310  2655.360   &lt;2e-16 ***\nFID.x1801             14.7867064  0.0211951   697.649   &lt;2e-16 ***\nFID.x1808             13.0686346  0.0243041   537.713   &lt;2e-16 ***\nFID.x1809             13.6566212  0.0156322   873.623   &lt;2e-16 ***\nFID.x1810             14.9699271  0.0071769  2085.858   &lt;2e-16 ***\nFID.x1811             15.4654605  0.0061684  2507.202   &lt;2e-16 ***\nFID.x1812             16.5689320  0.0053440  3100.453   &lt;2e-16 ***\nFID.x1813             16.7179893  0.0055764  2997.973   &lt;2e-16 ***\nFID.x1814             15.2139171  0.0089516  1699.567   &lt;2e-16 ***\nFID.x1815             15.0129491  0.0095922  1565.116   &lt;2e-16 ***\nFID.x1816             15.2192737  0.0211668   719.017   &lt;2e-16 ***\nFID.x1817             16.4258380  0.0094309  1741.701   &lt;2e-16 ***\nFID.x1819             14.5472977  0.0181972   799.423   &lt;2e-16 ***\nFID.x1820             12.5214835  0.0682580   183.443   &lt;2e-16 ***\nFID.x1821             10.8627738  0.1924706    56.439   &lt;2e-16 ***\nFID.x1828             12.6377787  0.0720357   175.438   &lt;2e-16 ***\nFID.x1829              9.4196855  0.4472218    21.063   &lt;2e-16 ***\nFID.x1830             12.1364259  0.0564030   215.173   &lt;2e-16 ***\nFID.x1832             15.9539077  0.0050392  3165.991   &lt;2e-16 ***\nFID.x1833             15.9697270  0.0054399  2935.639   &lt;2e-16 ***\nFID.x1834             15.0447799  0.0133719  1125.102   &lt;2e-16 ***\nFID.x1835             17.3355700  0.0066988  2587.877   &lt;2e-16 ***\nFID.x1836             13.0857124  0.0378173   346.025   &lt;2e-16 ***\nFID.x1837             14.3591151  0.0277117   518.161   &lt;2e-16 ***\nFID.x1838             14.3310174  0.0150022   955.263   &lt;2e-16 ***\nFID.x1839             14.8993828  0.0127412  1169.390   &lt;2e-16 ***\nFID.x1840             14.3104711  0.0192035   745.201   &lt;2e-16 ***\nFID.x1842             11.4577115  0.1037314   110.456   &lt;2e-16 ***\nFID.x1843             12.8437597  0.0523460   245.363   &lt;2e-16 ***\nFID.x1850             13.5557269  0.0535268   253.251   &lt;2e-16 ***\nFID.x1851              9.3221065  0.7071132    13.183   &lt;2e-16 ***\nFID.x1853             15.0804316  0.0109104  1382.206   &lt;2e-16 ***\nFID.x1854             14.5594612  0.0098814  1473.420   &lt;2e-16 ***\nFID.x1855             16.6317042  0.0044689  3721.631   &lt;2e-16 ***\nFID.x1856             15.8168053  0.0074640  2119.065   &lt;2e-16 ***\nFID.x1857             14.2773521  0.0166842   855.741   &lt;2e-16 ***\nFID.x1858             15.9086557  0.0062051  2563.793   &lt;2e-16 ***\nFID.x1859             15.5752151  0.0091779  1697.039   &lt;2e-16 ***\nFID.x1860             14.8840712  0.0120443  1235.779   &lt;2e-16 ***\nFID.x1863             12.3170913  0.0630546   195.340   &lt;2e-16 ***\nFID.x1865             12.5825273  0.0731827   171.933   &lt;2e-16 ***\nFID.x1874             15.8221188  0.0149640  1057.348   &lt;2e-16 ***\nFID.x1875             13.4055411  0.0211166   634.834   &lt;2e-16 ***\nFID.x1876             12.8480076  0.0308846   416.000   &lt;2e-16 ***\nFID.x1877             16.2715070  0.0048960  3323.414   &lt;2e-16 ***\nFID.x1878             16.5244088  0.0050896  3246.669   &lt;2e-16 ***\nFID.x1879             14.9535743  0.0129102  1158.279   &lt;2e-16 ***\nFID.x1880             15.4155343  0.0084475  1824.865   &lt;2e-16 ***\nFID.x1881             14.9951236  0.0255146   587.707   &lt;2e-16 ***\nFID.x1882             15.3113417  0.0100928  1517.063   &lt;2e-16 ***\nFID.x1883             16.1026500  0.0069286  2324.071   &lt;2e-16 ***\nFID.x1885             12.9390056  0.0416877   310.379   &lt;2e-16 ***\nFID.x1897             16.4187093  0.0045135  3637.658   &lt;2e-16 ***\nFID.x1898             15.9621126  0.0060169  2652.873   &lt;2e-16 ***\nFID.x1899             16.8267188  0.0049167  3422.337   &lt;2e-16 ***\nFID.x1900             15.2223694  0.0083430  1824.565   &lt;2e-16 ***\nFID.x1901             16.9733319  0.0041180  4121.719   &lt;2e-16 ***\nFID.x1902             15.6079868  0.0072132  2163.809   &lt;2e-16 ***\nFID.x1903             17.1748046  0.0044348  3872.731   &lt;2e-16 ***\nFID.x1905             16.7264808  0.0053930  3101.527   &lt;2e-16 ***\nFID.x1906             16.6889536  0.0057336  2910.742   &lt;2e-16 ***\nFID.x1907             13.1238285  0.0586869   223.625   &lt;2e-16 ***\nFID.x1917             16.1815161  0.0106353  1521.495   &lt;2e-16 ***\nFID.x1918             13.2576459  0.0294168   450.684   &lt;2e-16 ***\nFID.x1919             14.9667897  0.0146485  1021.731   &lt;2e-16 ***\nFID.x1920             14.8201712  0.0108465  1366.356   &lt;2e-16 ***\nFID.x1921             15.3856223  0.0093973  1637.231   &lt;2e-16 ***\nFID.x1922             15.8090037  0.0063634  2484.373   &lt;2e-16 ***\nFID.x1923             16.3130910  0.0052313  3118.375   &lt;2e-16 ***\nFID.x1924             16.6899821  0.0049544  3368.711   &lt;2e-16 ***\nFID.x1925             16.7469173  0.0047767  3505.949   &lt;2e-16 ***\nFID.x1926             16.5171414  0.0055204  2992.022   &lt;2e-16 ***\nFID.x1927             15.4569264  0.0096347  1604.290   &lt;2e-16 ***\nFID.x1928             12.4366834  0.0600417   207.134   &lt;2e-16 ***\nFID.x1939             15.5730528  0.0198170   785.842   &lt;2e-16 ***\nFID.x1940             16.2215481  0.0049127  3301.974   &lt;2e-16 ***\nFID.x1941             12.6508410  0.0536805   235.669   &lt;2e-16 ***\nFID.x1942             15.9172189  0.0062122  2562.252   &lt;2e-16 ***\nFID.x1943             15.7066735  0.0088442  1775.930   &lt;2e-16 ***\nFID.x1944             16.3390945  0.0050203  3254.584   &lt;2e-16 ***\nFID.x1946             16.8460620  0.0046449  3626.795   &lt;2e-16 ***\nFID.x1947             15.6021082  0.0081506  1914.231   &lt;2e-16 ***\nFID.x1948             16.7464334  0.0053625  3122.901   &lt;2e-16 ***\nFID.x1960             14.3955526  0.0279361   515.302   &lt;2e-16 ***\nFID.x1961             15.3254445  0.0083536  1834.584   &lt;2e-16 ***\nFID.x1962             16.4534684  0.0049062  3353.638   &lt;2e-16 ***\nFID.x1963             14.9504941  0.0089477  1670.879   &lt;2e-16 ***\nFID.x1964             16.4569553  0.0099312  1657.091   &lt;2e-16 ***\nFID.x1965             15.3947728  0.0082117  1874.735   &lt;2e-16 ***\nFID.x1966             14.7828187  0.0129925  1137.796   &lt;2e-16 ***\nFID.x1967             16.5824185  0.0055097  3009.653   &lt;2e-16 ***\nFID.x1968             17.0395531  0.0045557  3740.245   &lt;2e-16 ***\nFID.x197              14.4142941  0.0758659   189.997   &lt;2e-16 ***\nFID.x1970             16.2108253  0.0076820  2110.224   &lt;2e-16 ***\nFID.x1982             15.6727541  0.0077219  2029.657   &lt;2e-16 ***\nFID.x1983             16.0998145  0.0054786  2938.699   &lt;2e-16 ***\nFID.x1984             15.8469812  0.0061083  2594.351   &lt;2e-16 ***\nFID.x1985             15.8059986  0.0085377  1851.316   &lt;2e-16 ***\nFID.x1986             15.0823054  0.0094754  1591.739   &lt;2e-16 ***\nFID.x1987             16.6187554  0.0057746  2877.915   &lt;2e-16 ***\nFID.x1988             15.8328129  0.0092806  1706.006   &lt;2e-16 ***\nFID.x1989             17.1411826  0.0043271  3961.343   &lt;2e-16 ***\nFID.x199              13.5454644  0.0412227   328.593   &lt;2e-16 ***\nFID.x1990             17.5769206  0.0055665  3157.652   &lt;2e-16 ***\nFID.x1991             15.7824722  0.0121031  1304.005   &lt;2e-16 ***\nFID.x200              16.1843898  0.0075911  2132.023   &lt;2e-16 ***\nFID.x2003             15.5783327  0.0127109  1225.591   &lt;2e-16 ***\nFID.x2004             16.8146650  0.0049998  3363.057   &lt;2e-16 ***\nFID.x2005             16.1543273  0.0058449  2763.810   &lt;2e-16 ***\nFID.x2006             16.4319958  0.0051499  3190.716   &lt;2e-16 ***\nFID.x2007             15.7275112  0.0068105  2309.303   &lt;2e-16 ***\nFID.x2009             16.2517815  0.0062247  2610.833   &lt;2e-16 ***\nFID.x201              12.8218955  0.0705865   181.648   &lt;2e-16 ***\nFID.x2010             16.2172509  0.0060665  2673.250   &lt;2e-16 ***\nFID.x2011             16.9230649  0.0047070  3595.324   &lt;2e-16 ***\nFID.x2012             15.8152181  0.0092840  1703.483   &lt;2e-16 ***\nFID.x2013             15.4057972  0.0115025  1339.348   &lt;2e-16 ***\nFID.x202              12.7285833  0.0593017   214.641   &lt;2e-16 ***\nFID.x2025             15.7991529  0.0096821  1631.788   &lt;2e-16 ***\nFID.x2026             16.0659442  0.0059514  2699.505   &lt;2e-16 ***\nFID.x2027             15.2748764  0.0073700  2072.584   &lt;2e-16 ***\nFID.x2028             15.9151275  0.0058264  2731.537   &lt;2e-16 ***\nFID.x2029             13.4304863  0.0442445   303.552   &lt;2e-16 ***\nFID.x2030             16.9897902  0.0046153  3681.227   &lt;2e-16 ***\nFID.x2031             16.6427703  0.0050987  3264.102   &lt;2e-16 ***\nFID.x2032             16.8399270  0.0045010  3741.388   &lt;2e-16 ***\nFID.x2033             15.7713345  0.0080787  1952.211   &lt;2e-16 ***\nFID.x2034             17.0816312  0.0044980  3797.604   &lt;2e-16 ***\nFID.x2035             16.8508392  0.0096577  1744.811   &lt;2e-16 ***\nFID.x2047             13.4020370  0.0241427   555.118   &lt;2e-16 ***\nFID.x2048             16.5126818  0.0047335  3488.474   &lt;2e-16 ***\nFID.x2049             15.9884008  0.0057720  2770.012   &lt;2e-16 ***\nFID.x2050             13.1353602  0.0472227   278.158   &lt;2e-16 ***\nFID.x2051             13.9232427  0.0214506   649.084   &lt;2e-16 ***\nFID.x2052             16.3524543  0.0058830  2779.594   &lt;2e-16 ***\nFID.x2053             16.8585037  0.0043170  3905.151   &lt;2e-16 ***\nFID.x2054             16.5090731  0.0051458  3208.271   &lt;2e-16 ***\nFID.x2055             16.3834106  0.0052771  3104.610   &lt;2e-16 ***\nFID.x2056             16.0559770  0.0078696  2040.262   &lt;2e-16 ***\nFID.x2068             15.4837909  0.0082847  1868.967   &lt;2e-16 ***\nFID.x2069             15.8227073  0.0065981  2398.086   &lt;2e-16 ***\nFID.x2071             14.1181832  0.0293734   480.645   &lt;2e-16 ***\nFID.x2072             13.1544081  0.0307206   428.195   &lt;2e-16 ***\nFID.x2074             16.9748153  0.0045601  3722.443   &lt;2e-16 ***\nFID.x2075             16.5193173  0.0050879  3246.805   &lt;2e-16 ***\nFID.x2076             16.5533350  0.0049890  3317.980   &lt;2e-16 ***\nFID.x2077             16.9255465  0.0042450  3987.157   &lt;2e-16 ***\nFID.x2078             17.4279321  0.0042728  4078.828   &lt;2e-16 ***\nFID.x2090             15.3284761  0.0092861  1650.695   &lt;2e-16 ***\nFID.x2091             16.5049289  0.0047879  3447.220   &lt;2e-16 ***\nFID.x2092             15.8066265  0.0073190  2159.683   &lt;2e-16 ***\nFID.x2093             15.4254638  0.0088644  1740.164   &lt;2e-16 ***\nFID.x2094             14.4843105  0.0321840   450.047   &lt;2e-16 ***\nFID.x2096             16.5606122  0.0067096  2468.193   &lt;2e-16 ***\nFID.x2097             16.1033475  0.0058637  2746.298   &lt;2e-16 ***\nFID.x2098             16.6856397  0.0047105  3542.207   &lt;2e-16 ***\nFID.x2099             15.3497663  0.0088143  1741.456   &lt;2e-16 ***\nFID.x2100             16.0810562  0.0071536  2247.968   &lt;2e-16 ***\nFID.x2111             16.3011435  0.0060210  2707.398   &lt;2e-16 ***\nFID.x2112             15.9326038  0.0089188  1786.408   &lt;2e-16 ***\nFID.x2113             15.1566844  0.0099580  1522.061   &lt;2e-16 ***\nFID.x2114             15.9845320  0.0058906  2713.560   &lt;2e-16 ***\nFID.x2115             13.9959766  0.0334687   418.182   &lt;2e-16 ***\nFID.x2116             14.9255861  0.0273635   545.455   &lt;2e-16 ***\nFID.x2117             13.0946286  0.0461169   283.944   &lt;2e-16 ***\nFID.x2118             16.8291519  0.0053777  3129.427   &lt;2e-16 ***\nFID.x2119             16.3192195  0.0057056  2860.199   &lt;2e-16 ***\nFID.x2120             17.1432774  0.0040770  4204.927   &lt;2e-16 ***\nFID.x2121             16.8942397  0.0044385  3806.275   &lt;2e-16 ***\nFID.x2122             14.7954823  0.0200649   737.383   &lt;2e-16 ***\nFID.x2133             16.1682623  0.0067470  2396.356   &lt;2e-16 ***\nFID.x2134             16.3563333  0.0052432  3119.530   &lt;2e-16 ***\nFID.x2135             16.7281869  0.0045332  3690.142   &lt;2e-16 ***\nFID.x2136             14.5931973  0.0195742   745.533   &lt;2e-16 ***\nFID.x2140             16.9278029  0.0053091  3188.467   &lt;2e-16 ***\nFID.x2141             16.8616502  0.0046877  3597.027   &lt;2e-16 ***\nFID.x2142             16.0138812  0.0067323  2378.648   &lt;2e-16 ***\nFID.x2143             14.9029570  0.0127997  1164.323   &lt;2e-16 ***\nFID.x2144             16.3314923  0.0099268  1645.199   &lt;2e-16 ***\nFID.x2154             16.4220082  0.0057754  2843.431   &lt;2e-16 ***\nFID.x2155             15.8159449  0.0078676  2010.274   &lt;2e-16 ***\nFID.x2156             16.7061020  0.0046864  3564.792   &lt;2e-16 ***\nFID.x2157             16.2781323  0.0055257  2945.881   &lt;2e-16 ***\nFID.x2160             14.0587832  0.0405540   346.669   &lt;2e-16 ***\nFID.x2162             14.6916560  0.0210951   696.449   &lt;2e-16 ***\nFID.x2163             17.8477627  0.0035873  4975.236   &lt;2e-16 ***\nFID.x2164             16.4789751  0.0053602  3074.293   &lt;2e-16 ***\nFID.x2176             16.2417686  0.0056271  2886.369   &lt;2e-16 ***\nFID.x2177             15.2103669  0.0093460  1627.479   &lt;2e-16 ***\nFID.x2178             15.4782972  0.0192734   803.089   &lt;2e-16 ***\nFID.x2179             16.0863874  0.0067194  2394.009   &lt;2e-16 ***\nFID.x2182             14.7863013  0.0253215   583.942   &lt;2e-16 ***\nFID.x2184             16.4588481  0.0060991  2698.590   &lt;2e-16 ***\nFID.x2185             16.4582215  0.0054698  3008.901   &lt;2e-16 ***\nFID.x2187             14.0747468  0.0370922   379.453   &lt;2e-16 ***\nFID.x2197             16.0811789  0.0080387  2000.460   &lt;2e-16 ***\nFID.x2198             15.6747811  0.0087258  1796.371   &lt;2e-16 ***\nFID.x2199             16.5575237  0.0053091  3118.693   &lt;2e-16 ***\nFID.x220              11.0341719  0.3333453    33.101   &lt;2e-16 ***\nFID.x2200             17.0725980  0.0050088  3408.551   &lt;2e-16 ***\nFID.x2201             13.0035927  0.0441976   294.215   &lt;2e-16 ***\nFID.x2204             13.6107126  0.0507147   268.378   &lt;2e-16 ***\nFID.x2206             15.7835107  0.0080047  1971.783   &lt;2e-16 ***\nFID.x2207             16.2843151  0.0072285  2252.802   &lt;2e-16 ***\nFID.x221              12.7571878  0.0793536   160.764   &lt;2e-16 ***\nFID.x2219             16.7204713  0.0049754  3360.601   &lt;2e-16 ***\nFID.x222              13.3273188  0.0324927   410.164   &lt;2e-16 ***\nFID.x2220             14.1247264  0.0175833   803.303   &lt;2e-16 ***\nFID.x2221             16.3783347  0.0112032  1461.933   &lt;2e-16 ***\nFID.x2222             16.4609855  0.0053002  3105.742   &lt;2e-16 ***\nFID.x2226              9.6828374  0.5773564    16.771   &lt;2e-16 ***\nFID.x2228             16.3793687  0.0061213  2675.819   &lt;2e-16 ***\nFID.x223              12.2598187  0.1400548    87.536   &lt;2e-16 ***\nFID.x2241             15.3789506  0.0093662  1641.970   &lt;2e-16 ***\nFID.x2242             14.8920471  0.0110961  1342.103   &lt;2e-16 ***\nFID.x2243             16.0491576  0.0088951  1804.264   &lt;2e-16 ***\nFID.x2244             11.4809795  0.1324827    86.660   &lt;2e-16 ***\nFID.x2247             12.2033883  0.0874132   139.606   &lt;2e-16 ***\nFID.x2249             15.2269520  0.0114076  1334.808   &lt;2e-16 ***\nFID.x2250             15.9836898  0.0110576  1445.492   &lt;2e-16 ***\nFID.x2262             15.2473967  0.0107982  1412.038   &lt;2e-16 ***\nFID.x2263             15.3018014  0.0123786  1236.145   &lt;2e-16 ***\nFID.x2264             17.0963630  0.0064548  2648.620   &lt;2e-16 ***\nFID.x2265             16.4245273  0.0059226  2773.206   &lt;2e-16 ***\nFID.x2268             12.2726549  0.1231223    99.679   &lt;2e-16 ***\nFID.x2269             14.8377112  0.0266758   556.223   &lt;2e-16 ***\nFID.x2271             16.2180111  0.0104406  1553.358   &lt;2e-16 ***\nFID.x2284             15.8435581  0.0077150  2053.616   &lt;2e-16 ***\nFID.x2285             16.7618763  0.0048387  3464.149   &lt;2e-16 ***\nFID.x2286             17.3943381  0.0046181  3766.531   &lt;2e-16 ***\nFID.x2288             14.5211703  0.0466115   311.536   &lt;2e-16 ***\nFID.x2290             12.9656688  0.0700649   185.052   &lt;2e-16 ***\nFID.x2305             15.9811643  0.0085821  1862.161   &lt;2e-16 ***\nFID.x2306             15.8209356  0.0180387   877.053   &lt;2e-16 ***\nFID.x2307             16.4919357  0.0058227  2832.364   &lt;2e-16 ***\nFID.x2308             16.2918945  0.0070159  2322.133   &lt;2e-16 ***\nFID.x2309             16.8513897  0.0056309  2992.644   &lt;2e-16 ***\nFID.x2310             15.1797960  0.0171088   887.249   &lt;2e-16 ***\nFID.x2311             15.5603935  0.0152115  1022.936   &lt;2e-16 ***\nFID.x2327             15.9345991  0.0073813  2158.773   &lt;2e-16 ***\nFID.x2328             17.5287983  0.0037519  4671.936   &lt;2e-16 ***\nFID.x2329             17.1471969  0.0053585  3199.982   &lt;2e-16 ***\nFID.x2331             17.2428828  0.0048736  3538.005   &lt;2e-16 ***\nFID.x2332             15.1631429  0.0112401  1349.027   &lt;2e-16 ***\nFID.x2333             16.2075615  0.0076293  2124.393   &lt;2e-16 ***\nFID.x2349             15.1994833  0.0099631  1525.571   &lt;2e-16 ***\nFID.x2350             16.2283437  0.0059654  2720.412   &lt;2e-16 ***\nFID.x2351             16.6465063  0.0054436  3057.971   &lt;2e-16 ***\nFID.x2352             16.7536758  0.0050976  3286.584   &lt;2e-16 ***\nFID.x2353             16.5640254  0.0058240  2844.074   &lt;2e-16 ***\nFID.x2354             15.2257920  0.0109747  1387.349   &lt;2e-16 ***\nFID.x2355             16.7058322  0.0059477  2808.808   &lt;2e-16 ***\nFID.x2370             16.0945954  0.0072970  2205.633   &lt;2e-16 ***\nFID.x2371             16.8946855  0.0046171  3659.150   &lt;2e-16 ***\nFID.x2372             17.3863952  0.0041111  4229.159   &lt;2e-16 ***\nFID.x2373             14.6477200  0.0121805  1202.560   &lt;2e-16 ***\nFID.x2374             16.6135735  0.0059184  2807.103   &lt;2e-16 ***\nFID.x2375             17.1658934  0.0047198  3636.997   &lt;2e-16 ***\nFID.x2376             14.6410913  0.0214245   683.382   &lt;2e-16 ***\nFID.x2377             16.5259056  0.0076652  2155.978   &lt;2e-16 ***\nFID.x2392             16.0046684  0.0075402  2122.590   &lt;2e-16 ***\nFID.x2393             16.7064382  0.0055586  3005.522   &lt;2e-16 ***\nFID.x2395             16.6283677  0.0052608  3160.832   &lt;2e-16 ***\nFID.x2396             16.9484930  0.0048001  3530.841   &lt;2e-16 ***\nFID.x2397             16.2632893  0.0075755  2146.820   &lt;2e-16 ***\nFID.x2398             17.3054160  0.0044348  3902.186   &lt;2e-16 ***\nFID.x2414             16.5303934  0.0058869  2807.977   &lt;2e-16 ***\nFID.x2415             16.8238390  0.0074613  2254.818   &lt;2e-16 ***\nFID.x2416             16.0245419  0.0085515  1873.876   &lt;2e-16 ***\nFID.x2417             16.0040612  0.0060554  2642.947   &lt;2e-16 ***\nFID.x2418             16.3533195  0.0072645  2251.124   &lt;2e-16 ***\nFID.x2419             16.7302180  0.0054787  3053.662   &lt;2e-16 ***\nFID.x242              10.8884161  0.1740988    62.542   &lt;2e-16 ***\nFID.x2420             15.8720963  0.0133242  1191.220   &lt;2e-16 ***\nFID.x243              12.9041700  0.0481920   267.766   &lt;2e-16 ***\nFID.x2435             16.4885648  0.0062219  2650.082   &lt;2e-16 ***\nFID.x2436             17.3685749  0.0041859  4149.335   &lt;2e-16 ***\nFID.x2437             14.3949882  0.0232039   620.368   &lt;2e-16 ***\nFID.x2438             16.6270901  0.0047611  3492.253   &lt;2e-16 ***\nFID.x2439             17.7437375  0.0035418  5009.819   &lt;2e-16 ***\nFID.x244              13.1365979  0.0610332   215.237   &lt;2e-16 ***\nFID.x2440             16.0094285  0.0114276  1400.950   &lt;2e-16 ***\nFID.x2441             16.3126836  0.0071645  2276.870   &lt;2e-16 ***\nFID.x2457             15.8181167  0.0203502   777.295   &lt;2e-16 ***\nFID.x2458             15.3749301  0.0102027  1506.950   &lt;2e-16 ***\nFID.x2459             15.4295364  0.0101118  1525.889   &lt;2e-16 ***\nFID.x2460             16.0836991  0.0068482  2348.601   &lt;2e-16 ***\nFID.x2462             17.3770999  0.0041060  4232.097   &lt;2e-16 ***\nFID.x2463             15.0483929  0.0269945   557.461   &lt;2e-16 ***\nFID.x2478             15.6667106  0.0095663  1637.706   &lt;2e-16 ***\nFID.x2479             15.2134014  0.0100536  1513.224   &lt;2e-16 ***\nFID.x2480             15.7291798  0.0075991  2069.872   &lt;2e-16 ***\nFID.x2481             16.1575781  0.0061417  2630.790   &lt;2e-16 ***\nFID.x2482             16.6911621  0.0048723  3425.756   &lt;2e-16 ***\nFID.x2483             16.2897319  0.0073602  2213.226   &lt;2e-16 ***\nFID.x2499             13.4111544  0.1010544   132.712   &lt;2e-16 ***\nFID.x2500             15.8541716  0.0108023  1467.661   &lt;2e-16 ***\nFID.x2501             13.8542581  0.0208433   664.685   &lt;2e-16 ***\nFID.x2502             16.5475046  0.0055790  2966.049   &lt;2e-16 ***\nFID.x2503             16.9493087  0.0042795  3960.583   &lt;2e-16 ***\nFID.x2504             17.0211622  0.0055245  3081.046   &lt;2e-16 ***\nFID.x2505             16.1853201  0.0066877  2420.179   &lt;2e-16 ***\nFID.x2521             13.3959484  0.0617268   217.020   &lt;2e-16 ***\nFID.x2523             13.3251922  0.0264670   503.464   &lt;2e-16 ***\nFID.x2524             16.7013310  0.0052243  3196.848   &lt;2e-16 ***\nFID.x2525             17.3410974  0.0039846  4351.989   &lt;2e-16 ***\nFID.x2526             17.1138579  0.0047744  3584.536   &lt;2e-16 ***\nFID.x2527             15.7356326  0.0102798  1530.730   &lt;2e-16 ***\nFID.x2544             14.3819763  0.0154454   931.148   &lt;2e-16 ***\nFID.x2545             16.1053147  0.0063415  2539.687   &lt;2e-16 ***\nFID.x2546             16.5041648  0.0069123  2387.648   &lt;2e-16 ***\nFID.x2547             16.2782674  0.0059870  2718.920   &lt;2e-16 ***\nFID.x2548             17.1049943  0.0053191  3215.756   &lt;2e-16 ***\nFID.x2565             13.2408792  0.0668709   198.007   &lt;2e-16 ***\nFID.x2566             15.9029562  0.0076443  2080.371   &lt;2e-16 ***\nFID.x2567             15.2069632  0.0112157  1355.862   &lt;2e-16 ***\nFID.x2568             16.1675819  0.0068362  2365.004   &lt;2e-16 ***\nFID.x2569             16.4284021  0.0056711  2896.845   &lt;2e-16 ***\nFID.x2570             16.6527102  0.0071952  2314.409   &lt;2e-16 ***\nFID.x2587             13.3429170  0.0302402   441.231   &lt;2e-16 ***\nFID.x2588             13.7830278  0.0221079   623.443   &lt;2e-16 ***\nFID.x2589             15.6584285  0.0081255  1927.083   &lt;2e-16 ***\nFID.x2590             16.7655956  0.0049979  3354.554   &lt;2e-16 ***\nFID.x2591             15.8976219  0.0088127  1803.943   &lt;2e-16 ***\nFID.x2608             13.7200776  0.0798597   171.802   &lt;2e-16 ***\nFID.x2609             13.4117381  0.0292894   457.905   &lt;2e-16 ***\nFID.x2610             15.3859548  0.0181768   846.461   &lt;2e-16 ***\nFID.x2611             16.5135351  0.0062108  2658.862   &lt;2e-16 ***\nFID.x2612             15.7945066  0.0085829  1840.238   &lt;2e-16 ***\nFID.x2630             11.8835231  0.0928878   127.934   &lt;2e-16 ***\nFID.x2632             14.1003048  0.0272407   517.619   &lt;2e-16 ***\nFID.x2633             14.6389557  0.0156898   933.023   &lt;2e-16 ***\nFID.x2634             15.7718218  0.0097844  1611.940   &lt;2e-16 ***\nFID.x2635             14.1907422  0.0372944   380.506   &lt;2e-16 ***\nFID.x264              17.0423584  0.0056068  3039.612   &lt;2e-16 ***\nFID.x265              14.2597278  0.0219559   649.472   &lt;2e-16 ***\nFID.x2653             13.2483290  0.0588881   224.975   &lt;2e-16 ***\nFID.x2654             13.9156663  0.0392266   354.751   &lt;2e-16 ***\nFID.x2655             12.4895643  0.1072443   116.459   &lt;2e-16 ***\nFID.x2656             14.2600116  0.0310990   458.535   &lt;2e-16 ***\nFID.x2676             14.7876878  0.0184316   802.300   &lt;2e-16 ***\nFID.x2677             13.6331295  0.0295592   461.214   &lt;2e-16 ***\nFID.x2678             12.3861797  0.0582874   212.502   &lt;2e-16 ***\nFID.x2695             15.2960644  0.0161140   949.243   &lt;2e-16 ***\nFID.x2698             16.0347600  0.0114712  1397.825   &lt;2e-16 ***\nFID.x2699             14.5825891  0.0201532   723.588   &lt;2e-16 ***\nFID.x2700             14.6659342  0.0185985   788.555   &lt;2e-16 ***\nFID.x2717             16.0427813  0.0099396  1614.026   &lt;2e-16 ***\nFID.x2720             11.6322627  0.2132176    54.556   &lt;2e-16 ***\nFID.x2722             13.6521332  0.0545428   250.301   &lt;2e-16 ***\nFID.x2739             14.8098930  0.0195403   757.914   &lt;2e-16 ***\nFID.x2740             16.0255791  0.0101416  1580.184   &lt;2e-16 ***\nFID.x2743             15.7129004  0.0110071  1427.523   &lt;2e-16 ***\nFID.x2761             15.9519656  0.0106104  1503.421   &lt;2e-16 ***\nFID.x2762             16.4026743  0.0091407  1794.461   &lt;2e-16 ***\nFID.x2779             16.8501392  0.0152556  1104.521   &lt;2e-16 ***\nFID.x2786             15.5769814  0.0159508   976.566   &lt;2e-16 ***\nFID.x2800             16.6722006  0.0171697   971.023   &lt;2e-16 ***\nFID.x2806             15.6673819  0.0158047   991.314   &lt;2e-16 ***\nFID.x2828             15.3420245  0.0176663   868.436   &lt;2e-16 ***\nFID.x2829             14.1743425  0.0323639   437.968   &lt;2e-16 ***\nFID.x284              12.8963697  0.0825259   156.270   &lt;2e-16 ***\nFID.x2849             14.6269120  0.0513715   284.728   &lt;2e-16 ***\nFID.x285              13.2656985  0.0528496   251.008   &lt;2e-16 ***\nFID.x2850             16.6112594  0.0099867  1663.335   &lt;2e-16 ***\nFID.x286              12.8889308  0.0439819   293.051   &lt;2e-16 ***\nFID.x287              12.6815368  0.2886904    43.928   &lt;2e-16 ***\nFID.x2871             15.4620889  0.0346111   446.737   &lt;2e-16 ***\nFID.x2892             14.5617887  0.0407433   357.404   &lt;2e-16 ***\nFID.x2951             16.1936529  0.0363460   445.541   &lt;2e-16 ***\nFID.x305              14.3324503  0.0416878   343.805   &lt;2e-16 ***\nFID.x306              12.6736023  0.0684136   185.250   &lt;2e-16 ***\nFID.x307              14.2163544  0.0307401   462.469   &lt;2e-16 ***\nFID.x327              13.7617913  0.0480800   286.227   &lt;2e-16 ***\nFID.x328              15.4686597  0.0124982  1237.675   &lt;2e-16 ***\nFID.x329              13.4082588  0.0519241   258.228   &lt;2e-16 ***\nFID.x348              12.0492433  0.2500158    48.194   &lt;2e-16 ***\nFID.x349              13.6601408  0.0471705   289.591   &lt;2e-16 ***\nFID.x350              15.9151135  0.0117956  1349.244   &lt;2e-16 ***\nFID.x369              13.9079748  0.0537560   258.724   &lt;2e-16 ***\nFID.x370              13.1316887  0.0460618   285.088   &lt;2e-16 ***\nFID.x371              12.3381294  0.0806290   153.023   &lt;2e-16 ***\nFID.x372              12.6072995  0.1213006   103.934   &lt;2e-16 ***\nFID.x391              12.1478433  0.1066353   113.920   &lt;2e-16 ***\nFID.x392              14.6545639  0.0707699   207.073   &lt;2e-16 ***\nFID.x393              13.6034234  0.0348628   390.199   &lt;2e-16 ***\nFID.x412              14.4027049  0.0315260   456.851   &lt;2e-16 ***\nFID.x413              12.4350590  0.0618417   201.079   &lt;2e-16 ***\nFID.x414              13.9747707  0.0415058   336.695   &lt;2e-16 ***\nFID.x415              13.9819975  0.0370896   376.979   &lt;2e-16 ***\nFID.x435              13.7814743  0.0580919   237.236   &lt;2e-16 ***\nFID.x436              13.3856269  0.0376860   355.188   &lt;2e-16 ***\nFID.x437              13.9095022  0.0460584   301.997   &lt;2e-16 ***\nFID.x44               13.7554328  0.0985752   139.543   &lt;2e-16 ***\nFID.x456              13.7311730  0.0337293   407.100   &lt;2e-16 ***\nFID.x457              14.6793085  0.0475406   308.774   &lt;2e-16 ***\nFID.x458              17.9762659  0.0036940  4866.393   &lt;2e-16 ***\nFID.x46               13.6538235  0.1132643   120.548   &lt;2e-16 ***\nFID.x460              12.5272475  0.0781251   160.349   &lt;2e-16 ***\nFID.x477              14.4611178  0.0387318   373.365   &lt;2e-16 ***\nFID.x478              12.5491747  0.0572313   219.271   &lt;2e-16 ***\nFID.x479              13.0292367  0.0361922   360.001   &lt;2e-16 ***\nFID.x480              12.9789551  0.0639473   202.963   &lt;2e-16 ***\nFID.x481              13.2257546  0.0625611   211.405   &lt;2e-16 ***\nFID.x482              14.1427907  0.0365415   387.033   &lt;2e-16 ***\nFID.x499              12.5677449  0.1291285    97.327   &lt;2e-16 ***\nFID.x500              13.7966186  0.0459156   300.478   &lt;2e-16 ***\nFID.x501              14.4422047  0.0145432   993.055   &lt;2e-16 ***\nFID.x502              13.2444331  0.0657136   201.548   &lt;2e-16 ***\nFID.x503              14.2461687  0.0271640   524.451   &lt;2e-16 ***\nFID.x520              13.7674228  0.0587870   234.192   &lt;2e-16 ***\nFID.x521              12.9136112  0.0445392   289.938   &lt;2e-16 ***\nFID.x522              12.9351901  0.0468075   276.349   &lt;2e-16 ***\nFID.x523              12.7087020  0.0588914   215.799   &lt;2e-16 ***\nFID.x524              16.7619255  0.0080142  2091.530   &lt;2e-16 ***\nFID.x525              15.8157172  0.0128248  1233.217   &lt;2e-16 ***\nFID.x542               9.7044874  0.5773567    16.808   &lt;2e-16 ***\nFID.x543              14.1685057  0.0324061   437.217   &lt;2e-16 ***\nFID.x544              13.2627075  0.0376331   352.422   &lt;2e-16 ***\nFID.x545              16.2505689  0.0088825  1829.503   &lt;2e-16 ***\nFID.x546              15.0965756  0.0175828   858.600   &lt;2e-16 ***\nFID.x547              14.6305447  0.0297550   491.701   &lt;2e-16 ***\nFID.x563              13.6081124  0.0636892   213.665   &lt;2e-16 ***\nFID.x565              14.0147462  0.0320357   437.473   &lt;2e-16 ***\nFID.x566              14.5279235  0.0188614   770.246   &lt;2e-16 ***\nFID.x567              17.6851710  0.0045139  3917.906   &lt;2e-16 ***\nFID.x569              11.5012479  0.2041426    56.339   &lt;2e-16 ***\nFID.x585              13.0474081  0.0924919   141.065   &lt;2e-16 ***\nFID.x586              14.4173721  0.0364509   395.529   &lt;2e-16 ***\nFID.x587              15.6148439  0.0123042  1269.062   &lt;2e-16 ***\nFID.x588              15.8107855  0.0077294  2045.529   &lt;2e-16 ***\nFID.x589              17.6204480  0.0060070  2933.327   &lt;2e-16 ***\nFID.x590              14.6840095  0.0238747   615.045   &lt;2e-16 ***\nFID.x591              14.5124703  0.0368187   394.160   &lt;2e-16 ***\nFID.x592              11.6712712  0.2357176    49.514   &lt;2e-16 ***\nFID.x606              12.6973762  0.1458926    87.032   &lt;2e-16 ***\nFID.x607              14.6742021  0.0208412   704.095   &lt;2e-16 ***\nFID.x608              13.2597325  0.0372686   355.788   &lt;2e-16 ***\nFID.x609              15.2788068  0.0113454  1346.702   &lt;2e-16 ***\nFID.x610              17.3243990  0.0044235  3916.417   &lt;2e-16 ***\nFID.x613              14.6849878  0.0234139   627.192   &lt;2e-16 ***\nFID.x614              12.3044558  0.1400575    87.853   &lt;2e-16 ***\nFID.x628              13.7281628  0.0472185   290.737   &lt;2e-16 ***\nFID.x629              13.9328124  0.0322913   431.472   &lt;2e-16 ***\nFID.x630              13.8830113  0.0224645   617.997   &lt;2e-16 ***\nFID.x631              17.4898680  0.0042571  4108.438   &lt;2e-16 ***\nFID.x632              17.8858515  0.0041216  4339.518   &lt;2e-16 ***\nFID.x635              11.5674571  0.1666889    69.395   &lt;2e-16 ***\nFID.x636              10.5530151  0.7071128    14.924   &lt;2e-16 ***\nFID.x637              12.2029965  0.2041455    59.776   &lt;2e-16 ***\nFID.x638               9.7660336  0.5773564    16.915   &lt;2e-16 ***\nFID.x639              15.2192386  0.0485443   313.513   &lt;2e-16 ***\nFID.x650              12.1419018  0.0798534   152.052   &lt;2e-16 ***\nFID.x651              14.8130555  0.0366420   404.264   &lt;2e-16 ***\nFID.x652              13.6041311  0.0266103   511.235   &lt;2e-16 ***\nFID.x653              17.2635796  0.0046493  3713.171   &lt;2e-16 ***\nFID.x654              17.5692782  0.0047538  3695.815   &lt;2e-16 ***\nFID.x656              12.5807120  0.0877493   143.371   &lt;2e-16 ***\nFID.x659              12.6965393  0.0932918   136.095   &lt;2e-16 ***\nFID.x66               13.4900932  0.0650143   207.494   &lt;2e-16 ***\nFID.x660              11.8071724  0.2182369    54.103   &lt;2e-16 ***\nFID.x661              10.2815586  0.5000072    20.563   &lt;2e-16 ***\nFID.x671              11.2666010  0.2236236    50.382   &lt;2e-16 ***\nFID.x672              14.6336731  0.0587937   248.899   &lt;2e-16 ***\nFID.x673              14.1461576  0.0350741   403.322   &lt;2e-16 ***\nFID.x674              18.3494174  0.0032682  5614.569   &lt;2e-16 ***\nFID.x675              16.8461413  0.0055198  3051.940   &lt;2e-16 ***\nFID.x68               11.6771720  0.1373886    84.994   &lt;2e-16 ***\nFID.x682              12.6673662  0.1091438   116.061   &lt;2e-16 ***\nFID.x683              12.5580830  0.1072467   117.095   &lt;2e-16 ***\nFID.x69               12.2658651  0.1291303    94.988   &lt;2e-16 ***\nFID.x693              11.9166764  0.1020984   116.718   &lt;2e-16 ***\nFID.x694              14.6327073  0.0248805   588.119   &lt;2e-16 ***\nFID.x695              13.7618904  0.0222187   619.383   &lt;2e-16 ***\nFID.x696              16.1101929  0.0064966  2479.778   &lt;2e-16 ***\nFID.x697              15.3597068  0.0147695  1039.962   &lt;2e-16 ***\nFID.x699              10.5616134  0.3333451    31.684   &lt;2e-16 ***\nFID.x705              12.0822919  0.1715205    70.442   &lt;2e-16 ***\nFID.x706              14.8549940  0.0551294   269.457   &lt;2e-16 ***\nFID.x715              13.3936196  0.0376291   355.938   &lt;2e-16 ***\nFID.x716              13.4936465  0.0347983   387.767   &lt;2e-16 ***\nFID.x717              14.1325973  0.0204184   692.150   &lt;2e-16 ***\nFID.x718              17.6897139  0.0041777  4234.335   &lt;2e-16 ***\nFID.x727              10.2424521  0.4472216    22.902   &lt;2e-16 ***\nFID.x736              13.1951170  0.0477525   276.323   &lt;2e-16 ***\nFID.x738              13.6108980  0.0349867   389.030   &lt;2e-16 ***\nFID.x739              16.3995089  0.0063746  2572.630   &lt;2e-16 ***\nFID.x740              15.0670648  0.0152226   989.779   &lt;2e-16 ***\nFID.x742              14.2797681  0.0325698   438.436   &lt;2e-16 ***\nFID.x758              13.8571157  0.0281205   492.775   &lt;2e-16 ***\nFID.x759              15.5785030  0.0089789  1735.013   &lt;2e-16 ***\nFID.x760              15.4870609  0.0105226  1471.794   &lt;2e-16 ***\nFID.x761              16.4560342  0.0059469  2767.147   &lt;2e-16 ***\nFID.x779              14.1918808  0.0304973   465.348   &lt;2e-16 ***\nFID.x780              12.6655048  0.0500154   253.232   &lt;2e-16 ***\nFID.x781              14.9779866  0.0143955  1040.466   &lt;2e-16 ***\nFID.x782              17.4651982  0.0043152  4047.403   &lt;2e-16 ***\nFID.x783              17.6888000  0.0040702  4345.932   &lt;2e-16 ***\nFID.x785              17.1016359  0.0073462  2327.968   &lt;2e-16 ***\nFID.x801              14.7877879  0.0175054   844.755   &lt;2e-16 ***\nFID.x802              17.0442752  0.0051695  3297.099   &lt;2e-16 ***\nFID.x803              17.6341959  0.0042869  4113.477   &lt;2e-16 ***\nFID.x804              15.6945091  0.0087796  1787.618   &lt;2e-16 ***\nFID.x822              14.8486649  0.0204091   727.552   &lt;2e-16 ***\nFID.x823              12.2257899  0.0932933   131.047   &lt;2e-16 ***\nFID.x824              16.8828315  0.0057350  2943.806   &lt;2e-16 ***\nFID.x825              13.8268390  0.0253313   545.840   &lt;2e-16 ***\nFID.x826              17.3544279  0.0044559  3894.696   &lt;2e-16 ***\nFID.x828              13.2172537  0.0502039   263.271   &lt;2e-16 ***\nFID.x845              15.4346280  0.0109309  1412.024   &lt;2e-16 ***\nFID.x847              16.7139676  0.0058319  2865.936   &lt;2e-16 ***\nFID.x850              13.4810418  0.0436098   309.129   &lt;2e-16 ***\nFID.x865              12.3325003  0.0811570   151.959   &lt;2e-16 ***\nFID.x868              16.2300182  0.0087007  1865.365   &lt;2e-16 ***\nFID.x869              16.8156865  0.0065826  2554.557   &lt;2e-16 ***\nFID.x88               12.6235375  0.1250292   100.965   &lt;2e-16 ***\nFID.x886              14.5945288  0.0271876   536.808   &lt;2e-16 ***\nFID.x887              16.2718434  0.0093525  1739.846   &lt;2e-16 ***\nFID.x889              15.0476197  0.0124700  1206.706   &lt;2e-16 ***\nFID.x89               14.7251159  0.0243780   604.033   &lt;2e-16 ***\nFID.x890              16.7734199  0.0053239  3150.568   &lt;2e-16 ***\nFID.x891              16.5122942  0.0084185  1961.418   &lt;2e-16 ***\nFID.x893              17.3418711  0.0050626  3425.501   &lt;2e-16 ***\nFID.x899              13.2996932  0.0720388   184.618   &lt;2e-16 ***\nFID.x908              14.9610080  0.0167228   894.645   &lt;2e-16 ***\nFID.x909              17.2601682  0.0050029  3450.027   &lt;2e-16 ***\nFID.x91               13.5949559  0.0501379   271.152   &lt;2e-16 ***\nFID.x910              15.7327064  0.0077392  2032.871   &lt;2e-16 ***\nFID.x911              16.9745861  0.0044451  3818.678   &lt;2e-16 ***\nFID.x912              16.0790224  0.0080705  1992.324   &lt;2e-16 ***\nFID.x914              15.6919648  0.0129825  1208.698   &lt;2e-16 ***\nFID.x915              16.8361772  0.0069452  2424.143   &lt;2e-16 ***\nFID.x929              13.1319398  0.0488140   269.020   &lt;2e-16 ***\nFID.x930              13.7356192  0.0308640   445.037   &lt;2e-16 ***\nFID.x931              13.8001916  0.0235444   586.134   &lt;2e-16 ***\nFID.x932              17.0056118  0.0042699  3982.639   &lt;2e-16 ***\nFID.x933              16.3164989  0.0059461  2744.047   &lt;2e-16 ***\nFID.x934              17.0807329  0.0051719  3302.581   &lt;2e-16 ***\nFID.x936              17.5055538  0.0043834  3993.646   &lt;2e-16 ***\nFID.x937              15.7702099  0.0125784  1253.758   &lt;2e-16 ***\nFID.x950              12.2948900  0.0801117   153.472   &lt;2e-16 ***\nFID.x952              16.1916279  0.0064314  2517.575   &lt;2e-16 ***\nFID.x953              16.6463451  0.0048517  3431.052   &lt;2e-16 ***\nFID.x954              17.0838543  0.0044884  3806.242   &lt;2e-16 ***\nFID.x955              16.6594664  0.0058964  2825.370   &lt;2e-16 ***\nFID.x956              16.6956380  0.0072738  2295.300   &lt;2e-16 ***\nFID.x957              17.0529785  0.0056739  3005.489   &lt;2e-16 ***\nFID.x958              17.8205789  0.0036964  4821.015   &lt;2e-16 ***\nFID.x959              17.1376718  0.0053683  3192.399   &lt;2e-16 ***\nFID.x973              15.0303839  0.0137614  1092.213   &lt;2e-16 ***\nFID.x974              15.1080416  0.0104056  1451.911   &lt;2e-16 ***\nFID.x975              16.4048278  0.0059637  2750.766   &lt;2e-16 ***\nFID.x976              17.0563624  0.0044313  3849.032   &lt;2e-16 ***\nFID.x977              16.3169088  0.0062818  2597.500   &lt;2e-16 ***\nFID.x978              14.8730102  0.0187077   795.023   &lt;2e-16 ***\nFID.x979              16.5687717  0.0056027  2957.297   &lt;2e-16 ***\nFID.x980              14.5111257  0.0157012   924.203   &lt;2e-16 ***\nFID.x981              16.9153209  0.0067853  2492.954   &lt;2e-16 ***\nFID.x984              12.7823881  0.0586855   217.812   &lt;2e-16 ***\nFID.x985              15.7749349  0.0152265  1036.015   &lt;2e-16 ***\nFID.x993              14.1978353  0.0316806   448.155   &lt;2e-16 ***\nFID.x994              14.6053007  0.0311728   468.527   &lt;2e-16 ***\nFID.x995              16.3334010  0.0067864  2406.793   &lt;2e-16 ***\nFID.x996              14.4826586  0.0164013   883.021   &lt;2e-16 ***\nFID.x997              15.5010936  0.0098391  1575.454   &lt;2e-16 ***\nFID.x998              16.4696649  0.0050930  3233.805   &lt;2e-16 ***\nFID.x999              16.9475023  0.0050115  3381.715   &lt;2e-16 ***\nlog(SCHOOL_COUNT)      0.1586307  0.0008785   180.574   &lt;2e-16 ***\nlog(BUSINESS_COUNT)    0.0898753  0.0002048   438.873   &lt;2e-16 ***\nlog(HDB_COUNT)         0.0438982  0.0001572   279.309   &lt;2e-16 ***\nlog(TRAIN_COUNT)       0.8235272  0.0003146  2617.434   &lt;2e-16 ***\nlog(UNIVERSITY_COUNT) 16.8030061  0.1963405    85.581   &lt;2e-16 ***\nlog(dist)             -1.3783420  0.0002518 -5473.862   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 331546535  on 83714  degrees of freedom\nResidual deviance:  41407482  on 82685  degrees of freedom\nAIC: 41854357\n\nNumber of Fisher Scoring iterations: 7\n\n\n\n8.4.1 Goodness of fit\n\nCalcRSquared(orcSIM$data$MORNING_PEAK, orcSIM$fitted.values)\n\n[1] 0.3099136"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#destination-constrained",
    "href": "take_home_ex2/take_home_ex2.html#destination-constrained",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "8.5 Destination constrained",
    "text": "8.5 Destination constrained\nThe code chunk used to calibrate to model is shown below. FID.y is the destination:\n\ndecSIM &lt;- glm(formula = MORNING_PEAK ~ \n                  FID.y +\n                  log(SCHOOL_COUNT)+\n                  log(BUSINESS_COUNT)+\n                  log(HDB_COUNT)+\n                  log(TRAIN_COUNT)+\n                  log(UNIVERSITY_COUNT)+\n                  log(dist) - 1,\n              family = poisson(link = \"log\"),\n              data = inter_zonal_flow,\n              na.action = na.exclude)\nsummary(decSIM)\n\n\nCall:\nglm(formula = MORNING_PEAK ~ FID.y + log(SCHOOL_COUNT) + log(BUSINESS_COUNT) + \n    log(HDB_COUNT) + log(TRAIN_COUNT) + log(UNIVERSITY_COUNT) + \n    log(dist) - 1, family = poisson(link = \"log\"), data = inter_zonal_flow, \n    na.action = na.exclude)\n\nCoefficients: (5 not defined because of singularities)\n                        Estimate Std. Error   z value Pr(&gt;|z|)    \nFID.y1                14.8518014  0.0459701   323.075   &lt;2e-16 ***\nFID.y1000             15.1985903  0.0095032  1599.315   &lt;2e-16 ***\nFID.y1001             16.3796618  0.0058413  2804.096   &lt;2e-16 ***\nFID.y1002             16.1308459  0.0081365  1982.523   &lt;2e-16 ***\nFID.y1003             16.9567555  0.0085817  1975.930   &lt;2e-16 ***\nFID.y1005             15.2917790  0.0148000  1033.227   &lt;2e-16 ***\nFID.y1006             15.0260130  0.0161185   932.223   &lt;2e-16 ***\nFID.y1014             15.0575164  0.0184337   816.849   &lt;2e-16 ***\nFID.y1015             16.7756999  0.0144579  1160.313   &lt;2e-16 ***\nFID.y1016             15.8908146  0.0081206  1956.852   &lt;2e-16 ***\nFID.y1017             16.8224208  0.0056942  2954.315   &lt;2e-16 ***\nFID.y1018             16.9959639  0.0058198  2920.391   &lt;2e-16 ***\nFID.y1019             17.1995970  0.0033573  5123.052   &lt;2e-16 ***\nFID.y1020             18.0553099  0.0036967  4884.176   &lt;2e-16 ***\nFID.y1021             16.3132542  0.0063595  2565.190   &lt;2e-16 ***\nFID.y1022             15.3015867  0.0092278  1658.206   &lt;2e-16 ***\nFID.y1023             14.1933003  0.0240223   590.839   &lt;2e-16 ***\nFID.y1024             14.5823706  0.0182147   800.581   &lt;2e-16 ***\nFID.y1025             14.1044509  0.0281707   500.678   &lt;2e-16 ***\nFID.y1026             14.3843554  0.0213794   672.814   &lt;2e-16 ***\nFID.y1036             15.5373826  0.0144560  1074.803   &lt;2e-16 ***\nFID.y1037             16.3442340  0.0065745  2486.009   &lt;2e-16 ***\nFID.y1038             14.8546795  0.0135280  1098.070   &lt;2e-16 ***\nFID.y1039             14.2283328  0.0280927   506.477   &lt;2e-16 ***\nFID.y1040             16.2756907  0.0071416  2278.993   &lt;2e-16 ***\nFID.y1041             16.0706222  0.0075190  2137.345   &lt;2e-16 ***\nFID.y1043             16.3504666  0.0060653  2695.749   &lt;2e-16 ***\nFID.y1044             16.9235750  0.0062034  2728.126   &lt;2e-16 ***\nFID.y1045             14.4798918  0.0141644  1022.270   &lt;2e-16 ***\nFID.y1046             15.5214691  0.0094723  1638.621   &lt;2e-16 ***\nFID.y1047             14.9227562  0.0148838  1002.618   &lt;2e-16 ***\nFID.y1048             13.2559846  0.0437633   302.902   &lt;2e-16 ***\nFID.y1049             15.8231028  0.0113440  1394.848   &lt;2e-16 ***\nFID.y1058             15.9973095  0.0111320  1437.054   &lt;2e-16 ***\nFID.y1059             15.1421174  0.0113001  1339.996   &lt;2e-16 ***\nFID.y1060             15.6266759  0.0083549  1870.355   &lt;2e-16 ***\nFID.y1061             17.1719712  0.0042732  4018.548   &lt;2e-16 ***\nFID.y1062             16.0737852  0.0056159  2862.172   &lt;2e-16 ***\nFID.y1065             16.0383872  0.0058509  2741.165   &lt;2e-16 ***\nFID.y1066             15.6552958  0.0080259  1950.593   &lt;2e-16 ***\nFID.y1067             14.3429484  0.0181508   790.209   &lt;2e-16 ***\nFID.y1068             16.6513519  0.0056295  2957.892   &lt;2e-16 ***\nFID.y1069             11.7692224  0.1313170    89.625   &lt;2e-16 ***\nFID.y1070             15.2960615  0.0148971  1026.784   &lt;2e-16 ***\nFID.y1079             16.0661256  0.0093442  1719.360   &lt;2e-16 ***\nFID.y1080             16.0715895  0.0060119  2673.282   &lt;2e-16 ***\nFID.y1081             15.9819850  0.0070929  2253.224   &lt;2e-16 ***\nFID.y1082             15.6450019  0.0093786  1668.163   &lt;2e-16 ***\nFID.y1083             16.3635037  0.0059856  2733.801   &lt;2e-16 ***\nFID.y1084             14.9393164  0.0110779  1348.565   &lt;2e-16 ***\nFID.y1086             14.4365618  0.0161013   896.608   &lt;2e-16 ***\nFID.y1087             16.1250090  0.0061010  2643.031   &lt;2e-16 ***\nFID.y1090             13.2153024  0.0627707   210.533   &lt;2e-16 ***\nFID.y1091             17.7766146  0.0035882  4954.166   &lt;2e-16 ***\nFID.y1092             13.8091986  0.0389371   354.654   &lt;2e-16 ***\nFID.y110              13.1879063  0.0867299   152.057   &lt;2e-16 ***\nFID.y1100             14.8148691  0.0169873   872.112   &lt;2e-16 ***\nFID.y1101             16.4632213  0.0050927  3232.733   &lt;2e-16 ***\nFID.y1102             17.6864895  0.0027423  6449.591   &lt;2e-16 ***\nFID.y1103             16.8755286  0.0077003  2191.532   &lt;2e-16 ***\nFID.y1104             13.4159629  0.0282351   475.152   &lt;2e-16 ***\nFID.y1105             14.4115665  0.0147096   979.741   &lt;2e-16 ***\nFID.y1106             15.8239994  0.0078722  2010.115   &lt;2e-16 ***\nFID.y1107             16.3189182  0.0061116  2670.163   &lt;2e-16 ***\nFID.y1108             17.8836878  0.0027338  6541.578   &lt;2e-16 ***\nFID.y1109             15.8047509  0.0104857  1507.269   &lt;2e-16 ***\nFID.y111              14.8982143  0.0167094   891.607   &lt;2e-16 ***\nFID.y1111             13.2213544  0.0487674   271.111   &lt;2e-16 ***\nFID.y1113             14.8316234  0.0208310   711.996   &lt;2e-16 ***\nFID.y1114             15.0789378  0.0186104   810.242   &lt;2e-16 ***\nFID.y112              14.6105984  0.0288845   505.829   &lt;2e-16 ***\nFID.y1121             15.0998671  0.0115214  1310.594   &lt;2e-16 ***\nFID.y1122             15.7075135  0.0087717  1790.698   &lt;2e-16 ***\nFID.y1123             15.7648554  0.0056402  2795.070   &lt;2e-16 ***\nFID.y1124             15.8417595  0.0119937  1320.844   &lt;2e-16 ***\nFID.y1126             13.8709045  0.0275155   504.112   &lt;2e-16 ***\nFID.y1128             16.7873125  0.0045298  3706.010   &lt;2e-16 ***\nFID.y1129             14.9608445  0.0159007   940.891   &lt;2e-16 ***\nFID.y113              16.0568401  0.0113147  1419.114   &lt;2e-16 ***\nFID.y1130             15.0603807  0.0109233  1378.743   &lt;2e-16 ***\nFID.y1133             14.7368384  0.0286490   514.393   &lt;2e-16 ***\nFID.y1136             17.5683374  0.0047990  3660.865   &lt;2e-16 ***\nFID.y114              13.7718697  0.0300242   458.692   &lt;2e-16 ***\nFID.y1143             15.9887551  0.0063032  2536.622   &lt;2e-16 ***\nFID.y1144             16.2380379  0.0056502  2873.890   &lt;2e-16 ***\nFID.y1145             15.2713059  0.0092080  1658.475   &lt;2e-16 ***\nFID.y1147             15.6093165  0.0092461  1688.211   &lt;2e-16 ***\nFID.y1148             14.7883669  0.0114292  1293.910   &lt;2e-16 ***\nFID.y1149             14.6918193  0.0128692  1141.626   &lt;2e-16 ***\nFID.y1151             16.3605096  0.0053452  3060.771   &lt;2e-16 ***\nFID.y1152             16.3571196  0.0084001  1947.245   &lt;2e-16 ***\nFID.y1154             14.5220302  0.0240355   604.191   &lt;2e-16 ***\nFID.y1156             16.1155566  0.0119261  1351.286   &lt;2e-16 ***\nFID.y1157             15.2724179  0.0107406  1421.933   &lt;2e-16 ***\nFID.y1164             15.9142340  0.0072856  2184.327   &lt;2e-16 ***\nFID.y1165             16.3619610  0.0060444  2706.957   &lt;2e-16 ***\nFID.y1166             15.8262806  0.0061556  2571.030   &lt;2e-16 ***\nFID.y1167             15.3763378  0.0087311  1761.096   &lt;2e-16 ***\nFID.y1169             15.5685514  0.0074156  2099.431   &lt;2e-16 ***\nFID.y1170             13.8058108  0.0213659   646.162   &lt;2e-16 ***\nFID.y1171             15.7881443  0.0131183  1203.519   &lt;2e-16 ***\nFID.y1172             15.0095799  0.0131566  1140.837   &lt;2e-16 ***\nFID.y1173             16.5200890  0.0073711  2241.205   &lt;2e-16 ***\nFID.y1178             17.6266821  0.0033801  5214.900   &lt;2e-16 ***\nFID.y1179             16.8180585  0.0049595  3391.052   &lt;2e-16 ***\nFID.y1186             17.0723099  0.0058906  2898.243   &lt;2e-16 ***\nFID.y1187             15.6438839  0.0112265  1393.480   &lt;2e-16 ***\nFID.y1188             14.0875215  0.0212898   661.702   &lt;2e-16 ***\nFID.y1189             17.2509105  0.0039014  4421.732   &lt;2e-16 ***\nFID.y1190             16.7897505  0.0041446  4051.035   &lt;2e-16 ***\nFID.y1191             14.8565490  0.0125946  1179.594   &lt;2e-16 ***\nFID.y1193             15.7084935  0.0120153  1307.376   &lt;2e-16 ***\nFID.y1194             16.5772131  0.0059046  2807.509   &lt;2e-16 ***\nFID.y1197             14.9331365  0.0184277   810.364   &lt;2e-16 ***\nFID.y1199             16.4911078  0.0078014  2113.855   &lt;2e-16 ***\nFID.y1200             16.3421188  0.0068571  2383.245   &lt;2e-16 ***\nFID.y1207             15.4488054  0.0099117  1558.641   &lt;2e-16 ***\nFID.y1208             16.8413703  0.0064044  2629.664   &lt;2e-16 ***\nFID.y1209             16.7405562  0.0049776  3363.210   &lt;2e-16 ***\nFID.y1210             14.7033158  0.0133735  1099.433   &lt;2e-16 ***\nFID.y1211             17.0101200  0.0043306  3927.916   &lt;2e-16 ***\nFID.y1212             16.3396031  0.0053605  3048.128   &lt;2e-16 ***\nFID.y1221             15.9828966  0.0068295  2340.260   &lt;2e-16 ***\nFID.y1222             17.0123682  0.0055143  3085.149   &lt;2e-16 ***\nFID.y1228             16.4645360  0.0056948  2891.129   &lt;2e-16 ***\nFID.y1229             15.8840447  0.0142652  1113.483   &lt;2e-16 ***\nFID.y1230             15.8856209  0.0068474  2319.965   &lt;2e-16 ***\nFID.y1231             14.8099811  0.0142681  1037.979   &lt;2e-16 ***\nFID.y1233             16.1283625  0.0056489  2855.126   &lt;2e-16 ***\nFID.y1240             15.8181785  0.0107957  1465.225   &lt;2e-16 ***\nFID.y1242             15.2056970  0.0135465  1122.483   &lt;2e-16 ***\nFID.y1243             15.6084851  0.0103443  1508.891   &lt;2e-16 ***\nFID.y1244             13.0825716  0.0435132   300.657   &lt;2e-16 ***\nFID.y1249             16.4767911  0.0056775  2902.115   &lt;2e-16 ***\nFID.y1250             15.8909249  0.0078518  2023.854   &lt;2e-16 ***\nFID.y1251             16.1068500  0.0067982  2369.276   &lt;2e-16 ***\nFID.y1252             14.3311526  0.0200923   713.268   &lt;2e-16 ***\nFID.y1253             14.5812489  0.0232511   627.120   &lt;2e-16 ***\nFID.y1262             13.9137237  0.0472270   294.614   &lt;2e-16 ***\nFID.y1264             15.3296451  0.0111039  1380.561   &lt;2e-16 ***\nFID.y1265             18.0178875  0.0056641  3181.071   &lt;2e-16 ***\nFID.y1270             13.4739459  0.0297698   452.604   &lt;2e-16 ***\nFID.y1271             14.9944883  0.0172974   866.862   &lt;2e-16 ***\nFID.y1272             16.6327020  0.0045533  3652.863   &lt;2e-16 ***\nFID.y1273             15.4084441  0.0076178  2022.695   &lt;2e-16 ***\nFID.y1274             14.6307109  0.0123623  1183.494   &lt;2e-16 ***\nFID.y1276             15.1015601  0.0101621  1486.067   &lt;2e-16 ***\nFID.y1285             15.5141057  0.0118439  1309.880   &lt;2e-16 ***\nFID.y1286             18.7143539  0.0023196  8067.994   &lt;2e-16 ***\nFID.y1287             17.5303357  0.0046819  3744.284   &lt;2e-16 ***\nFID.y1292             14.4364844  0.0268768   537.136   &lt;2e-16 ***\nFID.y1293             16.4649142  0.0059730  2756.575   &lt;2e-16 ***\nFID.y1294             15.4951841  0.0109286  1417.853   &lt;2e-16 ***\nFID.y1295             15.2944171  0.0099747  1533.315   &lt;2e-16 ***\nFID.y1296             13.5614432  0.0270182   501.937   &lt;2e-16 ***\nFID.y1297             14.9270144  0.0109450  1363.818   &lt;2e-16 ***\nFID.y1304             16.5633387  0.0086838  1907.388   &lt;2e-16 ***\nFID.y1305             13.0756858  0.0848408   154.120   &lt;2e-16 ***\nFID.y1307             16.9665348  0.0049125  3453.751   &lt;2e-16 ***\nFID.y1308             16.5172905  0.0071961  2295.299   &lt;2e-16 ***\nFID.y1309             17.5172458  0.0049789  3518.295   &lt;2e-16 ***\nFID.y1313             15.6997456  0.0086087  1823.710   &lt;2e-16 ***\nFID.y1314             14.7655716  0.0168617   875.685   &lt;2e-16 ***\nFID.y1315             15.8455072  0.0173810   911.659   &lt;2e-16 ***\nFID.y1316             16.6331266  0.0039809  4178.204   &lt;2e-16 ***\nFID.y1317             13.4025215  0.0360828   371.438   &lt;2e-16 ***\nFID.y1318             14.3711369  0.0172703   832.131   &lt;2e-16 ***\nFID.y132              15.3587146  0.0231436   663.628   &lt;2e-16 ***\nFID.y1328             17.0862761  0.0059340  2879.402   &lt;2e-16 ***\nFID.y1329             16.2962959  0.0061390  2654.554   &lt;2e-16 ***\nFID.y133              16.1888294  0.0133506  1212.590   &lt;2e-16 ***\nFID.y1330             15.9022126  0.0099403  1599.773   &lt;2e-16 ***\nFID.y1336             15.2270985  0.0287845   529.004   &lt;2e-16 ***\nFID.y1337             16.0731564  0.0063427  2534.137   &lt;2e-16 ***\nFID.y1338             15.6622750  0.0073398  2133.890   &lt;2e-16 ***\nFID.y134              12.8926147  0.0608839   211.757   &lt;2e-16 ***\nFID.y1340             15.5880183  0.0076438  2039.307   &lt;2e-16 ***\nFID.y1348             14.4452133  0.0291927   494.822   &lt;2e-16 ***\nFID.y135              14.8869448  0.0280384   530.949   &lt;2e-16 ***\nFID.y1350             15.4275903  0.0102386  1506.813   &lt;2e-16 ***\nFID.y1351             15.8171954  0.0084850  1864.134   &lt;2e-16 ***\nFID.y1352             17.1629930  0.0060757  2824.854   &lt;2e-16 ***\nFID.y1356             16.8192708  0.0047878  3512.934   &lt;2e-16 ***\nFID.y1358             13.9564252  0.0164413   848.864   &lt;2e-16 ***\nFID.y1359             14.7204831  0.0259360   567.570   &lt;2e-16 ***\nFID.y136              15.2360141  0.0148825  1023.753   &lt;2e-16 ***\nFID.y1371             16.6090129  0.0084285  1970.570   &lt;2e-16 ***\nFID.y1372             18.2773295  0.0027722  6593.122   &lt;2e-16 ***\nFID.y1373             16.4264775  0.0061615  2665.981   &lt;2e-16 ***\nFID.y1374             15.7073285  0.0169524   926.557   &lt;2e-16 ***\nFID.y1377             15.1504959  0.0102992  1471.035   &lt;2e-16 ***\nFID.y1378             15.3573746  0.0083129  1847.417   &lt;2e-16 ***\nFID.y1379             15.2147669  0.0083228  1828.081   &lt;2e-16 ***\nFID.y1380             16.5404759  0.0042676  3875.792   &lt;2e-16 ***\nFID.y1381             14.5405737  0.0127656  1139.047   &lt;2e-16 ***\nFID.y1383             13.7606085  0.0323309   425.617   &lt;2e-16 ***\nFID.y1391             14.1070555  0.0408312   345.497   &lt;2e-16 ***\nFID.y1393             16.7734508  0.0058910  2847.308   &lt;2e-16 ***\nFID.y1394             15.7318466  0.0082730  1901.596   &lt;2e-16 ***\nFID.y1395             16.8408287  0.0066333  2538.839   &lt;2e-16 ***\nFID.y1396             15.4830026  0.0180115   859.617   &lt;2e-16 ***\nFID.y1399             17.0112175  0.0038575  4409.890   &lt;2e-16 ***\nFID.y1400             16.2044289  0.0049543  3270.810   &lt;2e-16 ***\nFID.y1401             15.8920223  0.0064150  2477.316   &lt;2e-16 ***\nFID.y1402             14.5774507  0.0131026  1112.565   &lt;2e-16 ***\nFID.y1403             14.7711424  0.0113228  1304.548   &lt;2e-16 ***\nFID.y1404             16.6747360  0.0048188  3460.329   &lt;2e-16 ***\nFID.y1413             14.4277437  0.0976122   147.807   &lt;2e-16 ***\nFID.y1415             16.7663625  0.0059590  2813.598   &lt;2e-16 ***\nFID.y1416             16.5610446  0.0056023  2956.127   &lt;2e-16 ***\nFID.y1417             16.8300819  0.0052191  3224.683   &lt;2e-16 ***\nFID.y1418             14.5324504  0.0284942   510.015   &lt;2e-16 ***\nFID.y1420             15.1349762  0.0097796  1547.609   &lt;2e-16 ***\nFID.y1421             16.1746019  0.0067833  2384.475   &lt;2e-16 ***\nFID.y1422             15.4689004  0.0078719  1965.086   &lt;2e-16 ***\nFID.y1424             14.2795416  0.0139476  1023.798   &lt;2e-16 ***\nFID.y1433             11.4240924  0.1601376    71.339   &lt;2e-16 ***\nFID.y1434             14.8939581  0.0212968   699.350   &lt;2e-16 ***\nFID.y1437             15.2593755  0.0104385  1461.840   &lt;2e-16 ***\nFID.y1438             16.2221691  0.0108551  1494.434   &lt;2e-16 ***\nFID.y1439             16.4361615  0.0083402  1970.725   &lt;2e-16 ***\nFID.y1442             15.4570347  0.0104747  1475.652   &lt;2e-16 ***\nFID.y1443             16.6509466  0.0047307  3519.764   &lt;2e-16 ***\nFID.y1444             15.7168048  0.0122921  1278.612   &lt;2e-16 ***\nFID.y1445             14.9045967  0.0115041  1295.595   &lt;2e-16 ***\nFID.y1446             15.7419366  0.0069505  2264.870   &lt;2e-16 ***\nFID.y1447             15.5853447  0.0075817  2055.643   &lt;2e-16 ***\nFID.y1459             16.5992623  0.0060957  2723.128   &lt;2e-16 ***\nFID.y1460             15.5889712  0.0109367  1425.379   &lt;2e-16 ***\nFID.y1463             15.7912554  0.0068505  2305.112   &lt;2e-16 ***\nFID.y1464             15.3240603  0.0104404  1467.769   &lt;2e-16 ***\nFID.y1465             16.1853739  0.0053350  3033.798   &lt;2e-16 ***\nFID.y1468             15.6887227  0.0067962  2308.456   &lt;2e-16 ***\nFID.y1469             14.2624582  0.0221634   643.513   &lt;2e-16 ***\nFID.y1476             13.6632696  0.0492360   277.506   &lt;2e-16 ***\nFID.y1480             15.6471435  0.0103498  1511.833   &lt;2e-16 ***\nFID.y1481             16.6050483  0.0060942  2724.750   &lt;2e-16 ***\nFID.y1482             17.2318088  0.0045531  3784.596   &lt;2e-16 ***\nFID.y1484             15.0360354  0.0108128  1390.584   &lt;2e-16 ***\nFID.y1485             15.2200117  0.0091927  1655.659   &lt;2e-16 ***\nFID.y1486             16.4761342  0.0048473  3399.024   &lt;2e-16 ***\nFID.y1487             15.7183764  0.0083519  1882.010   &lt;2e-16 ***\nFID.y1488             14.4959498  0.0143606  1009.427   &lt;2e-16 ***\nFID.y1490             14.8838537  0.0133072  1118.478   &lt;2e-16 ***\nFID.y1497             15.9884622  0.0081997  1949.882   &lt;2e-16 ***\nFID.y1501             15.7065312  0.0134827  1164.944   &lt;2e-16 ***\nFID.y1502             16.2465919  0.0065742  2471.279   &lt;2e-16 ***\nFID.y1503             15.3563807  0.0167076   919.124   &lt;2e-16 ***\nFID.y1506             14.2076775  0.0303094   468.754   &lt;2e-16 ***\nFID.y1507             17.0588360  0.0033737  5056.474   &lt;2e-16 ***\nFID.y1508             16.4161592  0.0046702  3515.124   &lt;2e-16 ***\nFID.y1509             15.2077206  0.0126337  1203.743   &lt;2e-16 ***\nFID.y1511             14.8217910  0.0119706  1238.186   &lt;2e-16 ***\nFID.y1512             12.8252788  0.0574760   223.141   &lt;2e-16 ***\nFID.y1518             11.6927641  0.1104470   105.868   &lt;2e-16 ***\nFID.y1519             16.3136133  0.0073486  2219.957   &lt;2e-16 ***\nFID.y152              15.9910347  0.0176393   906.558   &lt;2e-16 ***\nFID.y1523             16.2493895  0.0073597  2207.901   &lt;2e-16 ***\nFID.y1524             16.1957250  0.0069179  2341.138   &lt;2e-16 ***\nFID.y1525             15.8089121  0.0101815  1552.708   &lt;2e-16 ***\nFID.y1526             16.3247688  0.0155444  1050.204   &lt;2e-16 ***\nFID.y1527             17.1729106  0.0037619  4565.014   &lt;2e-16 ***\nFID.y1528             16.0863408  0.0059048  2724.274   &lt;2e-16 ***\nFID.y1529             15.9031633  0.0060482  2629.414   &lt;2e-16 ***\nFID.y153              14.3655484  0.0302631   474.688   &lt;2e-16 ***\nFID.y1531             15.7994968  0.0065618  2407.811   &lt;2e-16 ***\nFID.y1534             13.1266455  0.0371345   353.489   &lt;2e-16 ***\nFID.y1539             11.9306944  0.1132422   105.356   &lt;2e-16 ***\nFID.y154              14.9519867  0.0236508   632.198   &lt;2e-16 ***\nFID.y1541             14.1555775  0.0221485   639.121   &lt;2e-16 ***\nFID.y1542             14.0324340  0.0264171   531.187   &lt;2e-16 ***\nFID.y1545             17.6295227  0.0031778  5547.724   &lt;2e-16 ***\nFID.y1546             15.1281623  0.0134031  1128.705   &lt;2e-16 ***\nFID.y1549             15.4386018  0.0084406  1829.085   &lt;2e-16 ***\nFID.y155               8.6405658  1.0000013     8.641   &lt;2e-16 ***\nFID.y1550             16.4795277  0.0043800  3762.428   &lt;2e-16 ***\nFID.y1551             16.0561949  0.0055643  2885.575   &lt;2e-16 ***\nFID.y1552             14.8948748  0.0117300  1269.807   &lt;2e-16 ***\nFID.y1553             14.7816170  0.0177801   831.358   &lt;2e-16 ***\nFID.y1554             16.8181023  0.0041694  4033.712   &lt;2e-16 ***\nFID.y1556             11.2470376  0.1525106    73.746   &lt;2e-16 ***\nFID.y156              16.0274010  0.0126016  1271.851   &lt;2e-16 ***\nFID.y1560             16.9236898  0.0055597  3043.981   &lt;2e-16 ***\nFID.y1562             14.6298216  0.0186137   785.969   &lt;2e-16 ***\nFID.y1563             14.7697963  0.0156819   941.840   &lt;2e-16 ***\nFID.y1564             14.8705465  0.0130612  1138.532   &lt;2e-16 ***\nFID.y1565             15.7365780  0.0084666  1858.673   &lt;2e-16 ***\nFID.y1566             15.8116956  0.0090609  1745.042   &lt;2e-16 ***\nFID.y1567             15.9315268  0.0119056  1338.150   &lt;2e-16 ***\nFID.y157              13.8161563  0.0302643   456.517   &lt;2e-16 ***\nFID.y1570             13.2926111  0.0322465   412.218   &lt;2e-16 ***\nFID.y1571             15.8906065  0.0070010  2269.757   &lt;2e-16 ***\nFID.y1572             17.0273645  0.0037651  4522.445   &lt;2e-16 ***\nFID.y1573             15.0869143  0.0088458  1705.548   &lt;2e-16 ***\nFID.y1574             16.4880870  0.0049370  3339.687   &lt;2e-16 ***\nFID.y1575             15.4171325  0.0091468  1685.525   &lt;2e-16 ***\nFID.y1576             15.1947095  0.0138838  1094.419   &lt;2e-16 ***\nFID.y1579             14.8352791  0.0123672  1199.566   &lt;2e-16 ***\nFID.y158              14.7885676  0.0158820   931.152   &lt;2e-16 ***\nFID.y1580             14.8944802  0.0128663  1157.635   &lt;2e-16 ***\nFID.y1581             14.5990934  0.0140193  1041.355   &lt;2e-16 ***\nFID.y1583             13.2758996  0.0558453   237.726   &lt;2e-16 ***\nFID.y1584             13.5820500  0.0293361   462.981   &lt;2e-16 ***\nFID.y1586             17.0290142  0.0041157  4137.551   &lt;2e-16 ***\nFID.y1587             15.4021974  0.0100603  1530.995   &lt;2e-16 ***\nFID.y1588             15.1570933  0.0113977  1329.841   &lt;2e-16 ***\nFID.y1589             14.2094657  0.0277911   511.295   &lt;2e-16 ***\nFID.y159              15.5886199  0.0184672   844.123   &lt;2e-16 ***\nFID.y1592             11.8042644  0.0800850   147.397   &lt;2e-16 ***\nFID.y1593             14.9311947  0.0113531  1315.160   &lt;2e-16 ***\nFID.y1594             15.2755098  0.0091935  1661.561   &lt;2e-16 ***\nFID.y1595             15.4875166  0.0077612  1995.518   &lt;2e-16 ***\nFID.y1596             14.6307058  0.0156264   936.281   &lt;2e-16 ***\nFID.y1597             13.7577424  0.0418176   328.994   &lt;2e-16 ***\nFID.y1599             13.3468374  0.0484360   275.556   &lt;2e-16 ***\nFID.y1600             15.0477400  0.0133353  1128.418   &lt;2e-16 ***\nFID.y1601             15.4752208  0.0083739  1848.036   &lt;2e-16 ***\nFID.y1602             15.0099126  0.0113246  1325.429   &lt;2e-16 ***\nFID.y1606             14.7835480  0.0121979  1211.973   &lt;2e-16 ***\nFID.y1607             15.5717217  0.0090841  1714.168   &lt;2e-16 ***\nFID.y1608             15.8203905  0.0093403  1693.778   &lt;2e-16 ***\nFID.y1609             17.4658212  0.0043283  4035.254   &lt;2e-16 ***\nFID.y1610             14.4432870  0.0173275   833.548   &lt;2e-16 ***\nFID.y1614             15.9049567  0.0060358  2635.108   &lt;2e-16 ***\nFID.y1615             15.9440754  0.0056933  2800.505   &lt;2e-16 ***\nFID.y1616             15.3660130  0.0080082  1918.794   &lt;2e-16 ***\nFID.y1617             17.0638181  0.0035016  4873.115   &lt;2e-16 ***\nFID.y1618             16.4705527  0.0068249  2413.309   &lt;2e-16 ***\nFID.y1619             15.8546900  0.0070649  2244.142   &lt;2e-16 ***\nFID.y1620             13.0688659  0.0437254   298.885   &lt;2e-16 ***\nFID.y1622             16.1882954  0.0073163  2212.623   &lt;2e-16 ***\nFID.y1623             14.9797710  0.0114603  1307.102   &lt;2e-16 ***\nFID.y1624             14.8873415  0.0115672  1287.027   &lt;2e-16 ***\nFID.y1625             13.1921592  0.0619201   213.051   &lt;2e-16 ***\nFID.y1627             12.5293669  0.1147233   109.214   &lt;2e-16 ***\nFID.y1628             18.0990792  0.0026722  6773.054   &lt;2e-16 ***\nFID.y1629             18.3037520  0.0025293  7236.767   &lt;2e-16 ***\nFID.y1630             16.0018159  0.0068637  2331.381   &lt;2e-16 ***\nFID.y1631             15.7311351  0.0125506  1253.420   &lt;2e-16 ***\nFID.y1632             14.5186498  0.0346274   419.283   &lt;2e-16 ***\nFID.y1635             14.7378040  0.0142992  1030.677   &lt;2e-16 ***\nFID.y1637             15.2427053  0.0083505  1825.355   &lt;2e-16 ***\nFID.y1638             16.2842797  0.0047045  3461.390   &lt;2e-16 ***\nFID.y1639             16.0645576  0.0061227  2623.766   &lt;2e-16 ***\nFID.y1641             15.1778493  0.0091356  1661.395   &lt;2e-16 ***\nFID.y1642             15.9747620  0.0056798  2812.573   &lt;2e-16 ***\nFID.y1643             15.7068793  0.0068645  2288.129   &lt;2e-16 ***\nFID.y1644             16.0298759  0.0081684  1962.415   &lt;2e-16 ***\nFID.y1645             16.8918646  0.0048949  3450.945   &lt;2e-16 ***\nFID.y1646             15.2804527  0.0094080  1624.200   &lt;2e-16 ***\nFID.y1647             14.8495793  0.0163652   907.385   &lt;2e-16 ***\nFID.y1649             14.8439583  0.0161201   920.837   &lt;2e-16 ***\nFID.y1650             16.6096370  0.0043093  3854.384   &lt;2e-16 ***\nFID.y1651             16.3999057  0.0053416  3070.216   &lt;2e-16 ***\nFID.y1652             14.7144024  0.0217875   675.361   &lt;2e-16 ***\nFID.y1653             12.3073019  0.0953614   129.060   &lt;2e-16 ***\nFID.y1654             14.7057626  0.0369799   397.669   &lt;2e-16 ***\nFID.y1657             16.3458735  0.0049170  3324.358   &lt;2e-16 ***\nFID.y1658             14.9853724  0.0136842  1095.083   &lt;2e-16 ***\nFID.y1659             15.3041278  0.0096762  1581.631   &lt;2e-16 ***\nFID.y1661             15.6169391  0.0077701  2009.886   &lt;2e-16 ***\nFID.y1662             15.1551655  0.0083462  1815.812   &lt;2e-16 ***\nFID.y1663             16.1367137  0.0057342  2814.094   &lt;2e-16 ***\nFID.y1664             15.7563565  0.0065335  2411.618   &lt;2e-16 ***\nFID.y1665             15.8248499  0.0078970  2003.906   &lt;2e-16 ***\nFID.y1666             15.8322346  0.0069896  2265.105   &lt;2e-16 ***\nFID.y1667             15.6043473  0.0082293  1896.192   &lt;2e-16 ***\nFID.y1668             14.7677901  0.0126173  1170.436   &lt;2e-16 ***\nFID.y1671             16.0225455  0.0075432  2124.107   &lt;2e-16 ***\nFID.y1672             15.2857212  0.0104397  1464.195   &lt;2e-16 ***\nFID.y1673             16.9245070  0.0067933  2491.363   &lt;2e-16 ***\nFID.y1675             14.6374303  0.0428344   341.721   &lt;2e-16 ***\nFID.y1678             15.6137139  0.0079358  1967.512   &lt;2e-16 ***\nFID.y1679             16.4456140  0.0046135  3564.702   &lt;2e-16 ***\nFID.y1680             15.8790477  0.0063801  2488.826   &lt;2e-16 ***\nFID.y1681             15.4041749  0.0071416  2156.956   &lt;2e-16 ***\nFID.y1682             15.7866066  0.0101472  1555.763   &lt;2e-16 ***\nFID.y1683             16.7490656  0.0043187  3878.243   &lt;2e-16 ***\nFID.y1684             15.8542473  0.0058894  2691.984   &lt;2e-16 ***\nFID.y1685             15.0892127  0.0097815  1542.629   &lt;2e-16 ***\nFID.y1686             14.5042905  0.0163373   887.804   &lt;2e-16 ***\nFID.y1687             15.6669511  0.0068868  2274.940   &lt;2e-16 ***\nFID.y1688             14.6704941  0.0117408  1249.526   &lt;2e-16 ***\nFID.y1689             16.4247575  0.0050746  3236.689   &lt;2e-16 ***\nFID.y1692             14.2385846  0.0227347   626.293   &lt;2e-16 ***\nFID.y1693             15.5033016  0.0090488  1713.301   &lt;2e-16 ***\nFID.y1694             16.8840944  0.0051467  3280.574   &lt;2e-16 ***\nFID.y1700             16.2404044  0.0049169  3302.974   &lt;2e-16 ***\nFID.y1701             16.2867447  0.0046434  3507.503   &lt;2e-16 ***\nFID.y1702             16.4336237  0.0042841  3835.980   &lt;2e-16 ***\nFID.y1703             14.4877446  0.0247704   584.882   &lt;2e-16 ***\nFID.y1704             15.7211610  0.0068920  2281.086   &lt;2e-16 ***\nFID.y1705             16.2466876  0.0050717  3203.371   &lt;2e-16 ***\nFID.y1706             15.8645341  0.0080023  1982.506   &lt;2e-16 ***\nFID.y1707             14.5339432  0.0119676  1214.444   &lt;2e-16 ***\nFID.y1708             15.9522246  0.0065914  2420.161   &lt;2e-16 ***\nFID.y1709             16.4534545  0.0042276  3891.942   &lt;2e-16 ***\nFID.y1710             16.6733378  0.0041244  4042.570   &lt;2e-16 ***\nFID.y1711             16.6437190  0.0051683  3220.342   &lt;2e-16 ***\nFID.y1714             16.0800174  0.0072078  2230.927   &lt;2e-16 ***\nFID.y1715             15.9162354  0.0087163  1826.032   &lt;2e-16 ***\nFID.y1721             11.7384745  0.1250139    93.897   &lt;2e-16 ***\nFID.y1722             16.9613572  0.0043508  3898.407   &lt;2e-16 ***\nFID.y1723             16.2680482  0.0048138  3379.482   &lt;2e-16 ***\nFID.y1724             15.4643383  0.0091803  1684.511   &lt;2e-16 ***\nFID.y1725             16.3716687  0.0054972  2978.186   &lt;2e-16 ***\nFID.y1726             14.9830967  0.0147340  1016.904   &lt;2e-16 ***\nFID.y1727             17.5215392  0.0027895  6281.326   &lt;2e-16 ***\nFID.y1728             16.6401387  0.0044559  3734.430   &lt;2e-16 ***\nFID.y1729             17.5709639  0.0028812  6098.517   &lt;2e-16 ***\nFID.y1730             15.3524840  0.0100900  1521.553   &lt;2e-16 ***\nFID.y1731             17.3051565  0.0031358  5518.539   &lt;2e-16 ***\nFID.y1732             14.8003762  0.0135203  1094.677   &lt;2e-16 ***\nFID.y1733             17.0879825  0.0048530  3521.136   &lt;2e-16 ***\nFID.y1736             16.0887741  0.0067330  2389.548   &lt;2e-16 ***\nFID.y1737             14.2273815  0.0316347   449.739   &lt;2e-16 ***\nFID.y174              14.1486229  0.0477050   296.586   &lt;2e-16 ***\nFID.y1743             16.7577335  0.0046731  3585.976   &lt;2e-16 ***\nFID.y1744             16.6271423  0.0042423  3919.361   &lt;2e-16 ***\nFID.y1745             16.5312494  0.0039936  4139.468   &lt;2e-16 ***\nFID.y1746             16.4829827  0.0045174  3648.772   &lt;2e-16 ***\nFID.y1747             15.9107888  0.0076935  2068.070   &lt;2e-16 ***\nFID.y1748             15.6224352  0.0079184  1972.936   &lt;2e-16 ***\nFID.y1749             15.5765199  0.0067453  2309.240   &lt;2e-16 ***\nFID.y175              14.8855124  0.0285709   521.002   &lt;2e-16 ***\nFID.y1750             14.9128855  0.0098929  1507.435   &lt;2e-16 ***\nFID.y1751             14.5929866  0.0119513  1221.041   &lt;2e-16 ***\nFID.y1752             17.0908089  0.0034917  4894.669   &lt;2e-16 ***\nFID.y1753             16.4429379  0.0057916  2839.095   &lt;2e-16 ***\nFID.y1757             13.3368539  0.0656760   203.070   &lt;2e-16 ***\nFID.y1758             15.5654350  0.0151079  1030.283   &lt;2e-16 ***\nFID.y1765             16.6117634  0.0045220  3673.579   &lt;2e-16 ***\nFID.y1766             15.8309667  0.0057731  2742.172   &lt;2e-16 ***\nFID.y1767             16.7735587  0.0037088  4522.659   &lt;2e-16 ***\nFID.y1768             15.5188345  0.0075736  2049.061   &lt;2e-16 ***\nFID.y1769             16.0826264  0.0059037  2724.181   &lt;2e-16 ***\nFID.y177              14.8321760  0.0256037   579.299   &lt;2e-16 ***\nFID.y1770             15.9253419  0.0056763  2805.565   &lt;2e-16 ***\nFID.y1771             16.3838310  0.0043287  3784.968   &lt;2e-16 ***\nFID.y1772             15.4188768  0.0095613  1612.639   &lt;2e-16 ***\nFID.y1773             16.3290371  0.0048343  3377.737   &lt;2e-16 ***\nFID.y1774             15.8824200  0.0062721  2532.240   &lt;2e-16 ***\nFID.y1776             15.3006532  0.0113670  1346.058   &lt;2e-16 ***\nFID.y1779             14.6100820  0.0166477   877.604   &lt;2e-16 ***\nFID.y178              15.5793823  0.0172998   900.555   &lt;2e-16 ***\nFID.y1786             14.2167154  0.0282134   503.899   &lt;2e-16 ***\nFID.y1788             16.5623840  0.0045433  3645.415   &lt;2e-16 ***\nFID.y1789             15.5908586  0.0076159  2047.144   &lt;2e-16 ***\nFID.y179              15.2810339  0.0123423  1238.105   &lt;2e-16 ***\nFID.y1790             15.0193701  0.0093002  1614.959   &lt;2e-16 ***\nFID.y1791             15.8329541  0.0059792  2648.000   &lt;2e-16 ***\nFID.y1792             17.1848990  0.0048881  3515.650   &lt;2e-16 ***\nFID.y1793             15.1240039  0.0140932  1073.143   &lt;2e-16 ***\nFID.y1794             16.2327931  0.0051336  3162.062   &lt;2e-16 ***\nFID.y1795             16.2444524  0.0051101  3178.903   &lt;2e-16 ***\nFID.y1796             17.6702259  0.0036995  4776.421   &lt;2e-16 ***\nFID.y180              15.4249810  0.0109309  1411.138   &lt;2e-16 ***\nFID.y1801             12.7169019  0.0573832   221.614   &lt;2e-16 ***\nFID.y1808             15.2867809  0.0133241  1147.302   &lt;2e-16 ***\nFID.y1809             16.1792745  0.0059160  2734.826   &lt;2e-16 ***\nFID.y1810             16.1758370  0.0049465  3270.147   &lt;2e-16 ***\nFID.y1811             16.3063470  0.0048708  3347.759   &lt;2e-16 ***\nFID.y1812             16.1457889  0.0059218  2726.502   &lt;2e-16 ***\nFID.y1813             15.7568377  0.0079834  1973.696   &lt;2e-16 ***\nFID.y1814             15.5813028  0.0070361  2214.479   &lt;2e-16 ***\nFID.y1815             14.9944351  0.0091904  1631.526   &lt;2e-16 ***\nFID.y1816             13.8190906  0.0412736   334.817   &lt;2e-16 ***\nFID.y1817             15.1520617  0.0149325  1014.703   &lt;2e-16 ***\nFID.y1819             13.6310905  0.0269443   505.898   &lt;2e-16 ***\nFID.y1820             14.8636621  0.0167916   885.187   &lt;2e-16 ***\nFID.y1821             14.6818486  0.0182492   804.520   &lt;2e-16 ***\nFID.y1828             13.9906554  0.0503448   277.897   &lt;2e-16 ***\nFID.y1829             12.9756482  0.1020778   127.115   &lt;2e-16 ***\nFID.y1830             13.7543115  0.0454439   302.666   &lt;2e-16 ***\nFID.y1832             16.2773500  0.0047738  3409.709   &lt;2e-16 ***\nFID.y1833             16.5260076  0.0042310  3905.907   &lt;2e-16 ***\nFID.y1834             14.1749849  0.0206335   686.989   &lt;2e-16 ***\nFID.y1835             16.0545433  0.0091091  1762.478   &lt;2e-16 ***\nFID.y1836             14.8491569  0.0151675   979.010   &lt;2e-16 ***\nFID.y1837             15.1956879  0.0222002   684.484   &lt;2e-16 ***\nFID.y1838             15.4638825  0.0081987  1886.137   &lt;2e-16 ***\nFID.y1839             16.3757012  0.0056937  2876.133   &lt;2e-16 ***\nFID.y1840             14.5410834  0.0162676   893.867   &lt;2e-16 ***\nFID.y1842             13.7974288  0.0304958   452.437   &lt;2e-16 ***\nFID.y1843             15.6418234  0.0115153  1358.355   &lt;2e-16 ***\nFID.y1850             12.8675946  0.0712667   180.556   &lt;2e-16 ***\nFID.y1851             12.9591351  0.1154846   112.215   &lt;2e-16 ***\nFID.y1853             15.4700900  0.0090115  1716.707   &lt;2e-16 ***\nFID.y1854             16.4258000  0.0044783  3667.831   &lt;2e-16 ***\nFID.y1855             15.7845585  0.0059192  2666.668   &lt;2e-16 ***\nFID.y1856             16.5943351  0.0069915  2373.499   &lt;2e-16 ***\nFID.y1857             13.7473252  0.0221249   621.350   &lt;2e-16 ***\nFID.y1858             15.1006341  0.0084797  1780.800   &lt;2e-16 ***\nFID.y1859             15.6860629  0.0078842  1989.568   &lt;2e-16 ***\nFID.y1860             16.4942505  0.0051558  3199.149   &lt;2e-16 ***\nFID.y1863             15.0744271  0.0135371  1113.567   &lt;2e-16 ***\nFID.y1865             14.5318105  0.0210385   690.724   &lt;2e-16 ***\nFID.y1874             15.0371670  0.0192281   782.042   &lt;2e-16 ***\nFID.y1875             14.8629519  0.0155249   957.364   &lt;2e-16 ***\nFID.y1876             15.9298512  0.0071096  2240.604   &lt;2e-16 ***\nFID.y1877             16.7516280  0.0037703  4443.089   &lt;2e-16 ***\nFID.y1878             16.1528907  0.0056545  2856.644   &lt;2e-16 ***\nFID.y1879             14.6569381  0.0165082   887.856   &lt;2e-16 ***\nFID.y1880             14.4884147  0.0132273  1095.341   &lt;2e-16 ***\nFID.y1881             12.4239362  0.0677490   183.382   &lt;2e-16 ***\nFID.y1882             16.8839599  0.0045154  3739.197   &lt;2e-16 ***\nFID.y1883             15.7122147  0.0076286  2059.652   &lt;2e-16 ***\nFID.y1885             14.5827654  0.0157420   926.359   &lt;2e-16 ***\nFID.y1894             11.9363300  0.1924587    62.020   &lt;2e-16 ***\nFID.y1897             16.3785950  0.0043255  3786.520   &lt;2e-16 ***\nFID.y1898             16.3051316  0.0052664  3096.095   &lt;2e-16 ***\nFID.y1899             16.6521352  0.0049226  3382.783   &lt;2e-16 ***\nFID.y1900             14.5961971  0.0114717  1272.363   &lt;2e-16 ***\nFID.y1901             17.6654782  0.0027484  6427.658   &lt;2e-16 ***\nFID.y1902             14.7983914  0.0098721  1499.015   &lt;2e-16 ***\nFID.y1903             17.0601983  0.0038895  4386.248   &lt;2e-16 ***\nFID.y1905             15.4669963  0.0087708  1763.455   &lt;2e-16 ***\nFID.y1906             16.6324180  0.0050913  3266.820   &lt;2e-16 ***\nFID.y1907             15.5435149  0.0175172   887.331   &lt;2e-16 ***\nFID.y1917             14.8776498  0.0176852   841.248   &lt;2e-16 ***\nFID.y1918             13.5088157  0.0300766   449.147   &lt;2e-16 ***\nFID.y1919             14.1202480  0.0300510   469.876   &lt;2e-16 ***\nFID.y1920             16.6841937  0.0047805  3490.070   &lt;2e-16 ***\nFID.y1921             15.0325519  0.0114935  1307.917   &lt;2e-16 ***\nFID.y1922             16.6789956  0.0040083  4161.093   &lt;2e-16 ***\nFID.y1923             15.7344512  0.0061922  2541.028   &lt;2e-16 ***\nFID.y1924             15.9285833  0.0060379  2638.109   &lt;2e-16 ***\nFID.y1925             16.6444579  0.0043045  3866.751   &lt;2e-16 ***\nFID.y1926             15.4759489  0.0082833  1868.335   &lt;2e-16 ***\nFID.y1927             14.9137452  0.0121037  1232.164   &lt;2e-16 ***\nFID.y1928             13.4934787  0.0296971   454.370   &lt;2e-16 ***\nFID.y1939             16.5371506  0.0106538  1552.228   &lt;2e-16 ***\nFID.y1940             15.4767917  0.0064813  2387.908   &lt;2e-16 ***\nFID.y1941             16.1016209  0.0109620  1468.864   &lt;2e-16 ***\nFID.y1942             15.9161194  0.0062346  2552.875   &lt;2e-16 ***\nFID.y1943             16.0383200  0.0076173  2105.518   &lt;2e-16 ***\nFID.y1944             15.9151342  0.0054514  2919.449   &lt;2e-16 ***\nFID.y1946             16.0543468  0.0053209  3017.210   &lt;2e-16 ***\nFID.y1947             14.2824462  0.0146777   973.071   &lt;2e-16 ***\nFID.y1948             15.7243454  0.0081099  1938.897   &lt;2e-16 ***\nFID.y1960             15.7434698  0.0118918  1323.889   &lt;2e-16 ***\nFID.y1961             15.5252749  0.0073265  2119.058   &lt;2e-16 ***\nFID.y1962             16.6182350  0.0041848  3971.131   &lt;2e-16 ***\nFID.y1963             16.3841405  0.0047096  3478.885   &lt;2e-16 ***\nFID.y1964             15.3713799  0.0157164   978.049   &lt;2e-16 ***\nFID.y1965             14.8890349  0.0102199  1456.871   &lt;2e-16 ***\nFID.y1966             15.1410497  0.0106226  1425.368   &lt;2e-16 ***\nFID.y1967             15.4266453  0.0082399  1872.183   &lt;2e-16 ***\nFID.y1968             16.1395372  0.0056761  2843.433   &lt;2e-16 ***\nFID.y197              13.6756554  0.0442706   308.910   &lt;2e-16 ***\nFID.y1970             14.8156507  0.0158375   935.477   &lt;2e-16 ***\nFID.y1982             15.0584382  0.0103800  1450.722   &lt;2e-16 ***\nFID.y1983             15.3537161  0.0082955  1850.844   &lt;2e-16 ***\nFID.y1984             15.5992544  0.0069538  2243.257   &lt;2e-16 ***\nFID.y1985             15.9362994  0.0075041  2123.674   &lt;2e-16 ***\nFID.y1986             15.6704812  0.0068235  2296.532   &lt;2e-16 ***\nFID.y1987             15.9722902  0.0070358  2270.158   &lt;2e-16 ***\nFID.y1988             15.8961579  0.0077958  2039.061   &lt;2e-16 ***\nFID.y1989             16.4887567  0.0046968  3510.631   &lt;2e-16 ***\nFID.y199              15.8444869  0.0133994  1182.474   &lt;2e-16 ***\nFID.y1990             15.9837000  0.0104666  1527.121   &lt;2e-16 ***\nFID.y1991             15.0432835  0.0182912   822.432   &lt;2e-16 ***\nFID.y200              13.6198831  0.0267351   509.439   &lt;2e-16 ***\nFID.y2003             15.2395940  0.0140433  1085.187   &lt;2e-16 ***\nFID.y2004             16.4514502  0.0053219  3091.254   &lt;2e-16 ***\nFID.y2005             16.1288285  0.0060256  2676.719   &lt;2e-16 ***\nFID.y2006             15.5857195  0.0070917  2197.729   &lt;2e-16 ***\nFID.y2007             16.4551217  0.0047015  3499.952   &lt;2e-16 ***\nFID.y2009             17.5773636  0.0037992  4626.547   &lt;2e-16 ***\nFID.y201              14.7768487  0.0264314   559.064   &lt;2e-16 ***\nFID.y2010             15.5700284  0.0072322  2152.865   &lt;2e-16 ***\nFID.y2011             16.6112584  0.0048113  3452.532   &lt;2e-16 ***\nFID.y2012             14.6728972  0.0155044   946.372   &lt;2e-16 ***\nFID.y2013             14.8576023  0.0187453   792.606   &lt;2e-16 ***\nFID.y202              12.3834681  0.0767168   161.418   &lt;2e-16 ***\nFID.y2025             15.5934947  0.0105135  1483.190   &lt;2e-16 ***\nFID.y2026             15.1703998  0.0099403  1526.145   &lt;2e-16 ***\nFID.y2027             15.2803772  0.0078870  1937.407   &lt;2e-16 ***\nFID.y2028             16.4797004  0.0042942  3837.668   &lt;2e-16 ***\nFID.y2029             13.4027056  0.0354274   378.315   &lt;2e-16 ***\nFID.y2030             16.4402239  0.0049298  3334.844   &lt;2e-16 ***\nFID.y2031             15.3728323  0.0080404  1911.958   &lt;2e-16 ***\nFID.y2032             17.2071017  0.0033525  5132.665   &lt;2e-16 ***\nFID.y2033             15.1650355  0.0107717  1407.860   &lt;2e-16 ***\nFID.y2034             16.2717446  0.0060380  2694.887   &lt;2e-16 ***\nFID.y2035             15.1720475  0.0260831   581.680   &lt;2e-16 ***\nFID.y2047             14.5479463  0.0146427   993.527   &lt;2e-16 ***\nFID.y2048             16.9183319  0.0035433  4774.692   &lt;2e-16 ***\nFID.y2049             16.6430508  0.0041221  4037.499   &lt;2e-16 ***\nFID.y2050             15.5264408  0.0136376  1138.504   &lt;2e-16 ***\nFID.y2051             15.2391010  0.0101475  1501.756   &lt;2e-16 ***\nFID.y2052             16.2385469  0.0055377  2932.381   &lt;2e-16 ***\nFID.y2053             17.0948307  0.0033497  5103.370   &lt;2e-16 ***\nFID.y2054             15.5217004  0.0074733  2076.962   &lt;2e-16 ***\nFID.y2055             15.5169683  0.0076610  2025.457   &lt;2e-16 ***\nFID.y2056             15.8345751  0.0089690  1765.482   &lt;2e-16 ***\nFID.y2068             15.6150828  0.0076830  2032.419   &lt;2e-16 ***\nFID.y2069             15.1622169  0.0089161  1700.544   &lt;2e-16 ***\nFID.y2071             17.1407640  0.0064670  2650.504   &lt;2e-16 ***\nFID.y2072             15.2193950  0.0104474  1456.770   &lt;2e-16 ***\nFID.y2074             16.3481572  0.0048927  3341.320   &lt;2e-16 ***\nFID.y2075             16.0871029  0.0053058  3031.973   &lt;2e-16 ***\nFID.y2076             17.3492417  0.0034066  5092.820   &lt;2e-16 ***\nFID.y2077             17.8762009  0.0027563  6485.593   &lt;2e-16 ***\nFID.y2078             16.1473603  0.0069431  2325.656   &lt;2e-16 ***\nFID.y2090             15.4696552  0.0085528  1808.720   &lt;2e-16 ***\nFID.y2091             16.6523406  0.0040749  4086.609   &lt;2e-16 ***\nFID.y2092             16.4891906  0.0053388  3088.558   &lt;2e-16 ***\nFID.y2093             16.6202323  0.0047082  3530.052   &lt;2e-16 ***\nFID.y2094             16.0717409  0.0113137  1420.551   &lt;2e-16 ***\nFID.y2096             14.7651260  0.0149172   989.803   &lt;2e-16 ***\nFID.y2097             15.3386580  0.0080323  1909.611   &lt;2e-16 ***\nFID.y2098             16.2412388  0.0053372  3043.011   &lt;2e-16 ***\nFID.y2099             14.7057191  0.0165424   888.971   &lt;2e-16 ***\nFID.y2100             15.9856690  0.0084707  1887.163   &lt;2e-16 ***\nFID.y2111             16.0081630  0.0064341  2488.013   &lt;2e-16 ***\nFID.y2112             15.6179118  0.0103046  1515.623   &lt;2e-16 ***\nFID.y2113             16.1983919  0.0060261  2688.046   &lt;2e-16 ***\nFID.y2114             16.4971998  0.0043134  3824.627   &lt;2e-16 ***\nFID.y2115             16.8231206  0.0082536  2038.268   &lt;2e-16 ***\nFID.y2116             17.3423946  0.0071979  2409.384   &lt;2e-16 ***\nFID.y2117             14.2952656  0.0238601   599.128   &lt;2e-16 ***\nFID.y2118             16.1120114  0.0063139  2551.836   &lt;2e-16 ***\nFID.y2119             15.7120630  0.0073290  2143.812   &lt;2e-16 ***\nFID.y2120             16.6534519  0.0044141  3772.774   &lt;2e-16 ***\nFID.y2121             17.8132009  0.0028923  6158.856   &lt;2e-16 ***\nFID.y2122             14.8408957  0.0216383   685.861   &lt;2e-16 ***\nFID.y2133             16.2839653  0.0058773  2770.653   &lt;2e-16 ***\nFID.y2134             16.0515361  0.0051079  3142.503   &lt;2e-16 ***\nFID.y2135             16.2974908  0.0048749  3343.116   &lt;2e-16 ***\nFID.y2136             15.4710709  0.0136917  1129.956   &lt;2e-16 ***\nFID.y2140             15.1042297  0.0114414  1320.136   &lt;2e-16 ***\nFID.y2141             15.9259372  0.0065548  2429.676   &lt;2e-16 ***\nFID.y2142             15.1464583  0.0107460  1409.504   &lt;2e-16 ***\nFID.y2143             15.4997150  0.0112232  1381.043   &lt;2e-16 ***\nFID.y2144             15.5055329  0.0175400   884.011   &lt;2e-16 ***\nFID.y2154             16.9239921  0.0043519  3888.902   &lt;2e-16 ***\nFID.y2155             15.0374992  0.0107513  1398.662   &lt;2e-16 ***\nFID.y2156             16.5406054  0.0044295  3734.155   &lt;2e-16 ***\nFID.y2157             16.5330368  0.0045424  3639.739   &lt;2e-16 ***\nFID.y2160             16.0319294  0.0133506  1200.840   &lt;2e-16 ***\nFID.y2162             13.8867774  0.0294655   471.289   &lt;2e-16 ***\nFID.y2163             17.6178508  0.0032407  5436.367   &lt;2e-16 ***\nFID.y2164             15.7815395  0.0073998  2132.685   &lt;2e-16 ***\nFID.y2176             15.8028133  0.0060745  2601.498   &lt;2e-16 ***\nFID.y2177             14.9788160  0.0101762  1471.953   &lt;2e-16 ***\nFID.y2178             13.8363151  0.0450226   307.319   &lt;2e-16 ***\nFID.y2179             16.6440619  0.0049511  3361.675   &lt;2e-16 ***\nFID.y2182             16.4838179  0.0084503  1950.676   &lt;2e-16 ***\nFID.y2184             15.2847351  0.0105123  1453.980   &lt;2e-16 ***\nFID.y2185             15.8822708  0.0070766  2244.335   &lt;2e-16 ***\nFID.y2187             15.5837008  0.0202047   771.289   &lt;2e-16 ***\nFID.y2197             15.0672085  0.0120051  1255.064   &lt;2e-16 ***\nFID.y2198             14.7967259  0.0126556  1169.183   &lt;2e-16 ***\nFID.y2199             16.2659251  0.0050460  3223.501   &lt;2e-16 ***\nFID.y220               8.9412911  0.7071087    12.645   &lt;2e-16 ***\nFID.y2200             16.2970689  0.0066825  2438.767   &lt;2e-16 ***\nFID.y2201             15.0657345  0.0166234   906.299   &lt;2e-16 ***\nFID.y2204             15.6041360  0.0139481  1118.732   &lt;2e-16 ***\nFID.y2206             15.7728982  0.0083383  1891.610   &lt;2e-16 ***\nFID.y2207             15.7840424  0.0102477  1540.252   &lt;2e-16 ***\nFID.y221              16.3747806  0.0124729  1312.832   &lt;2e-16 ***\nFID.y2219             16.0830684  0.0055564  2894.509   &lt;2e-16 ***\nFID.y222              15.0666929  0.0123066  1224.278   &lt;2e-16 ***\nFID.y2220             14.2945347  0.0164198   870.565   &lt;2e-16 ***\nFID.y2221             14.7776436  0.0244539   604.305   &lt;2e-16 ***\nFID.y2222             16.9335273  0.0041604  4070.166   &lt;2e-16 ***\nFID.y2226             13.0934180  0.1280528   102.250   &lt;2e-16 ***\nFID.y2228             15.2541798  0.0105191  1450.142   &lt;2e-16 ***\nFID.y223              13.8391193  0.1767884    78.281   &lt;2e-16 ***\nFID.y2241             14.9503181  0.0107945  1384.990   &lt;2e-16 ***\nFID.y2242             15.5889745  0.0072565  2148.291   &lt;2e-16 ***\nFID.y2243             15.1249487  0.0116051  1303.297   &lt;2e-16 ***\nFID.y2244             14.6016240  0.0237663   614.385   &lt;2e-16 ***\nFID.y2247             12.4725762  0.0658185   189.499   &lt;2e-16 ***\nFID.y2249             15.0066340  0.0132400  1133.433   &lt;2e-16 ***\nFID.y2250             14.7862664  0.0232470   636.050   &lt;2e-16 ***\nFID.y2262             15.1266351  0.0108948  1388.425   &lt;2e-16 ***\nFID.y2263             15.1002912  0.0120331  1254.893   &lt;2e-16 ***\nFID.y2264             16.5581993  0.0077142  2146.454   &lt;2e-16 ***\nFID.y2265             15.9390904  0.0072069  2211.640   &lt;2e-16 ***\nFID.y2268             13.6936975  0.0520862   262.904   &lt;2e-16 ***\nFID.y2269             16.0451870  0.0092767  1729.618   &lt;2e-16 ***\nFID.y2271             15.0251481  0.0217078   692.154   &lt;2e-16 ***\nFID.y2284             15.6714584  0.0071761  2183.851   &lt;2e-16 ***\nFID.y2285             16.6390073  0.0043624  3814.178   &lt;2e-16 ***\nFID.y2286             15.8101910  0.0082858  1908.109   &lt;2e-16 ***\nFID.y2288             12.8249163  0.1250155   102.587   &lt;2e-16 ***\nFID.y2290             16.1822489  0.0104623  1546.727   &lt;2e-16 ***\nFID.y2305             15.6688829  0.0107179  1461.936   &lt;2e-16 ***\nFID.y2306             13.6353215  0.0459134   296.979   &lt;2e-16 ***\nFID.y2307             15.1541224  0.0099696  1520.029   &lt;2e-16 ***\nFID.y2308             15.5412440  0.0099745  1558.102   &lt;2e-16 ***\nFID.y2309             16.0126146  0.0076117  2103.697   &lt;2e-16 ***\nFID.y2310             13.4630105  0.0330514   407.336   &lt;2e-16 ***\nFID.y2311             14.5354040  0.0200949   723.339   &lt;2e-16 ***\nFID.y2327             15.4975047  0.0081709  1896.672   &lt;2e-16 ***\nFID.y2328             17.9325837  0.0026171  6852.087   &lt;2e-16 ***\nFID.y2329             15.8064800  0.0083207  1899.669   &lt;2e-16 ***\nFID.y2331             16.1985771  0.0068304  2371.549   &lt;2e-16 ***\nFID.y2332             15.2744068  0.0094095  1623.291   &lt;2e-16 ***\nFID.y2333             17.3631215  0.0040916  4243.611   &lt;2e-16 ***\nFID.y2349             16.1392934  0.0061267  2634.262   &lt;2e-16 ***\nFID.y2350             15.9488703  0.0061379  2598.416   &lt;2e-16 ***\nFID.y2351             16.8730353  0.0043620  3868.147   &lt;2e-16 ***\nFID.y2352             17.0398512  0.0040158  4243.203   &lt;2e-16 ***\nFID.y2353             15.9252051  0.0071853  2216.352   &lt;2e-16 ***\nFID.y2354             15.0336507  0.0102587  1465.455   &lt;2e-16 ***\nFID.y2355             16.4752801  0.0055413  2973.186   &lt;2e-16 ***\nFID.y2370             14.9737477  0.0110900  1350.202   &lt;2e-16 ***\nFID.y2371             16.1896982  0.0052313  3094.778   &lt;2e-16 ***\nFID.y2372             16.5556135  0.0045798  3614.934   &lt;2e-16 ***\nFID.y2373             15.0058985  0.0099724  1504.740   &lt;2e-16 ***\nFID.y2374             15.6689046  0.0085189  1839.305   &lt;2e-16 ***\nFID.y2375             15.8726359  0.0071150  2230.865   &lt;2e-16 ***\nFID.y2376             13.3613853  0.0465058   287.306   &lt;2e-16 ***\nFID.y2377             16.1593617  0.0089986  1795.755   &lt;2e-16 ***\nFID.y2392             15.0432098  0.0106379  1414.114   &lt;2e-16 ***\nFID.y2393             15.2843588  0.0093742  1630.468   &lt;2e-16 ***\nFID.y2395             16.8748659  0.0044942  3754.789   &lt;2e-16 ***\nFID.y2396             15.8842334  0.0066245  2397.803   &lt;2e-16 ***\nFID.y2397             14.3245454  0.0165221   866.993   &lt;2e-16 ***\nFID.y2398             16.7687434  0.0047142  3557.057   &lt;2e-16 ***\nFID.y2414             15.4857774  0.0083036  1864.938   &lt;2e-16 ***\nFID.y2415             16.2695900  0.0083780  1941.931   &lt;2e-16 ***\nFID.y2416             16.8168578  0.0059803  2812.036   &lt;2e-16 ***\nFID.y2417             16.6168651  0.0042799  3882.530   &lt;2e-16 ***\nFID.y2418             15.2410868  0.0108590  1403.551   &lt;2e-16 ***\nFID.y2419             15.2595253  0.0097412  1566.501   &lt;2e-16 ***\nFID.y242              13.7403720  0.0422544   325.182   &lt;2e-16 ***\nFID.y2420             14.8907141  0.0163435   911.110   &lt;2e-16 ***\nFID.y243              15.7886624  0.0102536  1539.818   &lt;2e-16 ***\nFID.y2435             15.4819895  0.0089860  1722.895   &lt;2e-16 ***\nFID.y2436             17.1508079  0.0036630  4682.182   &lt;2e-16 ***\nFID.y2437             16.4614544  0.0069299  2375.431   &lt;2e-16 ***\nFID.y2438             16.2560898  0.0049116  3309.736   &lt;2e-16 ***\nFID.y2439             18.2702421  0.0024334  7508.164   &lt;2e-16 ***\nFID.y244              14.6379582  0.0249874   585.813   &lt;2e-16 ***\nFID.y2440             15.0585906  0.0164439   915.757   &lt;2e-16 ***\nFID.y2441             15.6551748  0.0089836  1742.636   &lt;2e-16 ***\nFID.y2457             13.4482074  0.0439265   306.152   &lt;2e-16 ***\nFID.y2458             15.5900908  0.0087039  1791.162   &lt;2e-16 ***\nFID.y2459             17.2303006  0.0051366  3354.436   &lt;2e-16 ***\nFID.y2460             16.3345847  0.0056485  2891.842   &lt;2e-16 ***\nFID.y2462             17.9144709  0.0027754  6454.762   &lt;2e-16 ***\nFID.y2463             14.4043662  0.0289633   497.332   &lt;2e-16 ***\nFID.y2478             15.9728682  0.0073757  2165.597   &lt;2e-16 ***\nFID.y2479             15.7109372  0.0074220  2116.796   &lt;2e-16 ***\nFID.y2480             16.3942462  0.0051938  3156.519   &lt;2e-16 ***\nFID.y2481             15.0879557  0.0097337  1550.068   &lt;2e-16 ***\nFID.y2482             15.8975935  0.0064061  2481.640   &lt;2e-16 ***\nFID.y2483             15.1820685  0.0118162  1284.852   &lt;2e-16 ***\nFID.y2499             15.0420564  0.0754072   199.478   &lt;2e-16 ***\nFID.y2500             15.4239963  0.0124771  1236.181   &lt;2e-16 ***\nFID.y2501             16.9910957  0.0043204  3932.757   &lt;2e-16 ***\nFID.y2502             16.7827513  0.0045846  3660.686   &lt;2e-16 ***\nFID.y2503             16.3527930  0.0048360  3381.454   &lt;2e-16 ***\nFID.y2504             16.0159427  0.0080848  1981.004   &lt;2e-16 ***\nFID.y2505             16.4193192  0.0053478  3070.314   &lt;2e-16 ***\nFID.y2521             14.2416084  0.0328595   433.409   &lt;2e-16 ***\nFID.y2523             14.4660246  0.0147845   978.460   &lt;2e-16 ***\nFID.y2524             15.5938961  0.0085411  1825.752   &lt;2e-16 ***\nFID.y2525             17.3395783  0.0032289  5370.108   &lt;2e-16 ***\nFID.y2526             16.4716042  0.0055012  2994.187   &lt;2e-16 ***\nFID.y2527             15.5941477  0.0158787   982.077   &lt;2e-16 ***\nFID.y2544             15.1450380  0.0107375  1410.483   &lt;2e-16 ***\nFID.y2545             15.9603137  0.0063138  2527.831   &lt;2e-16 ***\nFID.y2546             16.1535948  0.0078682  2053.029   &lt;2e-16 ***\nFID.y2547             14.5936512  0.0123416  1182.477   &lt;2e-16 ***\nFID.y2548             15.5939614  0.0084276  1850.342   &lt;2e-16 ***\nFID.y2565             15.5575974  0.0228370   681.245   &lt;2e-16 ***\nFID.y2566             15.5257018  0.0081854  1896.766   &lt;2e-16 ***\nFID.y2567             15.6301479  0.0093704  1668.033   &lt;2e-16 ***\nFID.y2568             15.5775704  0.0076357  2040.095   &lt;2e-16 ***\nFID.y2569             15.8463583  0.0065579  2416.359   &lt;2e-16 ***\nFID.y2570             14.8878324  0.0152756   974.613   &lt;2e-16 ***\nFID.y2587             16.5891918  0.0071414  2322.976   &lt;2e-16 ***\nFID.y2588             13.6425551  0.0237895   573.470   &lt;2e-16 ***\nFID.y2589             16.0838449  0.0062610  2568.879   &lt;2e-16 ***\nFID.y2590             15.7067986  0.0071078  2209.810   &lt;2e-16 ***\nFID.y2591             15.6233113  0.0092571  1687.717   &lt;2e-16 ***\nFID.y2608             16.5031974  0.0132481  1245.701   &lt;2e-16 ***\nFID.y2609             16.5831011  0.0066433  2496.199   &lt;2e-16 ***\nFID.y2610             17.4126250  0.0067593  2576.115   &lt;2e-16 ***\nFID.y2611             16.0050503  0.0073423  2179.837   &lt;2e-16 ***\nFID.y2612             15.5875912  0.0083596  1864.642   &lt;2e-16 ***\nFID.y2630             15.4233551  0.0192584   800.862   &lt;2e-16 ***\nFID.y2632             16.8518011  0.0075627  2228.285   &lt;2e-16 ***\nFID.y2633             14.6313873  0.0144268  1014.184   &lt;2e-16 ***\nFID.y2634             16.8095387  0.0051122  3288.152   &lt;2e-16 ***\nFID.y2635             16.6396354  0.0088362  1883.128   &lt;2e-16 ***\nFID.y264              14.6492130  0.0140240  1044.585   &lt;2e-16 ***\nFID.y265              15.5566293  0.0134287  1158.461   &lt;2e-16 ***\nFID.y2653             15.8086454  0.0163327   967.914   &lt;2e-16 ***\nFID.y2654             14.9661241  0.0245416   609.827   &lt;2e-16 ***\nFID.y2655             13.2471366  0.0461610   286.977   &lt;2e-16 ***\nFID.y2656             16.2295422  0.0101101  1605.282   &lt;2e-16 ***\nFID.y2676             13.9740801  0.0257946   541.745   &lt;2e-16 ***\nFID.y2677             14.7946867  0.0162695   909.350   &lt;2e-16 ***\nFID.y2678             14.8659981  0.0153021   971.499   &lt;2e-16 ***\nFID.y2695             15.1470533  0.0178348   849.300   &lt;2e-16 ***\nFID.y2698             15.0080553  0.0156863   956.763   &lt;2e-16 ***\nFID.y2699             15.6421573  0.0087595  1785.734   &lt;2e-16 ***\nFID.y2700             15.6562103  0.0095773  1634.724   &lt;2e-16 ***\nFID.y2717             16.9642040  0.0060654  2796.897   &lt;2e-16 ***\nFID.y2720             15.5498743  0.0209499   742.242   &lt;2e-16 ***\nFID.y2722             14.9752570  0.0227805   657.370   &lt;2e-16 ***\nFID.y2739             15.6247990  0.0123737  1262.744   &lt;2e-16 ***\nFID.y2740             17.3685550  0.0051525  3370.899   &lt;2e-16 ***\nFID.y2743             15.8203687  0.0088949  1778.593   &lt;2e-16 ***\nFID.y2761             16.2752778  0.0087439  1861.331   &lt;2e-16 ***\nFID.y2762             17.6345731  0.0050212  3512.022   &lt;2e-16 ***\nFID.y2779             16.3961629  0.0155661  1053.322   &lt;2e-16 ***\nFID.y2786             15.2352739  0.0148773  1024.063   &lt;2e-16 ***\nFID.y2800             15.4747763  0.0250322   618.196   &lt;2e-16 ***\nFID.y2806             16.5382215  0.0087923  1880.994   &lt;2e-16 ***\nFID.y2828             17.6565961  0.0049042  3600.275   &lt;2e-16 ***\nFID.y2829             15.9647160  0.0113214  1410.139   &lt;2e-16 ***\nFID.y284              15.3726955  0.0274637   559.746   &lt;2e-16 ***\nFID.y2849             15.8269496  0.0186903   846.802   &lt;2e-16 ***\nFID.y285              14.4475900  0.0271191   532.745   &lt;2e-16 ***\nFID.y2850             17.1542347  0.0063695  2693.176   &lt;2e-16 ***\nFID.y286              15.8716494  0.0103140  1538.851   &lt;2e-16 ***\nFID.y287              14.7616177  0.0483743   305.154   &lt;2e-16 ***\nFID.y2871             16.3313355  0.0126326  1292.793   &lt;2e-16 ***\nFID.y2892             15.9777124  0.0221172   722.410   &lt;2e-16 ***\nFID.y2951             16.9355255  0.0181967   930.691   &lt;2e-16 ***\nFID.y305              15.5766279  0.0169660   918.108   &lt;2e-16 ***\nFID.y306              15.5667089  0.0150732  1032.744   &lt;2e-16 ***\nFID.y307              13.9503164  0.0325074   429.142   &lt;2e-16 ***\nFID.y327              15.6356196  0.0166598   938.525   &lt;2e-16 ***\nFID.y328              14.8558250  0.0161949   917.313   &lt;2e-16 ***\nFID.y329              15.5169661  0.0140852  1101.649   &lt;2e-16 ***\nFID.y348              14.0784882  0.0563720   249.742   &lt;2e-16 ***\nFID.y349              15.7863719  0.0128337  1230.076   &lt;2e-16 ***\nFID.y350              14.2261851  0.0293298   485.042   &lt;2e-16 ***\nFID.y369              15.5739058  0.0164498   946.753   &lt;2e-16 ***\nFID.y370              15.6317040  0.0135074  1157.267   &lt;2e-16 ***\nFID.y371              15.2239120  0.0208015   731.867   &lt;2e-16 ***\nFID.y372              12.6674743  0.1443501    87.755   &lt;2e-16 ***\nFID.y391              16.1102258  0.0135382  1189.981   &lt;2e-16 ***\nFID.y392              15.3755317  0.0212638   723.084   &lt;2e-16 ***\nFID.y393              17.3117134  0.0070255  2464.124   &lt;2e-16 ***\nFID.y412              16.1213482  0.0141818  1136.763   &lt;2e-16 ***\nFID.y413              15.2033365  0.0154100   986.592   &lt;2e-16 ***\nFID.y414              15.6396108  0.0161276   969.741   &lt;2e-16 ***\nFID.y415              16.9339616  0.0092200  1836.657   &lt;2e-16 ***\nFID.y435              15.5148388  0.0161457   960.925   &lt;2e-16 ***\nFID.y436              16.5369642  0.0090020  1837.023   &lt;2e-16 ***\nFID.y437              16.0363347  0.0148354  1080.952   &lt;2e-16 ***\nFID.y44               14.3851664  0.0459644   312.964   &lt;2e-16 ***\nFID.y456              15.7271321  0.0109638  1434.461   &lt;2e-16 ***\nFID.y457              12.6970856  0.0540997   234.698   &lt;2e-16 ***\nFID.y458              16.3588839  0.0052143  3137.325   &lt;2e-16 ***\nFID.y46               15.6726795  0.0285212   549.510   &lt;2e-16 ***\nFID.y460              16.2393446  0.0105987  1532.199   &lt;2e-16 ***\nFID.y477              15.8173460  0.0164872   959.370   &lt;2e-16 ***\nFID.y478              16.1880290  0.0101268  1598.529   &lt;2e-16 ***\nFID.y479              15.4840964  0.0123432  1254.468   &lt;2e-16 ***\nFID.y480              12.8199769  0.0836401   153.275   &lt;2e-16 ***\nFID.y481              16.8037739  0.0085172  1972.928   &lt;2e-16 ***\nFID.y482              15.4916860  0.0217012   713.864   &lt;2e-16 ***\nFID.y499              14.9967592  0.0271062   553.260   &lt;2e-16 ***\nFID.y500              15.8010194  0.0157884  1000.798   &lt;2e-16 ***\nFID.y501              14.4903946  0.0133036  1089.208   &lt;2e-16 ***\nFID.y502              13.9983747  0.0357788   391.248   &lt;2e-16 ***\nFID.y503              17.5148266  0.0049360  3548.407   &lt;2e-16 ***\nFID.y520              16.0262258  0.0220545   726.665   &lt;2e-16 ***\nFID.y521              15.0615600  0.0171691   877.246   &lt;2e-16 ***\nFID.y522              15.7474222  0.0093699  1680.636   &lt;2e-16 ***\nFID.y523              15.2975419  0.0259272   590.019   &lt;2e-16 ***\nFID.y524              15.7012955  0.0088842  1767.328   &lt;2e-16 ***\nFID.y525              15.4812723  0.0127120  1217.846   &lt;2e-16 ***\nFID.y542              13.3101177  0.0762685   174.517   &lt;2e-16 ***\nFID.y543              15.2676846  0.0173789   878.518   &lt;2e-16 ***\nFID.y544              15.6256020  0.0098973  1578.775   &lt;2e-16 ***\nFID.y545              16.2640147  0.0077895  2087.951   &lt;2e-16 ***\nFID.y546              16.2997869  0.0142959  1140.173   &lt;2e-16 ***\nFID.y547              15.5964208  0.0157530   990.061   &lt;2e-16 ***\nFID.y563              14.7435471  0.0318142   463.427   &lt;2e-16 ***\nFID.y565              15.8523389  0.0114437  1385.250   &lt;2e-16 ***\nFID.y566              15.7163744  0.0102090  1539.465   &lt;2e-16 ***\nFID.y567              16.2762109  0.0067113  2425.201   &lt;2e-16 ***\nFID.y569              13.5277764  0.0554130   244.126   &lt;2e-16 ***\nFID.y585              14.6590039  0.0238706   614.104   &lt;2e-16 ***\nFID.y586              13.4647611  0.0465046   289.536   &lt;2e-16 ***\nFID.y587              15.4178227  0.0124937  1234.049   &lt;2e-16 ***\nFID.y588              15.8236843  0.0071210  2222.126   &lt;2e-16 ***\nFID.y589              16.3759082  0.0094289  1736.785   &lt;2e-16 ***\nFID.y590              17.0528921  0.0072656  2347.074   &lt;2e-16 ***\nFID.y591              16.2027291  0.0117156  1383.005   &lt;2e-16 ***\nFID.y592              15.0354205  0.0307087   489.614   &lt;2e-16 ***\nFID.y606              13.8771779  0.0539431   257.256   &lt;2e-16 ***\nFID.y607              16.2785764  0.0077867  2090.574   &lt;2e-16 ***\nFID.y608              16.0108027  0.0096800  1654.004   &lt;2e-16 ***\nFID.y609              16.2099585  0.0066622  2433.120   &lt;2e-16 ***\nFID.y610              15.9381621  0.0067942  2345.836   &lt;2e-16 ***\nFID.y613              15.3180847  0.0138408  1106.737   &lt;2e-16 ***\nFID.y614              14.4649129  0.0325112   444.921   &lt;2e-16 ***\nFID.y628              15.3655816  0.0158504   969.413   &lt;2e-16 ***\nFID.y629              16.5574772  0.0075855  2182.770   &lt;2e-16 ***\nFID.y630              15.5099937  0.0100683  1540.474   &lt;2e-16 ***\nFID.y631              17.6982924  0.0032507  5444.401   &lt;2e-16 ***\nFID.y632              16.4827629  0.0058049  2839.433   &lt;2e-16 ***\nFID.y635              12.1057098  0.1186917   101.993   &lt;2e-16 ***\nFID.y636               9.9385306  1.0000017     9.939   &lt;2e-16 ***\nFID.y637              13.8181731  0.0424094   325.828   &lt;2e-16 ***\nFID.y638              11.5505109  0.5773541    20.006   &lt;2e-16 ***\nFID.y639              15.4413638  0.0170166   907.431   &lt;2e-16 ***\nFID.y650              16.4068004  0.0110399  1486.138   &lt;2e-16 ***\nFID.y651              17.5082037  0.0106463  1644.529   &lt;2e-16 ***\nFID.y652              16.5589773  0.0095967  1725.494   &lt;2e-16 ***\nFID.y653              15.7058421  0.0084157  1866.256   &lt;2e-16 ***\nFID.y654              16.8410836  0.0054476  3091.460   &lt;2e-16 ***\nFID.y656              12.9674167  0.0793257   163.470   &lt;2e-16 ***\nFID.y659              13.6727822  0.0543410   251.611   &lt;2e-16 ***\nFID.y66               16.1329189  0.0180368   894.444   &lt;2e-16 ***\nFID.y660              14.6722269  0.0510668   287.314   &lt;2e-16 ***\nFID.y661              13.9119327  0.0541038   257.134   &lt;2e-16 ***\nFID.y671              14.7630452  0.0323866   455.837   &lt;2e-16 ***\nFID.y672              10.1298683  0.5000032    20.260   &lt;2e-16 ***\nFID.y673              15.4940287  0.0160321   966.440   &lt;2e-16 ***\nFID.y674              18.1224945  0.0024666  7347.080   &lt;2e-16 ***\nFID.y675              15.9421662  0.0077398  2059.759   &lt;2e-16 ***\nFID.y68               15.5316366  0.0275567   563.625   &lt;2e-16 ***\nFID.y682              13.3124880  0.0953655   139.594   &lt;2e-16 ***\nFID.y683              13.6221682  0.0504746   269.882   &lt;2e-16 ***\nFID.y684              14.8062354  0.0985574   150.229   &lt;2e-16 ***\nFID.y69               15.7859100  0.0190581   828.304   &lt;2e-16 ***\nFID.y693              14.8959047  0.0214841   693.346   &lt;2e-16 ***\nFID.y694              15.0851730  0.0170313   885.731   &lt;2e-16 ***\nFID.y695              16.4452277  0.0063921  2572.756   &lt;2e-16 ***\nFID.y696              16.2126519  0.0062077  2611.713   &lt;2e-16 ***\nFID.y697              16.4671777  0.0077446  2126.272   &lt;2e-16 ***\nFID.y699              11.1440424  0.2000076    55.718   &lt;2e-16 ***\nFID.y705              14.1769478  0.0845392   167.697   &lt;2e-16 ***\nFID.y706              14.8372384  0.0348398   425.870   &lt;2e-16 ***\nFID.y715              15.5511003  0.0125175  1242.348   &lt;2e-16 ***\nFID.y716              16.3539458  0.0086961  1880.598   &lt;2e-16 ***\nFID.y717              15.8368214  0.0091140  1737.632   &lt;2e-16 ***\nFID.y718              16.5154261  0.0054963  3004.845   &lt;2e-16 ***\nFID.y727              15.7509230  0.0601241   261.974   &lt;2e-16 ***\nFID.y736              15.1460706  0.0171384   883.751   &lt;2e-16 ***\nFID.y738              15.9474242  0.0101697  1568.137   &lt;2e-16 ***\nFID.y739              15.7323427  0.0084061  1871.534   &lt;2e-16 ***\nFID.y740              14.4719063  0.0190897   758.099   &lt;2e-16 ***\nFID.y742              15.9515811  0.0109358  1458.652   &lt;2e-16 ***\nFID.y758              14.5714043  0.0195043   747.086   &lt;2e-16 ***\nFID.y759              15.8502142  0.0069305  2287.008   &lt;2e-16 ***\nFID.y760              16.3470835  0.0065007  2514.662   &lt;2e-16 ***\nFID.y761              15.2063065  0.0096085  1582.595   &lt;2e-16 ***\nFID.y779              16.4239111  0.0079137  2075.364   &lt;2e-16 ***\nFID.y780              14.1365144  0.0201998   699.833   &lt;2e-16 ***\nFID.y781              14.7887212  0.0148889   993.269   &lt;2e-16 ***\nFID.y782              18.3083267  0.0026517  6904.303   &lt;2e-16 ***\nFID.y783              17.0408844  0.0041861  4070.796   &lt;2e-16 ***\nFID.y785              16.1605833  0.0103038  1568.406   &lt;2e-16 ***\nFID.y801              16.1813505  0.0080171  2018.352   &lt;2e-16 ***\nFID.y802              16.6816444  0.0049519  3368.731   &lt;2e-16 ***\nFID.y803              16.1630320  0.0066778  2420.413   &lt;2e-16 ***\nFID.y804              15.3508298  0.0097311  1577.505   &lt;2e-16 ***\nFID.y822              16.1614535  0.0081323  1987.313   &lt;2e-16 ***\nFID.y823              14.5045563  0.0225033   644.551   &lt;2e-16 ***\nFID.y824              15.4098010  0.0095169  1619.205   &lt;2e-16 ***\nFID.y825              15.4186751  0.0113720  1355.848   &lt;2e-16 ***\nFID.y826              16.5420191  0.0053498  3092.079   &lt;2e-16 ***\nFID.y828              16.2937911  0.0108606  1500.273   &lt;2e-16 ***\nFID.y845              14.2325171  0.0189033   752.913   &lt;2e-16 ***\nFID.y847              15.9437736  0.0067977  2345.477   &lt;2e-16 ***\nFID.y850              14.3478594  0.0267835   535.697   &lt;2e-16 ***\nFID.y865              15.6848036  0.0154424  1015.699   &lt;2e-16 ***\nFID.y868              17.0057572  0.0052909  3214.143   &lt;2e-16 ***\nFID.y869              16.5512315  0.0070394  2351.224   &lt;2e-16 ***\nFID.y88               15.0238629  0.0434754   345.572   &lt;2e-16 ***\nFID.y886              16.5763547  0.0080920  2048.479   &lt;2e-16 ***\nFID.y887              14.5186035  0.0186329   779.191   &lt;2e-16 ***\nFID.y889              13.8457123  0.0208999   662.478   &lt;2e-16 ***\nFID.y89               15.5934128  0.0130290  1196.821   &lt;2e-16 ***\nFID.y890              16.3472267  0.0055119  2965.826   &lt;2e-16 ***\nFID.y891              16.1185785  0.0091729  1757.189   &lt;2e-16 ***\nFID.y893              16.1305353  0.0078499  2054.858   &lt;2e-16 ***\nFID.y899              14.7632741  0.0345362   427.473   &lt;2e-16 ***\nFID.y908              16.1688529  0.0076918  2102.084   &lt;2e-16 ***\nFID.y909              15.3134122  0.0102396  1495.511   &lt;2e-16 ***\nFID.y91               14.9208424  0.0309995   481.325   &lt;2e-16 ***\nFID.y910              15.8579125  0.0066902  2370.315   &lt;2e-16 ***\nFID.y911              16.4391917  0.0045856  3584.921   &lt;2e-16 ***\nFID.y912              15.7370209  0.0088619  1775.810   &lt;2e-16 ***\nFID.y914              13.3369733  0.0389333   342.559   &lt;2e-16 ***\nFID.y915              16.4750792  0.0095630  1722.794   &lt;2e-16 ***\nFID.y929              15.2941278  0.0136535  1120.164   &lt;2e-16 ***\nFID.y930              12.9544345  0.0530290   244.290   &lt;2e-16 ***\nFID.y931              14.1543212  0.0198169   714.255   &lt;2e-16 ***\nFID.y932              16.2272645  0.0051243  3166.735   &lt;2e-16 ***\nFID.y933              16.3502653  0.0052120  3137.013   &lt;2e-16 ***\nFID.y934              16.1223782  0.0070155  2298.116   &lt;2e-16 ***\nFID.y936              16.2968988  0.0071976  2264.206   &lt;2e-16 ***\nFID.y937              15.1963250  0.0222022   684.452   &lt;2e-16 ***\nFID.y950              13.9627656  0.0380842   366.628   &lt;2e-16 ***\nFID.y952              15.9188659  0.0063310  2514.416   &lt;2e-16 ***\nFID.y953              17.2876547  0.0031343  5515.627   &lt;2e-16 ***\nFID.y954              16.2014145  0.0055041  2943.515   &lt;2e-16 ***\nFID.y955              15.2238975  0.0104424  1457.896   &lt;2e-16 ***\nFID.y956              15.1661482  0.0128541  1179.866   &lt;2e-16 ***\nFID.y957              15.1688814  0.0131197  1156.187   &lt;2e-16 ***\nFID.y958              17.9837680  0.0027721  6487.355   &lt;2e-16 ***\nFID.y959              16.4926565  0.0073265  2251.107   &lt;2e-16 ***\nFID.y973              14.3288433  0.0181621   788.943   &lt;2e-16 ***\nFID.y974              15.9685229  0.0062003  2575.464   &lt;2e-16 ***\nFID.y975              15.7854408  0.0073079  2160.051   &lt;2e-16 ***\nFID.y976              16.3131263  0.0051764  3151.458   &lt;2e-16 ***\nFID.y977              15.3399647  0.0092458  1659.119   &lt;2e-16 ***\nFID.y978              13.2295762  0.0384451   344.116   &lt;2e-16 ***\nFID.y979              16.0500300  0.0065907  2435.271   &lt;2e-16 ***\nFID.y980              14.2090539  0.0233479   608.578   &lt;2e-16 ***\nFID.y981              18.3598390  0.0033393  5498.135   &lt;2e-16 ***\nFID.y984              14.2629858  0.0288840   493.802   &lt;2e-16 ***\nFID.y985              15.3749679  0.0164484   934.742   &lt;2e-16 ***\nFID.y993              15.5222789  0.0130538  1189.104   &lt;2e-16 ***\nFID.y994              17.6552057  0.0076723  2301.157   &lt;2e-16 ***\nFID.y995              15.4459572  0.0089916  1717.824   &lt;2e-16 ***\nFID.y996              16.4001805  0.0062000  2645.191   &lt;2e-16 ***\nFID.y997              14.9202116  0.0124779  1195.726   &lt;2e-16 ***\nFID.y998              16.6506330  0.0042265  3939.596   &lt;2e-16 ***\nFID.y999              16.1407426  0.0068230  2365.628   &lt;2e-16 ***\nlog(SCHOOL_COUNT)             NA         NA        NA       NA    \nlog(BUSINESS_COUNT)           NA         NA        NA       NA    \nlog(HDB_COUNT)                NA         NA        NA       NA    \nlog(TRAIN_COUNT)              NA         NA        NA       NA    \nlog(UNIVERSITY_COUNT)         NA         NA        NA       NA    \nlog(dist)             -1.3340440  0.0002452 -5439.763   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 331546535  on 83714  degrees of freedom\nResidual deviance:  47103140  on 82688  degrees of freedom\nAIC: 47550008\n\nNumber of Fisher Scoring iterations: 8\n\n\n\n8.5.1 Goodness of fit\n\nCalcRSquared(decSIM$data$MORNING_PEAK, decSIM$fitted.values)\n\n[1] 0.2825791"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#doubly-constrained-model",
    "href": "take_home_ex2/take_home_ex2.html#doubly-constrained-model",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "8.6 Doubly constrained model",
    "text": "8.6 Doubly constrained model\nThe code chunk used to calibrate to model is shown below.\n\ndbcSIM_Poisson &lt;- glm(formula = MORNING_PEAK ~ \n                  FID.x +\n                  FID.y +\n                  log(SCHOOL_COUNT)+\n                  log(BUSINESS_COUNT)+\n                  log(FINANCE_COUNT)+\n                  log(HDB_COUNT)+\n                  log(TRAIN_COUNT)+\n                  log(UNIVERSITY_COUNT)+\n                  log(dist),\n              family = poisson(link = \"log\"),\n              data = inter_zonal_flow,\n              na.action = na.exclude)\nsummary(dbcSIM_Poisson)\n\n\nCall:\nglm(formula = MORNING_PEAK ~ FID.x + FID.y + log(SCHOOL_COUNT) + \n    log(BUSINESS_COUNT) + log(FINANCE_COUNT) + log(HDB_COUNT) + \n    log(TRAIN_COUNT) + log(UNIVERSITY_COUNT) + log(dist), family = poisson(link = \"log\"), \n    data = inter_zonal_flow, na.action = na.exclude)\n\nCoefficients: (6 not defined because of singularities)\n                        Estimate Std. Error   z value Pr(&gt;|z|)    \n(Intercept)           14.4277189  0.1096679   131.558  &lt; 2e-16 ***\nFID.x1000              4.1458138  0.0999922    41.461  &lt; 2e-16 ***\nFID.x1001              4.8082277  0.0999122    48.125  &lt; 2e-16 ***\nFID.x1002              4.8693479  0.0999886    48.699  &lt; 2e-16 ***\nFID.x1003              5.9940726  0.0999285    59.984  &lt; 2e-16 ***\nFID.x1005              1.4194264  0.1067630    13.295  &lt; 2e-16 ***\nFID.x1006              2.1044748  0.1033051    20.371  &lt; 2e-16 ***\nFID.x1014              0.1939143  0.1197655     1.619 0.105422    \nFID.x1015             -1.7238081  0.2312187    -7.455 8.97e-14 ***\nFID.x1016              2.6459379  0.1004813    26.333  &lt; 2e-16 ***\nFID.x1017              1.8100579  0.1014847    17.836  &lt; 2e-16 ***\nFID.x1018              4.1839883  0.1000109    41.835  &lt; 2e-16 ***\nFID.x1019              4.9873712  0.0998511    49.948  &lt; 2e-16 ***\nFID.x1020              5.0178689  0.0999822    50.188  &lt; 2e-16 ***\nFID.x1021              3.9241577  0.1000471    39.223  &lt; 2e-16 ***\nFID.x1022              4.0248505  0.1000321    40.236  &lt; 2e-16 ***\nFID.x1023              1.2288539  0.1084261    11.334  &lt; 2e-16 ***\nFID.x1024              4.3007192  0.1000189    42.999  &lt; 2e-16 ***\nFID.x1025              1.0380892  0.1231339     8.431  &lt; 2e-16 ***\nFID.x1026              1.7834685  0.1036053    17.214  &lt; 2e-16 ***\nFID.x1036              0.2807992  0.1126535     2.493 0.012681 *  \nFID.x1037              1.6356809  0.1011155    16.176  &lt; 2e-16 ***\nFID.x1038              3.6833870  0.1000285    36.823  &lt; 2e-16 ***\nFID.x1039             -0.4777592  0.1191936    -4.008 6.12e-05 ***\nFID.x1040              3.6879327  0.1000468    36.862  &lt; 2e-16 ***\nFID.x1041              4.1758264  0.0999516    41.778  &lt; 2e-16 ***\nFID.x1043              2.4192051  0.1009315    23.969  &lt; 2e-16 ***\nFID.x1044              4.4255454  0.1000538    44.232  &lt; 2e-16 ***\nFID.x1045              3.4553869  0.1002157    34.479  &lt; 2e-16 ***\nFID.x1046              2.5525319  0.1010534    25.259  &lt; 2e-16 ***\nFID.x1047              1.9323701  0.1020854    18.929  &lt; 2e-16 ***\nFID.x1048             -1.0486642  0.1340520    -7.823 5.17e-15 ***\nFID.x1049              2.4674883  0.1022247    24.138  &lt; 2e-16 ***\nFID.x1058              3.1750386  0.1007699    31.508  &lt; 2e-16 ***\nFID.x1059              2.6020048  0.1002833    25.947  &lt; 2e-16 ***\nFID.x1060              1.4996022  0.1011989    14.818  &lt; 2e-16 ***\nFID.x1061              2.8256303  0.1003082    28.169  &lt; 2e-16 ***\nFID.x1062              4.7628917  0.0998728    47.690  &lt; 2e-16 ***\nFID.x1065              4.5788768  0.0998972    45.836  &lt; 2e-16 ***\nFID.x1066              4.4805329  0.0999440    44.830  &lt; 2e-16 ***\nFID.x1067              2.2567813  0.1016941    22.192  &lt; 2e-16 ***\nFID.x1068              4.2498662  0.1000701    42.469  &lt; 2e-16 ***\nFID.x1069              0.5398554  0.1431822     3.770 0.000163 ***\nFID.x1070             -0.6965499  0.1243604    -5.601 2.13e-08 ***\nFID.x1079              2.5802559  0.1006492    25.636  &lt; 2e-16 ***\nFID.x1080              3.5715050  0.0999432    35.735  &lt; 2e-16 ***\nFID.x1081              3.6508627  0.0999482    36.528  &lt; 2e-16 ***\nFID.x1082              1.7642362  0.1011182    17.447  &lt; 2e-16 ***\nFID.x1083              4.2831058  0.0999580    42.849  &lt; 2e-16 ***\nFID.x1084              3.8863385  0.1000104    38.859  &lt; 2e-16 ***\nFID.x1086              2.3434041  0.1007416    23.262  &lt; 2e-16 ***\nFID.x1087              4.4229680  0.0999289    44.261  &lt; 2e-16 ***\nFID.x1090              0.8582515  0.1137687     7.544 4.56e-14 ***\nFID.x1091              5.9633599  0.0998795    59.706  &lt; 2e-16 ***\nFID.x1092              4.0804743  0.1002446    40.705  &lt; 2e-16 ***\nFID.x110              -0.1942786  0.1288388    -1.508 0.131575    \nFID.x1100              2.6095813  0.1006928    25.916  &lt; 2e-16 ***\nFID.x1101              4.4944035  0.0998843    44.996  &lt; 2e-16 ***\nFID.x1102              5.5315104  0.0998288    55.410  &lt; 2e-16 ***\nFID.x1103              2.0119680  0.1019418    19.736  &lt; 2e-16 ***\nFID.x1104              1.5074970  0.1017033    14.822  &lt; 2e-16 ***\nFID.x1105              2.6117622  0.1005194    25.983  &lt; 2e-16 ***\nFID.x1106              4.4897530  0.0999435    44.923  &lt; 2e-16 ***\nFID.x1107              2.7124169  0.1004673    26.998  &lt; 2e-16 ***\nFID.x1108              5.5304494  0.0998461    55.390  &lt; 2e-16 ***\nFID.x1109              4.0513155  0.1002556    40.410  &lt; 2e-16 ***\nFID.x111               1.4885232  0.1010318    14.733  &lt; 2e-16 ***\nFID.x1111              0.6817527  0.1146525     5.946 2.74e-09 ***\nFID.x1113             -0.8128041  0.1300579    -6.250 4.12e-10 ***\nFID.x1114              0.2772357  0.1167097     2.375 0.017529 *  \nFID.x112              -1.3344140  0.1964090    -6.794 1.09e-11 ***\nFID.x1121              2.6348858  0.1003171    26.266  &lt; 2e-16 ***\nFID.x1122              2.8088299  0.1003336    27.995  &lt; 2e-16 ***\nFID.x1123              3.8505091  0.0998791    38.552  &lt; 2e-16 ***\nFID.x1124              3.8700078  0.1000038    38.699  &lt; 2e-16 ***\nFID.x1126              1.9850207  0.1014477    19.567  &lt; 2e-16 ***\nFID.x1128              3.8712118  0.1000164    38.706  &lt; 2e-16 ***\nFID.x1129              2.2136099  0.1014202    21.826  &lt; 2e-16 ***\nFID.x113               3.4600104  0.1006291    34.384  &lt; 2e-16 ***\nFID.x1130              4.4503961  0.0999353    44.533  &lt; 2e-16 ***\nFID.x1133             -0.4136793  0.2854293    -1.449 0.147247    \nFID.x1136             -3.7148702  1.0049742    -3.696 0.000219 ***\nFID.x114              -0.4436394  0.1186540    -3.739 0.000185 ***\nFID.x1143              2.4714076  0.1001816    24.669  &lt; 2e-16 ***\nFID.x1144              3.3234814  0.0999904    33.238  &lt; 2e-16 ***\nFID.x1145              3.3457842  0.0999815    33.464  &lt; 2e-16 ***\nFID.x1147              2.6109775  0.1005502    25.967  &lt; 2e-16 ***\nFID.x1148              3.1869693  0.1001456    31.823  &lt; 2e-16 ***\nFID.x1149              3.4044623  0.1001469    33.995  &lt; 2e-16 ***\nFID.x1151              5.2360318  0.0998614    52.433  &lt; 2e-16 ***\nFID.x1152              5.9057424  0.0999094    59.111  &lt; 2e-16 ***\nFID.x1154              0.1404468  0.1316789     1.067 0.286159    \nFID.x1156              1.0542517  0.1041535    10.122  &lt; 2e-16 ***\nFID.x1157              2.1600198  0.1008204    21.424  &lt; 2e-16 ***\nFID.x1158              6.7641765  0.0998810    67.722  &lt; 2e-16 ***\nFID.x1164              2.4133109  0.1004037    24.036  &lt; 2e-16 ***\nFID.x1165              1.4388749  0.1010653    14.237  &lt; 2e-16 ***\nFID.x1166              4.0047840  0.0998902    40.092  &lt; 2e-16 ***\nFID.x1167              3.1709024  0.1000262    31.701  &lt; 2e-16 ***\nFID.x1169              3.7547691  0.0999596    37.563  &lt; 2e-16 ***\nFID.x1170              2.2362706  0.1010149    22.138  &lt; 2e-16 ***\nFID.x1171              2.0223232  0.1040439    19.437  &lt; 2e-16 ***\nFID.x1172              4.0472506  0.1000819    40.439  &lt; 2e-16 ***\nFID.x1173              4.9843260  0.0999916    49.847  &lt; 2e-16 ***\nFID.x1178              4.7908861  0.0998994    47.957  &lt; 2e-16 ***\nFID.x1179              5.6207422  0.0998605    56.286  &lt; 2e-16 ***\nFID.x1186              0.7277745  0.1047780     6.946 3.76e-12 ***\nFID.x1187              1.4410183  0.1016426    14.177  &lt; 2e-16 ***\nFID.x1188              2.6460065  0.1003991    26.355  &lt; 2e-16 ***\nFID.x1189              2.0188325  0.1006857    20.051  &lt; 2e-16 ***\nFID.x1190              3.6694535  0.0999518    36.712  &lt; 2e-16 ***\nFID.x1191              2.4772791  0.1006267    24.619  &lt; 2e-16 ***\nFID.x1193              4.0971553  0.1002796    40.857  &lt; 2e-16 ***\nFID.x1194              5.3384869  0.0998824    53.448  &lt; 2e-16 ***\nFID.x1197              2.1750464  0.1028862    21.140  &lt; 2e-16 ***\nFID.x1199              4.0749847  0.1001015    40.709  &lt; 2e-16 ***\nFID.x1200              4.3602493  0.0999297    43.633  &lt; 2e-16 ***\nFID.x1207              2.2712421  0.1004152    22.618  &lt; 2e-16 ***\nFID.x1208              1.0994576  0.1037042    10.602  &lt; 2e-16 ***\nFID.x1209              3.7816040  0.0999748    37.826  &lt; 2e-16 ***\nFID.x1210              2.6623079  0.1002520    26.556  &lt; 2e-16 ***\nFID.x1211              1.5945929  0.1010371    15.782  &lt; 2e-16 ***\nFID.x1212              3.4192827  0.1000132    34.188  &lt; 2e-16 ***\nFID.x1221              4.1670803  0.0999358    41.698  &lt; 2e-16 ***\nFID.x1222              4.3284570  0.0999558    43.304  &lt; 2e-16 ***\nFID.x1228              2.2072761  0.1004577    21.972  &lt; 2e-16 ***\nFID.x1229             -0.6250263  0.1181404    -5.291 1.22e-07 ***\nFID.x1230              2.8848382  0.1001234    28.813  &lt; 2e-16 ***\nFID.x1231              2.4777008  0.1008198    24.576  &lt; 2e-16 ***\nFID.x1233              3.9025484  0.0999142    39.059  &lt; 2e-16 ***\nFID.x1240              2.1900800  0.1029211    21.279  &lt; 2e-16 ***\nFID.x1242              3.6075531  0.1002124    35.999  &lt; 2e-16 ***\nFID.x1243              4.1810350  0.0999366    41.837  &lt; 2e-16 ***\nFID.x1244             -0.0009014  0.1096005    -0.008 0.993438    \nFID.x1249              3.9433060  0.0999481    39.454  &lt; 2e-16 ***\nFID.x1250              2.7869728  0.1001830    27.819  &lt; 2e-16 ***\nFID.x1251              3.0550451  0.1000982    30.520  &lt; 2e-16 ***\nFID.x1252              0.0540037  0.1088702     0.496 0.619868    \nFID.x1253              2.2820836  0.1016666    22.447  &lt; 2e-16 ***\nFID.x1262             -0.9765495  0.1585684    -6.159 7.34e-10 ***\nFID.x1264              3.2935426  0.1000409    32.922  &lt; 2e-16 ***\nFID.x1265              1.1122413  0.1024993    10.851  &lt; 2e-16 ***\nFID.x1270              1.5094714  0.1014137    14.884  &lt; 2e-16 ***\nFID.x1271             -1.3333748  0.1428017    -9.337  &lt; 2e-16 ***\nFID.x1272              2.8118686  0.1000657    28.100  &lt; 2e-16 ***\nFID.x1273              4.1234266  0.0999215    41.267  &lt; 2e-16 ***\nFID.x1274              1.9588298  0.1008287    19.427  &lt; 2e-16 ***\nFID.x1276              3.0508110  0.1001210    30.471  &lt; 2e-16 ***\nFID.x1285              3.7553376  0.1001086    37.513  &lt; 2e-16 ***\nFID.x1286              6.0861945  0.0998424    60.958  &lt; 2e-16 ***\nFID.x1287              4.7050465  0.0999346    47.081  &lt; 2e-16 ***\nFID.x1292              2.3547851  0.1011846    23.272  &lt; 2e-16 ***\nFID.x1293              1.1637281  0.1017283    11.440  &lt; 2e-16 ***\nFID.x1294              1.3327038  0.1010120    13.194  &lt; 2e-16 ***\nFID.x1295              4.1118833  0.0999297    41.148  &lt; 2e-16 ***\nFID.x1296              1.9532136  0.1015619    19.232  &lt; 2e-16 ***\nFID.x1297              2.4265895  0.1003976    24.170  &lt; 2e-16 ***\nFID.x1304              1.1328419  0.1171663     9.669  &lt; 2e-16 ***\nFID.x1305             -0.4314849  0.1356209    -3.182 0.001465 ** \nFID.x1307              4.1872314  0.0999312    41.901  &lt; 2e-16 ***\nFID.x1308              3.3271185  0.1000770    33.246  &lt; 2e-16 ***\nFID.x1309              3.8180787  0.1000816    38.150  &lt; 2e-16 ***\nFID.x1313              2.9071647  0.1001538    29.027  &lt; 2e-16 ***\nFID.x1314              1.1128635  0.1039789    10.703  &lt; 2e-16 ***\nFID.x1315              0.8409666  0.1087879     7.730 1.07e-14 ***\nFID.x1316              4.3278529  0.0998660    43.337  &lt; 2e-16 ***\nFID.x1317              1.2519927  0.1037384    12.069  &lt; 2e-16 ***\nFID.x1318              2.5297930  0.1007256    25.116  &lt; 2e-16 ***\nFID.x132               0.1765694  0.1330363     1.327 0.184434    \nFID.x1328              4.0138004  0.1000940    40.100  &lt; 2e-16 ***\nFID.x1329              4.3624057  0.0998979    43.669  &lt; 2e-16 ***\nFID.x133               0.5602053  0.1145110     4.892 9.97e-07 ***\nFID.x1330              3.1433416  0.1001629    31.382  &lt; 2e-16 ***\nFID.x1336              0.4833835  0.1169230     4.134 3.56e-05 ***\nFID.x1337              3.0549114  0.1001176    30.513  &lt; 2e-16 ***\nFID.x1338              3.0563796  0.1000744    30.541  &lt; 2e-16 ***\nFID.x134               1.6193022  0.1031903    15.692  &lt; 2e-16 ***\nFID.x1340              3.6234863  0.0999919    36.238  &lt; 2e-16 ***\nFID.x1348              0.9227281  0.1124397     8.206 2.28e-16 ***\nFID.x135              -1.7283109  0.1533768   -11.268  &lt; 2e-16 ***\nFID.x1350              4.5000932  0.0999217    45.036  &lt; 2e-16 ***\nFID.x1351              4.8175064  0.0998941    48.226  &lt; 2e-16 ***\nFID.x1352              2.3772685  0.1008742    23.567  &lt; 2e-16 ***\nFID.x1356              1.5612260  0.1009553    15.465  &lt; 2e-16 ***\nFID.x1358              1.5115831  0.1007102    15.009  &lt; 2e-16 ***\nFID.x1359              3.5675232  0.1003008    35.568  &lt; 2e-16 ***\nFID.x136               0.4256815  0.1102967     3.859 0.000114 ***\nFID.x1371              4.7858377  0.0999725    47.872  &lt; 2e-16 ***\nFID.x1372              5.4200219  0.0998773    54.267  &lt; 2e-16 ***\nFID.x1373              4.1402153  0.0999687    41.415  &lt; 2e-16 ***\nFID.x1374             -2.8952509  0.3674106    -7.880 3.27e-15 ***\nFID.x1377              0.9012091  0.1019233     8.842  &lt; 2e-16 ***\nFID.x1378              2.0872439  0.1002439    20.822  &lt; 2e-16 ***\nFID.x1379              3.3438215  0.0999535    33.454  &lt; 2e-16 ***\nFID.x1380              4.0800164  0.0998838    40.848  &lt; 2e-16 ***\nFID.x1381              2.2664012  0.1005751    22.534  &lt; 2e-16 ***\nFID.x1383              1.5486905  0.1022087    15.152  &lt; 2e-16 ***\nFID.x1391              1.5652068  0.1149750    13.613  &lt; 2e-16 ***\nFID.x1393              4.4763476  0.0999492    44.786  &lt; 2e-16 ***\nFID.x1394              4.3093332  0.0999346    43.122  &lt; 2e-16 ***\nFID.x1395              1.7165101  0.1013361    16.939  &lt; 2e-16 ***\nFID.x1396             -0.2395567  0.1241507    -1.930 0.053661 .  \nFID.x1399              2.6033747  0.1001250    26.001  &lt; 2e-16 ***\nFID.x1400              3.1707518  0.0999498    31.723  &lt; 2e-16 ***\nFID.x1401              3.7828817  0.0999225    37.858  &lt; 2e-16 ***\nFID.x1402              2.7489031  0.1001562    27.446  &lt; 2e-16 ***\nFID.x1403              2.8572649  0.1001643    28.526  &lt; 2e-16 ***\nFID.x1404              2.2654543  0.1005952    22.520  &lt; 2e-16 ***\nFID.x1413              0.6722055  0.1349976     4.979 6.38e-07 ***\nFID.x1415              4.1582740  0.0999905    41.587  &lt; 2e-16 ***\nFID.x1416              4.4976493  0.0999730    44.989  &lt; 2e-16 ***\nFID.x1417              2.7879066  0.1004523    27.754  &lt; 2e-16 ***\nFID.x1418             -3.3477935  0.4582896    -7.305 2.77e-13 ***\nFID.x1420              3.0773290  0.1000079    30.771  &lt; 2e-16 ***\nFID.x1421              2.7767174  0.1001260    27.732  &lt; 2e-16 ***\nFID.x1422              2.2926869  0.1002135    22.878  &lt; 2e-16 ***\nFID.x1424              2.3813619  0.1003239    23.737  &lt; 2e-16 ***\nFID.x1433             -1.6657350  0.2502366    -6.657 2.80e-11 ***\nFID.x1434              0.5141214  0.1212397     4.241 2.23e-05 ***\nFID.x1437              4.6802095  0.0999179    46.841  &lt; 2e-16 ***\nFID.x1438              1.3974555  0.1074210    13.009  &lt; 2e-16 ***\nFID.x1439              1.8045880  0.1012104    17.830  &lt; 2e-16 ***\nFID.x1442              3.4564819  0.1000203    34.558  &lt; 2e-16 ***\nFID.x1443              3.4492500  0.0999534    34.509  &lt; 2e-16 ***\nFID.x1444              3.2384421  0.1002917    32.290  &lt; 2e-16 ***\nFID.x1445              0.9313225  0.1027203     9.067  &lt; 2e-16 ***\nFID.x1446              3.2623762  0.1000437    32.610  &lt; 2e-16 ***\nFID.x1447              3.5043954  0.0999917    35.047  &lt; 2e-16 ***\nFID.x1459              2.2502808  0.1008309    22.317  &lt; 2e-16 ***\nFID.x1460              1.9030258  0.1017457    18.704  &lt; 2e-16 ***\nFID.x1463              3.7578865  0.0999176    37.610  &lt; 2e-16 ***\nFID.x1464              1.9969987  0.1002575    19.919  &lt; 2e-16 ***\nFID.x1465              3.3332374  0.0999378    33.353  &lt; 2e-16 ***\nFID.x1468              2.9142489  0.1001183    29.108  &lt; 2e-16 ***\nFID.x1469              1.6760987  0.1083604    15.468  &lt; 2e-16 ***\nFID.x1476              1.3642458  0.1103510    12.363  &lt; 2e-16 ***\nFID.x1480              3.6752006  0.1001373    36.702  &lt; 2e-16 ***\nFID.x1481              4.5952553  0.0999591    45.971  &lt; 2e-16 ***\nFID.x1482              2.5957579  0.1005795    25.808  &lt; 2e-16 ***\nFID.x1484              2.2281247  0.1003127    22.212  &lt; 2e-16 ***\nFID.x1485              2.7965917  0.1000571    27.950  &lt; 2e-16 ***\nFID.x1486              2.4787732  0.1001005    24.763  &lt; 2e-16 ***\nFID.x1487              1.7316821  0.1008703    17.167  &lt; 2e-16 ***\nFID.x1488              0.2614469  0.1054963     2.478 0.013203 *  \nFID.x1490              2.1419921  0.1009689    21.214  &lt; 2e-16 ***\nFID.x1497              4.6632149  0.0999941    46.635  &lt; 2e-16 ***\nFID.x1501              1.5727009  0.1045630    15.041  &lt; 2e-16 ***\nFID.x1502              4.3832136  0.0999212    43.867  &lt; 2e-16 ***\nFID.x1503              0.5400675  0.1068334     5.055 4.30e-07 ***\nFID.x1506              1.5627846  0.1026427    15.225  &lt; 2e-16 ***\nFID.x1507              3.4704911  0.0999068    34.737  &lt; 2e-16 ***\nFID.x1508              4.0857932  0.0998728    40.910  &lt; 2e-16 ***\nFID.x1509              1.8251353  0.1012986    18.017  &lt; 2e-16 ***\nFID.x1511              2.0145729  0.1006457    20.016  &lt; 2e-16 ***\nFID.x1512              0.0829315  0.1808911     0.458 0.646621    \nFID.x1518             -0.9508873  0.1526695    -6.228 4.71e-10 ***\nFID.x1519              2.9165183  0.1006473    28.978  &lt; 2e-16 ***\nFID.x152               4.0548364  0.1011059    40.105  &lt; 2e-16 ***\nFID.x1523              3.9989300  0.1000386    39.974  &lt; 2e-16 ***\nFID.x1524              4.3793747  0.0999347    43.822  &lt; 2e-16 ***\nFID.x1525              1.8969528  0.1014519    18.698  &lt; 2e-16 ***\nFID.x1527              4.3254308  0.0998843    43.304  &lt; 2e-16 ***\nFID.x1528              3.8213566  0.0999031    38.251  &lt; 2e-16 ***\nFID.x1529              3.2670617  0.0999308    32.693  &lt; 2e-16 ***\nFID.x153               0.5465434  0.1250747     4.370 1.24e-05 ***\nFID.x1531              2.5654815  0.1001567    25.615  &lt; 2e-16 ***\nFID.x1534              0.6660545  0.1095281     6.081 1.19e-09 ***\nFID.x1539             -1.9357955  0.2108554    -9.181  &lt; 2e-16 ***\nFID.x154              -0.2014627  0.1186311    -1.698 0.089465 .  \nFID.x1541              2.0494579  0.1019155    20.109  &lt; 2e-16 ***\nFID.x1542             -0.4864456  0.1287987    -3.777 0.000159 ***\nFID.x1545              5.0069732  0.0998866    50.127  &lt; 2e-16 ***\nFID.x1546              3.3900399  0.1002153    33.828  &lt; 2e-16 ***\nFID.x1549              3.3827025  0.0999624    33.840  &lt; 2e-16 ***\nFID.x155               1.2075615  0.1107082    10.908  &lt; 2e-16 ***\nFID.x1550              3.9281074  0.0998729    39.331  &lt; 2e-16 ***\nFID.x1551              3.1679024  0.0999511    31.695  &lt; 2e-16 ***\nFID.x1552              1.8438654  0.1010919    18.240  &lt; 2e-16 ***\nFID.x1553              2.1906382  0.1023790    21.397  &lt; 2e-16 ***\nFID.x1554              3.8244886  0.0999253    38.273  &lt; 2e-16 ***\nFID.x1556             -0.4328286  0.1420286    -3.047 0.002308 ** \nFID.x156               0.8503139  0.1076547     7.899 2.82e-15 ***\nFID.x1560              2.6520531  0.1011253    26.225  &lt; 2e-16 ***\nFID.x1562              2.4140182  0.1015421    23.774  &lt; 2e-16 ***\nFID.x1563              1.0415500  0.1051685     9.904  &lt; 2e-16 ***\nFID.x1564              2.7385421  0.1004380    27.266  &lt; 2e-16 ***\nFID.x1565              3.8226874  0.1000165    38.221  &lt; 2e-16 ***\nFID.x1566              3.3201770  0.1001562    33.150  &lt; 2e-16 ***\nFID.x1567              3.2887446  0.1008208    32.620  &lt; 2e-16 ***\nFID.x157              -1.6885461  0.1820963    -9.273  &lt; 2e-16 ***\nFID.x1570              1.0123102  0.1016876     9.955  &lt; 2e-16 ***\nFID.x1571              3.2048834  0.0999823    32.055  &lt; 2e-16 ***\nFID.x1572              4.1872565  0.0998732    41.926  &lt; 2e-16 ***\nFID.x1573              2.5037798  0.1000959    25.014  &lt; 2e-16 ***\nFID.x1574              2.5572853  0.1001407    25.537  &lt; 2e-16 ***\nFID.x1575              2.4740893  0.1003554    24.653  &lt; 2e-16 ***\nFID.x1576             -0.3376153  0.1146299    -2.945 0.003227 ** \nFID.x1579              3.2529087  0.1001092    32.494  &lt; 2e-16 ***\nFID.x158               0.6751526  0.1047714     6.444 1.16e-10 ***\nFID.x1580              2.2743232  0.1008383    22.554  &lt; 2e-16 ***\nFID.x1581              2.8799299  0.1003170    28.708  &lt; 2e-16 ***\nFID.x1583             -0.3128794  0.1465011    -2.136 0.032706 *  \nFID.x1584              0.2764306  0.1110627     2.489 0.012812 *  \nFID.x1586              4.6540718  0.0998968    46.589  &lt; 2e-16 ***\nFID.x1587              2.9178827  0.1003174    29.087  &lt; 2e-16 ***\nFID.x1588              3.9943868  0.1000167    39.937  &lt; 2e-16 ***\nFID.x1589              0.9933164  0.1095366     9.068  &lt; 2e-16 ***\nFID.x159               1.2593970  0.1071125    11.758  &lt; 2e-16 ***\nFID.x1592             -1.0258555  0.1331086    -7.707 1.29e-14 ***\nFID.x1593              2.8809215  0.1000312    28.800  &lt; 2e-16 ***\nFID.x1594              2.8353770  0.1000170    28.349  &lt; 2e-16 ***\nFID.x1595              2.9946933  0.0999698    29.956  &lt; 2e-16 ***\nFID.x1596              1.5655128  0.1009687    15.505  &lt; 2e-16 ***\nFID.x1597              0.7490636  0.1058984     7.073 1.51e-12 ***\nFID.x1599             -0.5217121  0.1273460    -4.097 4.19e-05 ***\nFID.x1600              2.6912524  0.1010067    26.644  &lt; 2e-16 ***\nFID.x1601              2.6911272  0.1002846    26.835  &lt; 2e-16 ***\nFID.x1602              2.7439877  0.1003677    27.339  &lt; 2e-16 ***\nFID.x1606              3.0237769  0.1002087    30.175  &lt; 2e-16 ***\nFID.x1607              3.7130467  0.0999927    37.133  &lt; 2e-16 ***\nFID.x1608              4.1242870  0.1000289    41.231  &lt; 2e-16 ***\nFID.x1609              4.2987445  0.1000346    42.973  &lt; 2e-16 ***\nFID.x1610              3.2333789  0.1004574    32.187  &lt; 2e-16 ***\nFID.x1614              3.2909482  0.0999444    32.928  &lt; 2e-16 ***\nFID.x1615              2.9292925  0.0999791    29.299  &lt; 2e-16 ***\nFID.x1616              2.7613881  0.1000758    27.593  &lt; 2e-16 ***\nFID.x1617              2.9894678  0.0999795    29.901  &lt; 2e-16 ***\nFID.x1618              2.8323767  0.1002491    28.253  &lt; 2e-16 ***\nFID.x1619              1.9800579  0.1006403    19.675  &lt; 2e-16 ***\nFID.x1620              0.9487044  0.1148464     8.261  &lt; 2e-16 ***\nFID.x1622              2.5697548  0.1007287    25.512  &lt; 2e-16 ***\nFID.x1623              2.7414421  0.1003196    27.327  &lt; 2e-16 ***\nFID.x1624              3.4711918  0.1000884    34.681  &lt; 2e-16 ***\nFID.x1625              3.2020631  0.1021765    31.339  &lt; 2e-16 ***\nFID.x1627              0.8104632  0.1116299     7.260 3.86e-13 ***\nFID.x1628              5.5383969  0.0998577    55.463  &lt; 2e-16 ***\nFID.x1629              5.0527291  0.0998827    50.587  &lt; 2e-16 ***\nFID.x1630              4.2931661  0.0999518    42.952  &lt; 2e-16 ***\nFID.x1631              5.0758386  0.0999669    50.775  &lt; 2e-16 ***\nFID.x1632              2.2518679  0.1080308    20.845  &lt; 2e-16 ***\nFID.x1635              0.1730097  0.1048678     1.650 0.098986 .  \nFID.x1637              1.9477340  0.1003550    19.408  &lt; 2e-16 ***\nFID.x1638              2.3925321  0.1000838    23.905  &lt; 2e-16 ***\nFID.x1639              3.4586781  0.0999597    34.601  &lt; 2e-16 ***\nFID.x1641              0.9173984  0.1018205     9.010  &lt; 2e-16 ***\nFID.x1642              3.0889232  0.1000378    30.878  &lt; 2e-16 ***\nFID.x1643              3.2932404  0.1000268    32.924  &lt; 2e-16 ***\nFID.x1644              2.2115971  0.1008223    21.936  &lt; 2e-16 ***\nFID.x1645              4.3522275  0.0999543    43.542  &lt; 2e-16 ***\nFID.x1646              3.2441644  0.1001552    32.391  &lt; 2e-16 ***\nFID.x1647              2.6574187  0.1007437    26.378  &lt; 2e-16 ***\nFID.x1649              2.8518738  0.1005133    28.373  &lt; 2e-16 ***\nFID.x1650              4.0880884  0.0999158    40.915  &lt; 2e-16 ***\nFID.x1651              4.5318736  0.0999128    45.358  &lt; 2e-16 ***\nFID.x1652              3.7598207  0.1003085    37.483  &lt; 2e-16 ***\nFID.x1653              1.5171967  0.1152291    13.167  &lt; 2e-16 ***\nFID.x1654              2.7571949  0.1084344    25.427  &lt; 2e-16 ***\nFID.x1657              2.9459682  0.0999962    29.461  &lt; 2e-16 ***\nFID.x1658              2.0497096  0.1005787    20.379  &lt; 2e-16 ***\nFID.x1659              2.0408310  0.1003679    20.334  &lt; 2e-16 ***\nFID.x1661              2.9606667  0.1000564    29.590  &lt; 2e-16 ***\nFID.x1662              2.3369979  0.1001573    23.333  &lt; 2e-16 ***\nFID.x1663              2.1839830  0.1003713    21.759  &lt; 2e-16 ***\nFID.x1664              2.9516167  0.1000599    29.499  &lt; 2e-16 ***\nFID.x1665              3.1251383  0.1001354    31.209  &lt; 2e-16 ***\nFID.x1666              3.6562180  0.0999664    36.574  &lt; 2e-16 ***\nFID.x1667              4.3518333  0.0999166    43.555  &lt; 2e-16 ***\nFID.x1668              3.0889171  0.1002347    30.817  &lt; 2e-16 ***\nFID.x1671              4.6404589  0.0999307    46.437  &lt; 2e-16 ***\nFID.x1672              3.8555150  0.1000233    38.546  &lt; 2e-16 ***\nFID.x1673              4.4324938  0.1000723    44.293  &lt; 2e-16 ***\nFID.x1675              4.4977416  0.1013469    44.380  &lt; 2e-16 ***\nFID.x1678              2.3923609  0.1003560    23.839  &lt; 2e-16 ***\nFID.x1679              3.4010549  0.0999223    34.037  &lt; 2e-16 ***\nFID.x1680              2.2342178  0.1001432    22.310  &lt; 2e-16 ***\nFID.x1681              1.8458382  0.1002699    18.409  &lt; 2e-16 ***\nFID.x1682              2.2245821  0.1007190    22.087  &lt; 2e-16 ***\nFID.x1683              3.6175722  0.0999331    36.200  &lt; 2e-16 ***\nFID.x1684              3.5064546  0.0999293    35.089  &lt; 2e-16 ***\nFID.x1685              1.3614031  0.1011861    13.454  &lt; 2e-16 ***\nFID.x1686              1.9124267  0.1008133    18.970  &lt; 2e-16 ***\nFID.x1687              3.1055562  0.1000188    31.050  &lt; 2e-16 ***\nFID.x1688              3.4496663  0.1000594    34.476  &lt; 2e-16 ***\nFID.x1689              3.4619711  0.1000196    34.613  &lt; 2e-16 ***\nFID.x1692              3.5147680  0.1004013    35.007  &lt; 2e-16 ***\nFID.x1693              4.6393495  0.0999445    46.419  &lt; 2e-16 ***\nFID.x1694              5.7904155  0.0998846    57.971  &lt; 2e-16 ***\nFID.x1700              2.3971628  0.1000846    23.951  &lt; 2e-16 ***\nFID.x1701              2.8048474  0.0999669    28.058  &lt; 2e-16 ***\nFID.x1702              3.4522605  0.0999020    34.556  &lt; 2e-16 ***\nFID.x1703              1.3302132  0.1065369    12.486  &lt; 2e-16 ***\nFID.x1704              2.4268699  0.1001643    24.229  &lt; 2e-16 ***\nFID.x1705              3.4865981  0.0999235    34.893  &lt; 2e-16 ***\nFID.x1706              3.8209882  0.0999502    38.229  &lt; 2e-16 ***\nFID.x1707              1.5794796  0.1007431    15.678  &lt; 2e-16 ***\nFID.x1708              4.5285065  0.0998791    45.340  &lt; 2e-16 ***\nFID.x1709              4.4254802  0.0998629    44.316  &lt; 2e-16 ***\nFID.x1710              4.8177299  0.0998570    48.246  &lt; 2e-16 ***\nFID.x1711              1.3631971  0.1018276    13.387  &lt; 2e-16 ***\nFID.x1714              5.7471843  0.0998830    57.539  &lt; 2e-16 ***\nFID.x1715              5.3885975  0.0999143    53.932  &lt; 2e-16 ***\nFID.x1721             -0.6327872  0.1142494    -5.539 3.05e-08 ***\nFID.x1722              1.8748573  0.1003458    18.684  &lt; 2e-16 ***\nFID.x1723              2.1235205  0.1001265    21.208  &lt; 2e-16 ***\nFID.x1724              2.2247045  0.1006714    22.099  &lt; 2e-16 ***\nFID.x1725              2.3349154  0.1003035    23.278  &lt; 2e-16 ***\nFID.x1726              2.1097436  0.1025374    20.575  &lt; 2e-16 ***\nFID.x1727              4.6691198  0.0998462    46.763  &lt; 2e-16 ***\nFID.x1728              3.5011547  0.0999764    35.020  &lt; 2e-16 ***\nFID.x1729              4.2741890  0.0998797    42.793  &lt; 2e-16 ***\nFID.x1730              3.4033993  0.1000463    34.018  &lt; 2e-16 ***\nFID.x1731              4.2136564  0.0998762    42.189  &lt; 2e-16 ***\nFID.x1732              0.5432820  0.1040811     5.220 1.79e-07 ***\nFID.x1733              2.5093289  0.1008492    24.882  &lt; 2e-16 ***\nFID.x1736              5.3086997  0.0999179    53.131  &lt; 2e-16 ***\nFID.x1737              4.5226655  0.1003098    45.087  &lt; 2e-16 ***\nFID.x174               1.2519329  0.1185968    10.556  &lt; 2e-16 ***\nFID.x1743              2.5776542  0.1007653    25.581  &lt; 2e-16 ***\nFID.x1744              1.3944565  0.1005444    13.869  &lt; 2e-16 ***\nFID.x1745              2.4702949  0.1000169    24.699  &lt; 2e-16 ***\nFID.x1746              3.7564395  0.0998939    37.604  &lt; 2e-16 ***\nFID.x1747              3.1748869  0.1000441    31.735  &lt; 2e-16 ***\nFID.x1748              3.3716399  0.0999666    33.728  &lt; 2e-16 ***\nFID.x1749              3.6467061  0.0999097    36.500  &lt; 2e-16 ***\nFID.x175               0.1911395  0.1309454     1.460 0.144376    \nFID.x1750              2.9137647  0.1000431    29.125  &lt; 2e-16 ***\nFID.x1751              2.5449165  0.1001824    25.403  &lt; 2e-16 ***\nFID.x1752              4.6089155  0.0998593    46.154  &lt; 2e-16 ***\nFID.x1753              3.1637168  0.1000596    31.618  &lt; 2e-16 ***\nFID.x1757              3.7134905  0.1007171    36.871  &lt; 2e-16 ***\nFID.x1758              5.6861761  0.0999529    56.889  &lt; 2e-16 ***\nFID.x1765              2.2245349  0.1004964    22.135  &lt; 2e-16 ***\nFID.x1766              2.6192540  0.1000094    26.190  &lt; 2e-16 ***\nFID.x1767              3.2995098  0.0999117    33.024  &lt; 2e-16 ***\nFID.x1768              4.0404152  0.0999423    40.427  &lt; 2e-16 ***\nFID.x1769              4.1373570  0.0998874    41.420  &lt; 2e-16 ***\nFID.x177              -1.2866523  0.2109669    -6.099 1.07e-09 ***\nFID.x1770              3.9425248  0.0998904    39.469  &lt; 2e-16 ***\nFID.x1771              4.1552844  0.0998739    41.605  &lt; 2e-16 ***\nFID.x1772              2.7801602  0.1002190    27.741  &lt; 2e-16 ***\nFID.x1773              4.3765284  0.0998769    43.819  &lt; 2e-16 ***\nFID.x1774              3.8408122  0.0999075    38.444  &lt; 2e-16 ***\nFID.x1776              3.2208429  0.1002552    32.126  &lt; 2e-16 ***\nFID.x1779              3.7178801  0.1004096    37.027  &lt; 2e-16 ***\nFID.x178               1.0877876  0.1119871     9.714  &lt; 2e-16 ***\nFID.x1786             -1.2608865  0.1345328    -9.372  &lt; 2e-16 ***\nFID.x1788              1.9793853  0.1002200    19.750  &lt; 2e-16 ***\nFID.x1789              2.6895744  0.1001227    26.863  &lt; 2e-16 ***\nFID.x179               2.2027854  0.1013104    21.743  &lt; 2e-16 ***\nFID.x1790              2.6570943  0.1001042    26.543  &lt; 2e-16 ***\nFID.x1791              4.0779069  0.0998874    40.825  &lt; 2e-16 ***\nFID.x1792              4.7693294  0.0998971    47.742  &lt; 2e-16 ***\nFID.x1793              3.9341373  0.1000195    39.334  &lt; 2e-16 ***\nFID.x1794              2.5003522  0.1002276    24.947  &lt; 2e-16 ***\nFID.x1795              4.5289026  0.0998679    45.349  &lt; 2e-16 ***\nFID.x1796              3.1406909  0.1001888    31.348  &lt; 2e-16 ***\nFID.x180               4.3884995  0.0997225    44.007  &lt; 2e-16 ***\nFID.x1801              2.7851550  0.1020211    27.300  &lt; 2e-16 ***\nFID.x1808              0.9883809  0.1027192     9.622  &lt; 2e-16 ***\nFID.x1809              1.5204300  0.1009993    15.054  &lt; 2e-16 ***\nFID.x1810              2.5547082  0.1000373    25.538  &lt; 2e-16 ***\nFID.x1811              3.1039755  0.0999695    31.049  &lt; 2e-16 ***\nFID.x1812              3.9585893  0.0999232    39.616  &lt; 2e-16 ***\nFID.x1813              3.9205558  0.0999341    39.231  &lt; 2e-16 ***\nFID.x1814              2.5256652  0.1001804    25.211  &lt; 2e-16 ***\nFID.x1815              2.4274171  0.1002391    24.216  &lt; 2e-16 ***\nFID.x1816              2.6268423  0.1020301    25.746  &lt; 2e-16 ***\nFID.x1817              3.7086046  0.1002408    36.997  &lt; 2e-16 ***\nFID.x1819              2.1493839  0.1014316    21.190  &lt; 2e-16 ***\nFID.x1820              0.3709695  0.1209104     3.068 0.002154 ** \nFID.x1821             -1.2374361  0.2168110    -5.707 1.15e-08 ***\nFID.x1828              0.7025179  0.1251001     5.616 1.96e-08 ***\nFID.x1829             -2.9934567  0.4587668    -6.525 6.80e-11 ***\nFID.x1830             -0.1349660  0.1146354    -1.177 0.239056    \nFID.x1832              3.4931165  0.0999047    34.964  &lt; 2e-16 ***\nFID.x1833              3.4546684  0.0999267    34.572  &lt; 2e-16 ***\nFID.x1834              2.1933668  0.1006760    21.786  &lt; 2e-16 ***\nFID.x1835              4.2776720  0.1000295    42.764  &lt; 2e-16 ***\nFID.x1836              0.4431230  0.1067115     4.153 3.29e-05 ***\nFID.x1837              1.7251707  0.1035822    16.655  &lt; 2e-16 ***\nFID.x1838              1.6869451  0.1009031    16.718  &lt; 2e-16 ***\nFID.x1839              2.0810787  0.1005939    20.688  &lt; 2e-16 ***\nFID.x1840              2.0059375  0.1016137    19.741  &lt; 2e-16 ***\nFID.x1842             -0.5672631  0.1439633    -3.940 8.14e-05 ***\nFID.x1843              0.9519847  0.1127051     8.447  &lt; 2e-16 ***\nFID.x1850              1.1441164  0.1161587     9.850  &lt; 2e-16 ***\nFID.x1851             -2.0369820  0.7141313    -2.852 0.004339 ** \nFID.x1853              2.5372232  0.1003788    25.276  &lt; 2e-16 ***\nFID.x1854              2.0573780  0.1002668    20.519  &lt; 2e-16 ***\nFID.x1855              4.0986830  0.0998783    41.037  &lt; 2e-16 ***\nFID.x1856              3.0379467  0.1000614    30.361  &lt; 2e-16 ***\nFID.x1857              1.6502639  0.1011655    16.313  &lt; 2e-16 ***\nFID.x1858              3.3053478  0.0999719    33.063  &lt; 2e-16 ***\nFID.x1859              3.1278168  0.1002099    31.213  &lt; 2e-16 ***\nFID.x1860              2.1882447  0.1005063    21.772  &lt; 2e-16 ***\nFID.x1863              0.1917393  0.1180602     1.624 0.104359    \nFID.x1865              0.4732758  0.1237686     3.824 0.000131 ***\nFID.x1874              3.2100402  0.1009675    31.793  &lt; 2e-16 ***\nFID.x1875              1.0258713  0.1019903    10.059  &lt; 2e-16 ***\nFID.x1876              0.1399711  0.1044522     1.340 0.180229    \nFID.x1877              3.6725347  0.0998978    36.763  &lt; 2e-16 ***\nFID.x1878              4.0204353  0.0999096    40.241  &lt; 2e-16 ***\nFID.x1879              2.1654671  0.1006171    21.522  &lt; 2e-16 ***\nFID.x1880              2.7298317  0.1001379    27.261  &lt; 2e-16 ***\nFID.x1881              2.3262600  0.1030187    22.581  &lt; 2e-16 ***\nFID.x1882              2.6227157  0.1002923    26.151  &lt; 2e-16 ***\nFID.x1883              3.8420542  0.1000215    38.412  &lt; 2e-16 ***\nFID.x1885              0.8416289  0.1081646     7.781 7.20e-15 ***\nFID.x1897              3.9400930  0.0998789    39.449  &lt; 2e-16 ***\nFID.x1898              3.3439710  0.0999603    33.453  &lt; 2e-16 ***\nFID.x1899              4.2704869  0.0999010    42.747  &lt; 2e-16 ***\nFID.x1900              2.6249362  0.1001276    26.216  &lt; 2e-16 ***\nFID.x1901              4.5718170  0.0998633    45.781  &lt; 2e-16 ***\nFID.x1902              3.1679006  0.1000400    31.666  &lt; 2e-16 ***\nFID.x1903              4.5524422  0.0998789    45.580  &lt; 2e-16 ***\nFID.x1905              4.6711547  0.0999312    46.744  &lt; 2e-16 ***\nFID.x1906              4.7419748  0.0999505    47.443  &lt; 2e-16 ***\nFID.x1907              1.2505821  0.1157951    10.800  &lt; 2e-16 ***\nFID.x1917              3.4670488  0.1004616    34.511  &lt; 2e-16 ***\nFID.x1918              0.8781090  0.1040294     8.441  &lt; 2e-16 ***\nFID.x1919              2.2326692  0.1008595    22.136  &lt; 2e-16 ***\nFID.x1920              2.0916284  0.1003689    20.839  &lt; 2e-16 ***\nFID.x1921              2.7862244  0.1002237    27.800  &lt; 2e-16 ***\nFID.x1922              3.2085180  0.0999827    32.091  &lt; 2e-16 ***\nFID.x1923              3.7738395  0.0999162    37.770  &lt; 2e-16 ***\nFID.x1924              4.1854704  0.0999014    41.896  &lt; 2e-16 ***\nFID.x1925              4.2465663  0.0998941    42.511  &lt; 2e-16 ***\nFID.x1926              4.3949990  0.0999344    43.979  &lt; 2e-16 ***\nFID.x1927              3.4713629  0.1002547    34.625  &lt; 2e-16 ***\nFID.x1928              0.2747546  0.1164705     2.359 0.018324 *  \nFID.x1939              3.0840199  0.1018405    30.283  &lt; 2e-16 ***\nFID.x1940              3.6924195  0.0998983    36.962  &lt; 2e-16 ***\nFID.x1941             -0.1584825  0.1133171    -1.399 0.161940    \nFID.x1942              3.2165736  0.0999732    32.174  &lt; 2e-16 ***\nFID.x1943              3.0779646  0.1001736    30.726  &lt; 2e-16 ***\nFID.x1944              3.7405090  0.0999054    37.441  &lt; 2e-16 ***\nFID.x1946              4.2403668  0.0998879    42.451  &lt; 2e-16 ***\nFID.x1947              3.2322563  0.1001144    32.286  &lt; 2e-16 ***\nFID.x1948              4.8212132  0.0999308    48.246  &lt; 2e-16 ***\nFID.x1960              1.9701756  0.1036907    19.000  &lt; 2e-16 ***\nFID.x1961              2.7629147  0.1001364    27.592  &lt; 2e-16 ***\nFID.x1962              3.9160339  0.0999000    39.200  &lt; 2e-16 ***\nFID.x1963              2.3228492  0.1001796    23.187  &lt; 2e-16 ***\nFID.x1964              3.9777403  0.1002820    39.666  &lt; 2e-16 ***\nFID.x1965              2.7572947  0.1001180    27.540  &lt; 2e-16 ***\nFID.x1966              2.2310451  0.1006228    22.172  &lt; 2e-16 ***\nFID.x1967              3.9948904  0.0999310    39.976  &lt; 2e-16 ***\nFID.x1968              4.5166579  0.0998850    45.219  &lt; 2e-16 ***\nFID.x197               1.5731693  0.1256031    12.525  &lt; 2e-16 ***\nFID.x1970              4.4846894  0.1000899    44.807  &lt; 2e-16 ***\nFID.x1982              3.1368502  0.1000844    31.342  &lt; 2e-16 ***\nFID.x1983              3.5746045  0.0999288    35.772  &lt; 2e-16 ***\nFID.x1984              3.2454579  0.0999676    32.465  &lt; 2e-16 ***\nFID.x1985              2.8028636  0.1001490    27.987  &lt; 2e-16 ***\nFID.x1986              2.4067475  0.1002285    24.013  &lt; 2e-16 ***\nFID.x1987              3.8915799  0.0999507    38.935  &lt; 2e-16 ***\nFID.x1988              3.1932927  0.1002177    31.864  &lt; 2e-16 ***\nFID.x1989              4.6068990  0.0998738    46.127  &lt; 2e-16 ***\nFID.x199               0.6172614  0.1081832     5.706 1.16e-08 ***\nFID.x1990              5.1378240  0.0999472    51.405  &lt; 2e-16 ***\nFID.x1991              3.9526577  0.1005313    39.318  &lt; 2e-16 ***\nFID.x200               3.7097734  0.0998082    37.169  &lt; 2e-16 ***\nFID.x2003              2.9823028  0.1006072    29.643  &lt; 2e-16 ***\nFID.x2004              4.3551572  0.0999075    43.592  &lt; 2e-16 ***\nFID.x2005              3.5934248  0.0999519    35.952  &lt; 2e-16 ***\nFID.x2006              3.7171016  0.0999122    37.204  &lt; 2e-16 ***\nFID.x2007              3.0389838  0.1000129    30.386  &lt; 2e-16 ***\nFID.x2009              3.7153532  0.0999758    37.163  &lt; 2e-16 ***\nFID.x201              -0.0480855  0.1223160    -0.393 0.694227    \nFID.x2010              3.6078685  0.0999644    36.092  &lt; 2e-16 ***\nFID.x2011              4.4927895  0.0998922    44.976  &lt; 2e-16 ***\nFID.x2012              3.7272463  0.1002158    37.192  &lt; 2e-16 ***\nFID.x2013              3.7285125  0.1004585    37.115  &lt; 2e-16 ***\nFID.x202              -0.0727668  0.1159142    -0.628 0.530158    \nFID.x2025              3.3497739  0.1002527    33.413  &lt; 2e-16 ***\nFID.x2026              3.5747826  0.0999557    35.764  &lt; 2e-16 ***\nFID.x2027              2.6878164  0.1000511    26.864  &lt; 2e-16 ***\nFID.x2028              3.1027975  0.0999534    31.042  &lt; 2e-16 ***\nFID.x2029              0.9047659  0.1091588     8.289  &lt; 2e-16 ***\nFID.x2030              4.3607325  0.0998866    43.657  &lt; 2e-16 ***\nFID.x2031              4.0300398  0.0999118    40.336  &lt; 2e-16 ***\nFID.x2032              4.3634063  0.0998807    43.686  &lt; 2e-16 ***\nFID.x2033              3.3301121  0.1001088    33.265  &lt; 2e-16 ***\nFID.x2034              5.1302768  0.0998883    51.360  &lt; 2e-16 ***\nFID.x2035              4.9049890  0.1002865    48.910  &lt; 2e-16 ***\nFID.x2047              0.7870489  0.1026635     7.666 1.77e-14 ***\nFID.x2048              3.9328276  0.0998896    39.372  &lt; 2e-16 ***\nFID.x2049              3.3653338  0.0999451    33.672  &lt; 2e-16 ***\nFID.x2050             -0.2527423  0.1104178    -2.289 0.022082 *  \nFID.x2051              1.1845591  0.1020591    11.607  &lt; 2e-16 ***\nFID.x2052              3.6837459  0.0999536    36.855  &lt; 2e-16 ***\nFID.x2053              4.4107892  0.0998716    44.165  &lt; 2e-16 ***\nFID.x2054              4.0846650  0.0999134    40.882  &lt; 2e-16 ***\nFID.x2055              4.1155677  0.0999219    41.188  &lt; 2e-16 ***\nFID.x2056              3.8250231  0.1001004    38.212  &lt; 2e-16 ***\nFID.x2068              2.9201265  0.1001233    29.165  &lt; 2e-16 ***\nFID.x2069              3.2446865  0.1000006    32.447  &lt; 2e-16 ***\nFID.x2071              1.0589525  0.1040231    10.180  &lt; 2e-16 ***\nFID.x2072              0.4101184  0.1044035     3.928 8.56e-05 ***\nFID.x2074              4.3978119  0.0998838    44.029  &lt; 2e-16 ***\nFID.x2075              4.0411338  0.0999091    40.448  &lt; 2e-16 ***\nFID.x2076              4.3454781  0.0999051    43.496  &lt; 2e-16 ***\nFID.x2077              4.9668202  0.0998713    49.732  &lt; 2e-16 ***\nFID.x2078              5.2642890  0.0998762    52.708  &lt; 2e-16 ***\nFID.x2090              2.6963737  0.1002127    26.906  &lt; 2e-16 ***\nFID.x2091              3.9931665  0.0998933    39.974  &lt; 2e-16 ***\nFID.x2092              3.0500622  0.1000496    30.485  &lt; 2e-16 ***\nFID.x2093              2.4269400  0.1001858    24.224  &lt; 2e-16 ***\nFID.x2094              0.3066333  0.1049729     2.921 0.003488 ** \nFID.x2096              3.9110384  0.1000097    39.107  &lt; 2e-16 ***\nFID.x2097              3.8281700  0.0999527    38.300  &lt; 2e-16 ***\nFID.x2098              4.4851806  0.0998938    44.899  &lt; 2e-16 ***\nFID.x2099              3.2839402  0.1001768    32.781  &lt; 2e-16 ***\nFID.x2100              4.0384914  0.1000465    40.366  &lt; 2e-16 ***\nFID.x2111              3.6401746  0.0999625    36.415  &lt; 2e-16 ***\nFID.x2112              3.4513388  0.1001895    34.448  &lt; 2e-16 ***\nFID.x2113              2.2930505  0.1002781    22.867  &lt; 2e-16 ***\nFID.x2114              3.0558162  0.0999576    30.571  &lt; 2e-16 ***\nFID.x2115              0.2430056  0.1053008     2.308 0.021014 *  \nFID.x2116              1.2915729  0.1035854    12.469  &lt; 2e-16 ***\nFID.x2117              0.1180370  0.1099310     1.074 0.282940    \nFID.x2118              4.7225910  0.0999285    47.260  &lt; 2e-16 ***\nFID.x2119              4.1100799  0.0999444    41.124  &lt; 2e-16 ***\nFID.x2120              4.9642029  0.0998663    49.708  &lt; 2e-16 ***\nFID.x2121              5.0318384  0.0998818    50.378  &lt; 2e-16 ***\nFID.x2122              2.8077657  0.1018636    27.564  &lt; 2e-16 ***\nFID.x2133              3.6526710  0.1000119    36.522  &lt; 2e-16 ***\nFID.x2134              3.6359509  0.0999162    36.390  &lt; 2e-16 ***\nFID.x2135              3.9377926  0.0998825    39.424  &lt; 2e-16 ***\nFID.x2136              1.8804666  0.1016963    18.491  &lt; 2e-16 ***\nFID.x2140              4.9087394  0.0999263    49.124  &lt; 2e-16 ***\nFID.x2141              4.7376848  0.0998937    47.427  &lt; 2e-16 ***\nFID.x2142              3.7528539  0.1000130    37.524  &lt; 2e-16 ***\nFID.x2143              3.0505782  0.1006177    30.318  &lt; 2e-16 ***\nFID.x2144              5.1245698  0.1003925    51.045  &lt; 2e-16 ***\nFID.x2154              3.8321298  0.0999476    38.341  &lt; 2e-16 ***\nFID.x2155              3.1144603  0.1000933    31.116  &lt; 2e-16 ***\nFID.x2156              3.9952054  0.0998896    39.996  &lt; 2e-16 ***\nFID.x2157              3.5192596  0.0999333    35.216  &lt; 2e-16 ***\nFID.x2160              0.6650726  0.1077665     6.171 6.77e-10 ***\nFID.x2162              2.8127631  0.1019968    27.577  &lt; 2e-16 ***\nFID.x2163              5.8359073  0.0998463    58.449  &lt; 2e-16 ***\nFID.x2164              4.4847238  0.0999307    44.878  &lt; 2e-16 ***\nFID.x2176              3.5668826  0.0999388    35.691  &lt; 2e-16 ***\nFID.x2177              2.5236887  0.1002181    25.182  &lt; 2e-16 ***\nFID.x2178              3.0271863  0.1017163    29.761  &lt; 2e-16 ***\nFID.x2179              3.3428778  0.1000088    33.426  &lt; 2e-16 ***\nFID.x2182              2.0242220  0.1030056    19.652  &lt; 2e-16 ***\nFID.x2184              4.4847006  0.0999740    44.859  &lt; 2e-16 ***\nFID.x2185              4.4568887  0.0999361    44.597  &lt; 2e-16 ***\nFID.x2187              2.3851154  0.1067647    22.340  &lt; 2e-16 ***\nFID.x2197              3.3231931  0.1001102    33.195  &lt; 2e-16 ***\nFID.x2198              2.9908496  0.1001662    29.859  &lt; 2e-16 ***\nFID.x2199              3.9524073  0.0999225    39.555  &lt; 2e-16 ***\nFID.x220              -1.0972410  0.3480410    -3.153 0.001618 ** \nFID.x2200              4.3574789  0.0999086    43.615  &lt; 2e-16 ***\nFID.x2201              0.5274948  0.1091503     4.833 1.35e-06 ***\nFID.x2204              0.3513235  0.1120121     3.136 0.001710 ** \nFID.x2206              3.7961745  0.1001087    37.921  &lt; 2e-16 ***\nFID.x2207              4.7747587  0.1000566    47.721  &lt; 2e-16 ***\nFID.x221               0.4808049  0.1276031     3.768 0.000165 ***\nFID.x2219              4.1287045  0.0999033    41.327  &lt; 2e-16 ***\nFID.x222               0.8784975  0.1048504     8.379  &lt; 2e-16 ***\nFID.x2220              1.4669362  0.1013206    14.478  &lt; 2e-16 ***\nFID.x2221              3.9538092  0.1004635    39.356  &lt; 2e-16 ***\nFID.x2222              3.8990104  0.0999234    39.020  &lt; 2e-16 ***\nFID.x2226             -4.0170627  0.5859577    -6.856 7.10e-12 ***\nFID.x2228              4.5183120  0.0999761    45.194  &lt; 2e-16 ***\nFID.x223              -0.1471353  0.1719815    -0.856 0.392258    \nFID.x2241              2.7783142  0.1002209    27.722  &lt; 2e-16 ***\nFID.x2242              2.1820074  0.1003970    21.734  &lt; 2e-16 ***\nFID.x2243              3.2016127  0.1001848    31.957  &lt; 2e-16 ***\nFID.x2244             -0.7403910  0.1658870    -4.463 8.07e-06 ***\nFID.x2247             -1.0023747  0.1327296    -7.552 4.29e-14 ***\nFID.x2249              3.3199937  0.1004367    33.056  &lt; 2e-16 ***\nFID.x2250              4.8071701  0.1004446    47.859  &lt; 2e-16 ***\nFID.x2262              2.5275836  0.1003640    25.184  &lt; 2e-16 ***\nFID.x2263              2.5228250  0.1005559    25.089  &lt; 2e-16 ***\nFID.x2264              4.2047938  0.0999989    42.048  &lt; 2e-16 ***\nFID.x2265              3.7909584  0.0999581    37.925  &lt; 2e-16 ***\nFID.x2268             -0.7056555  0.1585508    -4.451 8.56e-06 ***\nFID.x2269              1.7891213  0.1033620    17.309  &lt; 2e-16 ***\nFID.x2271              5.1859270  0.1003723    51.667  &lt; 2e-16 ***\nFID.x2284              3.1772808  0.1000811    31.747  &lt; 2e-16 ***\nFID.x2285              4.0307520  0.0998993    40.348  &lt; 2e-16 ***\nFID.x2286              4.8687403  0.0998911    48.740  &lt; 2e-16 ***\nFID.x2288              1.6391715  0.1101503    14.881  &lt; 2e-16 ***\nFID.x2290             -0.0472699  0.1220504    -0.387 0.698536    \nFID.x2305              3.4706256  0.1001496    34.654  &lt; 2e-16 ***\nFID.x2306              3.1292685  0.1014623    30.842  &lt; 2e-16 ***\nFID.x2307              3.5881659  0.0999551    35.898  &lt; 2e-16 ***\nFID.x2308              3.5228097  0.1000285    35.218  &lt; 2e-16 ***\nFID.x2309              4.0336321  0.0999413    40.360  &lt; 2e-16 ***\nFID.x2310              2.1924609  0.1012463    21.655  &lt; 2e-16 ***\nFID.x2311              2.8154423  0.1009645    27.885  &lt; 2e-16 ***\nFID.x2327              3.2259044  0.1000537    32.242  &lt; 2e-16 ***\nFID.x2328              4.9367971  0.0998496    49.442  &lt; 2e-16 ***\nFID.x2329              4.3269731  0.0999293    43.300  &lt; 2e-16 ***\nFID.x2331              4.4107932  0.0999054    44.150  &lt; 2e-16 ***\nFID.x2332              2.3326492  0.1004168    23.230  &lt; 2e-16 ***\nFID.x2333              3.3212672  0.1000837    33.185  &lt; 2e-16 ***\nFID.x2349              2.3576980  0.1002795    23.511  &lt; 2e-16 ***\nFID.x2350              3.3960463  0.0999612    33.974  &lt; 2e-16 ***\nFID.x2351              3.8846504  0.0999291    38.874  &lt; 2e-16 ***\nFID.x2352              4.0252424  0.0999137    40.287  &lt; 2e-16 ***\nFID.x2353              3.7081247  0.0999540    37.098  &lt; 2e-16 ***\nFID.x2354              2.2722594  0.1003893    22.634  &lt; 2e-16 ***\nFID.x2355              3.8466002  0.0999626    38.480  &lt; 2e-16 ***\nFID.x2370              3.3752219  0.1000471    33.736  &lt; 2e-16 ***\nFID.x2371              4.0359614  0.0998893    40.404  &lt; 2e-16 ***\nFID.x2372              4.6648321  0.0998675    46.710  &lt; 2e-16 ***\nFID.x2373              1.8019684  0.1005233    17.926  &lt; 2e-16 ***\nFID.x2374              3.6692815  0.0999634    36.706  &lt; 2e-16 ***\nFID.x2375              4.2655259  0.0998970    42.699  &lt; 2e-16 ***\nFID.x2376              1.5112544  0.1020745    14.805  &lt; 2e-16 ***\nFID.x2377              3.6703085  0.1000823    36.673  &lt; 2e-16 ***\nFID.x2392              3.2451538  0.1000675    32.430  &lt; 2e-16 ***\nFID.x2393              3.7074457  0.0999405    37.097  &lt; 2e-16 ***\nFID.x2395              3.7517325  0.0999224    37.546  &lt; 2e-16 ***\nFID.x2396              3.9244762  0.0999005    39.284  &lt; 2e-16 ***\nFID.x2397              3.2670391  0.1000747    32.646  &lt; 2e-16 ***\nFID.x2398              4.6361252  0.0998827    46.416  &lt; 2e-16 ***\nFID.x2414              3.6868919  0.0999596    36.884  &lt; 2e-16 ***\nFID.x2415              3.8807806  0.1000724    38.780  &lt; 2e-16 ***\nFID.x2416              3.2651888  0.1001513    32.603  &lt; 2e-16 ***\nFID.x2417              3.0484312  0.0999666    30.494  &lt; 2e-16 ***\nFID.x2418              3.1302885  0.1000519    31.287  &lt; 2e-16 ***\nFID.x2419              3.7749228  0.0999358    37.773  &lt; 2e-16 ***\nFID.x242              -2.1228460  0.2007207   -10.576  &lt; 2e-16 ***\nFID.x2420              2.9193414  0.1006889    28.994  &lt; 2e-16 ***\nFID.x243               0.4583694  0.1107569     4.139 3.50e-05 ***\nFID.x2435              3.8244464  0.0999767    38.253  &lt; 2e-16 ***\nFID.x2436              4.6117755  0.0998711    46.177  &lt; 2e-16 ***\nFID.x2437              1.5137104  0.1024572    14.774  &lt; 2e-16 ***\nFID.x2438              3.7806325  0.0998970    37.845  &lt; 2e-16 ***\nFID.x2439              5.1185217  0.0998447    51.265  &lt; 2e-16 ***\nFID.x244               0.5602739  0.1169520     4.791 1.66e-06 ***\nFID.x2440              2.5389419  0.1004442    25.277  &lt; 2e-16 ***\nFID.x2441              3.3085530  0.1000450    33.071  &lt; 2e-16 ***\nFID.x2457              2.8817498  0.1018562    28.292  &lt; 2e-16 ***\nFID.x2458              2.3845104  0.1003081    23.772  &lt; 2e-16 ***\nFID.x2459              2.4323296  0.1003005    24.250  &lt; 2e-16 ***\nFID.x2460              2.9629165  0.1000190    29.624  &lt; 2e-16 ***\nFID.x2462              4.7471503  0.0998662    47.535  &lt; 2e-16 ***\nFID.x2463              1.7556139  0.1033875    16.981  &lt; 2e-16 ***\nFID.x2478              3.0599133  0.1002406    30.526  &lt; 2e-16 ***\nFID.x2479              2.2759920  0.1002919    22.694  &lt; 2e-16 ***\nFID.x2480              2.8075129  0.1000766    28.054  &lt; 2e-16 ***\nFID.x2481              3.1898993  0.0999749    31.907  &lt; 2e-16 ***\nFID.x2482              3.6557048  0.0999039    36.592  &lt; 2e-16 ***\nFID.x2483              3.0626465  0.1000568    30.609  &lt; 2e-16 ***\nFID.x2499              0.8893336  0.1420290     6.262 3.81e-10 ***\nFID.x2500              3.0888647  0.1003751    30.773  &lt; 2e-16 ***\nFID.x2501              1.0771960  0.1019435    10.567  &lt; 2e-16 ***\nFID.x2502              3.7879454  0.0999460    37.900  &lt; 2e-16 ***\nFID.x2503              4.1537544  0.0998758    41.589  &lt; 2e-16 ***\nFID.x2504              4.1209671  0.0999401    41.234  &lt; 2e-16 ***\nFID.x2505              3.2166194  0.1000106    32.163  &lt; 2e-16 ***\nFID.x2521              0.8591790  0.1173790     7.320 2.49e-13 ***\nFID.x2523              0.6135824  0.1032455     5.943 2.80e-09 ***\nFID.x2524              3.8334309  0.0999273    38.362  &lt; 2e-16 ***\nFID.x2525              4.5144833  0.0998638    45.206  &lt; 2e-16 ***\nFID.x2526              4.3114696  0.0998976    43.159  &lt; 2e-16 ***\nFID.x2527              2.6357040  0.1003194    26.273  &lt; 2e-16 ***\nFID.x2544              1.4010247  0.1009938    13.872  &lt; 2e-16 ***\nFID.x2545              3.3262482  0.0999938    33.265  &lt; 2e-16 ***\nFID.x2546              3.6592822  0.1000294    36.582  &lt; 2e-16 ***\nFID.x2547              3.4569975  0.0999637    34.583  &lt; 2e-16 ***\nFID.x2548              4.3192814  0.0999273    43.224  &lt; 2e-16 ***\nFID.x2565             -0.2543676  0.1203626    -2.113 0.034571 *  \nFID.x2566              2.9224780  0.1000948    29.197  &lt; 2e-16 ***\nFID.x2567              2.6234683  0.1004222    26.124  &lt; 2e-16 ***\nFID.x2568              3.4788645  0.1000199    34.782  &lt; 2e-16 ***\nFID.x2569              3.5947775  0.0999467    35.967  &lt; 2e-16 ***\nFID.x2570              3.5943443  0.1000664    35.920  &lt; 2e-16 ***\nFID.x2587              0.7335415  0.1043094     7.032 2.03e-12 ***\nFID.x2588              1.1671715  0.1022271    11.417  &lt; 2e-16 ***\nFID.x2589              2.5630616  0.1001448    25.594  &lt; 2e-16 ***\nFID.x2590              3.9686445  0.0999113    39.722  &lt; 2e-16 ***\nFID.x2591              2.8179028  0.1001878    28.126  &lt; 2e-16 ***\nFID.x2608              0.4758350  0.1278801     3.721 0.000198 ***\nFID.x2609              0.8302328  0.1040310     7.981 1.46e-15 ***\nFID.x2610              2.0531305  0.1015350    20.221  &lt; 2e-16 ***\nFID.x2611              3.7565870  0.0999960    37.567  &lt; 2e-16 ***\nFID.x2612              2.8145669  0.1001618    28.100  &lt; 2e-16 ***\nFID.x2630             -1.2669599  0.1363845    -9.290  &lt; 2e-16 ***\nFID.x2632              0.6032844  0.1035255     5.827 5.63e-09 ***\nFID.x2633              1.9764780  0.1010225    19.565  &lt; 2e-16 ***\nFID.x2634              2.6486622  0.1002922    26.409  &lt; 2e-16 ***\nFID.x2635              0.8781426  0.1066589     8.233  &lt; 2e-16 ***\nFID.x264               4.5429420  0.0998687    45.489  &lt; 2e-16 ***\nFID.x265               1.8171603  0.1020858    17.800  &lt; 2e-16 ***\nFID.x2653             -0.7846309  0.1159610    -6.766 1.32e-11 ***\nFID.x2654              1.1531231  0.1072663    10.750  &lt; 2e-16 ***\nFID.x2655             -0.2597960  0.1466842    -1.771 0.076540 .  \nFID.x2656              0.7922941  0.1046255     7.573 3.66e-14 ***\nFID.x2676              2.2378679  0.1015095    22.046  &lt; 2e-16 ***\nFID.x2677              0.7112319  0.1040896     6.833 8.32e-12 ***\nFID.x2678             -1.1000395  0.1156089    -9.515  &lt; 2e-16 ***\nFID.x2695              2.3974778  0.1011186    23.710  &lt; 2e-16 ***\nFID.x2698              3.4848027  0.1004772    34.683  &lt; 2e-16 ***\nFID.x2699              1.4107766  0.1018176    13.856  &lt; 2e-16 ***\nFID.x2700              1.6287147  0.1015342    16.041  &lt; 2e-16 ***\nFID.x2717              3.2821617  0.1002924    32.726  &lt; 2e-16 ***\nFID.x2720             -1.4759294  0.2354887    -6.268 3.67e-10 ***\nFID.x2722              0.4660339  0.1138169     4.095 4.23e-05 ***\nFID.x2739              1.4625498  0.1017010    14.381  &lt; 2e-16 ***\nFID.x2740              2.7785149  0.1003219    27.696  &lt; 2e-16 ***\nFID.x2743              2.6325814  0.1004208    26.215  &lt; 2e-16 ***\nFID.x2761              2.6844885  0.1003649    26.747  &lt; 2e-16 ***\nFID.x2762              3.2792589  0.1002227    32.720  &lt; 2e-16 ***\nFID.x2779              3.6660806  0.1014526    36.136  &lt; 2e-16 ***\nFID.x2786              1.8291480  0.1010922    18.094  &lt; 2e-16 ***\nFID.x2800              2.8083704  0.1021338    27.497  &lt; 2e-16 ***\nFID.x2806              1.6991228  0.1010722    16.811  &lt; 2e-16 ***\nFID.x2828              1.6002337  0.1014006    15.781  &lt; 2e-16 ***\nFID.x2829              0.2673863  0.1049506     2.548 0.010842 *  \nFID.x284               0.2235629  0.1297564     1.723 0.084899 .  \nFID.x2849              0.3929590  0.1128998     3.481 0.000500 ***\nFID.x285               0.6859951  0.1130427     6.068 1.29e-09 ***\nFID.x2850              2.6976805  0.1003400    26.885  &lt; 2e-16 ***\nFID.x286               0.7318307  0.1090197     6.713 1.91e-11 ***\nFID.x287              -0.2734064  0.3054720    -0.895 0.370771    \nFID.x2871              1.5234924  0.1080386    14.101  &lt; 2e-16 ***\nFID.x2892              0.5226529  0.1082773     4.827 1.39e-06 ***\nFID.x2951              2.9400211  0.1066475    27.568  &lt; 2e-16 ***\nFID.x305               0.7618671  0.1084877     7.023 2.18e-12 ***\nFID.x306              -0.0701234  0.1212803    -0.578 0.563134    \nFID.x307               2.1713677  0.1044659    20.785  &lt; 2e-16 ***\nFID.x327               0.0436952  0.1110640     0.393 0.694007    \nFID.x328               2.9153566  0.1005655    28.990  &lt; 2e-16 ***\nFID.x329               0.7713592  0.1124354     6.860 6.86e-12 ***\nFID.x348              -1.1061467  0.2694011    -4.106 4.03e-05 ***\nFID.x349               0.8283844  0.1104932     7.497 6.52e-14 ***\nFID.x350               3.7795312  0.1004416    37.629  &lt; 2e-16 ***\nFID.x369               0.2795141  0.1135198     2.462 0.013807 *  \nFID.x370              -0.4507648  0.1100008    -4.098 4.17e-05 ***\nFID.x371              -0.2724924  0.1283956    -2.122 0.033814 *  \nFID.x372              -0.3774659  0.1570194    -2.404 0.016219 *  \nFID.x391              -1.8708037  0.1462687   -12.790  &lt; 2e-16 ***\nFID.x392               1.9265563  0.1223827    15.742  &lt; 2e-16 ***\nFID.x393               1.1395128  0.1057401    10.777  &lt; 2e-16 ***\nFID.x412               0.8189987  0.1048732     7.809 5.75e-15 ***\nFID.x413              -1.2954828  0.1174491   -11.030  &lt; 2e-16 ***\nFID.x414               1.5457263  0.1083345    14.268  &lt; 2e-16 ***\nFID.x415               0.7330564  0.1064698     6.885 5.77e-12 ***\nFID.x435               1.8869864  0.1155417    16.332  &lt; 2e-16 ***\nFID.x436               0.3955553  0.1066455     3.709 0.000208 ***\nFID.x437               1.1309657  0.1099574    10.285  &lt; 2e-16 ***\nFID.x44               -0.4007723  0.1393431    -2.876 0.004026 ** \nFID.x456               0.2628159  0.1053762     2.494 0.012629 *  \nFID.x457               1.8955980  0.1105877    17.141  &lt; 2e-16 ***\nFID.x458               5.4135916  0.0997856    54.252  &lt; 2e-16 ***\nFID.x46                1.1704542  0.1514314     7.729 1.08e-14 ***\nFID.x460              -0.8693519  0.1267637    -6.858 6.98e-12 ***\nFID.x477               0.8945073  0.1072085     8.344  &lt; 2e-16 ***\nFID.x478              -0.6878740  0.1150715    -5.978 2.26e-09 ***\nFID.x479               0.1134324  0.1061068     1.069 0.285052    \nFID.x480               0.1370749  0.1184835     1.157 0.247309    \nFID.x481               0.9431033  0.1177836     8.007 1.17e-15 ***\nFID.x482               0.7045405  0.1063136     6.627 3.43e-11 ***\nFID.x499              -0.9679991  0.1637774    -5.910 3.41e-09 ***\nFID.x500               0.9239221  0.1099792     8.401  &lt; 2e-16 ***\nFID.x501               1.7921087  0.1007857    17.781  &lt; 2e-16 ***\nFID.x502               0.7016448  0.1194739     5.873 4.29e-09 ***\nFID.x503               1.4061230  0.1034523    13.592  &lt; 2e-16 ***\nFID.x520               0.7137487  0.1160749     6.149 7.80e-10 ***\nFID.x521              -0.2580651  0.1093045    -2.361 0.018227 *  \nFID.x522               0.1985991  0.1102316     1.802 0.071600 .  \nFID.x523               0.3715479  0.1158521     3.207 0.001341 ** \nFID.x524               4.3116952  0.1000847    43.080  &lt; 2e-16 ***\nFID.x525               2.6110804  0.1006366    25.946  &lt; 2e-16 ***\nFID.x542              -3.0468491  0.5861097    -5.198 2.01e-07 ***\nFID.x543               1.1533291  0.1049670    10.988  &lt; 2e-16 ***\nFID.x544               0.8550124  0.1066135     8.020 1.06e-15 ***\nFID.x545               3.8330082  0.1001578    38.270  &lt; 2e-16 ***\nFID.x546               1.9917785  0.1013406    19.654  &lt; 2e-16 ***\nFID.x547               1.4293709  0.1041647    13.722  &lt; 2e-16 ***\nFID.x563               0.3035347  0.1185539     2.560 0.010458 *  \nFID.x565               1.5399290  0.1047762    14.697  &lt; 2e-16 ***\nFID.x566               2.1211568  0.1015157    20.895  &lt; 2e-16 ***\nFID.x567               5.0697916  0.0998731    50.762  &lt; 2e-16 ***\nFID.x569              -1.3627438  0.2273072    -5.995 2.03e-09 ***\nFID.x585              -1.0187782  0.1362088    -7.480 7.46e-14 ***\nFID.x586               1.5532519  0.1062922    14.613  &lt; 2e-16 ***\nFID.x587               3.2257520  0.1005134    32.093  &lt; 2e-16 ***\nFID.x588               3.3131748  0.1000509    33.115  &lt; 2e-16 ***\nFID.x589               5.1146270  0.0999411    51.176  &lt; 2e-16 ***\nFID.x590               2.0521460  0.1026328    19.995  &lt; 2e-16 ***\nFID.x591               1.7432685  0.1064303    16.379  &lt; 2e-16 ***\nFID.x592               0.0992684  0.2569174     0.386 0.699213    \nFID.x606              -1.1324294  0.1768615    -6.403 1.52e-10 ***\nFID.x607               1.3175672  0.1020490    12.911  &lt; 2e-16 ***\nFID.x608               0.1961756  0.1065367     1.841 0.065564 .  \nFID.x609               2.5865228  0.1004019    25.762  &lt; 2e-16 ***\nFID.x610               4.7956961  0.0998532    48.027  &lt; 2e-16 ***\nFID.x613               2.4983965  0.1025978    24.351  &lt; 2e-16 ***\nFID.x614               0.1505032  0.1720522     0.875 0.381708    \nFID.x628               0.0019692  0.1105108     0.018 0.985783    \nFID.x629               0.6604519  0.1049753     6.291 3.14e-10 ***\nFID.x630               1.1523390  0.1022677    11.268  &lt; 2e-16 ***\nFID.x631               4.8407540  0.0998449    48.483  &lt; 2e-16 ***\nFID.x632               5.4701279  0.0998454    54.786  &lt; 2e-16 ***\nFID.x635              -0.4838654  0.1944470    -2.488 0.012831 *  \nFID.x636              -1.7930366  0.7141739    -2.511 0.012051 *  \nFID.x637               0.1948001  0.2272797     0.857 0.391393    \nFID.x638              -1.3765770  0.5868167    -2.346 0.018984 *  \nFID.x639               3.3376283  0.1110147    30.065  &lt; 2e-16 ***\nFID.x650              -1.5670018  0.1278770   -12.254  &lt; 2e-16 ***\nFID.x651               1.8770111  0.1064157    17.638  &lt; 2e-16 ***\nFID.x652               0.6589294  0.1032531     6.382 1.75e-10 ***\nFID.x653               4.5727472  0.0998623    45.791  &lt; 2e-16 ***\nFID.x654               5.1157812  0.0998800    51.219  &lt; 2e-16 ***\nFID.x656               0.2990392  0.1329649     2.249 0.024512 *  \nFID.x659               0.9399783  0.1372064     6.851 7.34e-12 ***\nFID.x66               -0.5154664  0.1187993    -4.339 1.43e-05 ***\nFID.x660               0.2111320  0.2401849     0.879 0.379380    \nFID.x661              -2.8322734  0.5101245    -5.552 2.82e-08 ***\nFID.x671              -2.0643927  0.2451276    -8.422  &lt; 2e-16 ***\nFID.x672               1.6573619  0.1158020    14.312  &lt; 2e-16 ***\nFID.x673               1.3329838  0.1057501    12.605  &lt; 2e-16 ***\nFID.x674               5.9082805  0.0998091    59.196  &lt; 2e-16 ***\nFID.x675               4.3058381  0.0999153    43.095  &lt; 2e-16 ***\nFID.x68               -1.8571088  0.1698003   -10.937  &lt; 2e-16 ***\nFID.x682               0.0321736  0.1485187     0.217 0.828496    \nFID.x683               0.6008929  0.1469719     4.088 4.34e-05 ***\nFID.x69               -0.8711895  0.1634068    -5.331 9.75e-08 ***\nFID.x693              -1.7262132  0.1428240   -12.086  &lt; 2e-16 ***\nFID.x694               1.1443659  0.1028768    11.124  &lt; 2e-16 ***\nFID.x695               0.9634532  0.1022103     9.426  &lt; 2e-16 ***\nFID.x696               3.4266231  0.0999723    34.276  &lt; 2e-16 ***\nFID.x697               2.8458699  0.1008520    28.218  &lt; 2e-16 ***\nFID.x699              -1.9944156  0.3479802    -5.731 9.96e-09 ***\nFID.x705               0.2149202  0.1990758     1.080 0.280325    \nFID.x706               3.2633864  0.1142338    28.568  &lt; 2e-16 ***\nFID.x715               0.2766154  0.1066792     2.593 0.009515 ** \nFID.x716               0.4648663  0.1056764     4.399 1.09e-05 ***\nFID.x717               1.1340212  0.1018349    11.136  &lt; 2e-16 ***\nFID.x718               5.2123396  0.0998505    52.201  &lt; 2e-16 ***\nFID.x727              -1.9104048  0.4588331    -4.164 3.13e-05 ***\nFID.x736               0.3222387  0.1106710     2.912 0.003595 ** \nFID.x738               0.9958750  0.1057324     9.419  &lt; 2e-16 ***\nFID.x739               3.6005154  0.0999704    36.016  &lt; 2e-16 ***\nFID.x740               2.4852136  0.1009222    24.625  &lt; 2e-16 ***\nFID.x742               1.9796939  0.1050032    18.854  &lt; 2e-16 ***\nFID.x758               1.0589576  0.1036914    10.213  &lt; 2e-16 ***\nFID.x759               3.0069758  0.1001754    30.017  &lt; 2e-16 ***\nFID.x760               2.6213654  0.1003232    26.129  &lt; 2e-16 ***\nFID.x761               3.7580585  0.0999430    37.602  &lt; 2e-16 ***\nFID.x779               1.6440325  0.1043951    15.748  &lt; 2e-16 ***\nFID.x780              -0.1745757  0.1116170    -1.564 0.117803    \nFID.x781               2.4427462  0.1008106    24.231  &lt; 2e-16 ***\nFID.x782               5.1338218  0.0998615    51.409  &lt; 2e-16 ***\nFID.x783               5.2862709  0.0998475    52.943  &lt; 2e-16 ***\nFID.x785               5.1012823  0.1000808    50.972  &lt; 2e-16 ***\nFID.x801               1.9834863  0.1013256    19.575  &lt; 2e-16 ***\nFID.x802               4.5571279  0.0999040    45.615  &lt; 2e-16 ***\nFID.x803               4.8360615  0.0998616    48.428  &lt; 2e-16 ***\nFID.x804               2.9656916  0.1001569    29.610  &lt; 2e-16 ***\nFID.x822               1.9968795  0.1018854    19.599  &lt; 2e-16 ***\nFID.x823              -0.6577659  0.1366051    -4.815 1.47e-06 ***\nFID.x824               4.1907729  0.0999347    41.935  &lt; 2e-16 ***\nFID.x825               1.0362250  0.1029409    10.066  &lt; 2e-16 ***\nFID.x826               4.8833142  0.0998654    48.899  &lt; 2e-16 ***\nFID.x828               1.0387573  0.1117333     9.297  &lt; 2e-16 ***\nFID.x845               2.8706802  0.1003688    28.601  &lt; 2e-16 ***\nFID.x847               4.1968543  0.0999411    41.993  &lt; 2e-16 ***\nFID.x850               1.3201216  0.1089112    12.121  &lt; 2e-16 ***\nFID.x865              -0.4664767  0.1286696    -3.625 0.000289 ***\nFID.x868               3.7259241  0.1001518    37.203  &lt; 2e-16 ***\nFID.x869               4.5024650  0.0999883    45.030  &lt; 2e-16 ***\nFID.x88               -2.5468223  0.1599295   -15.925  &lt; 2e-16 ***\nFID.x886               1.7456403  0.1034863    16.868  &lt; 2e-16 ***\nFID.x887               3.4025056  0.1002395    33.944  &lt; 2e-16 ***\nFID.x889               2.6845497  0.1005495    26.699  &lt; 2e-16 ***\nFID.x89                1.0876190  0.1022532    10.637  &lt; 2e-16 ***\nFID.x890               4.3279485  0.0999085    43.319  &lt; 2e-16 ***\nFID.x891               4.2349587  0.1001274    42.296  &lt; 2e-16 ***\nFID.x893               5.5050751  0.0999086    55.101  &lt; 2e-16 ***\nFID.x899               1.1187839  0.1231256     9.087  &lt; 2e-16 ***\nFID.x908               2.1283176  0.1012204    21.027  &lt; 2e-16 ***\nFID.x909               4.7318641  0.0999029    47.365  &lt; 2e-16 ***\nFID.x91                0.3803141  0.1119395     3.397 0.000680 ***\nFID.x910               3.3246582  0.1000713    33.223  &lt; 2e-16 ***\nFID.x911               4.6315597  0.0998673    46.377  &lt; 2e-16 ***\nFID.x912               3.8026464  0.1000999    37.988  &lt; 2e-16 ***\nFID.x914               3.7533579  0.1006273    37.300  &lt; 2e-16 ***\nFID.x915               4.6940792  0.1000336    46.925  &lt; 2e-16 ***\nFID.x929               0.1062433  0.1111419     0.956 0.339110    \nFID.x930               1.0125495  0.1044751     9.692  &lt; 2e-16 ***\nFID.x931               1.1208820  0.1025167    10.934  &lt; 2e-16 ***\nFID.x932               4.5037151  0.0998608    45.100  &lt; 2e-16 ***\nFID.x933               4.0631638  0.0999469    40.653  &lt; 2e-16 ***\nFID.x934               4.9710441  0.0999095    49.755  &lt; 2e-16 ***\nFID.x936               5.5502824  0.0998786    55.570  &lt; 2e-16 ***\nFID.x937               3.4202545  0.1005891    34.002  &lt; 2e-16 ***\nFID.x950              -0.6221486  0.1280113    -4.860 1.17e-06 ***\nFID.x952               3.7162370  0.0999815    37.169  &lt; 2e-16 ***\nFID.x953               4.1328918  0.0998879    41.375  &lt; 2e-16 ***\nFID.x954               4.5477122  0.0998705    45.536  &lt; 2e-16 ***\nFID.x955               4.3705771  0.0999460    43.729  &lt; 2e-16 ***\nFID.x956               4.6198998  0.1000401    46.180  &lt; 2e-16 ***\nFID.x957               5.1798632  0.0999436    51.828  &lt; 2e-16 ***\nFID.x958               6.0194334  0.0998427    60.289  &lt; 2e-16 ***\nFID.x959               5.2341425  0.0999496    52.368  &lt; 2e-16 ***\nFID.x973               2.4692573  0.1007239    24.515  &lt; 2e-16 ***\nFID.x974               2.6412267  0.1003139    26.330  &lt; 2e-16 ***\nFID.x975               3.6913163  0.0999547    36.930  &lt; 2e-16 ***\nFID.x976               4.6995982  0.0998699    47.057  &lt; 2e-16 ***\nFID.x977               4.0055727  0.0999726    40.067  &lt; 2e-16 ***\nFID.x978               2.8273954  0.1015142    27.852  &lt; 2e-16 ***\nFID.x979               4.5767760  0.0999337    45.798  &lt; 2e-16 ***\nFID.x980               2.3985276  0.1010135    23.745  &lt; 2e-16 ***\nFID.x981               5.2102692  0.1000516    52.076  &lt; 2e-16 ***\nFID.x984               0.5775778  0.1158188     4.987 6.14e-07 ***\nFID.x985               3.7128822  0.1010168    36.755  &lt; 2e-16 ***\nFID.x993               1.3951400  0.1047377    13.320  &lt; 2e-16 ***\nFID.x994               1.5639354  0.1045596    14.957  &lt; 2e-16 ***\nFID.x995               3.6984298  0.1000038    36.983  &lt; 2e-16 ***\nFID.x996               1.8017511  0.1011133    17.819  &lt; 2e-16 ***\nFID.x997               2.9739214  0.1002616    29.662  &lt; 2e-16 ***\nFID.x998               4.2118248  0.0999023    42.159  &lt; 2e-16 ***\nFID.x999               4.7308656  0.0999019    47.355  &lt; 2e-16 ***\nFID.y1000             -2.6286180  0.0476662   -55.146  &lt; 2e-16 ***\nFID.y1001             -1.6165253  0.0470799   -34.336  &lt; 2e-16 ***\nFID.y1002             -1.9307980  0.0474717   -40.673  &lt; 2e-16 ***\nFID.y1003             -1.2105232  0.0476080   -25.427  &lt; 2e-16 ***\nFID.y1005             -1.6826339  0.0490675   -34.292  &lt; 2e-16 ***\nFID.y1006             -1.7341409  0.0495756   -34.980  &lt; 2e-16 ***\nFID.y1014             -1.3339762  0.0502386   -26.553  &lt; 2e-16 ***\nFID.y1015             -0.9668557  0.0489102   -19.768  &lt; 2e-16 ***\nFID.y1016             -1.0073936  0.0474042   -21.251  &lt; 2e-16 ***\nFID.y1017             -0.2244152  0.0470294    -4.772 1.83e-06 ***\nFID.y1018              0.2355738  0.0470827     5.003 5.63e-07 ***\nFID.y1019             -0.1274935  0.0468157    -2.723 0.006463 ** \nFID.y1020              0.2352868  0.0468658     5.020 5.16e-07 ***\nFID.y1021             -1.4669420  0.0471346   -31.122  &lt; 2e-16 ***\nFID.y1022             -2.5454827  0.0476112   -53.464  &lt; 2e-16 ***\nFID.y1023             -3.5602426  0.0525293   -67.776  &lt; 2e-16 ***\nFID.y1024             -3.6953696  0.0502007   -73.612  &lt; 2e-16 ***\nFID.y1025             -2.9168832  0.0545876   -53.435  &lt; 2e-16 ***\nFID.y1026             -2.7617515  0.0514158   -53.714  &lt; 2e-16 ***\nFID.y1036             -1.2191162  0.0489107   -24.925  &lt; 2e-16 ***\nFID.y1037             -0.6160884  0.0471694   -13.061  &lt; 2e-16 ***\nFID.y1038             -2.1531276  0.0486144   -44.290  &lt; 2e-16 ***\nFID.y1039             -2.2338002  0.0545230   -40.970  &lt; 2e-16 ***\nFID.y1040             -1.1716666  0.0472593   -24.792  &lt; 2e-16 ***\nFID.y1041             -1.5200101  0.0473205   -32.122  &lt; 2e-16 ***\nFID.y1043             -1.3808364  0.0470956   -29.320  &lt; 2e-16 ***\nFID.y1044             -1.1223949  0.0471238   -23.818  &lt; 2e-16 ***\nFID.y1045             -3.1808223  0.0488284   -65.143  &lt; 2e-16 ***\nFID.y1046             -1.6361434  0.0476763   -34.318  &lt; 2e-16 ***\nFID.y1047             -2.4466955  0.0490485   -49.883  &lt; 2e-16 ***\nFID.y1048             -4.9268133  0.0640477   -76.924  &lt; 2e-16 ***\nFID.y1049             -1.1527443  0.0481497   -23.941  &lt; 2e-16 ***\nFID.y1058             -0.2393937  0.0480582    -4.981 6.31e-07 ***\nFID.y1059             -2.1190690  0.0480479   -44.103  &lt; 2e-16 ***\nFID.y1060             -1.4060303  0.0474335   -29.642  &lt; 2e-16 ***\nFID.y1061              0.3668836  0.0469113     7.821 5.25e-15 ***\nFID.y1062             -1.0647318  0.0470354   -22.637  &lt; 2e-16 ***\nFID.y1065             -1.6905578  0.0470690   -35.917  &lt; 2e-16 ***\nFID.y1066             -2.0710658  0.0473984   -43.695  &lt; 2e-16 ***\nFID.y1067             -2.9619457  0.0501223   -59.094  &lt; 2e-16 ***\nFID.y1068             -0.3480639  0.0470512    -7.398 1.39e-13 ***\nFID.y1069             -6.8585292  0.1394074   -49.198  &lt; 2e-16 ***\nFID.y1070             -2.4448019  0.0491241   -49.768  &lt; 2e-16 ***\nFID.y1079             -0.9275684  0.0476628   -19.461  &lt; 2e-16 ***\nFID.y1080             -0.9634771  0.0470838   -20.463  &lt; 2e-16 ***\nFID.y1081             -1.2081802  0.0472288   -25.581  &lt; 2e-16 ***\nFID.y1082             -1.3455565  0.0476360   -28.247  &lt; 2e-16 ***\nFID.y1083             -0.7618031  0.0470889   -16.178  &lt; 2e-16 ***\nFID.y1084             -2.3572115  0.0480005   -49.108  &lt; 2e-16 ***\nFID.y1086             -3.2966053  0.0494017   -66.731  &lt; 2e-16 ***\nFID.y1087             -1.7051810  0.0471079   -36.197  &lt; 2e-16 ***\nFID.y1090             -4.0512556  0.0783400   -51.714  &lt; 2e-16 ***\nFID.y1091              0.8629848  0.0468566    18.418  &lt; 2e-16 ***\nFID.y1092             -4.4326331  0.0608368   -72.861  &lt; 2e-16 ***\nFID.y110              -3.1143223  0.0992740   -31.371  &lt; 2e-16 ***\nFID.y1100             -1.8390357  0.0497212   -36.987  &lt; 2e-16 ***\nFID.y1101             -0.1197902  0.0469811    -2.550 0.010780 *  \nFID.y1102              1.0658459  0.0467694    22.789  &lt; 2e-16 ***\nFID.y1103             -0.6537822  0.0473356   -13.812  &lt; 2e-16 ***\nFID.y1104             -3.4997492  0.0545918   -64.108  &lt; 2e-16 ***\nFID.y1105             -2.8615480  0.0489598   -58.447  &lt; 2e-16 ***\nFID.y1106             -1.2683423  0.0473668   -26.777  &lt; 2e-16 ***\nFID.y1107             -1.0853154  0.0470977   -23.044  &lt; 2e-16 ***\nFID.y1108              0.3555406  0.0467818     7.600 2.96e-14 ***\nFID.y1109             -2.5172464  0.0479054   -52.546  &lt; 2e-16 ***\nFID.y111              -0.0699915  0.0494885    -1.414 0.157274    \nFID.y1111             -3.6771974  0.0676282   -54.374  &lt; 2e-16 ***\nFID.y1113             -3.5571542  0.0511924   -69.486  &lt; 2e-16 ***\nFID.y1114             -3.2811453  0.0503227   -65.202  &lt; 2e-16 ***\nFID.y112              -1.0807756  0.0549812   -19.657  &lt; 2e-16 ***\nFID.y1121             -1.3843625  0.0480994   -28.781  &lt; 2e-16 ***\nFID.y1122             -1.0354550  0.0475278   -21.786  &lt; 2e-16 ***\nFID.y1123             -1.1106109  0.0470338   -23.613  &lt; 2e-16 ***\nFID.y1124             -1.8557868  0.0482256   -38.481  &lt; 2e-16 ***\nFID.y1126             -3.2391010  0.0542305   -59.728  &lt; 2e-16 ***\nFID.y1128             -0.3591913  0.0469199    -7.655 1.93e-14 ***\nFID.y1129             -2.8842868  0.0493624   -58.431  &lt; 2e-16 ***\nFID.y113               1.0215065  0.0479921    21.285  &lt; 2e-16 ***\nFID.y1130             -3.0040283  0.0479854   -62.603  &lt; 2e-16 ***\nFID.y1133             -2.0535611  0.0548892   -37.413  &lt; 2e-16 ***\nFID.y1136             -0.0201584  0.0469973    -0.429 0.667976    \nFID.y114              -2.0196785  0.0552275   -36.570  &lt; 2e-16 ***\nFID.y1143             -0.3773317  0.0471217    -8.008 1.17e-15 ***\nFID.y1144             -0.4776980  0.0470348   -10.156  &lt; 2e-16 ***\nFID.y1145             -1.8358247  0.0476017   -38.566  &lt; 2e-16 ***\nFID.y1147             -1.2595276  0.0476186   -26.450  &lt; 2e-16 ***\nFID.y1148             -2.2143896  0.0480733   -46.063  &lt; 2e-16 ***\nFID.y1149             -2.3826618  0.0484483   -49.179  &lt; 2e-16 ***\nFID.y1151             -1.3659868  0.0470201   -29.051  &lt; 2e-16 ***\nFID.y1152             -1.6602911  0.0474893   -34.961  &lt; 2e-16 ***\nFID.y1154             -1.8381813  0.0526491   -34.914  &lt; 2e-16 ***\nFID.y1156             -1.9610470  0.0482362   -40.655  &lt; 2e-16 ***\nFID.y1157             -2.7656752  0.0479565   -57.671  &lt; 2e-16 ***\nFID.y1164             -0.4873888  0.0472617   -10.313  &lt; 2e-16 ***\nFID.y1165             -0.0574028  0.0470948    -1.219 0.222891    \nFID.y1166             -0.8416304  0.0471005   -17.869  &lt; 2e-16 ***\nFID.y1167             -1.3814863  0.0475033   -29.082  &lt; 2e-16 ***\nFID.y1169             -1.2265585  0.0472830   -25.941  &lt; 2e-16 ***\nFID.y1170             -3.2422126  0.0513561   -63.132  &lt; 2e-16 ***\nFID.y1171             -1.7389002  0.0485817   -35.793  &lt; 2e-16 ***\nFID.y1172             -2.8205270  0.0485450   -58.101  &lt; 2e-16 ***\nFID.y1173             -1.8723917  0.0473197   -39.569  &lt; 2e-16 ***\nFID.y1178              0.0601399  0.0468459     1.284 0.199219    \nFID.y1179             -1.2685560  0.0470239   -26.977  &lt; 2e-16 ***\nFID.y1186              0.7525545  0.0470865    15.982  &lt; 2e-16 ***\nFID.y1187             -1.0095035  0.0480495   -21.010  &lt; 2e-16 ***\nFID.y1188             -2.2195098  0.0513547   -43.219  &lt; 2e-16 ***\nFID.y1189              0.5951426  0.0468562    12.701  &lt; 2e-16 ***\nFID.y1190              0.0310927  0.0468766     0.663 0.507146    \nFID.y1191             -2.0566709  0.0483725   -42.517  &lt; 2e-16 ***\nFID.y1193             -2.0214896  0.0482483   -41.898  &lt; 2e-16 ***\nFID.y1194             -1.2279405  0.0470900   -26.076  &lt; 2e-16 ***\nFID.y1197             -1.5991054  0.0502570   -31.819  &lt; 2e-16 ***\nFID.y1199             -1.2583364  0.0473942   -26.550  &lt; 2e-16 ***\nFID.y1200             -1.5610839  0.0472409   -33.045  &lt; 2e-16 ***\nFID.y1207             -0.9829686  0.0477420   -20.589  &lt; 2e-16 ***\nFID.y1208              0.1148804  0.0471256     2.438 0.014779 *  \nFID.y1209              0.0253436  0.0469625     0.540 0.589435    \nFID.y1210             -1.8654510  0.0485801   -38.400  &lt; 2e-16 ***\nFID.y1211              0.3083466  0.0468968     6.575 4.87e-11 ***\nFID.y1212             -0.5111643  0.0470007   -10.876  &lt; 2e-16 ***\nFID.y1221             -1.7409171  0.0472230   -36.866  &lt; 2e-16 ***\nFID.y1222             -0.7871229  0.0470724   -16.722  &lt; 2e-16 ***\nFID.y1228              0.0405452  0.0470499     0.862 0.388826    \nFID.y1229             -0.2242246  0.0489243    -4.583 4.58e-06 ***\nFID.y1230             -0.6357545  0.0472110   -13.466  &lt; 2e-16 ***\nFID.y1231             -1.3494189  0.0488606   -27.618  &lt; 2e-16 ***\nFID.y1233             -0.5576244  0.0470311   -11.857  &lt; 2e-16 ***\nFID.y1240             -0.5345851  0.0479763   -11.143  &lt; 2e-16 ***\nFID.y1242             -2.5308539  0.0486703   -52.000  &lt; 2e-16 ***\nFID.y1243             -2.5108894  0.0478707   -52.451  &lt; 2e-16 ***\nFID.y1244             -4.8068086  0.0638667   -75.263  &lt; 2e-16 ***\nFID.y1249              0.3399569  0.0470474     7.226 4.98e-13 ***\nFID.y1250             -0.0498981  0.0473835    -1.053 0.292309    \nFID.y1251             -0.2364224  0.0471995    -5.009 5.47e-07 ***\nFID.y1252             -2.8071033  0.0508528   -55.201  &lt; 2e-16 ***\nFID.y1253             -2.2307030  0.0521778   -42.752  &lt; 2e-16 ***\nFID.y1262             -2.9145107  0.0665070   -43.823  &lt; 2e-16 ***\nFID.y1264             -2.6556726  0.0480454   -55.274  &lt; 2e-16 ***\nFID.y1265             -0.7348537  0.0470998   -15.602  &lt; 2e-16 ***\nFID.y1270             -3.0044823  0.0553948   -54.238  &lt; 2e-16 ***\nFID.y1271             -1.3220193  0.0499189   -26.483  &lt; 2e-16 ***\nFID.y1272              0.3534902  0.0469240     7.533 4.95e-14 ***\nFID.y1273             -1.0638765  0.0473213   -22.482  &lt; 2e-16 ***\nFID.y1274             -1.8082044  0.0483187   -37.422  &lt; 2e-16 ***\nFID.y1276             -1.6187662  0.0477831   -33.877  &lt; 2e-16 ***\nFID.y1285             -2.2606839  0.0482235   -46.879  &lt; 2e-16 ***\nFID.y1286              1.3822046  0.0467830    29.545  &lt; 2e-16 ***\nFID.y1287              0.0498175  0.0469801     1.060 0.288964    \nFID.y1292             -1.8548082  0.0540002   -34.348  &lt; 2e-16 ***\nFID.y1293              0.1430899  0.0470843     3.039 0.002374 ** \nFID.y1294             -1.3359658  0.0479902   -27.838  &lt; 2e-16 ***\nFID.y1295             -1.1114354  0.0477783   -23.262  &lt; 2e-16 ***\nFID.y1296             -2.9398586  0.0539689   -54.473  &lt; 2e-16 ***\nFID.y1297             -1.7608122  0.0479586   -36.715  &lt; 2e-16 ***\nFID.y1304              0.5685500  0.0475658    11.953  &lt; 2e-16 ***\nFID.y1305             -4.0407335  0.0968623   -41.716  &lt; 2e-16 ***\nFID.y1307             -0.9934818  0.0470006   -21.138  &lt; 2e-16 ***\nFID.y1308             -1.4923759  0.0472958   -31.554  &lt; 2e-16 ***\nFID.y1309              0.0879594  0.0470222     1.871 0.061402 .  \nFID.y1313             -0.5473702  0.0474833   -11.528  &lt; 2e-16 ***\nFID.y1314             -1.3786589  0.0496597   -27.762  &lt; 2e-16 ***\nFID.y1315             -0.2363131  0.0500092    -4.725 2.30e-06 ***\nFID.y1316              0.2593764  0.0468696     5.534 3.13e-08 ***\nFID.y1317             -3.0108423  0.0590326   -51.003  &lt; 2e-16 ***\nFID.y1318             -2.1280194  0.0498027   -42.729  &lt; 2e-16 ***\nFID.y132              -0.2791861  0.0519418    -5.375 7.66e-08 ***\nFID.y1328             -0.9076117  0.0471339   -19.256  &lt; 2e-16 ***\nFID.y1329             -1.6799788  0.0471423   -35.636  &lt; 2e-16 ***\nFID.y133               0.5718864  0.0482159    11.861  &lt; 2e-16 ***\nFID.y1330             -1.5553358  0.0478022   -32.537  &lt; 2e-16 ***\nFID.y1336             -0.6520751  0.0551456   -11.825  &lt; 2e-16 ***\nFID.y1337             -0.3620927  0.0471397    -7.681 1.58e-14 ***\nFID.y1338             -0.7209720  0.0472758   -15.250  &lt; 2e-16 ***\nFID.y134              -2.1029347  0.0765676   -27.465  &lt; 2e-16 ***\nFID.y1340             -0.9398435  0.0473097   -19.866  &lt; 2e-16 ***\nFID.y1348             -2.0042530  0.0551079   -36.370  &lt; 2e-16 ***\nFID.y135              -0.7784619  0.0541942   -14.364  &lt; 2e-16 ***\nFID.y1350             -2.5165645  0.0478588   -52.583  &lt; 2e-16 ***\nFID.y1351             -1.9602639  0.0475059   -41.264  &lt; 2e-16 ***\nFID.y1352             -0.1486440  0.0471436    -3.153 0.001616 ** \nFID.y1356              0.5689594  0.0469466    12.119  &lt; 2e-16 ***\nFID.y1358             -2.6198506  0.0495105   -52.915  &lt; 2e-16 ***\nFID.y1359             -2.1032367  0.0534647   -39.339  &lt; 2e-16 ***\nFID.y136              -0.8833516  0.0486038   -18.175  &lt; 2e-16 ***\nFID.y1371             -1.3715007  0.0475169   -28.863  &lt; 2e-16 ***\nFID.y1372              0.5642827  0.0468252    12.051  &lt; 2e-16 ***\nFID.y1373             -1.0651804  0.0471508   -22.591  &lt; 2e-16 ***\nFID.y1374             -0.4743276  0.0497837    -9.528  &lt; 2e-16 ***\nFID.y1377             -1.1719610  0.0478199   -24.508  &lt; 2e-16 ***\nFID.y1378             -0.9019913  0.0474374   -19.014  &lt; 2e-16 ***\nFID.y1379             -1.1624353  0.0474332   -24.507  &lt; 2e-16 ***\nFID.y1380              0.1411827  0.0468965     3.011 0.002608 ** \nFID.y1381             -1.8286411  0.0484180   -37.768  &lt; 2e-16 ***\nFID.y1383             -3.1030115  0.0568024   -54.628  &lt; 2e-16 ***\nFID.y1391             -2.3316880  0.0621148   -37.538  &lt; 2e-16 ***\nFID.y1393             -1.1504095  0.0471239   -24.412  &lt; 2e-16 ***\nFID.y1394             -2.0702845  0.0474735   -43.609  &lt; 2e-16 ***\nFID.y1395             -0.1940709  0.0472223    -4.110 3.96e-05 ***\nFID.y1396             -0.6934109  0.0501696   -13.821  &lt; 2e-16 ***\nFID.y1399              0.7491786  0.0468637    15.986  &lt; 2e-16 ***\nFID.y1400             -0.1242738  0.0469605    -2.646 0.008137 ** \nFID.y1401             -0.4861243  0.0471491   -10.310  &lt; 2e-16 ***\nFID.y1402             -1.8632428  0.0485062   -38.412  &lt; 2e-16 ***\nFID.y1403             -1.5478973  0.0480532   -32.212  &lt; 2e-16 ***\nFID.y1404              0.1900390  0.0469407     4.048 5.15e-05 ***\nFID.y1413             -3.2668591  0.1082174   -30.188  &lt; 2e-16 ***\nFID.y1415             -1.1485716  0.0471309   -24.370  &lt; 2e-16 ***\nFID.y1416             -0.8173565  0.0470818   -17.360  &lt; 2e-16 ***\nFID.y1417              0.2785197  0.0470311     5.922 3.18e-09 ***\nFID.y1418             -1.5954759  0.0548290   -29.099  &lt; 2e-16 ***\nFID.y1420             -1.2604461  0.0477167   -26.415  &lt; 2e-16 ***\nFID.y1421             -0.0778785  0.0472047    -1.650 0.098983 .  \nFID.y1422             -0.9378772  0.0473667   -19.800  &lt; 2e-16 ***\nFID.y1424             -2.0311853  0.0487397   -41.674  &lt; 2e-16 ***\nFID.y1433             -5.2978363  0.1668831   -31.746  &lt; 2e-16 ***\nFID.y1434             -1.5744498  0.0513936   -30.635  &lt; 2e-16 ***\nFID.y1437             -2.2715681  0.0478974   -47.426  &lt; 2e-16 ***\nFID.y1438             -1.4984887  0.0480305   -31.199  &lt; 2e-16 ***\nFID.y1439             -0.4933146  0.0474867   -10.388  &lt; 2e-16 ***\nFID.y1442             -0.9950021  0.0478871   -20.778  &lt; 2e-16 ***\nFID.y1443              0.2379400  0.0469377     5.069 3.99e-07 ***\nFID.y1444             -0.9887031  0.0483229   -20.460  &lt; 2e-16 ***\nFID.y1445             -1.4145544  0.0480966   -29.411  &lt; 2e-16 ***\nFID.y1446             -0.5241606  0.0472139   -11.102  &lt; 2e-16 ***\nFID.y1447             -0.7745449  0.0473048   -16.374  &lt; 2e-16 ***\nFID.y1459             -1.1196613  0.0471466   -23.749  &lt; 2e-16 ***\nFID.y1460             -1.5683839  0.0480245   -32.658  &lt; 2e-16 ***\nFID.y1463             -0.6041901  0.0472028   -12.800  &lt; 2e-16 ***\nFID.y1464             -1.0970727  0.0478684   -22.919  &lt; 2e-16 ***\nFID.y1465             -0.1541429  0.0470105    -3.279 0.001042 ** \nFID.y1468             -0.6364743  0.0471915   -13.487  &lt; 2e-16 ***\nFID.y1469             -2.1378469  0.0517138   -41.340  &lt; 2e-16 ***\nFID.y1476             -3.6218605  0.0680422   -53.230  &lt; 2e-16 ***\nFID.y1480             -1.9325633  0.0478785   -40.364  &lt; 2e-16 ***\nFID.y1481             -0.7187691  0.0471491   -15.245  &lt; 2e-16 ***\nFID.y1482              0.3374128  0.0469609     7.185 6.72e-13 ***\nFID.y1484             -1.5554687  0.0479384   -32.447  &lt; 2e-16 ***\nFID.y1485             -1.2700726  0.0476130   -26.675  &lt; 2e-16 ***\nFID.y1486             -0.0707943  0.0469543    -1.508 0.131624    \nFID.y1487             -0.7537641  0.0474644   -15.881  &lt; 2e-16 ***\nFID.y1488             -1.7395135  0.0488568   -35.604  &lt; 2e-16 ***\nFID.y1490             -1.5747923  0.0485607   -32.429  &lt; 2e-16 ***\nFID.y1497             -0.5356945  0.0474523   -11.289  &lt; 2e-16 ***\nFID.y1501             -1.9120538  0.0486475   -39.304  &lt; 2e-16 ***\nFID.y1502             -1.1962084  0.0472131   -25.336  &lt; 2e-16 ***\nFID.y1503             -2.2902569  0.0496775   -46.103  &lt; 2e-16 ***\nFID.y1506             -2.5317436  0.0557166   -45.440  &lt; 2e-16 ***\nFID.y1507              0.6389877  0.0468224    13.647  &lt; 2e-16 ***\nFID.y1508              0.1362231  0.0469391     2.902 0.003706 ** \nFID.y1509             -1.0272973  0.0484012   -21.225  &lt; 2e-16 ***\nFID.y1511             -1.6571189  0.0482083   -34.374  &lt; 2e-16 ***\nFID.y1512             -3.4493519  0.0741267   -46.533  &lt; 2e-16 ***\nFID.y1518             -5.7492107  0.1199534   -47.929  &lt; 2e-16 ***\nFID.y1519             -0.7767686  0.0473209   -16.415  &lt; 2e-16 ***\nFID.y152               1.6014083  0.0493332    32.461  &lt; 2e-16 ***\nFID.y1523             -1.1858649  0.0473304   -25.055  &lt; 2e-16 ***\nFID.y1524             -1.0939497  0.0472667   -23.144  &lt; 2e-16 ***\nFID.y1525             -1.1521418  0.0478443   -24.081  &lt; 2e-16 ***\nFID.y1526             -0.0428650  0.0492403    -0.871 0.384013    \nFID.y1527              0.8737768  0.0468472    18.652  &lt; 2e-16 ***\nFID.y1528             -0.3068994  0.0470880    -6.518 7.15e-11 ***\nFID.y1529             -0.5962535  0.0471007   -12.659  &lt; 2e-16 ***\nFID.y153              -1.5983365  0.0561547   -28.463  &lt; 2e-16 ***\nFID.y1531             -0.3538307  0.0471581    -7.503 6.23e-14 ***\nFID.y1534             -3.0579311  0.0596868   -51.233  &lt; 2e-16 ***\nFID.y1539             -5.0990881  0.1225170   -41.619  &lt; 2e-16 ***\nFID.y154              -0.5778024  0.0522210   -11.065  &lt; 2e-16 ***\nFID.y1541             -3.0363834  0.0517157   -58.713  &lt; 2e-16 ***\nFID.y1542             -3.4230673  0.0536799   -63.768  &lt; 2e-16 ***\nFID.y1545              0.4188586  0.0468540     8.940  &lt; 2e-16 ***\nFID.y1546             -1.9601955  0.0486365   -40.303  &lt; 2e-16 ***\nFID.y1549             -1.0487244  0.0474706   -22.092  &lt; 2e-16 ***\nFID.y155              -5.2563780  1.0026630    -5.242 1.58e-07 ***\nFID.y1550              0.0311318  0.0469108     0.664 0.506922    \nFID.y1551             -0.4156270  0.0470362    -8.836  &lt; 2e-16 ***\nFID.y1552             -1.2395950  0.0481601   -25.739  &lt; 2e-16 ***\nFID.y1553             -1.3786184  0.0499966   -27.574  &lt; 2e-16 ***\nFID.y1554              0.5003778  0.0468795    10.674  &lt; 2e-16 ***\nFID.y1556             -5.2538771  0.1595056   -32.939  &lt; 2e-16 ***\nFID.y156               0.4535295  0.0482838     9.393  &lt; 2e-16 ***\nFID.y1560              0.1660969  0.0470499     3.530 0.000415 ***\nFID.y1562             -2.2881513  0.0502833   -45.505  &lt; 2e-16 ***\nFID.y1563             -2.6785394  0.0492877   -54.345  &lt; 2e-16 ***\nFID.y1564             -2.6291415  0.0485236   -54.183  &lt; 2e-16 ***\nFID.y1565             -1.6761809  0.0474926   -35.294  &lt; 2e-16 ***\nFID.y1566             -1.5882985  0.0476134   -33.358  &lt; 2e-16 ***\nFID.y1567             -1.5002584  0.0483213   -31.048  &lt; 2e-16 ***\nFID.y157              -2.0902279  0.0552781   -37.813  &lt; 2e-16 ***\nFID.y1570             -3.0972205  0.0567699   -54.557  &lt; 2e-16 ***\nFID.y1571             -0.6300292  0.0472341   -13.338  &lt; 2e-16 ***\nFID.y1572              0.6870910  0.0468629    14.662  &lt; 2e-16 ***\nFID.y1573             -1.2392098  0.0475344   -26.070  &lt; 2e-16 ***\nFID.y1574              0.2508727  0.0469577     5.343 9.17e-08 ***\nFID.y1575             -0.9963462  0.0475996   -20.932  &lt; 2e-16 ***\nFID.y1576             -1.1897445  0.0487276   -24.416  &lt; 2e-16 ***\nFID.y1579             -1.7012877  0.0483201   -35.209  &lt; 2e-16 ***\nFID.y158              -1.4166222  0.0489034   -28.968  &lt; 2e-16 ***\nFID.y1580             -1.6905078  0.0484561   -34.887  &lt; 2e-16 ***\nFID.y1581             -2.0501055  0.0487806   -42.027  &lt; 2e-16 ***\nFID.y1583             -3.8246765  0.0728273   -52.517  &lt; 2e-16 ***\nFID.y1584             -3.5568325  0.0551648   -64.476  &lt; 2e-16 ***\nFID.y1586             -0.4357734  0.0469152    -9.289  &lt; 2e-16 ***\nFID.y1587             -2.0940738  0.0478058   -43.804  &lt; 2e-16 ***\nFID.y1588             -2.2843246  0.0481419   -47.450  &lt; 2e-16 ***\nFID.y1589             -2.7105990  0.0544273   -49.802  &lt; 2e-16 ***\nFID.y159              -1.2692528  0.0498908   -25.441  &lt; 2e-16 ***\nFID.y1592             -4.3674394  0.0927178   -47.105  &lt; 2e-16 ***\nFID.y1593             -1.6796750  0.0480713   -34.941  &lt; 2e-16 ***\nFID.y1594             -1.1284422  0.0476063   -23.704  &lt; 2e-16 ***\nFID.y1595             -0.7045196  0.0473437   -14.881  &lt; 2e-16 ***\nFID.y1596             -1.7707957  0.0492529   -35.953  &lt; 2e-16 ***\nFID.y1597             -3.1284084  0.0627108   -49.886  &lt; 2e-16 ***\nFID.y1599             -2.9271994  0.0672766   -43.510  &lt; 2e-16 ***\nFID.y1600             -1.1490638  0.0485803   -23.653  &lt; 2e-16 ***\nFID.y1601             -1.1026600  0.0474574   -23.235  &lt; 2e-16 ***\nFID.y1602             -1.6941881  0.0480844   -35.234  &lt; 2e-16 ***\nFID.y1606             -2.6964676  0.0482911   -55.838  &lt; 2e-16 ***\nFID.y1607             -2.2705188  0.0476169   -47.683  &lt; 2e-16 ***\nFID.y1608             -2.0106756  0.0476812   -42.169  &lt; 2e-16 ***\nFID.y1609             -0.0803355  0.0469690    -1.710 0.087193 .  \nFID.y1610             -2.4942978  0.0499339   -49.952  &lt; 2e-16 ***\nFID.y1614             -0.4848724  0.0470872   -10.297  &lt; 2e-16 ***\nFID.y1615             -0.3519579  0.0470526    -7.480 7.43e-14 ***\nFID.y1616             -0.8729139  0.0473873   -18.421  &lt; 2e-16 ***\nFID.y1617              0.7634573  0.0468266    16.304  &lt; 2e-16 ***\nFID.y1618              0.0112552  0.0472035     0.238 0.811539    \nFID.y1619             -0.6294673  0.0472278   -13.328  &lt; 2e-16 ***\nFID.y1620             -3.5956348  0.0639870   -56.193  &lt; 2e-16 ***\nFID.y1622             -0.5690222  0.0472903   -12.033  &lt; 2e-16 ***\nFID.y1623             -1.7425258  0.0481130   -36.217  &lt; 2e-16 ***\nFID.y1624             -2.0323999  0.0481406   -42.218  &lt; 2e-16 ***\nFID.y1625             -3.6340221  0.0776487   -46.801  &lt; 2e-16 ***\nFID.y1627             -5.1207262  0.1239017   -41.329  &lt; 2e-16 ***\nFID.y1628              0.7943801  0.0468059    16.972  &lt; 2e-16 ***\nFID.y1629              0.7138176  0.0468057    15.251  &lt; 2e-16 ***\nFID.y1630             -1.5568118  0.0472484   -32.950  &lt; 2e-16 ***\nFID.y1631             -1.8027312  0.0484411   -37.215  &lt; 2e-16 ***\nFID.y1632             -2.6051905  0.0582864   -44.696  &lt; 2e-16 ***\nFID.y1635             -1.4653677  0.0488458   -30.000  &lt; 2e-16 ***\nFID.y1637             -0.9388138  0.0474485   -19.786  &lt; 2e-16 ***\nFID.y1638              0.0039247  0.0469299     0.084 0.933351    \nFID.y1639             -0.2714768  0.0471059    -5.763 8.26e-09 ***\nFID.y1641             -1.2737665  0.0475920   -26.764  &lt; 2e-16 ***\nFID.y1642             -0.3789445  0.0470438    -8.055 7.94e-16 ***\nFID.y1643             -0.8272891  0.0472103   -17.523  &lt; 2e-16 ***\nFID.y1644             -0.7861139  0.0474326   -16.573  &lt; 2e-16 ***\nFID.y1645             -0.0494457  0.0469895    -1.052 0.292675    \nFID.y1646             -1.5885193  0.0476760   -33.319  &lt; 2e-16 ***\nFID.y1647             -1.7823138  0.0495099   -35.999  &lt; 2e-16 ***\nFID.y1649             -3.0966043  0.0494520   -62.618  &lt; 2e-16 ***\nFID.y1650             -1.0405579  0.0469309   -22.172  &lt; 2e-16 ***\nFID.y1651             -1.3884977  0.0470517   -29.510  &lt; 2e-16 ***\nFID.y1652             -3.1756344  0.0516231   -61.516  &lt; 2e-16 ***\nFID.y1653             -4.7125895  0.1062875   -44.338  &lt; 2e-16 ***\nFID.y1654             -2.1614297  0.0597051   -36.202  &lt; 2e-16 ***\nFID.y1657              0.0830960  0.0469566     1.770 0.076788 .  \nFID.y1658             -1.0673208  0.0486749   -21.928  &lt; 2e-16 ***\nFID.y1659             -1.0373032  0.0477010   -21.746  &lt; 2e-16 ***\nFID.y1661             -0.8892505  0.0473461   -18.782  &lt; 2e-16 ***\nFID.y1662             -1.3517051  0.0474427   -28.491  &lt; 2e-16 ***\nFID.y1663             -0.4249019  0.0470609    -9.029  &lt; 2e-16 ***\nFID.y1664             -0.7850977  0.0471612   -16.647  &lt; 2e-16 ***\nFID.y1665             -0.9984295  0.0473829   -21.072  &lt; 2e-16 ***\nFID.y1666             -1.1125599  0.0472406   -23.551  &lt; 2e-16 ***\nFID.y1667             -1.4894479  0.0474480   -31.391  &lt; 2e-16 ***\nFID.y1668             -1.9655426  0.0484135   -40.599  &lt; 2e-16 ***\nFID.y1671             -1.9850105  0.0473578   -41.915  &lt; 2e-16 ***\nFID.y1672             -2.9331553  0.0479082   -61.224  &lt; 2e-16 ***\nFID.y1673             -1.1809990  0.0472659   -24.986  &lt; 2e-16 ***\nFID.y1675             -2.5172951  0.0634745   -39.658  &lt; 2e-16 ***\nFID.y1678             -0.5274632  0.0473699   -11.135  &lt; 2e-16 ***\nFID.y1679              0.2011949  0.0469247     4.288 1.81e-05 ***\nFID.y1680             -0.3394679  0.0471398    -7.201 5.96e-13 ***\nFID.y1681             -0.8917045  0.0472364   -18.877  &lt; 2e-16 ***\nFID.y1682             -0.6249527  0.0478042   -13.073  &lt; 2e-16 ***\nFID.y1683              0.2268918  0.0469047     4.837 1.32e-06 ***\nFID.y1684             -0.7975249  0.0470736   -16.942  &lt; 2e-16 ***\nFID.y1685             -1.4670414  0.0477239   -30.740  &lt; 2e-16 ***\nFID.y1686             -2.4696333  0.0494976   -49.894  &lt; 2e-16 ***\nFID.y1687             -1.3048505  0.0472200   -27.633  &lt; 2e-16 ***\nFID.y1688             -2.4313532  0.0481751   -50.469  &lt; 2e-16 ***\nFID.y1689             -0.4784151  0.0469975   -10.180  &lt; 2e-16 ***\nFID.y1692             -3.7460009  0.0519973   -72.042  &lt; 2e-16 ***\nFID.y1693             -2.6254922  0.0476230   -55.131  &lt; 2e-16 ***\nFID.y1694             -1.0851122  0.0470482   -23.064  &lt; 2e-16 ***\nFID.y1700             -0.0391461  0.0469538    -0.834 0.404442    \nFID.y1701              0.0836094  0.0469280     1.782 0.074806 .  \nFID.y1702              0.1919118  0.0468907     4.093 4.26e-05 ***\nFID.y1703             -2.0685091  0.0528892   -39.110  &lt; 2e-16 ***\nFID.y1704             -0.8320788  0.0472145   -17.623  &lt; 2e-16 ***\nFID.y1705             -0.4784879  0.0469831   -10.184  &lt; 2e-16 ***\nFID.y1706             -1.0633793  0.0474036   -22.432  &lt; 2e-16 ***\nFID.y1707             -2.2758637  0.0482213   -47.196  &lt; 2e-16 ***\nFID.y1708             -0.8426352  0.0471782   -17.861  &lt; 2e-16 ***\nFID.y1709             -0.4292729  0.0469017    -9.153  &lt; 2e-16 ***\nFID.y1710             -0.2041726  0.0468963    -4.354 1.34e-05 ***\nFID.y1711             -0.1965192  0.0470047    -4.181 2.90e-05 ***\nFID.y1714             -1.6697793  0.0473095   -35.295  &lt; 2e-16 ***\nFID.y1715             -2.4492410  0.0475777   -51.479  &lt; 2e-16 ***\nFID.y1721             -4.2166391  0.1335328   -31.578  &lt; 2e-16 ***\nFID.y1722              0.7450114  0.0468957    15.887  &lt; 2e-16 ***\nFID.y1723             -0.0102195  0.0469455    -0.218 0.827672    \nFID.y1724             -0.6621849  0.0476078   -13.909  &lt; 2e-16 ***\nFID.y1725             -0.1413597  0.0470282    -3.006 0.002648 ** \nFID.y1726             -1.7383484  0.0490068   -35.472  &lt; 2e-16 ***\nFID.y1727              0.8708137  0.0467862    18.613  &lt; 2e-16 ***\nFID.y1728             -0.1724976  0.0469234    -3.676 0.000237 ***\nFID.y1729              0.8450021  0.0467972    18.057  &lt; 2e-16 ***\nFID.y1730             -1.8276510  0.0477993   -38.236  &lt; 2e-16 ***\nFID.y1731              0.3180585  0.0468172     6.794 1.09e-11 ***\nFID.y1732             -2.2457587  0.0486442   -46.167  &lt; 2e-16 ***\nFID.y1733              0.3310280  0.0469695     7.048 1.82e-12 ***\nFID.y1736             -1.9308226  0.0472442   -40.869  &lt; 2e-16 ***\nFID.y1737             -4.4485330  0.0564958   -78.741  &lt; 2e-16 ***\nFID.y174              -2.7683548  0.0685703   -40.373  &lt; 2e-16 ***\nFID.y1743              0.5668884  0.0469301    12.079  &lt; 2e-16 ***\nFID.y1744              0.3667022  0.0468885     7.821 5.25e-15 ***\nFID.y1745              0.2259499  0.0468654     4.821 1.43e-06 ***\nFID.y1746              0.1305478  0.0469189     2.782 0.005396 ** \nFID.y1747             -0.8180297  0.0473515   -17.276  &lt; 2e-16 ***\nFID.y1748             -1.1977918  0.0473803   -25.280  &lt; 2e-16 ***\nFID.y1749             -1.3522898  0.0471954   -28.653  &lt; 2e-16 ***\nFID.y175              -0.7779077  0.0546578   -14.232  &lt; 2e-16 ***\nFID.y1750             -1.9807569  0.0477510   -41.481  &lt; 2e-16 ***\nFID.y1751             -2.4179900  0.0482214   -50.143  &lt; 2e-16 ***\nFID.y1752              0.0659146  0.0468430     1.407 0.159387    \nFID.y1753             -0.7908154  0.0470776   -16.798  &lt; 2e-16 ***\nFID.y1757             -3.5606471  0.0808456   -44.043  &lt; 2e-16 ***\nFID.y1758             -2.5921629  0.0491990   -52.687  &lt; 2e-16 ***\nFID.y1765              0.3593601  0.0469108     7.660 1.85e-14 ***\nFID.y1766             -0.4359946  0.0470493    -9.267  &lt; 2e-16 ***\nFID.y1767              0.4839181  0.0468473    10.330  &lt; 2e-16 ***\nFID.y1768             -0.8556137  0.0473190   -18.082  &lt; 2e-16 ***\nFID.y1769             -0.4520441  0.0470863    -9.600  &lt; 2e-16 ***\nFID.y177              -0.8647317  0.0532424   -16.241  &lt; 2e-16 ***\nFID.y1770             -1.0333782  0.0470527   -21.962  &lt; 2e-16 ***\nFID.y1771             -0.4035381  0.0469086    -8.603  &lt; 2e-16 ***\nFID.y1772             -1.3157434  0.0476993   -27.584  &lt; 2e-16 ***\nFID.y1773             -0.6434854  0.0469611   -13.703  &lt; 2e-16 ***\nFID.y1774             -1.2030629  0.0471374   -25.522  &lt; 2e-16 ***\nFID.y1776             -1.5153038  0.0480810   -31.516  &lt; 2e-16 ***\nFID.y1779             -3.4021288  0.0496466   -68.527  &lt; 2e-16 ***\nFID.y178              -0.6847198  0.0494355   -13.851  &lt; 2e-16 ***\nFID.y1786             -1.8455797  0.0545702   -33.820  &lt; 2e-16 ***\nFID.y1788              0.2472124  0.0469207     5.269 1.37e-07 ***\nFID.y1789             -1.0432653  0.0473289   -22.043  &lt; 2e-16 ***\nFID.y179              -0.8298659  0.0478795   -17.332  &lt; 2e-16 ***\nFID.y1790             -1.6128893  0.0476291   -33.864  &lt; 2e-16 ***\nFID.y1791             -0.9466572  0.0470905   -20.103  &lt; 2e-16 ***\nFID.y1792              0.1075970  0.0469959     2.289 0.022051 *  \nFID.y1793             -1.6074232  0.0488099   -32.932  &lt; 2e-16 ***\nFID.y1794             -0.6070689  0.0469912   -12.919  &lt; 2e-16 ***\nFID.y1795             -0.6949703  0.0469938   -14.789  &lt; 2e-16 ***\nFID.y1796              0.4511476  0.0468616     9.627  &lt; 2e-16 ***\nFID.y180               0.1349544  0.0477845     2.824 0.004739 ** \nFID.y1801             -4.5342038  0.0740365   -61.243  &lt; 2e-16 ***\nFID.y1808             -0.7919971  0.0485664   -16.308  &lt; 2e-16 ***\nFID.y1809              0.0305202  0.0470696     0.648 0.516723    \nFID.y1810             -0.1293450  0.0469617    -2.754 0.005882 ** \nFID.y1811             -0.2650134  0.0469610    -5.643 1.67e-08 ***\nFID.y1812             -0.5577431  0.0470893   -11.844  &lt; 2e-16 ***\nFID.y1813             -1.1922898  0.0473922   -25.158  &lt; 2e-16 ***\nFID.y1814             -1.2822993  0.0472380   -27.146  &lt; 2e-16 ***\nFID.y1815             -1.7321907  0.0476043   -36.387  &lt; 2e-16 ***\nFID.y1816             -2.6946064  0.0624342   -43.159  &lt; 2e-16 ***\nFID.y1817             -1.9314790  0.0490678   -39.363  &lt; 2e-16 ***\nFID.y1819             -3.4033259  0.0539358   -63.100  &lt; 2e-16 ***\nFID.y1820             -2.0206096  0.0496584   -40.690  &lt; 2e-16 ***\nFID.y1821             -2.1316560  0.0501801   -42.480  &lt; 2e-16 ***\nFID.y1828             -0.7567958  0.0729636   -10.372  &lt; 2e-16 ***\nFID.y1829             -2.1854496  0.1124591   -19.433  &lt; 2e-16 ***\nFID.y1830             -1.5676436  0.0652861   -24.012  &lt; 2e-16 ***\nFID.y1832             -0.0247749  0.0469451    -0.528 0.597678    \nFID.y1833             -0.0836094  0.0468971    -1.783 0.074615 .  \nFID.y1834             -2.8389472  0.0510771   -55.582  &lt; 2e-16 ***\nFID.y1835             -1.2543145  0.0476225   -26.339  &lt; 2e-16 ***\nFID.y1836             -1.8610171  0.0491265   -37.882  &lt; 2e-16 ***\nFID.y1837             -1.7428698  0.0517816   -33.658  &lt; 2e-16 ***\nFID.y1838             -1.4612992  0.0474318   -30.808  &lt; 2e-16 ***\nFID.y1839             -0.7498932  0.0470649   -15.933  &lt; 2e-16 ***\nFID.y1840             -2.5560685  0.0494737   -51.665  &lt; 2e-16 ***\nFID.y1842             -3.1851601  0.0558091   -57.072  &lt; 2e-16 ***\nFID.y1843             -1.5246763  0.0481354   -31.675  &lt; 2e-16 ***\nFID.y1850             -1.3478827  0.0882042   -15.281  &lt; 2e-16 ***\nFID.y1851             -2.2029642  0.1247575   -17.658  &lt; 2e-16 ***\nFID.y1853             -0.8556300  0.0475674   -17.988  &lt; 2e-16 ***\nFID.y1854             -0.1402080  0.0469179    -2.988 0.002805 ** \nFID.y1855             -0.8235815  0.0470815   -17.493  &lt; 2e-16 ***\nFID.y1856             -0.6728372  0.0472595   -14.237  &lt; 2e-16 ***\nFID.y1857             -3.0351159  0.0516892   -58.719  &lt; 2e-16 ***\nFID.y1858             -1.6690701  0.0474729   -35.158  &lt; 2e-16 ***\nFID.y1859             -1.0916396  0.0473900   -23.035  &lt; 2e-16 ***\nFID.y1860             -0.4223802  0.0469986    -8.987  &lt; 2e-16 ***\nFID.y1863             -2.0164519  0.0486718   -41.430  &lt; 2e-16 ***\nFID.y1865             -2.5655513  0.0512557   -50.054  &lt; 2e-16 ***\nFID.y1874             -1.5431586  0.0506560   -30.463  &lt; 2e-16 ***\nFID.y1875             -1.8771643  0.0492237   -38.135  &lt; 2e-16 ***\nFID.y1876             -0.7002134  0.0472518   -14.819  &lt; 2e-16 ***\nFID.y1877              0.0627858  0.0468577     1.340 0.180270    \nFID.y1878             -0.5746584  0.0470530   -12.213  &lt; 2e-16 ***\nFID.y1879             -2.0772885  0.0495628   -41.912  &lt; 2e-16 ***\nFID.y1880             -2.5175610  0.0485524   -51.852  &lt; 2e-16 ***\nFID.y1881             -4.0076110  0.0823475   -48.667  &lt; 2e-16 ***\nFID.y1882             -0.3520663  0.0469362    -7.501 6.34e-14 ***\nFID.y1883             -1.4282177  0.0473423   -30.168  &lt; 2e-16 ***\nFID.y1885             -2.5458710  0.0493201   -51.619  &lt; 2e-16 ***\nFID.y1894             -2.7155533  0.1981659   -13.703  &lt; 2e-16 ***\nFID.y1897             -0.1280181  0.0469022    -2.729 0.006344 ** \nFID.y1898             -0.3284429  0.0470060    -6.987 2.80e-12 ***\nFID.y1899             -0.1292155  0.0469712    -2.751 0.005942 ** \nFID.y1900             -2.1501714  0.0481002   -44.702  &lt; 2e-16 ***\nFID.y1901              0.9749148  0.0467882    20.837  &lt; 2e-16 ***\nFID.y1902             -2.1415880  0.0477451   -44.855  &lt; 2e-16 ***\nFID.y1903              0.0893749  0.0468777     1.907 0.056579 .  \nFID.y1905             -1.7879793  0.0475483   -37.603  &lt; 2e-16 ***\nFID.y1906             -0.3971118  0.0469976    -8.450  &lt; 2e-16 ***\nFID.y1907             -1.8030426  0.0499283   -36.113  &lt; 2e-16 ***\nFID.y1917             -1.6024492  0.0501499   -31.953  &lt; 2e-16 ***\nFID.y1918             -2.9201569  0.0555607   -52.558  &lt; 2e-16 ***\nFID.y1919             -2.7551688  0.0555689   -49.581  &lt; 2e-16 ***\nFID.y1920              0.1112213  0.0469549     2.369 0.017852 *  \nFID.y1921             -1.8582655  0.0481263   -38.612  &lt; 2e-16 ***\nFID.y1922             -0.0601175  0.0468826    -1.282 0.199738    \nFID.y1923             -1.2028560  0.0471194   -25.528  &lt; 2e-16 ***\nFID.y1924             -1.1545471  0.0471013   -24.512  &lt; 2e-16 ***\nFID.y1925             -0.5400630  0.0469121   -11.512  &lt; 2e-16 ***\nFID.y1926             -1.7669689  0.0474556   -37.234  &lt; 2e-16 ***\nFID.y1927             -2.5688903  0.0482826   -53.205  &lt; 2e-16 ***\nFID.y1928             -3.7153791  0.0553832   -67.085  &lt; 2e-16 ***\nFID.y1939             -0.1366910  0.0481549    -2.839 0.004532 ** \nFID.y1940             -1.1082310  0.0471539   -23.502  &lt; 2e-16 ***\nFID.y1941             -0.7106445  0.0480175   -14.800  &lt; 2e-16 ***\nFID.y1942             -0.5966450  0.0471219   -12.662  &lt; 2e-16 ***\nFID.y1943             -0.4360103  0.0473361    -9.211  &lt; 2e-16 ***\nFID.y1944             -0.9411836  0.0470271   -20.014  &lt; 2e-16 ***\nFID.y1946             -1.0977601  0.0470167   -23.348  &lt; 2e-16 ***\nFID.y1947             -3.1781391  0.0489779   -64.889  &lt; 2e-16 ***\nFID.y1948             -1.6558980  0.0474369   -34.907  &lt; 2e-16 ***\nFID.y1960             -0.8987662  0.0483180   -18.601  &lt; 2e-16 ***\nFID.y1961             -1.0968484  0.0472951   -23.192  &lt; 2e-16 ***\nFID.y1962              0.0366332  0.0468947     0.781 0.434697    \nFID.y1963             -0.2114979  0.0469446    -4.505 6.63e-06 ***\nFID.y1964             -1.1756658  0.0493017   -23.846  &lt; 2e-16 ***\nFID.y1965             -1.9708402  0.0478179   -41.216  &lt; 2e-16 ***\nFID.y1966             -1.8861714  0.0479086   -39.370  &lt; 2e-16 ***\nFID.y1967             -1.7549523  0.0474394   -36.994  &lt; 2e-16 ***\nFID.y1968             -1.2592438  0.0470676   -26.754  &lt; 2e-16 ***\nFID.y197              -1.3053931  0.0646001   -20.207  &lt; 2e-16 ***\nFID.y1970             -2.7939631  0.0493575   -56.607  &lt; 2e-16 ***\nFID.y1982             -1.4884980  0.0478711   -31.094  &lt; 2e-16 ***\nFID.y1983             -1.3295044  0.0474411   -28.024  &lt; 2e-16 ***\nFID.y1984             -1.0081923  0.0472275   -21.348  &lt; 2e-16 ***\nFID.y1985             -0.5962817  0.0473159   -12.602  &lt; 2e-16 ***\nFID.y1986             -1.0360017  0.0472035   -21.948  &lt; 2e-16 ***\nFID.y1987             -0.9418158  0.0472479   -19.934  &lt; 2e-16 ***\nFID.y1988             -1.0291053  0.0473683   -21.726  &lt; 2e-16 ***\nFID.y1989             -0.8141199  0.0469544   -17.339  &lt; 2e-16 ***\nFID.y199              -0.0822580  0.0485163    -1.695 0.089986 .  \nFID.y1990             -1.5045837  0.0479007   -31.410  &lt; 2e-16 ***\nFID.y1991             -2.2907082  0.0502238   -45.610  &lt; 2e-16 ***\nFID.y200              -2.3213096  0.0535292   -43.365  &lt; 2e-16 ***\nFID.y2003             -1.2533025  0.0488192   -25.672  &lt; 2e-16 ***\nFID.y2004              0.0152277  0.0470161     0.324 0.746026    \nFID.y2005             -0.5555481  0.0470970   -11.796  &lt; 2e-16 ***\nFID.y2006             -0.9530347  0.0472443   -20.172  &lt; 2e-16 ***\nFID.y2007             -0.1567930  0.0469415    -3.340 0.000837 ***\nFID.y2009              0.2412227  0.0468805     5.145 2.67e-07 ***\nFID.y201              -2.0501163  0.0533597   -38.421  &lt; 2e-16 ***\nFID.y2010             -1.6864908  0.0472754   -35.674  &lt; 2e-16 ***\nFID.y2011             -0.8584192  0.0469733   -18.275  &lt; 2e-16 ***\nFID.y2012             -2.9382901  0.0492451   -59.667  &lt; 2e-16 ***\nFID.y2013             -3.0164233  0.0503836   -59.869  &lt; 2e-16 ***\nFID.y202              -4.3467317  0.0896020   -48.512  &lt; 2e-16 ***\nFID.y2025             -1.1038969  0.0479029   -23.044  &lt; 2e-16 ***\nFID.y2026             -1.4888995  0.0477575   -31.176  &lt; 2e-16 ***\nFID.y2027             -1.4445833  0.0473709   -30.495  &lt; 2e-16 ***\nFID.y2028             -0.0703595  0.0469039    -1.500 0.133594    \nFID.y2029             -3.0818800  0.0586274   -52.567  &lt; 2e-16 ***\nFID.y2030             -0.3607609  0.0469720    -7.680 1.59e-14 ***\nFID.y2031             -1.8050825  0.0474055   -38.078  &lt; 2e-16 ***\nFID.y2032             -0.0733012  0.0468365    -1.565 0.117573    \nFID.y2033             -2.4656283  0.0479554   -51.415  &lt; 2e-16 ***\nFID.y2034             -1.2664928  0.0471259   -26.875  &lt; 2e-16 ***\nFID.y2035             -3.0236057  0.0535715   -56.441  &lt; 2e-16 ***\nFID.y2047             -2.1313292  0.0489684   -43.525  &lt; 2e-16 ***\nFID.y2048              0.2866288  0.0468398     6.119 9.40e-10 ***\nFID.y2049              0.0181874  0.0468868     0.388 0.698089    \nFID.y2050             -0.7537878  0.0486941   -15.480  &lt; 2e-16 ***\nFID.y2051             -1.5736980  0.0478032   -32.920  &lt; 2e-16 ***\nFID.y2052             -0.7893604  0.0470425   -16.780  &lt; 2e-16 ***\nFID.y2053             -0.0355890  0.0468328    -0.760 0.447305    \nFID.y2054             -1.8968503  0.0473131   -40.091  &lt; 2e-16 ***\nFID.y2055             -2.0889793  0.0473495   -44.118  &lt; 2e-16 ***\nFID.y2056             -1.9194617  0.0475907   -40.333  &lt; 2e-16 ***\nFID.y2068             -0.9584362  0.0473427   -20.245  &lt; 2e-16 ***\nFID.y2069             -1.5135198  0.0475609   -31.823  &lt; 2e-16 ***\nFID.y2071              0.6489197  0.0471835    13.753  &lt; 2e-16 ***\nFID.y2072             -1.4691563  0.0478630   -30.695  &lt; 2e-16 ***\nFID.y2074             -0.6218241  0.0469705   -13.239  &lt; 2e-16 ***\nFID.y2075             -1.2311388  0.0470184   -26.184  &lt; 2e-16 ***\nFID.y2076             -0.1773157  0.0468446    -3.785 0.000154 ***\nFID.y2077              0.3509527  0.0468031     7.498 6.46e-14 ***\nFID.y2078             -1.4837549  0.0472634   -31.393  &lt; 2e-16 ***\nFID.y2090             -1.1780059  0.0474947   -24.803  &lt; 2e-16 ***\nFID.y2091              0.0421714  0.0468823     0.900 0.368378    \nFID.y2092             -0.1980059  0.0470188    -4.211 2.54e-05 ***\nFID.y2093              0.1336615  0.0469443     2.847 0.004410 ** \nFID.y2094              0.2785981  0.0481248     5.789 7.08e-09 ***\nFID.y2096             -2.6591807  0.0490567   -54.206  &lt; 2e-16 ***\nFID.y2097             -2.1655270  0.0474069   -45.680  &lt; 2e-16 ***\nFID.y2098             -1.3850576  0.0470258   -29.453  &lt; 2e-16 ***\nFID.y2099             -3.3757368  0.0495818   -68.084  &lt; 2e-16 ***\nFID.y2100             -1.8096462  0.0475139   -38.087  &lt; 2e-16 ***\nFID.y2111             -0.5724381  0.0471555   -12.139  &lt; 2e-16 ***\nFID.y2112             -0.9721876  0.0478611   -20.313  &lt; 2e-16 ***\nFID.y2113             -0.5921974  0.0471036   -12.572  &lt; 2e-16 ***\nFID.y2114             -0.0811672  0.0469086    -1.730 0.083572 .  \nFID.y2115              0.6728143  0.0474757    14.172  &lt; 2e-16 ***\nFID.y2116              1.5617444  0.0472942    33.022  &lt; 2e-16 ***\nFID.y2117             -2.9181489  0.0524670   -55.619  &lt; 2e-16 ***\nFID.y2118             -1.2892028  0.0471481   -27.344  &lt; 2e-16 ***\nFID.y2119             -1.9106557  0.0472951   -40.399  &lt; 2e-16 ***\nFID.y2120             -1.0395904  0.0469322   -22.151  &lt; 2e-16 ***\nFID.y2121              0.2855363  0.0468174     6.099 1.07e-09 ***\nFID.y2122             -2.8793519  0.0517904   -55.596  &lt; 2e-16 ***\nFID.y2133             -0.3291460  0.0470931    -6.989 2.76e-12 ***\nFID.y2134             -0.5990218  0.0469869   -12.749  &lt; 2e-16 ***\nFID.y2135             -0.3508241  0.0469648    -7.470 8.02e-14 ***\nFID.y2136             -1.2444122  0.0487032   -25.551  &lt; 2e-16 ***\nFID.y2140             -2.3294389  0.0481114   -48.418  &lt; 2e-16 ***\nFID.y2141             -1.8465522  0.0471830   -39.136  &lt; 2e-16 ***\nFID.y2142             -2.7462680  0.0479530   -57.270  &lt; 2e-16 ***\nFID.y2143             -2.3041258  0.0480900   -47.913  &lt; 2e-16 ***\nFID.y2144             -1.3260293  0.0501960   -26.417  &lt; 2e-16 ***\nFID.y2154              0.3363683  0.0469147     7.170 7.51e-13 ***\nFID.y2155             -1.7092803  0.0479434   -35.652  &lt; 2e-16 ***\nFID.y2156             -0.1606043  0.0469195    -3.423 0.000619 ***\nFID.y2157             -0.1928683  0.0469316    -4.110 3.96e-05 ***\nFID.y2160             -1.1722188  0.0485870   -24.126  &lt; 2e-16 ***\nFID.y2162             -3.7347900  0.0552678   -67.576  &lt; 2e-16 ***\nFID.y2163              0.0982221  0.0468380     2.097 0.035988 *  \nFID.y2164             -1.9250368  0.0473205   -40.681  &lt; 2e-16 ***\nFID.y2176             -0.8526257  0.0471071   -18.100  &lt; 2e-16 ***\nFID.y2177             -1.7711600  0.0478162   -37.041  &lt; 2e-16 ***\nFID.y2178             -3.3112462  0.0650948   -50.868  &lt; 2e-16 ***\nFID.y2179             -0.0409446  0.0469770    -0.872 0.383433    \nFID.y2182              0.1451388  0.0474946     3.056 0.002244 ** \nFID.y2184             -2.5234361  0.0478994   -52.682  &lt; 2e-16 ***\nFID.y2185             -1.9758950  0.0472713   -41.799  &lt; 2e-16 ***\nFID.y2187             -2.3354877  0.0515076   -45.343  &lt; 2e-16 ***\nFID.y2197             -1.6667841  0.0482443   -34.549  &lt; 2e-16 ***\nFID.y2198             -1.9547524  0.0484051   -40.383  &lt; 2e-16 ***\nFID.y2199             -0.3981695  0.0469984    -8.472  &lt; 2e-16 ***\nFID.y220              -5.0605204  0.7093030    -7.134 9.71e-13 ***\nFID.y2200             -0.6551643  0.0471966   -13.882  &lt; 2e-16 ***\nFID.y2201             -1.7041769  0.0496178   -34.346  &lt; 2e-16 ***\nFID.y2204             -0.8230478  0.0488008   -16.865  &lt; 2e-16 ***\nFID.y2206             -2.1364076  0.0474818   -44.994  &lt; 2e-16 ***\nFID.y2207             -1.9642012  0.0479062   -41.001  &lt; 2e-16 ***\nFID.y221              -0.9411797  0.0481398   -19.551  &lt; 2e-16 ***\nFID.y2219             -0.4687381  0.0470424    -9.964  &lt; 2e-16 ***\nFID.y222              -0.9717784  0.0479145   -20.282  &lt; 2e-16 ***\nFID.y2220             -2.4939545  0.0495341   -50.348  &lt; 2e-16 ***\nFID.y2221             -1.9606294  0.0529306   -37.042  &lt; 2e-16 ***\nFID.y2222              0.0282528  0.0469006     0.602 0.546910    \nFID.y2226             -4.4595421  0.1363084   -32.717  &lt; 2e-16 ***\nFID.y2228             -2.5763413  0.0479541   -53.725  &lt; 2e-16 ***\nFID.y223              -3.9362555  0.1828375   -21.529  &lt; 2e-16 ***\nFID.y2241             -1.7007262  0.0479521   -35.467  &lt; 2e-16 ***\nFID.y2242             -1.2402987  0.0472896   -26.228  &lt; 2e-16 ***\nFID.y2243             -2.0811732  0.0481525   -43.220  &lt; 2e-16 ***\nFID.y2244             -2.3575290  0.0524478   -44.950  &lt; 2e-16 ***\nFID.y2247             -3.7924023  0.0807372   -46.972  &lt; 2e-16 ***\nFID.y2249             -2.8298290  0.0486220   -58.201  &lt; 2e-16 ***\nFID.y2250             -2.9863324  0.0522802   -57.122  &lt; 2e-16 ***\nFID.y2262             -1.6234228  0.0479719   -33.841  &lt; 2e-16 ***\nFID.y2263             -1.6519761  0.0482782   -34.218  &lt; 2e-16 ***\nFID.y2264             -0.5750702  0.0473670   -12.141  &lt; 2e-16 ***\nFID.y2265             -0.9225628  0.0472704   -19.517  &lt; 2e-16 ***\nFID.y2268             -3.0798578  0.0700715   -43.953  &lt; 2e-16 ***\nFID.y2269              0.0733929  0.0476602     1.540 0.123580    \nFID.y2271             -2.5021432  0.0515963   -48.495  &lt; 2e-16 ***\nFID.y2284             -0.9956534  0.0472634   -21.066  &lt; 2e-16 ***\nFID.y2285             -0.1730585  0.0469267    -3.688 0.000226 ***\nFID.y2286             -1.2234014  0.0474584   -25.778  &lt; 2e-16 ***\nFID.y2288             -3.6800645  0.1334759   -27.571  &lt; 2e-16 ***\nFID.y2290             -0.3249358  0.0479334    -6.779 1.21e-11 ***\nFID.y2305             -0.9649002  0.0479526   -20.122  &lt; 2e-16 ***\nFID.y2306             -3.1379732  0.0655834   -47.847  &lt; 2e-16 ***\nFID.y2307             -2.1621685  0.0477795   -45.253  &lt; 2e-16 ***\nFID.y2308             -1.4330985  0.0477737   -29.998  &lt; 2e-16 ***\nFID.y2309             -0.9636996  0.0473402   -20.357  &lt; 2e-16 ***\nFID.y2310             -3.5721374  0.0572493   -62.396  &lt; 2e-16 ***\nFID.y2311             -1.8356415  0.0508852   -36.074  &lt; 2e-16 ***\nFID.y2327             -1.1934435  0.0474252   -25.165  &lt; 2e-16 ***\nFID.y2328              1.1817353  0.0467844    25.259  &lt; 2e-16 ***\nFID.y2329             -1.4048266  0.0474666   -29.596  &lt; 2e-16 ***\nFID.y2331             -0.7882826  0.0472305   -16.690  &lt; 2e-16 ***\nFID.y2332             -1.6257495  0.0476639   -34.109  &lt; 2e-16 ***\nFID.y2333              0.4095496  0.0469010     8.732  &lt; 2e-16 ***\nFID.y2349             -0.8201659  0.0471218   -17.405  &lt; 2e-16 ***\nFID.y2350             -1.2487387  0.0471226   -26.500  &lt; 2e-16 ***\nFID.y2351             -0.1178938  0.0469211    -2.513 0.011985 *  \nFID.y2352              0.0674618  0.0468951     1.439 0.150273    \nFID.y2353             -1.1409012  0.0472786   -24.131  &lt; 2e-16 ***\nFID.y2354             -1.8511548  0.0478411   -38.694  &lt; 2e-16 ***\nFID.y2355             -0.5262384  0.0470509   -11.184  &lt; 2e-16 ***\nFID.y2370             -1.7495979  0.0480123   -36.441  &lt; 2e-16 ***\nFID.y2371             -0.7052455  0.0470111   -15.002  &lt; 2e-16 ***\nFID.y2372             -0.4567318  0.0469444    -9.729  &lt; 2e-16 ***\nFID.y2373             -2.0003509  0.0477733   -41.872  &lt; 2e-16 ***\nFID.y2374             -1.4923762  0.0475049   -31.415  &lt; 2e-16 ***\nFID.y2375             -1.0141972  0.0472633   -21.458  &lt; 2e-16 ***\nFID.y2376             -4.1627586  0.0659437   -63.126  &lt; 2e-16 ***\nFID.y2377             -1.0716760  0.0475915   -22.518  &lt; 2e-16 ***\nFID.y2392             -1.8718078  0.0479176   -39.063  &lt; 2e-16 ***\nFID.y2393             -1.8747100  0.0476544   -39.340  &lt; 2e-16 ***\nFID.y2395             -0.1150087  0.0469345    -2.450 0.014270 *  \nFID.y2396             -1.2161390  0.0471927   -25.770  &lt; 2e-16 ***\nFID.y2397             -2.7191403  0.0495688   -54.856  &lt; 2e-16 ***\nFID.y2398             -0.1361499  0.0469659    -2.899 0.003745 ** \nFID.y2414             -1.4462001  0.0474616   -30.471  &lt; 2e-16 ***\nFID.y2415             -0.7824376  0.0474826   -16.478  &lt; 2e-16 ***\nFID.y2416             -0.0049267  0.0471057    -0.105 0.916703    \nFID.y2417             -0.4273572  0.0469141    -9.109  &lt; 2e-16 ***\nFID.y2418             -2.0626472  0.0479744   -42.995  &lt; 2e-16 ***\nFID.y2419             -1.9062328  0.0477303   -39.938  &lt; 2e-16 ***\nFID.y242              -2.9577128  0.0630478   -46.912  &lt; 2e-16 ***\nFID.y2420             -2.3514210  0.0495165   -47.488  &lt; 2e-16 ***\nFID.y243              -0.7906982  0.0475454   -16.630  &lt; 2e-16 ***\nFID.y2435             -1.3314348  0.0475771   -27.985  &lt; 2e-16 ***\nFID.y2436              0.4855095  0.0468604    10.361  &lt; 2e-16 ***\nFID.y2437             -0.4534649  0.0472565    -9.596  &lt; 2e-16 ***\nFID.y2438             -0.5687336  0.0469744   -12.107  &lt; 2e-16 ***\nFID.y2439              1.5157757  0.0467778    32.404  &lt; 2e-16 ***\nFID.y244              -1.8727808  0.0526781   -35.551  &lt; 2e-16 ***\nFID.y2440             -2.0536377  0.0495443   -41.451  &lt; 2e-16 ***\nFID.y2441             -1.5442655  0.0475902   -32.449  &lt; 2e-16 ***\nFID.y2457             -3.5711944  0.0641731   -55.649  &lt; 2e-16 ***\nFID.y2458             -1.1210453  0.0475314   -23.585  &lt; 2e-16 ***\nFID.y2459              0.1943503  0.0470076     4.134 3.56e-05 ***\nFID.y2460             -0.8554299  0.0470627   -18.176  &lt; 2e-16 ***\nFID.y2462              1.1228210  0.0467995    23.992  &lt; 2e-16 ***\nFID.y2463             -2.7198788  0.0550252   -49.430  &lt; 2e-16 ***\nFID.y2478             -0.7716855  0.0472997   -16.315  &lt; 2e-16 ***\nFID.y2479             -1.0003433  0.0473088   -21.145  &lt; 2e-16 ***\nFID.y2480             -0.2686844  0.0470097    -5.716 1.09e-08 ***\nFID.y2481             -1.9067223  0.0477246   -39.953  &lt; 2e-16 ***\nFID.y2482             -1.2507701  0.0471620   -26.521  &lt; 2e-16 ***\nFID.y2483             -2.1120699  0.0481987   -43.820  &lt; 2e-16 ***\nFID.y2499             -0.5281958  0.0888966    -5.942 2.82e-09 ***\nFID.y2500             -1.3653739  0.0483673   -28.229  &lt; 2e-16 ***\nFID.y2501              0.4637823  0.0469202     9.884  &lt; 2e-16 ***\nFID.y2502              0.2452606  0.0469556     5.223 1.76e-07 ***\nFID.y2503             -0.5570666  0.0469708   -11.860  &lt; 2e-16 ***\nFID.y2504             -1.0910951  0.0474241   -23.007  &lt; 2e-16 ***\nFID.y2505             -0.6008954  0.0470330   -12.776  &lt; 2e-16 ***\nFID.y2521             -2.6282523  0.0571554   -45.984  &lt; 2e-16 ***\nFID.y2523             -2.0985477  0.0490147   -42.815  &lt; 2e-16 ***\nFID.y2524             -1.2171370  0.0475031   -25.622  &lt; 2e-16 ***\nFID.y2525              0.4775444  0.0468335    10.197  &lt; 2e-16 ***\nFID.y2526             -0.5317105  0.0470475   -11.302  &lt; 2e-16 ***\nFID.y2527             -1.6611117  0.0493779   -33.641  &lt; 2e-16 ***\nFID.y2544             -1.2422379  0.0479423   -25.911  &lt; 2e-16 ***\nFID.y2545             -0.5276008  0.0471532   -11.189  &lt; 2e-16 ***\nFID.y2546             -0.9648062  0.0473918   -20.358  &lt; 2e-16 ***\nFID.y2547             -2.5083755  0.0483281   -51.903  &lt; 2e-16 ***\nFID.y2548             -1.2498258  0.0474899   -26.318  &lt; 2e-16 ***\nFID.y2565             -1.0406874  0.0520602   -19.990  &lt; 2e-16 ***\nFID.y2566             -0.7941660  0.0474379   -16.741  &lt; 2e-16 ***\nFID.y2567             -0.8493195  0.0476657   -17.818  &lt; 2e-16 ***\nFID.y2568             -1.3207933  0.0473497   -27.894  &lt; 2e-16 ***\nFID.y2569             -1.0355753  0.0471842   -21.947  &lt; 2e-16 ***\nFID.y2570             -1.5145129  0.0491759   -30.798  &lt; 2e-16 ***\nFID.y2587              0.4277373  0.0472935     9.044  &lt; 2e-16 ***\nFID.y2588             -2.7992586  0.0524418   -53.378  &lt; 2e-16 ***\nFID.y2589             -0.5740227  0.0471515   -12.174  &lt; 2e-16 ***\nFID.y2590             -1.0359077  0.0472622   -21.918  &lt; 2e-16 ***\nFID.y2591             -1.2495699  0.0476504   -26.224  &lt; 2e-16 ***\nFID.y2608              0.3561930  0.0486675     7.319 2.50e-13 ***\nFID.y2609              0.3388086  0.0472081     7.177 7.13e-13 ***\nFID.y2610              1.2518662  0.0472740    26.481  &lt; 2e-16 ***\nFID.y2611             -0.4365680  0.0473116    -9.228  &lt; 2e-16 ***\nFID.y2612             -1.0837455  0.0474724   -22.829  &lt; 2e-16 ***\nFID.y2630             -0.8177558  0.0505774   -16.168  &lt; 2e-16 ***\nFID.y2632              0.2807881  0.0474130     5.922 3.18e-09 ***\nFID.y2633             -1.9393506  0.0489231   -39.641  &lt; 2e-16 ***\nFID.y2634              0.2941569  0.0470061     6.258 3.90e-10 ***\nFID.y2635              0.6860003  0.0476478    14.397  &lt; 2e-16 ***\nFID.y264              -0.9172318  0.0485771   -18.882  &lt; 2e-16 ***\nFID.y265              -0.6939449  0.0482766   -14.374  &lt; 2e-16 ***\nFID.y2653             -0.3137951  0.0496317    -6.322 2.57e-10 ***\nFID.y2654             -1.9311808  0.0528487   -36.542  &lt; 2e-16 ***\nFID.y2655             -3.3320423  0.0657125   -50.706  &lt; 2e-16 ***\nFID.y2656              0.2802182  0.0479226     5.847 5.00e-09 ***\nFID.y2676             -2.3915364  0.0534496   -44.744  &lt; 2e-16 ***\nFID.y2677             -1.3081217  0.0495769   -26.386  &lt; 2e-16 ***\nFID.y2678             -1.4173678  0.0491743   -28.823  &lt; 2e-16 ***\nFID.y2695             -1.4099324  0.0500494   -28.171  &lt; 2e-16 ***\nFID.y2698             -0.9737190  0.0493379   -19.736  &lt; 2e-16 ***\nFID.y2699             -0.5844210  0.0475397   -12.293  &lt; 2e-16 ***\nFID.y2700             -0.5179926  0.0476996   -10.859  &lt; 2e-16 ***\nFID.y2717              0.4624467  0.0471151     9.815  &lt; 2e-16 ***\nFID.y2720             -1.1080830  0.0512134   -21.637  &lt; 2e-16 ***\nFID.y2722             -0.9003391  0.0521641   -17.260  &lt; 2e-16 ***\nFID.y2739             -1.1075887  0.0483509   -22.907  &lt; 2e-16 ***\nFID.y2740              0.7068210  0.0470153    15.034  &lt; 2e-16 ***\nFID.y2743             -0.2349028  0.0475679    -4.938 7.88e-07 ***\nFID.y2761             -0.3211823  0.0475377    -6.756 1.41e-11 ***\nFID.y2762              0.9704382  0.0469864    20.654  &lt; 2e-16 ***\nFID.y2779              0.1977249  0.0507440     3.897 9.76e-05 ***\nFID.y2786             -0.9940881  0.0490555   -20.265  &lt; 2e-16 ***\nFID.y2800             -1.2859323  0.0547377   -23.493  &lt; 2e-16 ***\nFID.y2806              0.1829027  0.0475479     3.847 0.000120 ***\nFID.y2828              1.3870312  0.0470046    29.508  &lt; 2e-16 ***\nFID.y2829             -0.1882695  0.0481257    -3.912 9.15e-05 ***\nFID.y284              -0.4935802  0.0542267    -9.102  &lt; 2e-16 ***\nFID.y2849             -0.1125901  0.0503916    -2.234 0.025463 *  \nFID.y285              -2.3587918  0.0539216   -43.745  &lt; 2e-16 ***\nFID.y2850              1.0712705  0.0471711    22.710  &lt; 2e-16 ***\nFID.y286              -0.7611040  0.0476223   -15.982  &lt; 2e-16 ***\nFID.y287              -1.7496229  0.0670100   -26.110  &lt; 2e-16 ***\nFID.y2871              0.7735793  0.0485814    15.923  &lt; 2e-16 ***\nFID.y2892              0.3512658  0.0538030     6.529 6.63e-11 ***\nFID.y2951              0.6486405  0.0506788    12.799  &lt; 2e-16 ***\nFID.y305               0.4625630  0.0497415     9.299  &lt; 2e-16 ***\nFID.y306              -0.4592080  0.0490426    -9.363  &lt; 2e-16 ***\nFID.y307              -3.0871689  0.0567992   -54.352  &lt; 2e-16 ***\nFID.y327               0.2075306  0.0496647     4.179 2.93e-05 ***\nFID.y328              -1.6439355  0.0493064   -33.341  &lt; 2e-16 ***\nFID.y329              -1.1594414  0.0486680   -23.823  &lt; 2e-16 ***\nFID.y348              -2.0181603  0.0731860   -27.576  &lt; 2e-16 ***\nFID.y349              -0.3567067  0.0483492    -7.378 1.61e-13 ***\nFID.y350              -1.9757786  0.0550280   -35.905  &lt; 2e-16 ***\nFID.y369               0.4996988  0.0496060    10.073  &lt; 2e-16 ***\nFID.y370               0.2465707  0.0486291     5.070 3.97e-07 ***\nFID.y371              -1.2627338  0.0511627   -24.681  &lt; 2e-16 ***\nFID.y372              -5.3103025  0.1516754   -35.011  &lt; 2e-16 ***\nFID.y391               0.7023392  0.0486026    14.451  &lt; 2e-16 ***\nFID.y392              -0.9827371  0.0512919   -19.160  &lt; 2e-16 ***\nFID.y393               0.4386351  0.0471616     9.301  &lt; 2e-16 ***\nFID.y412               0.8353802  0.0487765    17.127  &lt; 2e-16 ***\nFID.y413              -0.3005162  0.0490583    -6.126 9.03e-10 ***\nFID.y414              -0.9529186  0.0493786   -19.298  &lt; 2e-16 ***\nFID.y415              -0.8390483  0.0475469   -17.647  &lt; 2e-16 ***\nFID.y435              -0.6055705  0.0494583   -12.244  &lt; 2e-16 ***\nFID.y436              -0.9492333  0.0474626   -20.000  &lt; 2e-16 ***\nFID.y437              -1.7126591  0.0489394   -34.996  &lt; 2e-16 ***\nFID.y44               -0.1294835  0.0650844    -1.989 0.046649 *  \nFID.y456               0.3759596  0.0478777     7.853 4.08e-15 ***\nFID.y457              -3.6359674  0.0715245   -50.835  &lt; 2e-16 ***\nFID.y458               0.2741264  0.0469124     5.843 5.12e-09 ***\nFID.y46               -0.1051436  0.0545921    -1.926 0.054106 .  \nFID.y460              -0.5545356  0.0478846   -11.581  &lt; 2e-16 ***\nFID.y477               0.2121573  0.0495280     4.284 1.84e-05 ***\nFID.y478               0.4312717  0.0477582     9.030  &lt; 2e-16 ***\nFID.y479              -1.7421307  0.0482241   -36.126  &lt; 2e-16 ***\nFID.y480              -5.1844606  0.0956281   -54.215  &lt; 2e-16 ***\nFID.y481              -0.1619218  0.0474726    -3.411 0.000648 ***\nFID.y482              -1.3984499  0.0515417   -27.132  &lt; 2e-16 ***\nFID.y499              -1.0284727  0.0539720   -19.056  &lt; 2e-16 ***\nFID.y500              -0.8518109  0.0492722   -17.288  &lt; 2e-16 ***\nFID.y501              -2.3778691  0.0484587   -49.070  &lt; 2e-16 ***\nFID.y502              -3.2678880  0.0588319   -55.546  &lt; 2e-16 ***\nFID.y503               0.6231760  0.0469627    13.270  &lt; 2e-16 ***\nFID.y520              -0.4438231  0.0516237    -8.597  &lt; 2e-16 ***\nFID.y521              -1.1041778  0.0496966   -22.218  &lt; 2e-16 ***\nFID.y522              -0.8717509  0.0475411   -18.337  &lt; 2e-16 ***\nFID.y523              -2.0429815  0.0533762   -38.275  &lt; 2e-16 ***\nFID.y524              -1.5446681  0.0475132   -32.510  &lt; 2e-16 ***\nFID.y525              -1.3214114  0.0483998   -27.302  &lt; 2e-16 ***\nFID.y542              -2.8692211  0.0894328   -32.082  &lt; 2e-16 ***\nFID.y543              -0.6626874  0.0498350   -13.298  &lt; 2e-16 ***\nFID.y544              -1.5388530  0.0476728   -32.279  &lt; 2e-16 ***\nFID.y545              -1.4157287  0.0473171   -29.920  &lt; 2e-16 ***\nFID.y546              -1.9168077  0.0488528   -39.236  &lt; 2e-16 ***\nFID.y547              -1.1250138  0.0493370   -22.803  &lt; 2e-16 ***\nFID.y563              -1.3285639  0.0566014   -23.472  &lt; 2e-16 ***\nFID.y565              -1.1538135  0.0479962   -24.040  &lt; 2e-16 ***\nFID.y566              -1.8967754  0.0477555   -39.718  &lt; 2e-16 ***\nFID.y567              -1.1793740  0.0471532   -25.012  &lt; 2e-16 ***\nFID.y569              -3.8237065  0.0724827   -52.753  &lt; 2e-16 ***\nFID.y585              -1.0042011  0.0524877   -19.132  &lt; 2e-16 ***\nFID.y586              -2.8739923  0.0659072   -43.607  &lt; 2e-16 ***\nFID.y587              -1.4738981  0.0482790   -30.529  &lt; 2e-16 ***\nFID.y588              -1.6527897  0.0472016   -35.016  &lt; 2e-16 ***\nFID.y589              -1.8006930  0.0476225   -37.812  &lt; 2e-16 ***\nFID.y590              -0.1515566  0.0472693    -3.206 0.001345 ** \nFID.y591              -0.8059344  0.0481878   -16.725  &lt; 2e-16 ***\nFID.y592              -2.1838695  0.0560199   -38.984  &lt; 2e-16 ***\nFID.y606              -2.1323768  0.0713775   -29.875  &lt; 2e-16 ***\nFID.y607               0.9416973  0.0473565    19.885  &lt; 2e-16 ***\nFID.y608              -0.4896506  0.0476515   -10.276  &lt; 2e-16 ***\nFID.y609              -1.1402112  0.0471331   -24.191  &lt; 2e-16 ***\nFID.y610              -1.8164973  0.0471644   -38.514  &lt; 2e-16 ***\nFID.y613              -1.1757888  0.0487439   -24.122  &lt; 2e-16 ***\nFID.y614              -2.3233861  0.0570336   -40.737  &lt; 2e-16 ***\nFID.y628               0.0081089  0.0493736     0.164 0.869546    \nFID.y629               0.6594850  0.0473099    13.940  &lt; 2e-16 ***\nFID.y630              -1.4356658  0.0477361   -30.075  &lt; 2e-16 ***\nFID.y631               0.0910095  0.0467766     1.946 0.051700 .  \nFID.y632              -1.3340818  0.0470346   -28.364  &lt; 2e-16 ***\nFID.y635              -5.0748551  0.1275954   -39.773  &lt; 2e-16 ***\nFID.y636              -4.1743017  1.0055083    -4.151 3.30e-05 ***\nFID.y637              -2.7817443  0.0632386   -43.988  &lt; 2e-16 ***\nFID.y638              -6.3396382  0.5792547   -10.944  &lt; 2e-16 ***\nFID.y639              -0.5361085  0.0498086   -10.763  &lt; 2e-16 ***\nFID.y650               0.4919410  0.0480158    10.245  &lt; 2e-16 ***\nFID.y651              -0.0696672  0.0479013    -1.454 0.145838    \nFID.y652              -1.3860878  0.0476599   -29.083  &lt; 2e-16 ***\nFID.y653              -2.2945263  0.0474246   -48.383  &lt; 2e-16 ***\nFID.y654              -0.7770996  0.0469943   -16.536  &lt; 2e-16 ***\nFID.y656              -4.5815981  0.0920657   -49.764  &lt; 2e-16 ***\nFID.y659              -2.7986164  0.0717774   -38.990  &lt; 2e-16 ***\nFID.y66                1.6550414  0.0495266    33.417  &lt; 2e-16 ***\nFID.y660              -2.8095064  0.0692392   -40.577  &lt; 2e-16 ***\nFID.y661              -2.8067075  0.0715907   -39.205  &lt; 2e-16 ***\nFID.y671              -1.3453303  0.0568373   -23.670  &lt; 2e-16 ***\nFID.y672              -7.3807887  0.5021787   -14.698  &lt; 2e-16 ***\nFID.y673              -1.7105392  0.0493499   -34.661  &lt; 2e-16 ***\nFID.y674               1.1324052  0.0467233    24.236  &lt; 2e-16 ***\nFID.y675              -2.0001296  0.0473133   -42.274  &lt; 2e-16 ***\nFID.y68               -0.2504503  0.0541498    -4.625 3.74e-06 ***\nFID.y682              -3.9053401  0.1062548   -36.754  &lt; 2e-16 ***\nFID.y683              -2.6837568  0.0692084   -38.778  &lt; 2e-16 ***\nFID.y684              -3.4125610  0.1090655   -31.289  &lt; 2e-16 ***\nFID.y69               -0.0033651  0.0506325    -0.066 0.947010    \nFID.y693              -0.8290508  0.0514208   -16.123  &lt; 2e-16 ***\nFID.y694              -1.1169232  0.0497690   -22.442  &lt; 2e-16 ***\nFID.y695              -0.9449750  0.0471134   -20.057  &lt; 2e-16 ***\nFID.y696              -1.7132654  0.0470797   -36.391  &lt; 2e-16 ***\nFID.y697              -1.4406172  0.0473274   -30.439  &lt; 2e-16 ***\nFID.y699              -6.4693768  0.2054073   -31.495  &lt; 2e-16 ***\nFID.y705              -3.2794292  0.0965897   -33.952  &lt; 2e-16 ***\nFID.y706              -1.5916337  0.0583211   -27.291  &lt; 2e-16 ***\nFID.y715              -0.8169313  0.0483441   -16.898  &lt; 2e-16 ***\nFID.y716              -0.9225196  0.0474912   -19.425  &lt; 2e-16 ***\nFID.y717              -1.7636913  0.0475657   -37.079  &lt; 2e-16 ***\nFID.y718              -0.9818408  0.0469960   -20.892  &lt; 2e-16 ***\nFID.y727              -2.5580592  0.0761329   -33.600  &lt; 2e-16 ***\nFID.y736              -1.3737836  0.0497678   -27.604  &lt; 2e-16 ***\nFID.y738              -0.9762470  0.0477916   -20.427  &lt; 2e-16 ***\nFID.y739              -1.9820582  0.0474368   -41.783  &lt; 2e-16 ***\nFID.y740              -3.4789802  0.0504426   -68.969  &lt; 2e-16 ***\nFID.y742              -1.5144076  0.0480804   -31.497  &lt; 2e-16 ***\nFID.y758              -2.2688052  0.0506066   -44.832  &lt; 2e-16 ***\nFID.y759              -1.0765276  0.0471996   -22.808  &lt; 2e-16 ***\nFID.y760              -1.2063957  0.0471421   -25.591  &lt; 2e-16 ***\nFID.y761              -2.4769411  0.0476621   -51.969  &lt; 2e-16 ***\nFID.y779               0.0798121  0.0473927     1.684 0.092171 .  \nFID.y780              -2.8582224  0.0508852   -56.170  &lt; 2e-16 ***\nFID.y781              -1.9098349  0.0490071   -38.971  &lt; 2e-16 ***\nFID.y782               0.9815653  0.0467638    20.990  &lt; 2e-16 ***\nFID.y783              -0.3400821  0.0468653    -7.257 3.97e-13 ***\nFID.y785              -1.0251498  0.0478456   -21.426  &lt; 2e-16 ***\nFID.y801              -0.6233868  0.0473809   -13.157  &lt; 2e-16 ***\nFID.y802              -0.1857836  0.0469548    -3.957 7.60e-05 ***\nFID.y803              -1.1761841  0.0471674   -24.936  &lt; 2e-16 ***\nFID.y804              -2.3566703  0.0476996   -49.406  &lt; 2e-16 ***\nFID.y822              -0.4299177  0.0474068    -9.069  &lt; 2e-16 ***\nFID.y823              -2.4587127  0.0518421   -47.427  &lt; 2e-16 ***\nFID.y824              -1.8470420  0.0476527   -38.760  &lt; 2e-16 ***\nFID.y825              -2.2381090  0.0480674   -46.562  &lt; 2e-16 ***\nFID.y826              -0.9521042  0.0469862   -20.263  &lt; 2e-16 ***\nFID.y828              -1.8340941  0.0480206   -38.194  &lt; 2e-16 ***\nFID.y845              -3.0948108  0.0503764   -61.434  &lt; 2e-16 ***\nFID.y847              -1.5088292  0.0471898   -31.974  &lt; 2e-16 ***\nFID.y850              -3.8558021  0.0538791   -71.564  &lt; 2e-16 ***\nFID.y865              -1.0663081  0.0492208   -21.664  &lt; 2e-16 ***\nFID.y868              -0.4739001  0.0470001   -10.083  &lt; 2e-16 ***\nFID.y869              -1.1272752  0.0472187   -23.873  &lt; 2e-16 ***\nFID.y88               -0.2812625  0.0634469    -4.433 9.29e-06 ***\nFID.y886               0.2516041  0.0474432     5.303 1.14e-07 ***\nFID.y887              -2.2161706  0.0503180   -44.043  &lt; 2e-16 ***\nFID.y889              -3.4827488  0.0511605   -68.075  &lt; 2e-16 ***\nFID.y89                0.4583042  0.0485479     9.440  &lt; 2e-16 ***\nFID.y890              -1.1450043  0.0470112   -24.356  &lt; 2e-16 ***\nFID.y891              -1.5196379  0.0476103   -31.918  &lt; 2e-16 ***\nFID.y893              -1.8268476  0.0473841   -38.554  &lt; 2e-16 ***\nFID.y899              -2.4061145  0.0581734   -41.361  &lt; 2e-16 ***\nFID.y908              -0.2126790  0.0473707    -4.490 7.13e-06 ***\nFID.y909              -1.0841353  0.0478283   -22.667  &lt; 2e-16 ***\nFID.y91               -1.5965375  0.0565992   -28.208  &lt; 2e-16 ***\nFID.y910              -1.2325242  0.0471675   -26.131  &lt; 2e-16 ***\nFID.y911              -0.8598100  0.0469115   -18.328  &lt; 2e-16 ***\nFID.y912              -2.0433261  0.0475417   -42.980  &lt; 2e-16 ***\nFID.y914              -5.1365019  0.0608305   -84.440  &lt; 2e-16 ***\nFID.y915              -2.3454518  0.0477086   -49.162  &lt; 2e-16 ***\nFID.y929              -0.9829434  0.0487043   -20.182  &lt; 2e-16 ***\nFID.y930              -3.7287974  0.0706993   -52.742  &lt; 2e-16 ***\nFID.y931              -3.0420571  0.0507287   -59.967  &lt; 2e-16 ***\nFID.y932              -0.9870151  0.0469675   -21.015  &lt; 2e-16 ***\nFID.y933              -1.1781985  0.0469850   -25.076  &lt; 2e-16 ***\nFID.y934              -1.5857024  0.0472358   -33.570  &lt; 2e-16 ***\nFID.y936              -1.9882365  0.0472793   -42.053  &lt; 2e-16 ***\nFID.y937              -3.7056501  0.0517660   -71.585  &lt; 2e-16 ***\nFID.y950              -2.7605994  0.0602739   -45.801  &lt; 2e-16 ***\nFID.y952              -0.8995802  0.0471265   -19.089  &lt; 2e-16 ***\nFID.y953               0.3579248  0.0467901     7.650 2.02e-14 ***\nFID.y954              -1.1305065  0.0470140   -24.046  &lt; 2e-16 ***\nFID.y955              -2.3593902  0.0478566   -49.301  &lt; 2e-16 ***\nFID.y956              -2.4633552  0.0484559   -50.837  &lt; 2e-16 ***\nFID.y957              -2.9933114  0.0485331   -61.676  &lt; 2e-16 ***\nFID.y958               0.2866999  0.0467971     6.126 8.99e-10 ***\nFID.y959              -1.5559512  0.0473413   -32.867  &lt; 2e-16 ***\nFID.y973              -2.5869043  0.0501096   -51.625  &lt; 2e-16 ***\nFID.y974              -1.0313965  0.0471006   -21.898  &lt; 2e-16 ***\nFID.y975              -1.4827750  0.0472673   -31.370  &lt; 2e-16 ***\nFID.y976              -1.1882336  0.0469838   -25.290  &lt; 2e-16 ***\nFID.y977              -2.4576340  0.0476148   -51.615  &lt; 2e-16 ***\nFID.y978              -4.5505804  0.0605082   -75.206  &lt; 2e-16 ***\nFID.y979              -1.9967700  0.0471778   -42.324  &lt; 2e-16 ***\nFID.y980              -4.1992414  0.0522491   -80.370  &lt; 2e-16 ***\nFID.y981               0.0674819  0.0469126     1.438 0.150304    \nFID.y984              -2.7596013  0.0550043   -50.171  &lt; 2e-16 ***\nFID.y985              -1.2304544  0.0496088   -24.803  &lt; 2e-16 ***\nFID.y993              -0.7836896  0.0485140   -16.154  &lt; 2e-16 ***\nFID.y994               0.4315067  0.0473544     9.112  &lt; 2e-16 ***\nFID.y995              -1.4136307  0.0475557   -29.726  &lt; 2e-16 ***\nFID.y996              -0.7879325  0.0470979   -16.730  &lt; 2e-16 ***\nFID.y997              -2.5223456  0.0483477   -52.171  &lt; 2e-16 ***\nFID.y998              -0.8958904  0.0468895   -19.106  &lt; 2e-16 ***\nFID.y999              -1.6046325  0.0472024   -33.995  &lt; 2e-16 ***\nlog(SCHOOL_COUNT)             NA         NA        NA       NA    \nlog(BUSINESS_COUNT)           NA         NA        NA       NA    \nlog(FINANCE_COUNT)            NA         NA        NA       NA    \nlog(HDB_COUNT)                NA         NA        NA       NA    \nlog(TRAIN_COUNT)              NA         NA        NA       NA    \nlog(UNIVERSITY_COUNT)         NA         NA        NA       NA    \nlog(dist)             -1.5024838  0.0002782 -5401.208  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 99391956  on 83713  degrees of freedom\nResidual deviance: 26321677  on 81666  degrees of freedom\nAIC: 26770590\n\nNumber of Fisher Scoring iterations: 13\n\n\n\n8.6.1 Goodness of fit\n\nCalcRSquared(dbcSIM_Poisson$data$MORNING_PEAK,\n             dbcSIM_Poisson$fitted.values)\n\n[1] 0.5662579"
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#statistical-measures",
    "href": "take_home_ex2/take_home_ex2.html#statistical-measures",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "9.1 Statistical measures",
    "text": "9.1 Statistical measures\nFirst of all, I will create a list called model_list by using the code chunk below.\n\nmodel_list &lt;- list(\n  Unconstrained= uncSIM,\n  Origin_Constrained = orcSIM,\n  Destination_Constrained = decSIM,\n  Doubly_Constrained = dbcSIM_Poisson)\n\nNext, I will compute the RMSE of all the models in model_list file by using the code chunk below.\n\ncompare_performance(model_list,\n                    metrics = \"RMSE\")\n\n# Comparison of Model Performance Indices\n\nName                    | Model |     RMSE\n------------------------------------------\nUnconstrained           |   glm | 1364.886\nOrigin_Constrained      |   glm | 1223.219\nDestination_Constrained |   glm | 1247.124\nDoubly_Constrained      |   glm |  970.640\n\n\nThe print above reveals that doubly constrained SIM is the best model among the 4 SIMs because it has the smallest RMSE value."
  },
  {
    "objectID": "take_home_ex2/take_home_ex2.html#visualising-fitted-values",
    "href": "take_home_ex2/take_home_ex2.html#visualising-fitted-values",
    "title": "Take-home Exercise 2: Applied Spatial Interaction Models: A case study of Singapore public bus commuter flows",
    "section": "9.2 Visualising fitted values",
    "text": "9.2 Visualising fitted values\nI will do a plot to visualise the observed values and the fitted values.\nFirstly I will extract the fitted values from Origin-constrained Model by using the code chunk below.\n\ndf &lt;- as.data.frame(orcSIM$fitted.values) %&gt;%\n  round(digits = 0)\n\nNext, I will append the fitted values into inter_zonal_flow data frame by using the code chunk below.\n\ninter_zonal_flow &lt;- inter_zonal_flow %&gt;%\n  cbind(df) %&gt;%\n  rename(orcTRIPS = \"orcSIM$fitted.values\")\n\nI will do the same for dbcSIM_Poisson\n\ndf1 &lt;- as.data.frame(dbcSIM_Poisson$fitted.values) %&gt;%\n  round(digits = 0)\n\n\ninter_zonal_flow &lt;- inter_zonal_flow %&gt;%\n  cbind(df1) %&gt;%\n  rename(dbcTRIPS = \"dbcSIM_Poisson$fitted.values\")\n\nI will do the same for uncSIM\n\ndf2 &lt;- as.data.frame(uncSIM$fitted.values) %&gt;%\n  round(digits = 0)\n\n\ninter_zonal_flow &lt;- inter_zonal_flow %&gt;%\n  cbind(df2) %&gt;%\n  rename(uncTRIPS = \"uncSIM$fitted.values\")\n\nI will do the same for decSIM\n\ndf3 &lt;- as.data.frame(decSIM$fitted.values) %&gt;%\n  round(digits = 0)\n\n\ninter_zonal_flow &lt;- inter_zonal_flow %&gt;%\n  cbind(df3) %&gt;%\n  rename(decTRIPS = \"decSIM$fitted.values\")\n\nNext, 4 scatterplots will be created by using geom_point() and other appropriate functions of ggplot2 package.\n\norc_p &lt;- ggplot(data = inter_zonal_flow,\n                aes(x = orcTRIPS,\n                    y = MORNING_PEAK)) +\n  geom_point() +\n  geom_smooth(method = lm) +\n  coord_cartesian(xlim=c(0,100000),\n                  ylim=c(0,100000))\n\ndbc_p &lt;- ggplot(data = inter_zonal_flow,\n                aes(x = dbcTRIPS,\n                    y = MORNING_PEAK)) +\n  geom_point() +\n  geom_smooth(method = lm) +\n  coord_cartesian(xlim=c(0,100000),\n                  ylim=c(0,100000))\n\n\nunc_p &lt;- ggplot(data = inter_zonal_flow,\n                aes(x = uncTRIPS,\n                    y = MORNING_PEAK)) +\n  geom_point() +\n  geom_smooth(method = lm) +\n  coord_cartesian(xlim=c(0,100000),\n                  ylim=c(0,100000))\n\n\ndec_p &lt;- ggplot(data = inter_zonal_flow,\n                aes(x = decTRIPS,\n                    y = MORNING_PEAK)) +\n  geom_point() +\n  geom_smooth(method = lm) +\n  coord_cartesian(xlim=c(0,100000),\n                  ylim=c(0,100000))\n\nNow, I will put all the graphs into a single visual for better comparison by using the code chunk below.\n\nggarrange(unc_p, orc_p, dec_p, dbc_p,\n          ncol = 2,\n          nrow = 2)\n\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'"
  }
]